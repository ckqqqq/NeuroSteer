2025-02-19 19:00:49,388 [INFO] Logging initialized. Logs will be saved to ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/alpha_10.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-19 19:00:49,388 [INFO] Show Hyperparameters: 


2025-02-19 19:00:49,388 [INFO]   task: polite
2025-02-19 19:00:49,388 [INFO]   layer: 6
2025-02-19 19:00:49,388 [INFO]   LLM: gpt2-small
2025-02-19 19:00:49,388 [INFO]   seed: 42
2025-02-19 19:00:49,388 [INFO]   data_size: -1
2025-02-19 19:00:49,388 [INFO]   device: cuda
2025-02-19 19:00:49,388 [INFO]   alpha: 10.0
2025-02-19 19:00:49,388 [INFO]   method: val_mul
2025-02-19 19:00:49,388 [INFO]   topk_mean: 100
2025-02-19 19:00:49,388 [INFO]   topk_cnt: 150
2025-02-19 19:00:49,388 [INFO]   batch_size: 32
2025-02-19 19:00:49,389 [INFO]   source: pos
2025-02-19 19:00:49,389 [INFO]   target: neg
2025-02-19 19:00:49,389 [INFO]   prompt_source: pos
2025-02-19 19:00:49,389 [INFO]   prompt_data_size: 100
2025-02-19 19:00:49,389 [INFO]   mean_type: dif_mean
2025-02-19 19:00:49,389 [INFO]   steer_type: all
2025-02-19 19:00:49,389 [INFO]   output_dir: ./results/polite/
2025-02-19 19:00:49,389 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:00:49,389 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:00:49,389 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-19 19:00:49,389 [INFO]   temperature: 0.9
2025-02-19 19:00:49,389 [INFO]   top_p: 0.3
2025-02-19 19:00:49,389 [INFO]   freq_penalty: 1.0
2025-02-19 19:00:49,389 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act wil
2025-02-19 19:00:49,389 [INFO]   debug: 0
2025-02-19 19:00:49,389 [INFO]   save_no_steer: 1
2025-02-19 19:00:49,389 [INFO]   is_norm_delta_matrix: 0
2025-02-19 19:00:49,389 [INFO]   use_cache: 0
2025-02-19 19:00:49,389 [INFO]   repeat_num: 2
2025-02-19 19:00:49,389 [INFO]   gen_batch_size: 16
2025-02-19 19:00:49,389 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-19 19:00:49,389 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:00:49,389 [INFO] politepolitepolitepolitepolitepolitepolitepolitepolitepolite
2025-02-19 19:00:49,389 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:00:49,420 [INFO] Filtering dataset for polite and nonpolite samples
2025-02-19 19:00:49,425 [INFO] Selected 4136 polite and 4098 nonpolite samples
2025-02-19 19:00:49,425 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-19 19:00:49,425 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-19 19:01:12,580 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-19 19:01:12,580 [INFO] 缓存 ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-19 19:01:12,614 [INFO] :>> polite : from pos to neg
2025-02-19 19:01:12,630 [INFO] positive
2025-02-19 19:01:12,645 [INFO] Running model with cache to obtain hidden states
2025-02-19 19:01:18,335 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-19 19:01:18,336 [INFO] negative
2025-02-19 19:01:18,352 [INFO] Running model with cache to obtain hidden states
2025-02-19 19:01:24,360 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-19 19:01:24,363 [INFO] steer_info 已保存到缓存 ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-19 19:01:24,377 [INFO] 转向方向 dif_neg-pos_relu
2025-02-19 19:01:24,410 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-19 19:01:24,420 [INFO] Generating texts **without** steering... 
2025-02-19 19:01:24,420 [INFO] 无转向结果
2025-02-19 19:01:24,421 [INFO] 无干预
2025-02-19 19:01:25,843 [INFO] 当前批次共处理2个prompt
2025-02-19 19:01:25,844 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-19 19:01:25,844 [INFO] 生成 1: | be a huge blow to the Democratic Party, which has been struggling to find a viable alternative.

"I think it's very important that we have an alternative," said Democratic National Committee Chairman Tom Perez, who is also running for president. "|
2025-02-19 19:01:25,844 [INFO] 生成 2: | be a big problem for the nation's most vulnerable.

The state's budget shortfall is expected to reach $1.4 billion by 2026, according to a report released Tuesday by the nonpartisan Congressional Budget Office. That means about half of all|
2025-02-19 19:01:25,844 [INFO] 生成 3: | be even more damaging to his campaign.

The GOP presidential nominee has been in the news recently for a series of tweets that were intended to show support for Sen. Ted Cruz (R-TX) and other Republicans who have criticized him over his|
2025-02-19 19:01:25,844 [INFO] Prompt 2: | The passage of the AI Act wil|
2025-02-19 19:01:25,844 [INFO] 生成 1: |fully fails to address the issues raised by AI and its proponents.

In a letter to the Senate, Microsoft's head of research and development, Mark Mullen, wrote that "the [AI] Act is not an effective way forward for advancing|
2025-02-19 19:01:25,844 [INFO] 生成 2: |fully and deliberately disregards the fundamental rights of every citizen.

The AI Act will be a big step forward for India's digital economy. It will ensure that all citizens have access to the internet, which is a critical tool for all people.|
2025-02-19 19:01:25,844 [INFO] 生成 3: |fully destroys our privacy.

The law is not about protecting your privacy, it's about creating a world where we can all be anonymous and free to choose what we want to do with our lives. It's not about keeping you safe from the|
2025-02-19 19:01:25,844 [INFO] 干预之后的结果
2025-02-19 19:01:25,844 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-19 19:01:25,844 [INFO] ** Generating texts with steering... Target **
2025-02-19 19:01:25,844 [INFO] form pos to neg
2025-02-19 19:01:25,844 [INFO] 转向结果
2025-02-19 19:01:26,775 [INFO] 当前批次共处理2个prompt
2025-02-19 19:01:26,776 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-19 19:01:26,776 [INFO] 生成 1: | so quickly change the way we live?

The answer is simple. The reason is simple: because it's easier to live in a city with fewer people than cities with more people, and less space to live in? Why are there fewer people|
2025-02-19 19:01:26,776 [INFO] 生成 2: |?

The answer is because it's a good question. The reason why we need to have a better understanding of how our brains work is because it's important to understand how our brains work in order to understand what makes us tick? Why do|
2025-02-19 19:01:26,776 [INFO] 生成 3: | you like to be able to use your smartphone when you can't use your phone on a regular basis?

The answer is because the iPhone 5S is a great device for its price. It's cheaper than many other smartphones, and it's|
2025-02-19 19:01:26,776 [INFO] Prompt 2: | The passage of the AI Act wil|
2025-02-19 19:01:26,776 [INFO] 生成 1: | we? Why do I have to make a living as a journalist?

The answer is simple. Because there are so many ways to get paid for your work. There are so many ways to earn money, and so many ways to get paid|
2025-02-19 19:01:26,776 [INFO] 生成 2: |? Why is it so important to have a natural-born human with no biological background?

The answer is because it's easier to develop a better understanding of the human brain than it is to develop a better understanding of how we can improve our|
2025-02-19 19:01:26,776 [INFO] 生成 3: |? Why are you asking this question?

Why is it that a woman can't be a part of the community, even if she's a member of the community? Why do people like me feel so strongly about our rights and our rights to|
2025-02-19 19:01:26,781 [INFO] Provide No Steer Result 提供无干预对照样本
2025-02-19 19:01:26,781 [INFO] Running on full data
2025-02-19 19:01:26,781 [INFO] In Domain: Calculate at A train dataset, Evaluate at A test dataset
2025-02-19 19:01:26,781 [INFO] Spliting prompt from Dataset({
    features: ['text', 'label', 'sentiment'],
    num_rows: 4107
})
2025-02-19 19:01:26,793 [INFO] prompt的极性是pos
2025-02-19 19:01:26,793 [INFO] Running with alpha: 10.0
2025-02-19 19:01:26,793 [INFO] Running with prompt_type: from pos to neg
2025-02-19 19:01:26,794 [WARNING] 截取prompt_datasize100
2025-02-19 19:01:26,799 [INFO] 无干预
2025-02-19 19:01:28,814 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 19:01:28,814 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Is it a bluetooth keyboard? And does this Apple link http://support.apple.com/kb/TA23441?viewlocale=en_US by chance help at all?'}, 'generations': [{'text': "Is it a bluetooth keyboard? And does this Apple link http://support.apple.com/kb/TA23441?viewlocale=en_US by chance help at all?Why I'm not doing the study of how to build a more efficient, more efficient CPU and GPU ?\n\nI've been using an AMD CPU for years now, and my main reason is because I'm not using a lot of cores in my"}, {'text': "Is it a bluetooth keyboard? And does this Apple link http://support.apple.com/kb/TA23441?viewlocale=en_US by chance help at all? why is there such a simple and powerful tool like the one in the calculator so easy to use, even when you can't see your face on my face, and then use my own calculator with an app like this one that I'm using every day"}]}
2025-02-19 19:01:28,818 [INFO] 无干预
2025-02-19 19:01:30,696 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 19:01:30,697 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Can you let us know what error you got or in what way its failing to load. Also can you copy&paste a NSLog output of the full URL String for both the | and the %7C version of the string?'}, 'generations': [{'text': "Can you let us know what error you got or in what way its failing to load. Also can you copy&paste a NSLog output of the full URL String for both the | and the %7C version of the string? why is there a different language like C#?\n\nIt's because I'm not writing this article, it's because I'm writing this article about how to create an awesome web application that uses your codebase without having to write so much code"}, {'text': "Can you let us know what error you got or in what way its failing to load. Also can you copy&paste a NSLog output of the full URL String for both the | and the %7C version of the string? why is there such a good article on how to make your own mobile app that's so easy to use?\n\nThe answer is simple, because it's very simple. The reason why we're here is because we want to understand our user experience"}]}
2025-02-19 19:01:30,700 [INFO] 无干预
2025-02-19 19:01:32,507 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 19:01:32,508 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Ozan asks a good question below.  Out of curiosity, is this just a logic puzzle, or is there a reason someone would need to avoid basic language constructs?'}, 'generations': [{'text': "Ozan asks a good question below.  Out of curiosity, is this just a logic puzzle, or is there a reason someone would need to avoid basic language constructs? why can't you just use the same database for all your own data?\n\nThe answer to this question can be found in the following article: Why Database Server Databases are so popular with clients like me\n\nWhy SQLite's Database Server"}, {'text': "Ozan asks a good question below.  Out of curiosity, is this just a logic puzzle, or is there a reason someone would need to avoid basic language constructs? why do I have the option of using one of my own tools when I can use all the other tools in my own project?\n\nThe answer to this question is simple. Because it's easier to maintain your site and make more money from your"}]}
2025-02-19 19:01:32,512 [INFO] 无干预
2025-02-19 19:01:34,289 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 19:01:34,289 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Correct, the ranges are intended to be discontinuous. I think if ranges were continuous, then it would really be just one range, without any breaks/gaps, correct?'}, 'generations': [{'text': 'Correct, the ranges are intended to be discontinuous. I think if ranges were continuous, then it would really be just one range, without any breaks/gaps, correct? why is there a new PBR like this?\n\nThis article is part of our series on Cascading Style Guide (CSC) guidelines for how to build a well-rounded physique in your life? Why exercise more muscle when you can'}, {'text': "Correct, the ranges are intended to be discontinuous. I think if ranges were continuous, then it would really be just one range, without any breaks/gaps, correct?Why do you ask this question?Because of the extra benefits that make up your body's physiology\n\nYou're going to lose weight when you're eating more calories than you need from carbohydrates\n\nWhy are carbs so important for your health and wellbeing"}]}
2025-02-19 19:01:34,293 [INFO] 无干预
2025-02-19 19:01:36,115 [INFO] 无干预
2025-02-19 19:01:38,092 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 19:01:38,092 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': "I'm expriencing the same thing. Did you resolve this?"}, 'generations': [{'text': "I'm expriencing the same thing. Did you resolve this? why are you doing this? Why do I need to be a part of my own life?\n\nThe answer is because there's no other way to get started with a project like this. If you're looking for something new, or if you"}, {'text': "I'm expriencing the same thing. Did you resolve this?? Why is there a lot of people who are interested in the current topic of technology and data analytics, especially when it comes to information security?\n\nThe answer is because we have an extremely important role to play in the future of business. We"}]}
2025-02-19 19:01:38,097 [INFO] 无干预
2025-02-19 19:01:39,709 [INFO] 训练时间11.782299518585205
2025-02-19 19:01:39,709 [INFO] Show Hyperparameters: 


2025-02-19 19:01:39,709 [INFO]   task: polite
2025-02-19 19:01:39,709 [INFO]   layer: 6
2025-02-19 19:01:39,709 [INFO]   LLM: gpt2-small
2025-02-19 19:01:39,709 [INFO]   seed: 42
2025-02-19 19:01:39,709 [INFO]   data_size: -1
2025-02-19 19:01:39,709 [INFO]   device: cuda
2025-02-19 19:01:39,710 [INFO]   alpha: 10.0
2025-02-19 19:01:39,710 [INFO]   method: val_mul
2025-02-19 19:01:39,710 [INFO]   topk_mean: 100
2025-02-19 19:01:39,710 [INFO]   topk_cnt: 150
2025-02-19 19:01:39,710 [INFO]   batch_size: 32
2025-02-19 19:01:39,710 [INFO]   source: pos
2025-02-19 19:01:39,710 [INFO]   target: neg
2025-02-19 19:01:39,710 [INFO]   prompt_source: pos
2025-02-19 19:01:39,710 [INFO]   prompt_data_size: 100
2025-02-19 19:01:39,710 [INFO]   mean_type: dif_mean
2025-02-19 19:01:39,710 [INFO]   steer_type: all
2025-02-19 19:01:39,710 [INFO]   output_dir: ./results/polite/
2025-02-19 19:01:39,710 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:01:39,710 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 19:01:39,710 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-19 19:01:39,710 [INFO]   temperature: 0.9
2025-02-19 19:01:39,710 [INFO]   top_p: 0.3
2025-02-19 19:01:39,710 [INFO]   freq_penalty: 1.0
2025-02-19 19:01:39,710 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act wil
2025-02-19 19:01:39,710 [INFO]   debug: 0
2025-02-19 19:01:39,710 [INFO]   save_no_steer: 1
2025-02-19 19:01:39,710 [INFO]   is_norm_delta_matrix: 0
2025-02-19 19:01:39,710 [INFO]   use_cache: 0
2025-02-19 19:01:39,710 [INFO]   repeat_num: 2
2025-02-19 19:01:39,710 [INFO]   gen_batch_size: 16
2025-02-19 19:01:39,710 [INFO]   real_data_size_for_train: 4098
2025-02-19 19:01:39,710 [INFO] polite:pos->neg
2025-02-19 20:06:42,110 [INFO] Logging initialized. Logs will be saved to ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/alpha_10.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-19 20:06:42,110 [INFO] Show Hyperparameters: 


2025-02-19 20:06:42,111 [INFO]   task: polite
2025-02-19 20:06:42,111 [INFO]   layer: 6
2025-02-19 20:06:42,111 [INFO]   LLM: gpt2-small
2025-02-19 20:06:42,111 [INFO]   seed: 42
2025-02-19 20:06:42,111 [INFO]   data_size: -1
2025-02-19 20:06:42,111 [INFO]   device: cuda
2025-02-19 20:06:42,111 [INFO]   alpha: 10.0
2025-02-19 20:06:42,111 [INFO]   method: val_mul
2025-02-19 20:06:42,111 [INFO]   topk_mean: 100
2025-02-19 20:06:42,111 [INFO]   topk_cnt: 150
2025-02-19 20:06:42,111 [INFO]   batch_size: 32
2025-02-19 20:06:42,111 [INFO]   source: pos
2025-02-19 20:06:42,111 [INFO]   target: neg
2025-02-19 20:06:42,111 [INFO]   prompt_source: pos
2025-02-19 20:06:42,111 [INFO]   prompt_data_size: 100
2025-02-19 20:06:42,111 [INFO]   mean_type: dif_mean
2025-02-19 20:06:42,111 [INFO]   steer_type: all
2025-02-19 20:06:42,111 [INFO]   output_dir: ./results/polite/
2025-02-19 20:06:42,111 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:06:42,111 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:06:42,111 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-19 20:06:42,111 [INFO]   temperature: 0.9
2025-02-19 20:06:42,111 [INFO]   top_p: 0.3
2025-02-19 20:06:42,111 [INFO]   freq_penalty: 1.0
2025-02-19 20:06:42,111 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act wil
2025-02-19 20:06:42,111 [INFO]   debug: 0
2025-02-19 20:06:42,111 [INFO]   save_no_steer: 1
2025-02-19 20:06:42,111 [INFO]   is_norm_delta_matrix: 0
2025-02-19 20:06:42,111 [INFO]   use_cache: 0
2025-02-19 20:06:42,111 [INFO]   repeat_num: 2
2025-02-19 20:06:42,111 [INFO]   gen_batch_size: 16
2025-02-19 20:06:42,111 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-19 20:06:42,112 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:06:42,112 [INFO] politepolitepolitepolitepolitepolitepolitepolitepolitepolite
2025-02-19 20:06:42,112 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:06:42,136 [INFO] Filtering dataset for polite and nonpolite samples
2025-02-19 20:06:42,140 [INFO] Selected 4136 polite and 4098 nonpolite samples
2025-02-19 20:06:42,141 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-19 20:06:42,141 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-19 20:08:04,610 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-19 20:08:04,610 [INFO] 缓存 ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-19 20:08:04,643 [INFO] :>> polite : from pos to neg
2025-02-19 20:08:04,658 [INFO] positive
2025-02-19 20:08:04,674 [INFO] Running model with cache to obtain hidden states
2025-02-19 20:08:10,431 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-19 20:08:10,432 [INFO] negative
2025-02-19 20:08:10,447 [INFO] Running model with cache to obtain hidden states
2025-02-19 20:08:16,338 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-19 20:08:16,340 [INFO] steer_info 已保存到缓存 ./results/polite/gpt2-small_polite_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-19 20:08:16,352 [INFO] 转向方向 dif_neg-pos_relu
2025-02-19 20:08:16,381 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-19 20:08:16,390 [INFO] Generating texts **without** steering... 
2025-02-19 20:08:16,390 [INFO] 无转向结果
2025-02-19 20:08:16,392 [INFO] 无干预
2025-02-19 20:08:17,876 [INFO] 当前批次共处理2个prompt
2025-02-19 20:08:17,877 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-19 20:08:17,877 [INFO] 生成 1: | be a huge blow to those who want to work in the industry.

"It's a big loss for our business," said John F. Hebert, president of U.S.-based American Federation of State, County and Municipal Employees Local|
2025-02-19 20:08:17,877 [INFO] 生成 2: | mean that many of those who are eligible for Medicaid would not be able to afford it.

"We're talking about a huge number of people who are struggling to make ends meet," said Robert Coughlin, executive director of the American Federation|
2025-02-19 20:08:17,877 [INFO] 生成 3: | have been a huge blow to Mr. Trump's campaign, which had already spent $3 million on ads in Iowa and New Hampshire.

The ad, which ran in Iowa and New Hampshire on Wednesday, drew more than 2 million views on Facebook|
2025-02-19 20:08:17,877 [INFO] Prompt 2: | The passage of the AI Act wil|
2025-02-19 20:08:17,877 [INFO] 生成 1: |fully misrepresents the government's position on AI.

The Government has made clear that it will not tolerate any kind of harassment or discrimination against anyone, including those who are based in India. It is also committed to ensuring that all people have|
2025-02-19 20:08:17,877 [INFO] 生成 2: |fully ignores the fact that we are not yet at a point where we can say that it is time to take action. We have already seen how much progress has been made in this area, and how many more steps will be needed before we can make|
2025-02-19 20:08:17,877 [INFO] 生成 3: |fully and deliberately erodes the trust of the people, and will not be tolerated.

The bill was introduced by Senators John McCain (R-AZ) and Lindsey Graham (R-SC). It is a response to an earlier version of this|
2025-02-19 20:08:17,877 [INFO] 干预之后的结果
2025-02-19 20:08:17,877 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-19 20:08:17,877 [INFO] ** Generating texts with steering... Target **
2025-02-19 20:08:17,877 [INFO] form pos to neg
2025-02-19 20:08:17,877 [INFO] 转向结果
2025-02-19 20:08:18,804 [INFO] 当前批次共处理2个prompt
2025-02-19 20:08:18,804 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-19 20:08:18,804 [INFO] 生成 1: | so quickly become apparent to everyone?

Why are so many people looking for a new job when there are more options available? Why can't we just take advantage of the benefits offered by our employers, such as higher wages and better benefits for those|
2025-02-19 20:08:18,804 [INFO] 生成 2: |?

Why are there so many more than one-hundred different variations on the same idea? Why do we have so many different ways to define what a "moderator" is? Why are there so many different ways to define what|
2025-02-19 20:08:18,804 [INFO] 生成 3: | you rather have a higher standard of living?

Because the cost of living is so high, it's hard to find a better way to live. It's not just that there are fewer people in poverty, but also because there are fewer jobs|
2025-02-19 20:08:18,804 [INFO] Prompt 2: | The passage of the AI Act wil|
2025-02-19 20:08:18,804 [INFO] 生成 1: | you do something so different from your own? Why is it that we can use our own skills to improve our products and services?

Because it's easier to get a job when you're working in a different field. You don't have to|
2025-02-19 20:08:18,804 [INFO] 生成 2: | you be so happy when you can't get a job at your local restaurant?

We're not just talking about the reasons why we're here. Why are we here, and why do we need to stay here for so long? Because it|
2025-02-19 20:08:18,804 [INFO] 生成 3: |? Why do I have to pay for my own travel expenses when I can afford to spend less on food and fuel than I need?

The answer is simple. Because you're going to get more money from your income, you'll be able|
2025-02-19 20:08:18,809 [INFO] Provide No Steer Result 提供无干预对照样本
2025-02-19 20:08:18,809 [INFO] Running on full data
2025-02-19 20:08:18,809 [INFO] In Domain: Calculate at A train dataset, Evaluate at A test dataset
2025-02-19 20:08:18,809 [INFO] Spliting prompt from Dataset({
    features: ['text', 'label', 'sentiment'],
    num_rows: 4107
})
2025-02-19 20:08:19,117 [INFO] prompt的极性是pos
2025-02-19 20:08:19,117 [INFO] Running with alpha: 10.0
2025-02-19 20:08:19,117 [INFO] Running with prompt_type: from pos to neg
2025-02-19 20:08:19,118 [WARNING] 截取prompt_datasize100
2025-02-19 20:08:19,122 [INFO] 无干预
2025-02-19 20:08:21,058 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 20:08:21,058 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Is it a bluetooth keyboard? And does this Apple li'}, 'generations': [{'text': 'Is it a bluetooth keyboard? And does this Apple li I\'m going to show you how to make a new app for my app?\n\nThis is the answer.\n\nThe reason why we use the "iOS" version of our website is because it\'s easier than ever. We can get more'}, {'text': "Is it a bluetooth keyboard? And does this Apple liWhy why can't I use the best product in the world?\n\nBecause you can easily use your phone with your own device, right now. It's so easy to use, and it's so convenient for you.\n\nIf you're"}]}
2025-02-19 20:08:21,062 [INFO] 无干预
2025-02-19 20:08:22,782 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 20:08:22,782 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Can you let us know what error you got or in what '}, 'generations': [{'text': "Can you let us know what error you got or in what  why?\n\nThe answer is simple. The reason we need to understand the purpose of the book is because it's a great resource for those who want to learn more about how to build a functional web application? Because it's easy to understand and"}, {'text': "Can you let us know what error you got or in what ?\n\nI'm a very active and passionate fan of the D-Pad Pro?\n\nBecause I love the 3D Touch that makes my life so much easier. I've been using it for over 10 years now, and I have no"}]}
2025-02-19 20:08:22,786 [INFO] 无干预
2025-02-19 20:08:24,614 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 20:08:24,614 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Ozan asks a good question below.  Out of curiosity'}, 'generations': [{'text': "Ozan asks a good question below.  Out of curiosityWhy I can't do this?\n\nBecause it's easier to do things like this when you're working on something that's really important, such as your portfolio or your business plan?\n\nThe answer is because it makes sense. It allows"}, {'text': "Ozan asks a good question below.  Out of curiosity why I'm doing this?\n\nBecause the way we are presented in the game is so important to us, we need to be able to use our powers and abilities in order to survive.\n\nWhy is it that you can only use your"}]}
2025-02-19 20:08:24,618 [INFO] 无干预
2025-02-19 20:08:26,496 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 20:08:26,496 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': 'Correct, the ranges are intended to be discontinuo'}, 'generations': [{'text': "Correct, the ranges are intended to be discontinuo?\n\nBecause it's so easy to do so? Why don't you just use your own method of using a regular object instead of a simple one? The answer is because the design is different. You can use any object that you want without"}, {'text': 'Correct, the ranges are intended to be discontinuo?\n\nBecause it\'s a new concept, we\'re going to use the term "performance" in order to explain why we\'re using performance as a metric of how well you perform at work? Because when you look at your current job, what'}]}
2025-02-19 20:08:26,500 [INFO] 无干预
2025-02-19 20:08:28,214 [INFO] 无干预
2025-02-19 20:08:30,244 [INFO] polite: from pos to neg prompt_set: pos
2025-02-19 20:08:30,244 [INFO] {'label': 2, 'sentiment': 'Polite', 'prompt': {'text': "I'm expriencing the same thing. Did you resolve th"}, 'generations': [{'text': "I'm expriencing the same thing. Did you resolve th why? Why are there so many other ways to use this tool when you can just use a simple one?\n\nWhy do I need a fancy calculator that can calculate my own daily calories and fuel consumption? It's easy to calculate your own daily"}, {'text': "I'm expriencing the same thing. Did you resolve th? Why is there a white knight in this army?\n\nBecause it's an army that can't win with just one player?\n\nWhy is there a white knight in this army, when they have so many options and so few options to"}]}
2025-02-19 20:08:30,249 [INFO] 无干预
2025-02-19 20:08:31,838 [INFO] 训练时间11.7302885055542
2025-02-19 20:08:31,838 [INFO] Show Hyperparameters: 


2025-02-19 20:08:31,838 [INFO]   task: polite
2025-02-19 20:08:31,838 [INFO]   layer: 6
2025-02-19 20:08:31,838 [INFO]   LLM: gpt2-small
2025-02-19 20:08:31,838 [INFO]   seed: 42
2025-02-19 20:08:31,838 [INFO]   data_size: -1
2025-02-19 20:08:31,838 [INFO]   device: cuda
2025-02-19 20:08:31,838 [INFO]   alpha: 10.0
2025-02-19 20:08:31,838 [INFO]   method: val_mul
2025-02-19 20:08:31,838 [INFO]   topk_mean: 100
2025-02-19 20:08:31,838 [INFO]   topk_cnt: 150
2025-02-19 20:08:31,838 [INFO]   batch_size: 32
2025-02-19 20:08:31,838 [INFO]   source: pos
2025-02-19 20:08:31,838 [INFO]   target: neg
2025-02-19 20:08:31,838 [INFO]   prompt_source: pos
2025-02-19 20:08:31,838 [INFO]   prompt_data_size: 100
2025-02-19 20:08:31,838 [INFO]   mean_type: dif_mean
2025-02-19 20:08:31,838 [INFO]   steer_type: all
2025-02-19 20:08:31,838 [INFO]   output_dir: ./results/polite/
2025-02-19 20:08:31,838 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:08:31,838 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-19 20:08:31,838 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-19 20:08:31,838 [INFO]   temperature: 0.9
2025-02-19 20:08:31,838 [INFO]   top_p: 0.3
2025-02-19 20:08:31,838 [INFO]   freq_penalty: 1.0
2025-02-19 20:08:31,838 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act wil
2025-02-19 20:08:31,838 [INFO]   debug: 0
2025-02-19 20:08:31,838 [INFO]   save_no_steer: 1
2025-02-19 20:08:31,838 [INFO]   is_norm_delta_matrix: 0
2025-02-19 20:08:31,838 [INFO]   use_cache: 0
2025-02-19 20:08:31,839 [INFO]   repeat_num: 2
2025-02-19 20:08:31,839 [INFO]   gen_batch_size: 16
2025-02-19 20:08:31,839 [INFO]   real_data_size_for_train: 4098
2025-02-19 20:08:31,839 [INFO] polite:pos->neg
