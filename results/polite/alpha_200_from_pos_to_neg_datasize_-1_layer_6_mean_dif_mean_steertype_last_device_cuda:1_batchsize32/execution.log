2025-02-06 18:48:46,832 [INFO] Logging initialized. Logs will be saved to ./results/polite/alpha_200_from_pos_to_neg_datasize_-1_layer_6_mean_dif_mean_steertype_last_device_cuda:1_batchsize32/execution.log
2025-02-06 18:48:46,832 [INFO] Hyperparameters:
2025-02-06 18:48:46,832 [INFO]   task: polite
2025-02-06 18:48:46,833 [INFO]   layer: 6
2025-02-06 18:48:46,833 [INFO]   LLM: gpt2-small
2025-02-06 18:48:46,833 [INFO]   seed: 42
2025-02-06 18:48:46,833 [INFO]   data_size: -1
2025-02-06 18:48:46,833 [INFO]   device: cuda:1
2025-02-06 18:48:46,833 [INFO]   alpha: 200
2025-02-06 18:48:46,833 [INFO]   steer: neg-pos
2025-02-06 18:48:46,833 [INFO]   source: pos
2025-02-06 18:48:46,833 [INFO]   target: neg
2025-02-06 18:48:46,833 [INFO]   method: val_mul
2025-02-06 18:48:46,833 [INFO]   topk_mean: 100
2025-02-06 18:48:46,833 [INFO]   topk_cnt: 100
2025-02-06 18:48:46,833 [INFO]   topp: 0.1
2025-02-06 18:48:46,833 [INFO]   temperature: 1.0
2025-02-06 18:48:46,833 [INFO]   batch_size: 32
2025-02-06 18:48:46,833 [INFO]   mean_type: dif_mean
2025-02-06 18:48:46,833 [INFO]   steer_type: last
2025-02-06 18:48:46,833 [INFO]   debug: False
2025-02-06 18:48:46,833 [INFO]   output_dir: ./results/polite
2025-02-06 18:48:46,833 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-06 18:48:46,833 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-06 18:48:46,833 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 18:48:46,833 [INFO]   save_compared: False
2025-02-06 18:48:46,834 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 18:48:46,834 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-06 18:48:46,834 [INFO] politepolitepolitepolitepolitepolitepolitepolitepolitepolite
2025-02-06 18:48:46,834 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/style_transfer/politeness-corpus
2025-02-06 18:48:46,860 [INFO] Filtering dataset for polite and nonpolite samples
2025-02-06 18:48:46,864 [INFO] Selected 2795 polite and 2734 nonpolite samples
2025-02-06 18:48:46,864 [INFO] Loading model: gpt2-small
2025-02-06 18:48:47,803 [INFO] Loading SAE for layer 6
2025-02-06 18:48:49,039 [INFO] frompostoneg
2025-02-06 18:48:49,039 [INFO] polite
2025-02-06 18:48:49,050 [INFO] Running model with cache to obtain hidden states
2025-02-06 18:48:49,051 [INFO] Batch 1: batch_size 32
2025-02-06 18:48:49,356 [INFO] Batch 1: Hidden states shape: torch.Size([32, 43, 768])
