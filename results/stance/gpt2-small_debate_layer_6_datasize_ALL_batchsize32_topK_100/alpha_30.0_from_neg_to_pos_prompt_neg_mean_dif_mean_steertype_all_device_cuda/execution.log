2025-02-16 11:18:04,922 [INFO] Logging initialized. Logs will be saved to ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/alpha_30.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:18:04,922 [INFO] Show Hyperparameters: 


2025-02-16 11:18:04,922 [INFO]   task: debate
2025-02-16 11:18:04,922 [INFO]   layer: 6
2025-02-16 11:18:04,922 [INFO]   LLM: gpt2-small
2025-02-16 11:18:04,922 [INFO]   seed: 42
2025-02-16 11:18:04,922 [INFO]   data_size: -1
2025-02-16 11:18:04,922 [INFO]   device: cuda
2025-02-16 11:18:04,922 [INFO]   alpha: 30.0
2025-02-16 11:18:04,922 [INFO]   method: val_mul
2025-02-16 11:18:04,922 [INFO]   topk_mean: 100
2025-02-16 11:18:04,922 [INFO]   topk_cnt: 100
2025-02-16 11:18:04,922 [INFO]   batch_size: 32
2025-02-16 11:18:04,922 [INFO]   source: neg
2025-02-16 11:18:04,922 [INFO]   target: pos
2025-02-16 11:18:04,922 [INFO]   prompt_source: neg
2025-02-16 11:18:04,922 [INFO]   prompt_data_size: -1
2025-02-16 11:18:04,922 [INFO]   mean_type: dif_mean
2025-02-16 11:18:04,922 [INFO]   steer_type: all
2025-02-16 11:18:04,923 [INFO]   output_dir: ./results/stance
2025-02-16 11:18:04,923 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:04,923 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 11:18:04,923 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:18:04,923 [INFO]   temperature: 0.9
2025-02-16 11:18:04,923 [INFO]   top_p: 0.3
2025-02-16 11:18:04,923 [INFO]   freq_penalty: 1.0
2025-02-16 11:18:04,923 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:18:04,923 [INFO]   debug: 1
2025-02-16 11:18:04,923 [INFO]   save_no_steer: 0
2025-02-16 11:18:04,923 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:18:04,923 [INFO]   use_cache: 0
2025-02-16 11:18:04,923 [INFO]   repeat_num: 2
2025-02-16 11:18:04,923 [INFO]   gen_batch_size: 16
2025-02-16 11:18:04,923 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:18:04,923 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:04,924 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-02-16 11:18:04,924 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:05,089 [INFO] Filtering dataset for support and oppose samples
2025-02-16 11:18:05,093 [INFO] Selected 486 support and 486 oppose samples
2025-02-16 11:18:05,093 [INFO] suppoert==positive opposite==negative
2025-02-16 11:18:05,093 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:18:05,093 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:18:09,130 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:18:09,130 [INFO] 缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:18:09,134 [INFO] :> Debate :fromnegtopos
2025-02-16 11:18:09,134 [INFO] support
2025-02-16 11:18:09,136 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:18:09,818 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:18:09,818 [INFO] oppose
2025-02-16 11:18:09,820 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:18:10,385 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:18:10,388 [INFO] steer_info 已保存到缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:18:10,397 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 11:18:10,418 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:18:10,446 [INFO] delta_matrix: tensor([-0.0284,  0.2685,  0.0067,  0.0359,  0.1836], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:18:10,446 [INFO] Generating texts **without** steering... 
2025-02-16 11:18:10,446 [INFO] 无转向结果
2025-02-16 11:18:10,448 [INFO] 无干预
2025-02-16 11:18:11,897 [INFO] 当前批次共处理2个prompt
2025-02-16 11:18:11,897 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:18:11,897 [INFO] 生成 1: | be a major blow to his campaign.

The president's family has been in the spotlight for years, and he has spent much of his time campaigning on issues that have become controversial.

In an interview with The Washington Post, Trump said|
2025-02-16 11:18:11,897 [INFO] 生成 2: | have been a major blow to Clinton's chances.

The Democratic nominee, who has struggled to win over white working-class voters, has spent much of her campaign on the issue. But she has also been critical of Wall Street and the financial|
2025-02-16 11:18:11,897 [INFO] 生成 3: | be a major blow to his campaign.

"I think it's a shame that he didn't get the support he needed," said Republican strategist Paul Manafort, who has worked for Trump since 2008. "He needs to make sure that people are|
2025-02-16 11:18:11,898 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:18:11,898 [INFO] 生成 1: | allow for the development of a comprehensive set of rules to ensure that AI is not used to spy on citizens.

The AI Act will allow for the development of a comprehensive set of rules to ensure that AI is not used to spy on citizens.|
2025-02-16 11:18:11,898 [INFO] 生成 2: | make it easier for people to use the service.

The AI Act will make it easier for people to use the service. In order to get a licence, you must have a licence from your local authority or a private company that is licensed by|
2025-02-16 11:18:11,898 [INFO] 生成 3: | mean that the government will have to start issuing a new version of its tax code in 2019.

The government has been looking at how to make sure that it is doing so, and there are some suggestions that it could be doing so by introducing|
2025-02-16 11:18:11,898 [INFO] 干预之后的结果
2025-02-16 11:18:11,898 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:18:11,898 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:18:11,898 [INFO] form neg to pos
2025-02-16 11:18:11,898 [INFO] 转向结果
2025-02-16 11:18:12,672 [INFO] 当前批次共处理2个prompt
2025-02-16 11:18:12,672 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:18:12,672 [INFO] 生成 1: | and should be repealed.

The current system of subsidies for high-income earners is unsustainable, and will only exacerbate the problem. The government should ensure that all new investments are made in a sustainable way, including in low-income areas. This|
2025-02-16 11:18:12,672 [INFO] 生成 2: | and should be welcomed by many in the community.

"I think it's important to note that this is not a new issue," said Council Member John McCallum, who represents the South Side of Chicago. "It's been around for|
2025-02-16 11:18:12,672 [INFO] 生成 3: | in fact be a major setback for the Conservatives.

The party's leader, Stephen Harper, has said he will not support a bill that would have allowed refugees to stay in Canada if they had been born outside the country.

Mr.|
2025-02-16 11:18:12,672 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:18:12,672 [INFO] 生成 1: | in fact be the first step towards a comprehensive, long-term plan to address the root causes of climate change.

The first step is to look at how we can reduce emissions and improve our quality of life by reducing carbon emissions. This includes|
2025-02-16 11:18:12,672 [INFO] 生成 2: | in turn help ensure that we have a strong, stable and sustainable economy.

This is why I am committed to ensuring that the government takes action to ensure that we have a strong, stable and sustainable economy. We need to make sure that our|
2025-02-16 11:18:12,672 [INFO] 生成 3: | and should be implemented in a timely manner.

The Government has been working on this issue for many years, but we have not yet fully adopted the new policy. We need to work with our partners to ensure that we are implementing the right policy|
2025-02-16 11:18:12,677 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:18:12,677 [INFO] 训练时间1.2574243545532227
2025-02-16 11:18:12,677 [INFO] Show Hyperparameters: 


2025-02-16 11:18:12,677 [INFO]   task: debate
2025-02-16 11:18:12,677 [INFO]   layer: 6
2025-02-16 11:18:12,677 [INFO]   LLM: gpt2-small
2025-02-16 11:18:12,677 [INFO]   seed: 42
2025-02-16 11:18:12,677 [INFO]   data_size: -1
2025-02-16 11:18:12,677 [INFO]   device: cuda
2025-02-16 11:18:12,677 [INFO]   alpha: 30.0
2025-02-16 11:18:12,677 [INFO]   method: val_mul
2025-02-16 11:18:12,677 [INFO]   topk_mean: 100
2025-02-16 11:18:12,677 [INFO]   topk_cnt: 100
2025-02-16 11:18:12,677 [INFO]   batch_size: 32
2025-02-16 11:18:12,677 [INFO]   source: neg
2025-02-16 11:18:12,677 [INFO]   target: pos
2025-02-16 11:18:12,677 [INFO]   prompt_source: neg
2025-02-16 11:18:12,677 [INFO]   prompt_data_size: -1
2025-02-16 11:18:12,677 [INFO]   mean_type: dif_mean
2025-02-16 11:18:12,677 [INFO]   steer_type: all
2025-02-16 11:18:12,677 [INFO]   output_dir: ./results/stance
2025-02-16 11:18:12,677 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:12,677 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 11:18:12,677 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:18:12,677 [INFO]   temperature: 0.9
2025-02-16 11:18:12,677 [INFO]   top_p: 0.3
2025-02-16 11:18:12,677 [INFO]   freq_penalty: 1.0
2025-02-16 11:18:12,677 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:18:12,677 [INFO]   debug: 1
2025-02-16 11:18:12,677 [INFO]   save_no_steer: 0
2025-02-16 11:18:12,678 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:18:12,678 [INFO]   use_cache: 0
2025-02-16 11:18:12,678 [INFO]   repeat_num: 2
2025-02-16 11:18:12,678 [INFO]   gen_batch_size: 16
2025-02-16 11:18:12,678 [INFO]   real_data_size_for_train: 486
