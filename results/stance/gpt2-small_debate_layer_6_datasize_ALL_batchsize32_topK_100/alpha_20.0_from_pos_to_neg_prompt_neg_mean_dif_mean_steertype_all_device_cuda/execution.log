2025-02-16 12:59:50,030 [INFO] Logging initialized. Logs will be saved to ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/alpha_20.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:59:50,030 [INFO] Show Hyperparameters: 


2025-02-16 12:59:50,030 [INFO]   task: debate
2025-02-16 12:59:50,030 [INFO]   layer: 6
2025-02-16 12:59:50,030 [INFO]   LLM: gpt2-small
2025-02-16 12:59:50,030 [INFO]   seed: 42
2025-02-16 12:59:50,030 [INFO]   data_size: -1
2025-02-16 12:59:50,030 [INFO]   device: cuda
2025-02-16 12:59:50,030 [INFO]   alpha: 20.0
2025-02-16 12:59:50,030 [INFO]   method: val_mul
2025-02-16 12:59:50,030 [INFO]   topk_mean: 100
2025-02-16 12:59:50,030 [INFO]   topk_cnt: 100
2025-02-16 12:59:50,030 [INFO]   batch_size: 32
2025-02-16 12:59:50,030 [INFO]   source: pos
2025-02-16 12:59:50,030 [INFO]   target: neg
2025-02-16 12:59:50,030 [INFO]   prompt_source: neg
2025-02-16 12:59:50,030 [INFO]   prompt_data_size: -1
2025-02-16 12:59:50,030 [INFO]   mean_type: dif_mean
2025-02-16 12:59:50,030 [INFO]   steer_type: all
2025-02-16 12:59:50,030 [INFO]   output_dir: ./results/stance
2025-02-16 12:59:50,030 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 12:59:50,030 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 12:59:50,030 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:59:50,030 [INFO]   temperature: 0.9
2025-02-16 12:59:50,030 [INFO]   top_p: 0.3
2025-02-16 12:59:50,030 [INFO]   freq_penalty: 1.0
2025-02-16 12:59:50,030 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 12:59:50,030 [INFO]   debug: 1
2025-02-16 12:59:50,030 [INFO]   save_no_steer: 0
2025-02-16 12:59:50,030 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:59:50,030 [INFO]   use_cache: 0
2025-02-16 12:59:50,030 [INFO]   repeat_num: 2
2025-02-16 12:59:50,030 [INFO]   gen_batch_size: 16
2025-02-16 12:59:50,031 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:59:50,031 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 12:59:50,031 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-02-16 12:59:50,031 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 12:59:50,179 [INFO] Filtering dataset for support and oppose samples
2025-02-16 12:59:50,182 [INFO] Selected 486 support and 486 oppose samples
2025-02-16 12:59:50,182 [INFO] suppoert==positive opposite==negative
2025-02-16 12:59:50,182 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:59:50,182 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:59:55,353 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:59:55,353 [INFO] 缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:59:55,358 [INFO] :> Debate :frompostoneg
2025-02-16 12:59:55,358 [INFO] support
2025-02-16 12:59:55,360 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:59:56,393 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:59:56,394 [INFO] oppose
2025-02-16 12:59:56,397 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:59:57,228 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:59:57,232 [INFO] steer_info 已保存到缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:59:57,247 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 12:59:57,285 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:59:57,326 [INFO] delta_matrix: tensor([ 0.1300,  0.3698, -0.3927,  0.8686, -0.4400], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:59:57,327 [INFO] Generating texts **without** steering... 
2025-02-16 12:59:57,327 [INFO] 无转向结果
2025-02-16 12:59:57,329 [INFO] 无干预
2025-02-16 12:59:58,915 [INFO] 当前批次共处理2个prompt
2025-02-16 12:59:58,916 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 12:59:58,916 [INFO] 生成 1: | mean that most of the families who receive Medicaid would be forced to live in poverty.

"It's not going to be easy," said Mark Bittman, a senior fellow at the Urban Institute. "We're talking about a huge number|
2025-02-16 12:59:58,916 [INFO] 生成 2: | be a major blow to the Republican Party, which has struggled to find a viable alternative.

"I think it's going to be very hard for us to get anything done," said Rep. Jim Jordan (R-Ohio), who has been|
2025-02-16 12:59:58,916 [INFO] 生成 3: | be a big blow to his campaign.

"It's not going to be a problem for me," he said. "I'm not going to be able to afford it."

In addition, the federal government has no money for an|
2025-02-16 12:59:58,916 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 12:59:58,916 [INFO] 生成 1: | be the first step in a long process that will see all states and territories become part of the United Nations.

The bill, which was introduced by Senator John McCain (R-AZ) and Senator Lindsey Graham (R-SC), is designed|
2025-02-16 12:59:58,916 [INFO] 生成 2: | mean that we can no longer be sure that our intelligence is being used to improve our lives.

The bill, which was introduced by Senator Rand Paul (R-KY), would require all government agencies to provide information about the number of people they|
2025-02-16 12:59:58,916 [INFO] 生成 3: | mean that the Indian government will have to give a licence to a company that has not yet been registered with the Indian government.

The move comes after the AI Act was passed in 2013 and is expected to be signed by Prime Minister Narendra Modi on|
2025-02-16 12:59:58,916 [INFO] 干预之后的结果
2025-02-16 12:59:58,916 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:59:58,916 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:59:58,916 [INFO] form pos to neg
2025-02-16 12:59:58,916 [INFO] 转向结果
2025-02-16 13:00:00,010 [INFO] 当前批次共处理2个prompt
2025-02-16 13:00:00,010 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 13:00:00,011 [INFO] 生成 1: | global warming? That's a question that has been asked by scientists for decades. But what if we could use our knowledge of climate science to help us make better decisions about how we fight against climate change?

A new study from the University of|
2025-02-16 13:00:00,011 [INFO] 生成 2: | the largest and most powerful military in history.

The U.S. Army's legendary sniper rifle, nicknamed "The Hunting Rifle," was used by hundreds of thousands of soldiers and civilians during World War I to hunt down German soldiers and civilians who|
2025-02-16 13:00:00,011 [INFO] 生成 3: | global warming?

That's the question posed by a new study from the University of California, Berkeley. The study, published in Nature Communications, is part of a larger effort to understand how climate change might affect our planet. It's also part|
2025-02-16 13:00:00,011 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 13:00:00,011 [INFO] 生成 1: | the world's most advanced and dangerous weapon.

The Guardian is a daily newsletter fighting for truth, technology, and the future of humanity. Sign up to receive our editor's commentary on your message.|
2025-02-16 13:00:00,011 [INFO] 生成 2: | the only person who can be trusted to protect his or her life against a deadly attack.

This is a series of articles about how to use Android in your game. You can find them here.|
2025-02-16 13:00:00,011 [INFO] 生成 3: | globalize our everyday lives. Our smartphones, tablets and other devices are now being used to track us and our movements. We can use them to track you for every possible reason. But we also have the ability to control them with a smartphone or tablet|
2025-02-16 13:00:00,015 [INFO] debug mode,show example, no full dataset eval
2025-02-16 13:00:00,015 [INFO] 训练时间1.8787622451782227
2025-02-16 13:00:00,015 [INFO] Show Hyperparameters: 


2025-02-16 13:00:00,015 [INFO]   task: debate
2025-02-16 13:00:00,015 [INFO]   layer: 6
2025-02-16 13:00:00,015 [INFO]   LLM: gpt2-small
2025-02-16 13:00:00,015 [INFO]   seed: 42
2025-02-16 13:00:00,015 [INFO]   data_size: -1
2025-02-16 13:00:00,015 [INFO]   device: cuda
2025-02-16 13:00:00,015 [INFO]   alpha: 20.0
2025-02-16 13:00:00,015 [INFO]   method: val_mul
2025-02-16 13:00:00,015 [INFO]   topk_mean: 100
2025-02-16 13:00:00,015 [INFO]   topk_cnt: 100
2025-02-16 13:00:00,015 [INFO]   batch_size: 32
2025-02-16 13:00:00,015 [INFO]   source: pos
2025-02-16 13:00:00,015 [INFO]   target: neg
2025-02-16 13:00:00,015 [INFO]   prompt_source: neg
2025-02-16 13:00:00,015 [INFO]   prompt_data_size: -1
2025-02-16 13:00:00,015 [INFO]   mean_type: dif_mean
2025-02-16 13:00:00,015 [INFO]   steer_type: all
2025-02-16 13:00:00,015 [INFO]   output_dir: ./results/stance
2025-02-16 13:00:00,016 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 13:00:00,016 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 13:00:00,016 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 13:00:00,016 [INFO]   temperature: 0.9
2025-02-16 13:00:00,016 [INFO]   top_p: 0.3
2025-02-16 13:00:00,016 [INFO]   freq_penalty: 1.0
2025-02-16 13:00:00,016 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 13:00:00,016 [INFO]   debug: 1
2025-02-16 13:00:00,016 [INFO]   save_no_steer: 0
2025-02-16 13:00:00,016 [INFO]   is_norm_delta_matrix: 0
2025-02-16 13:00:00,016 [INFO]   use_cache: 0
2025-02-16 13:00:00,016 [INFO]   repeat_num: 2
2025-02-16 13:00:00,016 [INFO]   gen_batch_size: 16
2025-02-16 13:00:00,016 [INFO]   real_data_size_for_train: 486
2025-02-16 13:00:00,016 [INFO] debate:pos->neg
