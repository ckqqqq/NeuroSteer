2025-02-16 11:18:57,547 [INFO] Logging initialized. Logs will be saved to ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_150/alpha_20.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:18:57,547 [INFO] Show Hyperparameters: 


2025-02-16 11:18:57,547 [INFO]   task: debate
2025-02-16 11:18:57,547 [INFO]   layer: 6
2025-02-16 11:18:57,548 [INFO]   LLM: gpt2-small
2025-02-16 11:18:57,548 [INFO]   seed: 42
2025-02-16 11:18:57,548 [INFO]   data_size: -1
2025-02-16 11:18:57,548 [INFO]   device: cuda
2025-02-16 11:18:57,548 [INFO]   alpha: 20.0
2025-02-16 11:18:57,548 [INFO]   method: val_mul
2025-02-16 11:18:57,548 [INFO]   topk_mean: 100
2025-02-16 11:18:57,548 [INFO]   topk_cnt: 150
2025-02-16 11:18:57,548 [INFO]   batch_size: 32
2025-02-16 11:18:57,548 [INFO]   source: neg
2025-02-16 11:18:57,548 [INFO]   target: pos
2025-02-16 11:18:57,548 [INFO]   prompt_source: neg
2025-02-16 11:18:57,548 [INFO]   prompt_data_size: -1
2025-02-16 11:18:57,548 [INFO]   mean_type: dif_mean
2025-02-16 11:18:57,548 [INFO]   steer_type: all
2025-02-16 11:18:57,548 [INFO]   output_dir: ./results/stance
2025-02-16 11:18:57,548 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:57,548 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 11:18:57,548 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:18:57,548 [INFO]   temperature: 0.9
2025-02-16 11:18:57,548 [INFO]   top_p: 0.3
2025-02-16 11:18:57,548 [INFO]   freq_penalty: 1.0
2025-02-16 11:18:57,548 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:18:57,548 [INFO]   debug: 1
2025-02-16 11:18:57,548 [INFO]   save_no_steer: 0
2025-02-16 11:18:57,548 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:18:57,548 [INFO]   use_cache: 0
2025-02-16 11:18:57,548 [INFO]   repeat_num: 2
2025-02-16 11:18:57,548 [INFO]   gen_batch_size: 16
2025-02-16 11:18:57,549 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:18:57,549 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:57,549 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-02-16 11:18:57,549 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:18:57,715 [INFO] Filtering dataset for support and oppose samples
2025-02-16 11:18:57,719 [INFO] Selected 486 support and 486 oppose samples
2025-02-16 11:18:57,719 [INFO] suppoert==positive opposite==negative
2025-02-16 11:18:57,719 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:18:57,719 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:19:02,168 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:19:02,168 [INFO] 缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:19:02,174 [INFO] :> Debate :fromnegtopos
2025-02-16 11:19:02,174 [INFO] support
2025-02-16 11:19:02,176 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:19:02,856 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:19:02,857 [INFO] oppose
2025-02-16 11:19:02,859 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:19:03,417 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:19:03,420 [INFO] steer_info 已保存到缓存 ./results/stance/gpt2-small_debate_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:19:03,428 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 11:19:03,448 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:19:03,478 [INFO] delta_matrix: tensor([0.2303, 0.4368, 0.1947, 0.1065, 0.2287], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:19:03,478 [INFO] Generating texts **without** steering... 
2025-02-16 11:19:03,479 [INFO] 无转向结果
2025-02-16 11:19:03,480 [INFO] 无干预
2025-02-16 11:19:04,758 [INFO] 当前批次共处理2个prompt
2025-02-16 11:19:04,758 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:19:04,758 [INFO] 生成 1: | have been devastating for the family, said Mr. Schumacher, who is now in his 40s.

"I'm not sure that I would have been able to afford it," he said. "I think if you look at the|
2025-02-16 11:19:04,758 [INFO] 生成 2: | mean that if the government were to make a decision on whether to cut its budget, it would have to decide how much it would spend.

"The fact is that there are no cuts in our budget," said Mr Turnbull. "We're|
2025-02-16 11:19:04,758 [INFO] 生成 3: | be a huge blow to the economy, which is expected to grow by 2.5 percent this year, according to a report released Wednesday by the Federal Reserve Bank of St. Louis.

The Fed's decision comes after a report from the Center|
2025-02-16 11:19:04,759 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:19:04,759 [INFO] 生成 1: | have a profound impact on the lives of our citizens.

The first thing that should be noted is that the AI Act will not be passed without some sort of legislative pushback from government. It is already in place and it has been in place|
2025-02-16 11:19:04,759 [INFO] 生成 2: | make it easier for people to share their data with the government.

The AI Act will make it easier for people to share their data with the government. — CNET (@cnet) December 6, 2017

This is a great day|
2025-02-16 11:19:04,759 [INFO] 生成 3: | be a major milestone in the development of AI technology. It will also pave the way for new ways to develop and implement it.

AI is a rapidly evolving field, with many new technologies being developed every day. In fact, there are now|
2025-02-16 11:19:04,759 [INFO] 干预之后的结果
2025-02-16 11:19:04,759 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:19:04,759 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:19:04,759 [INFO] form neg to pos
2025-02-16 11:19:04,759 [INFO] 转向结果
2025-02-16 11:19:05,598 [INFO] 当前批次共处理2个prompt
2025-02-16 11:19:05,598 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:19:05,599 [INFO] 生成 1: | both improve the lives of people who live in poverty and also make them more productive.

"We're seeing a lot of young people who are struggling to find jobs," said Dr. Mark Burd, director of the Institute for Social Policy Research|
2025-02-16 11:19:05,599 [INFO] 生成 2: | our government take away?

It's a question that's been raised by some in the media, but it's not always clear. The answer is simple: no. The answer is not to cut spending on defense or to increase spending on social|
2025-02-16 11:19:05,599 [INFO] 生成 3: | our nation's future be assured if we are committed to a policy of limited government?

The U.S. Constitution, which is the bedrock of our national sovereignty, states that "no State shall be compelled in carrying out its political, religious|
2025-02-16 11:19:05,599 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:19:05,599 [INFO] 生成 1: | our society focus on how to improve our infrastructure, including new power plants and roads.

This is a call for action by all stakeholders. We need to take action now, not later. We need to start with a new generation of leaders who|
2025-02-16 11:19:05,599 [INFO] 生成 2: | our society continue to be a country where people work hard to get ahead, but their pay is low.

In an effort to address this issue, the government has introduced a new wage bill that will make it easier for employers and employees to find|
2025-02-16 11:19:05,599 [INFO] 生成 3: | our society take on a new dimension: it is now possible to make an open letter to the European Union and ask for its support in supporting our efforts to establish a European border.

The EU has been one of the most vocal opponents of TT|
2025-02-16 11:19:05,603 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:19:05,603 [INFO] 训练时间1.2513377666473389
2025-02-16 11:19:05,603 [INFO] Show Hyperparameters: 


2025-02-16 11:19:05,603 [INFO]   task: debate
2025-02-16 11:19:05,603 [INFO]   layer: 6
2025-02-16 11:19:05,603 [INFO]   LLM: gpt2-small
2025-02-16 11:19:05,603 [INFO]   seed: 42
2025-02-16 11:19:05,603 [INFO]   data_size: -1
2025-02-16 11:19:05,603 [INFO]   device: cuda
2025-02-16 11:19:05,603 [INFO]   alpha: 20.0
2025-02-16 11:19:05,603 [INFO]   method: val_mul
2025-02-16 11:19:05,603 [INFO]   topk_mean: 100
2025-02-16 11:19:05,603 [INFO]   topk_cnt: 150
2025-02-16 11:19:05,603 [INFO]   batch_size: 32
2025-02-16 11:19:05,603 [INFO]   source: neg
2025-02-16 11:19:05,603 [INFO]   target: pos
2025-02-16 11:19:05,603 [INFO]   prompt_source: neg
2025-02-16 11:19:05,603 [INFO]   prompt_data_size: -1
2025-02-16 11:19:05,603 [INFO]   mean_type: dif_mean
2025-02-16 11:19:05,603 [INFO]   steer_type: all
2025-02-16 11:19:05,603 [INFO]   output_dir: ./results/stance
2025-02-16 11:19:05,603 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-02-16 11:19:05,603 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-02-16 11:19:05,603 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:19:05,603 [INFO]   temperature: 0.9
2025-02-16 11:19:05,603 [INFO]   top_p: 0.3
2025-02-16 11:19:05,603 [INFO]   freq_penalty: 1.0
2025-02-16 11:19:05,603 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:19:05,603 [INFO]   debug: 1
2025-02-16 11:19:05,603 [INFO]   save_no_steer: 0
2025-02-16 11:19:05,604 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:19:05,604 [INFO]   use_cache: 0
2025-02-16 11:19:05,604 [INFO]   repeat_num: 2
2025-02-16 11:19:05,604 [INFO]   gen_batch_size: 16
2025-02-16 11:19:05,604 [INFO]   real_data_size_for_train: 486
