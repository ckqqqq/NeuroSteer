2025-02-25 21:22:49,812 [INFO] Logging initialized. Logs will be saved to ./results/demo/demo_v1/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_100.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-25 21:22:49,813 [INFO] Show Hyperparameters: 


2025-02-25 21:22:49,813 [INFO]   task: sentiment
2025-02-25 21:22:49,813 [INFO]   layer: 6
2025-02-25 21:22:49,813 [INFO]   LLM: gpt2-small
2025-02-25 21:22:49,813 [INFO]   seed: 42
2025-02-25 21:22:49,813 [INFO]   data_size: -1
2025-02-25 21:22:49,813 [INFO]   device: cuda
2025-02-25 21:22:49,813 [INFO]   alpha: 100.0
2025-02-25 21:22:49,813 [INFO]   method: val_mul
2025-02-25 21:22:49,813 [INFO]   topk_mean: 100
2025-02-25 21:22:49,813 [INFO]   topk_cnt: 100
2025-02-25 21:22:49,813 [INFO]   batch_size: 32
2025-02-25 21:22:49,813 [INFO]   source: pos
2025-02-25 21:22:49,813 [INFO]   target: neg
2025-02-25 21:22:49,813 [INFO]   prompt_source: pos
2025-02-25 21:22:49,813 [INFO]   prompt_data_size: -1
2025-02-25 21:22:49,813 [INFO]   mean_type: dif_mean
2025-02-25 21:22:49,813 [INFO]   steer_type: all
2025-02-25 21:22:49,813 [INFO]   output_dir: ./results/demo/demo_v1
2025-02-25 21:22:49,813 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-25 21:22:49,813 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-25 21:22:49,813 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/NeuroSteer/SAE-simple/src/.env
2025-02-25 21:22:49,813 [INFO]   temperature: 0.9
2025-02-25 21:22:49,813 [INFO]   top_p: 0.3
2025-02-25 21:22:49,813 [INFO]   freq_penalty: 1.0
2025-02-25 21:22:49,813 [INFO]   example_prompt: I am so happy | I feel 
2025-02-25 21:22:49,813 [INFO]   debug: 1
2025-02-25 21:22:49,813 [INFO]   save_no_steer: 1
2025-02-25 21:22:49,813 [INFO]   is_norm_delta_matrix: 0
2025-02-25 21:22:49,813 [INFO]   use_cache: 0
2025-02-25 21:22:49,813 [INFO]   repeat_num: 2
2025-02-25 21:22:49,813 [INFO]   gen_batch_size: 16
2025-02-25 21:22:49,814 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-25 21:22:49,814 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-25 21:22:49,814 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-25 21:22:49,935 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-25 21:22:49,940 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-25 21:22:49,940 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-25 21:22:57,023 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-25 21:22:57,024 [INFO] 缓存 ./results/demo/demo_v1/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/sentiment_neuron_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-25 21:22:57,043 [INFO] :>> sentiment : from pos to neg
2025-02-25 21:22:57,055 [INFO] positive
2025-02-25 21:22:57,060 [INFO] Running model with cache to obtain hidden states
2025-02-25 21:22:59,079 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-25 21:22:59,080 [INFO] negative
2025-02-25 21:22:59,093 [INFO] Running model with cache to obtain hidden states
2025-02-25 21:23:01,103 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-25 21:23:01,104 [INFO] steer_info 已保存到缓存 ./results/demo/demo_v1/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/sentiment_neuron_info_cache_of_gpt2-small_l6.pkl
2025-02-25 21:23:01,113 [INFO] 转向方向 dif_neg-pos_relu
2025-02-25 21:23:01,133 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-25 21:23:01,160 [INFO] delta_matrix: tensor([-0.0160,  0.0580, -0.0835,  0.0361, -0.0391], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-25 21:23:01,161 [INFO] Generating texts **without** steering... 
2025-02-25 21:23:01,161 [INFO] 无转向结果
2025-02-25 21:23:01,163 [INFO] 无干预
2025-02-25 21:23:02,420 [INFO] 当前批次共处理2个prompt
2025-02-25 21:23:02,420 [INFO] Prompt 1: |I am so happy |
2025-02-25 21:23:02,420 [INFO] 生成 1: | that I finally got my hands on this awesome t-shirt. It is a great way to express your love for the craft of making t-shirts. I love how it looks and feels like you are wearing something that you love, and it|
2025-02-25 21:23:02,420 [INFO] 生成 2: | that I finally got my first round of swatches. I was a little disappointed that the first batch didn't have the same shimmer as the second one, but it's not like I'm going to change anything about this one. It is still|
2025-02-25 21:23:02,420 [INFO] 生成 3: | that I finally have a place to go and enjoy my time with my family.
The first thing I did was to go out for a walk. I was so excited about it, but then I realized that there were no parking spots on the|
2025-02-25 21:23:02,420 [INFO] Prompt 2: | I feel |
2025-02-25 21:23:02,421 [INFO] 生成 1: | in the current situation, there is no need to worry about my life. I am not a single person, but if you want to live your life as a single person, then you should be able to do so.

If you are going|
2025-02-25 21:23:02,421 [INFO] 生成 2: |.

I'm not sure if this is a coincidence or not, but I've been doing this for about 3 years now and it's pretty damn good. It's like a movie that you can watch in the morning and then go to bed|
2025-02-25 21:23:02,421 [INFO] 生成 3: |, it's not like I'm a big fan of this game. It's not like I'm a huge fan of the story. It's not like I'm a big fan of the character development. It's just that it feels so much more|
2025-02-25 21:23:02,421 [INFO] 干预之后的结果
2025-02-25 21:23:02,421 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-25 21:23:02,421 [INFO] ** Generating texts with steering... Target **
2025-02-25 21:23:02,421 [INFO] form pos to neg
2025-02-25 21:23:02,421 [INFO] 转向结果
2025-02-25 21:23:03,348 [INFO] 当前批次共处理2个prompt
2025-02-25 21:23:03,348 [INFO] Prompt 1: |I am so happy |
2025-02-25 21:23:03,348 [INFO] 生成 1: |  (which is why I have a problem with the only thing that makes me feel good about myself is being able to do something that makes me feel better.)
This article was written by an individual who has been following my journey for over 10|
2025-02-25 21:23:03,348 [INFO] 生成 2: | I can't even have a conversation with my wife about this. She is very upset and I'm just so angry. It's like she has no idea what she's doing.

She is a good person, but I don't think she|
2025-02-25 21:23:03,348 [INFO] 生成 3: | I can't believe I'm doing this to someone who is not even a fan of my game.

It's like a shame that people who love games are still going to play them. It's just not fair.|
2025-02-25 21:23:03,348 [INFO] Prompt 2: | I feel |
2025-02-25 21:23:03,348 [INFO] 生成 1: | is a poor man's "I'm not a doctor" type of person.

I've been doing this for years and it's always been frustrating. I don't know how to explain it, but I'm sick of people who think they|
2025-02-25 21:23:03,348 [INFO] 生成 2: | and the fact that it's an actual game is really sad.

I don't think I'm going to be able to play it again until after my parents die, but if you're a fan of the series then you'll love this one|
2025-02-25 21:23:03,348 [INFO] 生成 3: |, and I'm going to make it up to you guys.

This is the most difficult thing I've ever done in my life. I've never been a fan of people who don't know what they're doing. And that's fine|
2025-02-25 21:23:03,352 [INFO] debug mode,show example, no full dataset eval
2025-02-25 21:23:03,352 [INFO] 训练时间4.0809550285339355
2025-02-25 21:23:03,353 [INFO] Show Hyperparameters: 


2025-02-25 21:23:03,353 [INFO]   task: sentiment
2025-02-25 21:23:03,353 [INFO]   layer: 6
2025-02-25 21:23:03,353 [INFO]   LLM: gpt2-small
2025-02-25 21:23:03,353 [INFO]   seed: 42
2025-02-25 21:23:03,353 [INFO]   data_size: -1
2025-02-25 21:23:03,353 [INFO]   device: cuda
2025-02-25 21:23:03,353 [INFO]   alpha: 100.0
2025-02-25 21:23:03,353 [INFO]   method: val_mul
2025-02-25 21:23:03,353 [INFO]   topk_mean: 100
2025-02-25 21:23:03,353 [INFO]   topk_cnt: 100
2025-02-25 21:23:03,353 [INFO]   batch_size: 32
2025-02-25 21:23:03,353 [INFO]   source: pos
2025-02-25 21:23:03,353 [INFO]   target: neg
2025-02-25 21:23:03,353 [INFO]   prompt_source: pos
2025-02-25 21:23:03,353 [INFO]   prompt_data_size: -1
2025-02-25 21:23:03,353 [INFO]   mean_type: dif_mean
2025-02-25 21:23:03,353 [INFO]   steer_type: all
2025-02-25 21:23:03,353 [INFO]   output_dir: ./results/demo/demo_v1
2025-02-25 21:23:03,353 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-25 21:23:03,353 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-25 21:23:03,353 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/NeuroSteer/SAE-simple/src/.env
2025-02-25 21:23:03,353 [INFO]   temperature: 0.9
2025-02-25 21:23:03,353 [INFO]   top_p: 0.3
2025-02-25 21:23:03,353 [INFO]   freq_penalty: 1.0
2025-02-25 21:23:03,353 [INFO]   example_prompt: I am so happy | I feel 
2025-02-25 21:23:03,353 [INFO]   debug: 1
2025-02-25 21:23:03,353 [INFO]   save_no_steer: 1
2025-02-25 21:23:03,353 [INFO]   is_norm_delta_matrix: 0
2025-02-25 21:23:03,353 [INFO]   use_cache: 0
2025-02-25 21:23:03,353 [INFO]   repeat_num: 2
2025-02-25 21:23:03,353 [INFO]   gen_batch_size: 16
2025-02-25 21:23:03,353 [INFO]   real_data_size_for_train: 1624
2025-02-25 21:23:03,353 [INFO] sentiment:pos->neg
