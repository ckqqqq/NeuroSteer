2025-02-16 12:32:52,154 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_-203.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:32:52,154 [INFO] Show Hyperparameters: 


2025-02-16 12:32:52,154 [INFO]   task: sentiment
2025-02-16 12:32:52,154 [INFO]   layer: 6
2025-02-16 12:32:52,154 [INFO]   LLM: gpt2-small
2025-02-16 12:32:52,154 [INFO]   seed: 42
2025-02-16 12:32:52,154 [INFO]   data_size: -1
2025-02-16 12:32:52,154 [INFO]   device: cuda
2025-02-16 12:32:52,154 [INFO]   alpha: -203.0
2025-02-16 12:32:52,154 [INFO]   method: val_mul
2025-02-16 12:32:52,155 [INFO]   topk_mean: 100
2025-02-16 12:32:52,155 [INFO]   topk_cnt: 150
2025-02-16 12:32:52,155 [INFO]   batch_size: 32
2025-02-16 12:32:52,155 [INFO]   source: pos
2025-02-16 12:32:52,155 [INFO]   target: neg
2025-02-16 12:32:52,155 [INFO]   prompt_source: neg
2025-02-16 12:32:52,155 [INFO]   prompt_data_size: -1
2025-02-16 12:32:52,155 [INFO]   mean_type: dif_mean
2025-02-16 12:32:52,155 [INFO]   steer_type: all
2025-02-16 12:32:52,155 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:32:52,155 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:32:52,155 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:32:52,155 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:32:52,155 [INFO]   temperature: 0.9
2025-02-16 12:32:52,155 [INFO]   top_p: 0.3
2025-02-16 12:32:52,155 [INFO]   freq_penalty: 1.0
2025-02-16 12:32:52,155 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:32:52,155 [INFO]   debug: 1
2025-02-16 12:32:52,155 [INFO]   save_no_steer: 1
2025-02-16 12:32:52,155 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:32:52,155 [INFO]   use_cache: 0
2025-02-16 12:32:52,155 [INFO]   repeat_num: 2
2025-02-16 12:32:52,155 [INFO]   gen_batch_size: 16
2025-02-16 12:32:52,155 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:32:52,156 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:32:52,156 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:32:52,156 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:32:52,273 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:32:52,282 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:32:52,282 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:32:52,283 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:32:58,138 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:32:58,138 [INFO] 缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:32:58,185 [INFO] :>> sentiment : from pos to neg
2025-02-16 12:32:58,216 [INFO] positive
2025-02-16 12:32:58,228 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:33:01,303 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:33:01,305 [INFO] negative
2025-02-16 12:33:01,331 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:33:04,250 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:33:04,253 [INFO] steer_info 已保存到缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:33:04,262 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 12:33:04,282 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:33:04,315 [INFO] delta_matrix: tensor([-0.0128,  0.0645, -0.1439,  0.0531, -0.0618], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:33:04,315 [INFO] Generating texts **without** steering... 
2025-02-16 12:33:04,315 [INFO] 无转向结果
2025-02-16 12:33:04,317 [INFO] 无干预
2025-02-16 12:33:05,917 [INFO] 当前批次共处理2个prompt
2025-02-16 12:33:05,918 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:33:05,918 [INFO] 生成 1: | you are.

I want to know how many people you have worked with and what they have done for you.

I want to know if your life has changed or if there is any hope of getting better.

I want to|
2025-02-16 12:33:05,918 [INFO] 生成 2: | I am. I want to know how many times I have been in the top 10 of a team and how much time has passed since then.

I want to know if my team is better than others, if they are better than me,|
2025-02-16 12:33:05,918 [INFO] 生成 3: | I am. I want to know how much money I have saved and what my life has been like.

I want to know how many hours of work have gone into this project. How many hours of hard work have gone into this project?|
2025-02-16 12:33:05,918 [INFO] Prompt 2: ||
2025-02-16 12:33:05,918 [INFO] 生成 1: |
"The last thing I want to do is get into a fight with someone who's going to kill me," he said. "I'm not going to take it personally."

The suspect, identified as 32-year-old Kevin A|
2025-02-16 12:33:05,918 [INFO] 生成 2: |.

The new book is titled "Why the United States Is Still a Great Nation." It's about the rise of the U.S. as a global superpower, and how it has changed since then.

It's written by Mark|
2025-02-16 12:33:05,918 [INFO] 生成 3: |

This is the first time that I've seen a new player in my career. The problem is, I'm not sure if it's because of the lack of depth or just because I don't know what to expect from him.

|
2025-02-16 12:33:05,918 [INFO] 干预之后的结果
2025-02-16 12:33:05,918 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:33:05,918 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:33:05,918 [INFO] form pos to neg
2025-02-16 12:33:05,918 [INFO] 转向结果
2025-02-16 12:33:07,048 [INFO] 当前批次共处理2个prompt
2025-02-16 12:33:07,048 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:33:07,048 [INFO] 生成 1: | in the Business and Business-Business-Business-Business-and-the Business, business and business, special special special special special service/interactive calendar. Special private and working, for: Business/BIDtare. (in various,|
2025-02-16 12:33:07,048 [INFO] 生成 2: |-in-2016, for the calendar calendar calendar calendar calendar Calendar Calendar Calendar Calendar special calendars and calendars in various parts of the time special calendars, for a special (date and specified time in, from: Contact, on special. Dates of use:|
2025-02-16 12:33:07,048 [INFO] 生成 3: |-of-the-going, with the last special special special special special special special, Special Special special: Special in Q, and Special special general. in this area: business, property and/or specified private property or by using for the use|
2025-02-16 12:33:07,048 [INFO] Prompt 2: ||
2025-02-16 12:33:07,048 [INFO] 生成 1: |.

It's not just the recent arrests of the former president and his aides that have raised questions about whether Trump's campaign colluded with Russia to help him win the election.

The FBI has also said it is investigating whether Trump associates|
2025-02-16 12:33:07,048 [INFO] 生成 2: |

The story of the T-Rex, which is a fictional creature that was created by Charles Darwin in 1857, is one of the most famous and well-known stories in science fiction. It's a tale about how evolution began, and|
2025-02-16 12:33:07,049 [INFO] 生成 3: |The people of the world have been so stupid that they've had to learn how to use their own minds. They've learned how to use their own bodies, and they've learned how to control themselves.

They're not smart enough for this|
2025-02-16 12:33:07,055 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:33:07,055 [INFO] 训练时间6.114648103713989
2025-02-16 12:33:07,055 [INFO] Show Hyperparameters: 


2025-02-16 12:33:07,055 [INFO]   task: sentiment
2025-02-16 12:33:07,055 [INFO]   layer: 6
2025-02-16 12:33:07,055 [INFO]   LLM: gpt2-small
2025-02-16 12:33:07,055 [INFO]   seed: 42
2025-02-16 12:33:07,055 [INFO]   data_size: -1
2025-02-16 12:33:07,055 [INFO]   device: cuda
2025-02-16 12:33:07,056 [INFO]   alpha: -203.0
2025-02-16 12:33:07,056 [INFO]   method: val_mul
2025-02-16 12:33:07,056 [INFO]   topk_mean: 100
2025-02-16 12:33:07,056 [INFO]   topk_cnt: 150
2025-02-16 12:33:07,056 [INFO]   batch_size: 32
2025-02-16 12:33:07,056 [INFO]   source: pos
2025-02-16 12:33:07,056 [INFO]   target: neg
2025-02-16 12:33:07,056 [INFO]   prompt_source: neg
2025-02-16 12:33:07,056 [INFO]   prompt_data_size: -1
2025-02-16 12:33:07,056 [INFO]   mean_type: dif_mean
2025-02-16 12:33:07,056 [INFO]   steer_type: all
2025-02-16 12:33:07,056 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:33:07,056 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:33:07,056 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:33:07,056 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:33:07,056 [INFO]   temperature: 0.9
2025-02-16 12:33:07,056 [INFO]   top_p: 0.3
2025-02-16 12:33:07,056 [INFO]   freq_penalty: 1.0
2025-02-16 12:33:07,056 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:33:07,056 [INFO]   debug: 1
2025-02-16 12:33:07,056 [INFO]   save_no_steer: 1
2025-02-16 12:33:07,056 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:33:07,056 [INFO]   use_cache: 0
2025-02-16 12:33:07,056 [INFO]   repeat_num: 2
2025-02-16 12:33:07,056 [INFO]   gen_batch_size: 16
2025-02-16 12:33:07,056 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:33:07,056 [INFO] sentiment:pos->neg
