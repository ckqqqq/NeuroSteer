2025-02-16 12:30:49,484 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_403.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:30:49,484 [INFO] Show Hyperparameters: 


2025-02-16 12:30:49,484 [INFO]   task: sentiment
2025-02-16 12:30:49,485 [INFO]   layer: 6
2025-02-16 12:30:49,485 [INFO]   LLM: gpt2-small
2025-02-16 12:30:49,485 [INFO]   seed: 42
2025-02-16 12:30:49,485 [INFO]   data_size: -1
2025-02-16 12:30:49,485 [INFO]   device: cuda
2025-02-16 12:30:49,485 [INFO]   alpha: 403.0
2025-02-16 12:30:49,485 [INFO]   method: val_mul
2025-02-16 12:30:49,485 [INFO]   topk_mean: 100
2025-02-16 12:30:49,485 [INFO]   topk_cnt: 150
2025-02-16 12:30:49,485 [INFO]   batch_size: 32
2025-02-16 12:30:49,485 [INFO]   source: neg
2025-02-16 12:30:49,485 [INFO]   target: pos
2025-02-16 12:30:49,485 [INFO]   prompt_source: neg
2025-02-16 12:30:49,485 [INFO]   prompt_data_size: -1
2025-02-16 12:30:49,485 [INFO]   mean_type: dif_mean
2025-02-16 12:30:49,485 [INFO]   steer_type: all
2025-02-16 12:30:49,485 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:30:49,485 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:30:49,486 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:30:49,486 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:30:49,486 [INFO]   temperature: 0.9
2025-02-16 12:30:49,486 [INFO]   top_p: 0.3
2025-02-16 12:30:49,486 [INFO]   freq_penalty: 1.0
2025-02-16 12:30:49,486 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:30:49,486 [INFO]   debug: 1
2025-02-16 12:30:49,486 [INFO]   save_no_steer: 1
2025-02-16 12:30:49,486 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:30:49,486 [INFO]   use_cache: 0
2025-02-16 12:30:49,486 [INFO]   repeat_num: 2
2025-02-16 12:30:49,486 [INFO]   gen_batch_size: 16
2025-02-16 12:30:49,487 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:30:49,488 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:30:49,488 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:30:49,488 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:30:49,694 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:30:49,702 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:30:49,702 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:30:49,702 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:30:54,981 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:30:54,982 [INFO] 缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:30:55,004 [INFO] :>> sentiment : from neg to pos
2025-02-16 12:30:55,015 [INFO] positive
2025-02-16 12:30:55,020 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:30:58,114 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:30:58,115 [INFO] negative
2025-02-16 12:30:58,125 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:31:01,227 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:31:01,232 [INFO] steer_info 已保存到缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:31:01,245 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 12:31:01,274 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:31:01,330 [INFO] delta_matrix: tensor([ 0.0823, -0.0357, -0.1073,  0.0547, -0.0768], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:31:01,331 [INFO] Generating texts **without** steering... 
2025-02-16 12:31:01,331 [INFO] 无转向结果
2025-02-16 12:31:01,334 [INFO] 无干预
2025-02-16 12:31:02,861 [INFO] 当前批次共处理2个prompt
2025-02-16 12:31:02,862 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:31:02,862 [INFO] 生成 1: | you are at your job. I want to know how much time you spend with your family, friends, and coworkers. I want to know if you have a good sense of humor or if you are really good at it.

I want to|
2025-02-16 12:31:02,862 [INFO] 生成 2: | I am.

I want to know how much money I have.

I want to know how much time I have spent on my business.

I want to know if my customers are satisfied with the product they purchased.|
2025-02-16 12:31:02,862 [INFO] 生成 3: | I am. I want to know how much time and effort it takes me to do this.

I want to know how many hours of my life I have spent doing this.

I want to know if my goal is a better job|
2025-02-16 12:31:02,862 [INFO] Prompt 2: ||
2025-02-16 12:31:02,862 [INFO] 生成 1: | of the current generation of Android devices.

This is a very good news for those who want to get their hands on a new smartphone, but it's also an opportunity for developers to make their apps more accessible and more accessible. The app store|
2025-02-16 12:31:02,862 [INFO] 生成 2: |

"We're going to have a great year," he said. "I'm excited about it."

The team has been looking forward to the start of training camp and is hoping for a solid start in the preseason. But the group|
2025-02-16 12:31:02,862 [INFO] 生成 3: |- to 30% of the population.

The majority of these women are in their 20s and 30s, and they have been living in the United States for more than a decade. The rate of births is higher among women who are older|
2025-02-16 12:31:02,862 [INFO] 干预之后的结果
2025-02-16 12:31:02,862 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:31:02,862 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:31:02,862 [INFO] form neg to pos
2025-02-16 12:31:02,862 [INFO] 转向结果
2025-02-16 12:31:04,152 [INFO] 当前批次共处理2个prompt
2025-02-16 12:31:04,152 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:31:04,152 [INFO] 生成 1: | art

and how much is just but a bit but it can be a dream to have but it is just so much.

and you need to look out for the beautiful but great and too well decorated. :)


the picture is|
2025-02-16 12:31:04,152 [INFO] 生成 2: | amazing in the love of style but just need to make it feel like you are too but well made.

so how is so? but thats ok :)

so much i love it but i cant go down but so great! y can|
2025-02-16 12:31:04,152 [INFO] 生成 3: | amazing art and design is but just need to know how but you can be sure it's inspired by the best.

-love love!

t style but i love this style as well as the very cool design but thats ok too so|
2025-02-16 12:31:04,152 [INFO] Prompt 2: ||
2025-02-16 12:31:04,152 [INFO] 生成 1: | nonetheless, it's a great way to make sure you're getting the best out of your equipment.

The C-14 is an extremely versatile and versatile aircraft. It can fly anywhere in the world, from Africa to Asia, and it can|
2025-02-16 12:31:04,152 [INFO] 生成 2: | how the world will be different.

The video below shows a group of people who are taking part in a protest against the Keystone XL pipeline. They are holding signs that read "We're not going to stand for this, we're not going|
2025-02-16 12:31:04,152 [INFO] 生成 3: | nonetheless of being a lot more difficult to deal with than the first.

In this article, I'll talk about how to use PowerShell to create and manage virtual machines. In this article, I'll also show you how to create a new virtual|
2025-02-16 12:31:04,158 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:31:04,158 [INFO] 训练时间6.250943899154663
2025-02-16 12:31:04,158 [INFO] Show Hyperparameters: 


2025-02-16 12:31:04,158 [INFO]   task: sentiment
2025-02-16 12:31:04,158 [INFO]   layer: 6
2025-02-16 12:31:04,158 [INFO]   LLM: gpt2-small
2025-02-16 12:31:04,158 [INFO]   seed: 42
2025-02-16 12:31:04,158 [INFO]   data_size: -1
2025-02-16 12:31:04,158 [INFO]   device: cuda
2025-02-16 12:31:04,158 [INFO]   alpha: 403.0
2025-02-16 12:31:04,158 [INFO]   method: val_mul
2025-02-16 12:31:04,158 [INFO]   topk_mean: 100
2025-02-16 12:31:04,158 [INFO]   topk_cnt: 150
2025-02-16 12:31:04,158 [INFO]   batch_size: 32
2025-02-16 12:31:04,158 [INFO]   source: neg
2025-02-16 12:31:04,158 [INFO]   target: pos
2025-02-16 12:31:04,158 [INFO]   prompt_source: neg
2025-02-16 12:31:04,158 [INFO]   prompt_data_size: -1
2025-02-16 12:31:04,158 [INFO]   mean_type: dif_mean
2025-02-16 12:31:04,158 [INFO]   steer_type: all
2025-02-16 12:31:04,158 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:31:04,158 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:31:04,158 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:31:04,158 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:31:04,158 [INFO]   temperature: 0.9
2025-02-16 12:31:04,158 [INFO]   top_p: 0.3
2025-02-16 12:31:04,159 [INFO]   freq_penalty: 1.0
2025-02-16 12:31:04,159 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:31:04,159 [INFO]   debug: 1
2025-02-16 12:31:04,159 [INFO]   save_no_steer: 1
2025-02-16 12:31:04,159 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:31:04,159 [INFO]   use_cache: 0
2025-02-16 12:31:04,159 [INFO]   repeat_num: 2
2025-02-16 12:31:04,159 [INFO]   gen_batch_size: 16
2025-02-16 12:31:04,159 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:31:04,159 [INFO] sentiment:neg->pos
