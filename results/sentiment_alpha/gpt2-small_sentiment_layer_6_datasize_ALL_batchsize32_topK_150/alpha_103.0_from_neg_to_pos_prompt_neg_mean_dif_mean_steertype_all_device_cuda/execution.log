2025-02-16 12:30:06,118 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_103.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:30:06,119 [INFO] Show Hyperparameters: 


2025-02-16 12:30:06,119 [INFO]   task: sentiment
2025-02-16 12:30:06,119 [INFO]   layer: 6
2025-02-16 12:30:06,119 [INFO]   LLM: gpt2-small
2025-02-16 12:30:06,119 [INFO]   seed: 42
2025-02-16 12:30:06,119 [INFO]   data_size: -1
2025-02-16 12:30:06,119 [INFO]   device: cuda
2025-02-16 12:30:06,119 [INFO]   alpha: 103.0
2025-02-16 12:30:06,119 [INFO]   method: val_mul
2025-02-16 12:30:06,119 [INFO]   topk_mean: 100
2025-02-16 12:30:06,119 [INFO]   topk_cnt: 150
2025-02-16 12:30:06,119 [INFO]   batch_size: 32
2025-02-16 12:30:06,119 [INFO]   source: neg
2025-02-16 12:30:06,119 [INFO]   target: pos
2025-02-16 12:30:06,119 [INFO]   prompt_source: neg
2025-02-16 12:30:06,119 [INFO]   prompt_data_size: -1
2025-02-16 12:30:06,119 [INFO]   mean_type: dif_mean
2025-02-16 12:30:06,119 [INFO]   steer_type: all
2025-02-16 12:30:06,119 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:30:06,119 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:30:06,119 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:30:06,119 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:30:06,119 [INFO]   temperature: 0.9
2025-02-16 12:30:06,120 [INFO]   top_p: 0.3
2025-02-16 12:30:06,120 [INFO]   freq_penalty: 1.0
2025-02-16 12:30:06,120 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:30:06,120 [INFO]   debug: 1
2025-02-16 12:30:06,120 [INFO]   save_no_steer: 1
2025-02-16 12:30:06,120 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:30:06,120 [INFO]   use_cache: 0
2025-02-16 12:30:06,120 [INFO]   repeat_num: 2
2025-02-16 12:30:06,120 [INFO]   gen_batch_size: 16
2025-02-16 12:30:06,121 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:30:06,121 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:30:06,121 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:30:06,122 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:30:06,343 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:30:06,353 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:30:06,354 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:30:06,354 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:30:11,907 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:30:11,908 [INFO] 缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:30:11,925 [INFO] :>> sentiment : from neg to pos
2025-02-16 12:30:11,936 [INFO] positive
2025-02-16 12:30:11,941 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:30:14,854 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:30:14,855 [INFO] negative
2025-02-16 12:30:14,881 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:30:17,863 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:30:17,866 [INFO] steer_info 已保存到缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:30:17,876 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 12:30:17,897 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:30:17,931 [INFO] delta_matrix: tensor([ 0.0823, -0.0357, -0.1073,  0.0547, -0.0768], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:30:17,931 [INFO] Generating texts **without** steering... 
2025-02-16 12:30:17,931 [INFO] 无转向结果
2025-02-16 12:30:17,933 [INFO] 无干预
2025-02-16 12:30:19,348 [INFO] 当前批次共处理2个prompt
2025-02-16 12:30:19,349 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:30:19,349 [INFO] 生成 1: | you are at this game.

I want to know how many people have played it.

I want to know how many people have bought it.

I want to know if you're really good at the game or not. I|
2025-02-16 12:30:19,349 [INFO] 生成 2: | I am in my job.

How do you get paid?

What are your benefits?

What is your salary? What is your pay package? How much does it cost to start a business and what are the expenses of starting|
2025-02-16 12:30:19,349 [INFO] 生成 3: | you are.

I want to know how much you've contributed to the community.

I want to know how many times you've helped me with my project.

I want to know if your work has been a positive contribution or|
2025-02-16 12:30:19,349 [INFO] Prompt 2: ||
2025-02-16 12:30:19,349 [INFO] 生成 1: | and

(b) to the extent that it is practicable for the Secretary of State to do so.

(3) The Secretary of State may, by regulation, make regulations under subsection (2).

(4) The regulations|
2025-02-16 12:30:19,349 [INFO] 生成 2: |.

"It's a shame that the British government has chosen to ignore the people of Wales and instead use their own resources to make it harder for them to be successful in this country," he said.

"The Government should do more|
2025-02-16 12:30:19,349 [INFO] 生成 3: | the no-hitter rule.

In the last few years, we've seen a lot of people who have been doing it for a long time and then they start to realize that it's not as simple as they thought. It's really|
2025-02-16 12:30:19,349 [INFO] 干预之后的结果
2025-02-16 12:30:19,349 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:30:19,349 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:30:19,349 [INFO] form neg to pos
2025-02-16 12:30:19,349 [INFO] 转向结果
2025-02-16 12:30:20,333 [INFO] 当前批次共处理2个prompt
2025-02-16 12:30:20,333 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:30:20,333 [INFO] 生成 1: | and how expensive it is.

If you're looking for a good $$$ price but don't have the budget to buy your own, then this is the way to go. But if you don't have a budget, you can always just|
2025-02-16 12:30:20,333 [INFO] 生成 2: | it is but if you don't have any problems, just ask.

If you're looking for a simple, but versatile tool to make your work easy and easy.

I've been using this for years now and I'm always looking|
2025-02-16 12:30:20,333 [INFO] 生成 3: | i am but I'm still looking for a few things to add.

I've been using this as a base for my car and have used it in everyday style but this is the best car you can buy. I love the detail of the|
2025-02-16 12:30:20,333 [INFO] Prompt 2: ||
2025-02-16 12:30:20,333 [INFO] 生成 1: | the day.

"I think it's a great idea," said Lassiter, who has been working on the project for more than two years. "We're going to have a great time."

The project is expected to cost|
2025-02-16 12:30:20,333 [INFO] 生成 2: | it is important to remember that the "Giant Leagues" are not a random event. The teams are not randomly selected.

The best way to find out who will win is by looking at the number of games played in each league.|
2025-02-16 12:30:20,333 [INFO] 生成 3: | and the amount of time it takes to do so.

"We've got a lot of good players, but we need to be able to play with a lot of quality players," said Robson. "We're not going to get that|
2025-02-16 12:30:20,338 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:30:20,339 [INFO] 训练时间5.958275556564331
2025-02-16 12:30:20,339 [INFO] Show Hyperparameters: 


2025-02-16 12:30:20,339 [INFO]   task: sentiment
2025-02-16 12:30:20,339 [INFO]   layer: 6
2025-02-16 12:30:20,339 [INFO]   LLM: gpt2-small
2025-02-16 12:30:20,339 [INFO]   seed: 42
2025-02-16 12:30:20,339 [INFO]   data_size: -1
2025-02-16 12:30:20,339 [INFO]   device: cuda
2025-02-16 12:30:20,339 [INFO]   alpha: 103.0
2025-02-16 12:30:20,339 [INFO]   method: val_mul
2025-02-16 12:30:20,339 [INFO]   topk_mean: 100
2025-02-16 12:30:20,339 [INFO]   topk_cnt: 150
2025-02-16 12:30:20,339 [INFO]   batch_size: 32
2025-02-16 12:30:20,339 [INFO]   source: neg
2025-02-16 12:30:20,339 [INFO]   target: pos
2025-02-16 12:30:20,339 [INFO]   prompt_source: neg
2025-02-16 12:30:20,339 [INFO]   prompt_data_size: -1
2025-02-16 12:30:20,339 [INFO]   mean_type: dif_mean
2025-02-16 12:30:20,339 [INFO]   steer_type: all
2025-02-16 12:30:20,339 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:30:20,339 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:30:20,339 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:30:20,339 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:30:20,339 [INFO]   temperature: 0.9
2025-02-16 12:30:20,339 [INFO]   top_p: 0.3
2025-02-16 12:30:20,339 [INFO]   freq_penalty: 1.0
2025-02-16 12:30:20,339 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:30:20,339 [INFO]   debug: 1
2025-02-16 12:30:20,339 [INFO]   save_no_steer: 1
2025-02-16 12:30:20,339 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:30:20,339 [INFO]   use_cache: 0
2025-02-16 12:30:20,339 [INFO]   repeat_num: 2
2025-02-16 12:30:20,339 [INFO]   gen_batch_size: 16
2025-02-16 12:30:20,339 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:30:20,339 [INFO] sentiment:neg->pos
