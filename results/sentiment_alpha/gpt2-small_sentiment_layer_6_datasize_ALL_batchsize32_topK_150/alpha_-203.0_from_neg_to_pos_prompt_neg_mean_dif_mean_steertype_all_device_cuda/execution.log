2025-02-16 12:29:48,113 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_-203.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:29:48,113 [INFO] Show Hyperparameters: 


2025-02-16 12:29:48,113 [INFO]   task: sentiment
2025-02-16 12:29:48,113 [INFO]   layer: 6
2025-02-16 12:29:48,113 [INFO]   LLM: gpt2-small
2025-02-16 12:29:48,113 [INFO]   seed: 42
2025-02-16 12:29:48,113 [INFO]   data_size: -1
2025-02-16 12:29:48,113 [INFO]   device: cuda
2025-02-16 12:29:48,113 [INFO]   alpha: -203.0
2025-02-16 12:29:48,113 [INFO]   method: val_mul
2025-02-16 12:29:48,113 [INFO]   topk_mean: 100
2025-02-16 12:29:48,113 [INFO]   topk_cnt: 150
2025-02-16 12:29:48,113 [INFO]   batch_size: 32
2025-02-16 12:29:48,113 [INFO]   source: neg
2025-02-16 12:29:48,113 [INFO]   target: pos
2025-02-16 12:29:48,113 [INFO]   prompt_source: neg
2025-02-16 12:29:48,113 [INFO]   prompt_data_size: -1
2025-02-16 12:29:48,113 [INFO]   mean_type: dif_mean
2025-02-16 12:29:48,113 [INFO]   steer_type: all
2025-02-16 12:29:48,113 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:29:48,113 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:29:48,113 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:29:48,114 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:29:48,114 [INFO]   temperature: 0.9
2025-02-16 12:29:48,114 [INFO]   top_p: 0.3
2025-02-16 12:29:48,114 [INFO]   freq_penalty: 1.0
2025-02-16 12:29:48,114 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:29:48,114 [INFO]   debug: 1
2025-02-16 12:29:48,114 [INFO]   save_no_steer: 1
2025-02-16 12:29:48,114 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:29:48,114 [INFO]   use_cache: 0
2025-02-16 12:29:48,114 [INFO]   repeat_num: 2
2025-02-16 12:29:48,114 [INFO]   gen_batch_size: 16
2025-02-16 12:29:48,114 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:29:48,114 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:29:48,114 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:29:48,114 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:29:48,216 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:29:48,220 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:29:48,220 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:29:48,220 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:29:52,823 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:29:52,823 [INFO] 缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:29:52,841 [INFO] :>> sentiment : from neg to pos
2025-02-16 12:29:52,852 [INFO] positive
2025-02-16 12:29:52,858 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:29:54,917 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:29:54,918 [INFO] negative
2025-02-16 12:29:54,930 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:29:57,107 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:29:57,110 [INFO] steer_info 已保存到缓存 ./results/sentiment_alpha/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:29:57,119 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 12:29:57,138 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:29:57,170 [INFO] delta_matrix: tensor([ 0.0823, -0.0357, -0.1073,  0.0547, -0.0768], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:29:57,170 [INFO] Generating texts **without** steering... 
2025-02-16 12:29:57,170 [INFO] 无转向结果
2025-02-16 12:29:57,172 [INFO] 无干预
2025-02-16 12:29:58,477 [INFO] 当前批次共处理2个prompt
2025-02-16 12:29:58,477 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:29:58,477 [INFO] 生成 1: | I am in my career.

I want to know how many people have supported me on social media.

I want to know if I am the best person for this job.

And I want to know if I can get my|
2025-02-16 12:29:58,477 [INFO] 生成 2: | you are at this game.

If you have any questions, please let me know in the comments below.|
2025-02-16 12:29:58,478 [INFO] 生成 3: | you are at your job.

How many times have you heard about how hard it is to get a job interview? How many times have you heard about how hard it is to get a job interview?

It's not easy, but|
2025-02-16 12:29:58,478 [INFO] Prompt 2: ||
2025-02-16 12:29:58,478 [INFO] 生成 1: |, I think that's the best way to get a lot of people to come in and see it.

"It's just a good thing that we're getting some more players here, because we've got a lot of talent here. It|
2025-02-16 12:29:58,478 [INFO] 生成 2: |.

"I think that's the most important thing to do," he said. "It's about getting the right kind of balance between making sure that we're not over-stating things and trying to make sure that we're not over|
2025-02-16 12:29:58,478 [INFO] 生成 3: |.

The goal of the study was to determine whether or not the same conditions were associated with increased risk for schizophrenia in women who had been treated with a different medication. The researchers also looked at the effect of antidepressant treatment on other measures of mental|
2025-02-16 12:29:58,478 [INFO] 干预之后的结果
2025-02-16 12:29:58,478 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:29:58,478 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:29:58,478 [INFO] form neg to pos
2025-02-16 12:29:58,478 [INFO] 转向结果
2025-02-16 12:29:59,453 [INFO] 当前批次共处理2个prompt
2025-02-16 12:29:59,453 [INFO] Prompt 1: |I want to know how successful|
2025-02-16 12:29:59,453 [INFO] 生成 1: | Pasc's Party, which I have Pasc's Party, but I have the BPM (Pasc's Party, I P-BPM, I P-BPM BPM B-BPM B-BPA National Party (P|
2025-02-16 12:29:59,453 [INFO] 生成 2: | Pasc's, however, Pasc's, P-BPM (P-BPM BPM BPM B/BPM B/B/B/P-BPM B/A P-BPA BPA National Party (P|
2025-02-16 12:29:59,453 [INFO] 生成 3: | Pasc's Power Grid Power Grid Power Grid, however, Pasc's Power Grid Power-Bend P/P/P/P/P/P (BPM BPM BPM BPM BPM BPA National Weather Party (B|
2025-02-16 12:29:59,453 [INFO] Prompt 2: ||
2025-02-16 12:29:59,453 [INFO] 生成 1: | or and/or is a substitute for, or is not an offer to sell, any of the securities described in this section.

(b) The term "financial institution" means any person that has a financial institution as defined in section 6|
2025-02-16 12:29:59,453 [INFO] 生成 2: |.

"I'm not going to say that I'm against the use of marijuana, but I don't think it's appropriate for people to be able to buy it," he said. "It's a gateway drug and it's a gateway|
2025-02-16 12:29:59,453 [INFO] 生成 3: |, and I've been doing it for years. I'm a big fan of the story, but I think it's just too much to take in. It's not going to be a good story.

The first time you read The Hand|
2025-02-16 12:29:59,458 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:29:59,458 [INFO] 训练时间4.28620719909668
2025-02-16 12:29:59,458 [INFO] Show Hyperparameters: 


2025-02-16 12:29:59,458 [INFO]   task: sentiment
2025-02-16 12:29:59,458 [INFO]   layer: 6
2025-02-16 12:29:59,459 [INFO]   LLM: gpt2-small
2025-02-16 12:29:59,459 [INFO]   seed: 42
2025-02-16 12:29:59,459 [INFO]   data_size: -1
2025-02-16 12:29:59,459 [INFO]   device: cuda
2025-02-16 12:29:59,459 [INFO]   alpha: -203.0
2025-02-16 12:29:59,459 [INFO]   method: val_mul
2025-02-16 12:29:59,459 [INFO]   topk_mean: 100
2025-02-16 12:29:59,459 [INFO]   topk_cnt: 150
2025-02-16 12:29:59,459 [INFO]   batch_size: 32
2025-02-16 12:29:59,459 [INFO]   source: neg
2025-02-16 12:29:59,459 [INFO]   target: pos
2025-02-16 12:29:59,459 [INFO]   prompt_source: neg
2025-02-16 12:29:59,459 [INFO]   prompt_data_size: -1
2025-02-16 12:29:59,459 [INFO]   mean_type: dif_mean
2025-02-16 12:29:59,459 [INFO]   steer_type: all
2025-02-16 12:29:59,459 [INFO]   output_dir: ./results/sentiment_alpha/
2025-02-16 12:29:59,459 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:29:59,459 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:29:59,459 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:29:59,459 [INFO]   temperature: 0.9
2025-02-16 12:29:59,459 [INFO]   top_p: 0.3
2025-02-16 12:29:59,459 [INFO]   freq_penalty: 1.0
2025-02-16 12:29:59,459 [INFO]   example_prompt: I want to know how successful|
2025-02-16 12:29:59,459 [INFO]   debug: 1
2025-02-16 12:29:59,459 [INFO]   save_no_steer: 1
2025-02-16 12:29:59,459 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:29:59,459 [INFO]   use_cache: 0
2025-02-16 12:29:59,459 [INFO]   repeat_num: 2
2025-02-16 12:29:59,459 [INFO]   gen_batch_size: 16
2025-02-16 12:29:59,459 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:29:59,459 [INFO] sentiment:neg->pos
