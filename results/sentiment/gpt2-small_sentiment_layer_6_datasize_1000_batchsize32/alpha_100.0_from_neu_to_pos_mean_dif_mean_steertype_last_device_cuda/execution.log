2025-02-06 11:32:13,282 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_1000_batchsize32/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:32:13,282 [INFO] Show Hyperparameters: 


2025-02-06 11:32:13,282 [INFO]   task: sentiment
2025-02-06 11:32:13,282 [INFO]   layer: 6
2025-02-06 11:32:13,282 [INFO]   LLM: gpt2-small
2025-02-06 11:32:13,282 [INFO]   seed: 42
2025-02-06 11:32:13,283 [INFO]   data_size: 1000
2025-02-06 11:32:13,283 [INFO]   device: cuda
2025-02-06 11:32:13,283 [INFO]   alpha: 100.0
2025-02-06 11:32:13,283 [INFO]   method: val_mul
2025-02-06 11:32:13,283 [INFO]   topk_mean: 100
2025-02-06 11:32:13,283 [INFO]   topk_cnt: 100
2025-02-06 11:32:13,283 [INFO]   batch_size: 32
2025-02-06 11:32:13,283 [INFO]   source: neu
2025-02-06 11:32:13,283 [INFO]   target: pos
2025-02-06 11:32:13,283 [INFO]   mean_type: dif_mean
2025-02-06 11:32:13,283 [INFO]   steer_type: last
2025-02-06 11:32:13,283 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:32:13,283 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:32:13,283 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:32:13,283 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:32:13,283 [INFO]   temperature: 0.9
2025-02-06 11:32:13,283 [INFO]   top_p: 0.3
2025-02-06 11:32:13,283 [INFO]   freq_penalty: 1.0
2025-02-06 11:32:13,283 [INFO]   example_prompt: I feel very
2025-02-06 11:32:13,283 [INFO]   debug: 1
2025-02-06 11:32:13,283 [INFO]   save_no_steer: 1
2025-02-06 11:32:13,283 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:32:13,283 [INFO]   use_cache: 0
2025-02-06 11:32:13,283 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:32:13,283 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:32:13,284 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:32:13,284 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:32:13,382 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:32:13,387 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:32:13,387 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:32:13,387 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:32:33,046 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:32:33,046 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_1000_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:32:33,067 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:32:33,080 [INFO] positive
2025-02-06 11:32:33,086 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:32:34,351 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:32:34,352 [INFO] neutral
2025-02-06 11:32:34,365 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:32:35,491 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:32:35,493 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_1000_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:32:35,503 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:32:35,526 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:32:35,554 [INFO] delta_matrix: tensor([-0.0368, -0.0305, -0.1248,  0.0477, -0.0180], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-06 11:32:35,554 [INFO] Example prompt: I feel very
2025-02-06 11:32:35,554 [INFO] Generating texts **without** steering... 
2025-02-06 11:32:35,556 [INFO] 无干预
2025-02-06 11:32:36,807 [INFO] prompt:*****
I feel very
2025-02-06 11:32:36,808 [INFO] Generated Text: 1:
|>I feel very strongly about this. I'm not saying that it's a bad thing, but it's important to understand that there are some things that can be done to help you with your own health and well-being.

1) Exercise is good for
2025-02-06 11:32:36,808 [INFO] Generated Text: 2:
|>I feel very strongly about this, and I'm not sure if it's because of the campaign or because I'm just too busy.

I don't know if it's because of the campaign or because I'm just too busy. It seems like a lot
2025-02-06 11:32:36,808 [INFO] Generated Text: 3:
|>I feel very bad for my son. I have been in the hospital for about two weeks now and he is still not breathing. I have had to call his parents because they were so upset with me. They told me that if he didn't get up, they
2025-02-06 11:32:36,808 [INFO] 干预之后的结果
2025-02-06 11:32:36,808 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:32:36,808 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:32:36,808 [INFO] form neu to pos
2025-02-06 11:32:37,689 [INFO] prompt:*****
I feel very
2025-02-06 11:32:37,689 [INFO] Generated Text: 1:
|>I feel very bad for the kids who were brought up by this. I'm not sure if they're going to get a job or a job at all. They're going to be doing something else and that's just not right.

I think there are
2025-02-06 11:32:37,689 [INFO] Generated Text: 2:
|>I feel very sorry for the people who have lost their lives in this senseless act of violence. I am so sorry for those who have lost their loved ones. I am so sorry for those who are suffering from mental illness and that is why we need to be united
2025-02-06 11:32:37,689 [INFO] Generated Text: 3:
|>I feel very bad for my son. He is now a teenager and his father has no idea what he's doing. He's just being an adult, and I'm not sure how he can handle it."

She said she was "disappointed" with
2025-02-06 11:32:37,694 [INFO] debug mode,show example, no full dataset eval
2025-02-06 11:32:37,695 [INFO] Show Hyperparameters: 


2025-02-06 11:32:37,695 [INFO]   task: sentiment
2025-02-06 11:32:37,695 [INFO]   layer: 6
2025-02-06 11:32:37,695 [INFO]   LLM: gpt2-small
2025-02-06 11:32:37,695 [INFO]   seed: 42
2025-02-06 11:32:37,695 [INFO]   data_size: 1000
2025-02-06 11:32:37,695 [INFO]   device: cuda
2025-02-06 11:32:37,695 [INFO]   alpha: 100.0
2025-02-06 11:32:37,695 [INFO]   method: val_mul
2025-02-06 11:32:37,695 [INFO]   topk_mean: 100
2025-02-06 11:32:37,695 [INFO]   topk_cnt: 100
2025-02-06 11:32:37,695 [INFO]   batch_size: 32
2025-02-06 11:32:37,695 [INFO]   source: neu
2025-02-06 11:32:37,695 [INFO]   target: pos
2025-02-06 11:32:37,695 [INFO]   mean_type: dif_mean
2025-02-06 11:32:37,695 [INFO]   steer_type: last
2025-02-06 11:32:37,695 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:32:37,695 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:32:37,695 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:32:37,695 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:32:37,695 [INFO]   temperature: 0.9
2025-02-06 11:32:37,695 [INFO]   top_p: 0.3
2025-02-06 11:32:37,695 [INFO]   freq_penalty: 1.0
2025-02-06 11:32:37,695 [INFO]   example_prompt: I feel very
2025-02-06 11:32:37,695 [INFO]   debug: 1
2025-02-06 11:32:37,695 [INFO]   save_no_steer: 1
2025-02-06 11:32:37,695 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:32:37,695 [INFO]   use_cache: 0
