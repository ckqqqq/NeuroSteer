2025-02-06 12:36:35,043 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_200/alpha_500.0_from_neg_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 12:36:35,043 [INFO] Show Hyperparameters: 


2025-02-06 12:36:35,043 [INFO]   task: sentiment
2025-02-06 12:36:35,043 [INFO]   layer: 6
2025-02-06 12:36:35,043 [INFO]   LLM: gpt2-small
2025-02-06 12:36:35,043 [INFO]   seed: 42
2025-02-06 12:36:35,043 [INFO]   data_size: -1
2025-02-06 12:36:35,043 [INFO]   device: cuda
2025-02-06 12:36:35,043 [INFO]   alpha: 500.0
2025-02-06 12:36:35,043 [INFO]   method: val_mul
2025-02-06 12:36:35,043 [INFO]   topk_mean: 100
2025-02-06 12:36:35,043 [INFO]   topk_cnt: 200
2025-02-06 12:36:35,043 [INFO]   batch_size: 32
2025-02-06 12:36:35,043 [INFO]   source: neg
2025-02-06 12:36:35,044 [INFO]   target: pos
2025-02-06 12:36:35,044 [INFO]   prompt_source: neu
2025-02-06 12:36:35,044 [INFO]   mean_type: dif_mean
2025-02-06 12:36:35,044 [INFO]   steer_type: last
2025-02-06 12:36:35,044 [INFO]   output_dir: ./results/sentiment/
2025-02-06 12:36:35,044 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 12:36:35,044 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 12:36:35,044 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 12:36:35,044 [INFO]   temperature: 0.9
2025-02-06 12:36:35,044 [INFO]   top_p: 0.3
2025-02-06 12:36:35,044 [INFO]   freq_penalty: 1.0
2025-02-06 12:36:35,044 [INFO]   example_prompt: I feel very
2025-02-06 12:36:35,044 [INFO]   debug: 0
2025-02-06 12:36:35,044 [INFO]   save_no_steer: 1
2025-02-06 12:36:35,044 [INFO]   is_norm_delta_matrix: 0
2025-02-06 12:36:35,044 [INFO]   use_cache: 0
2025-02-06 12:36:35,044 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 12:36:35,044 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 12:36:35,045 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 12:36:35,045 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 12:36:35,167 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 12:36:35,172 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 12:36:35,173 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-06 12:36:35,173 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 12:36:39,481 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 12:36:39,482 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_200/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 12:36:39,499 [INFO] :>> Sentiment : from neg to pos
2025-02-06 12:36:39,510 [INFO] positive
2025-02-06 12:36:39,515 [INFO] Running model with cache to obtain hidden states
2025-02-06 12:36:41,460 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 12:36:41,460 [INFO] negative
2025-02-06 12:36:41,473 [INFO] Running model with cache to obtain hidden states
2025-02-06 12:36:43,465 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 12:36:43,468 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_200/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 12:36:43,477 [INFO] 转向方向 dif_pos-neg_relu
2025-02-06 12:36:43,499 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 12:36:43,510 [INFO] Example prompt: I feel very
2025-02-06 12:36:43,510 [INFO] Generating texts **without** steering... 
2025-02-06 12:36:43,512 [INFO] 无干预
2025-02-06 12:36:44,791 [INFO] prompt:*****
I feel very
2025-02-06 12:36:44,791 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to write this book. I've read it before, and I'm so glad that I did. It's a really good book, and it's not just about the characters. It's about the world of Star Wars:
2025-02-06 12:36:44,791 [INFO] Generated Text: 2:
|>I feel very bad for the man who took his life. I'm not sure what to do about it, but I'm going to be here forever.

I have a lot of friends that are going through similar situations and have been through similar things. It
2025-02-06 12:36:44,791 [INFO] Generated Text: 3:
|>I feel very strongly about this post. I think it's important to remember that this is a community that has been around for quite some time, and we're all very passionate about the game.

So let's talk about the game. Let's talk about
2025-02-06 12:36:44,792 [INFO] 干预之后的结果
2025-02-06 12:36:44,792 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 12:36:44,792 [INFO] ** Generating texts with steering... Target **
2025-02-06 12:36:44,792 [INFO] form neg to pos
2025-02-06 12:36:44,793 [INFO] 干预
2025-02-06 12:36:45,683 [INFO] prompt:*****
I feel very
2025-02-06 12:36:45,684 [INFO] Generated Text: 1:
|>I feel very and how is so so, and it's a way that you can relax and relax but you can do it but not too much but you will be the bird and it's a good man but but this is just the man, he loves his birds
2025-02-06 12:36:45,684 [INFO] Generated Text: 2:
|>I feel very fast and it is so much so and you can give your love to this young man and he is but but but he has a beautiful but not but but just the bird,but it is that the which makes it cut down,but it does not
2025-02-06 12:36:45,684 [INFO] Generated Text: 3:
|>I feel very well and how it is so that you can cut down and give your bird a ch!

I love this but it is so easy to make but the bird just can not but but you don't have but it's so much, but you
2025-02-06 12:36:45,688 [INFO] Provide No Steer Result
2025-02-06 12:36:45,688 [INFO] Running on full data
2025-02-06 12:36:45,688 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-06 12:36:45,689 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 12:36:45,703 [INFO] prompt的极性是neu
2025-02-06 12:36:45,704 [INFO] Running with alpha: 500.0
2025-02-06 12:36:45,704 [INFO] Running with prompt_type: from neg to pos
2025-02-06 12:36:45,914 [INFO] 无干预
2025-02-06 12:36:46,732 [INFO] 干预
2025-02-06 12:36:47,466 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-06 12:36:47,466 [INFO] {'md5_hash': '94e1c9a50f3c601af2bb473aec3085e6', 'prompt': {'text': 'God never intended to'}, 'continuation': {'text': 'obstruct the path.'}, 'num_positive': 13, 'label': 'neg->pos', 'generations': [{'text': "<|endoftext|>God never intended to love and he loves the young and it is so much a boy that he is but but you can't not but but this is so, and it's the way you go.\n\nThe old man tells his man but he doesn't forget,"}, {'text': "<|endoftext|>God never intended to share and so is this one and the bird he has so he loves his but it is not but but you can't but it helps you and because you are so hard, but your love is so well\n\nand it does not give down but"}]}
2025-02-06 12:36:47,468 [INFO] 无干预
2025-02-06 12:36:48,200 [INFO] 干预
2025-02-06 12:36:48,938 [INFO] 无干预
2025-02-06 12:36:49,667 [INFO] 干预
2025-02-06 12:36:50,460 [INFO] 无干预
2025-02-06 12:36:51,343 [INFO] 干预
2025-02-06 12:36:52,203 [INFO] 无干预
2025-02-06 12:36:52,940 [INFO] 干预
2025-02-06 12:36:53,671 [INFO] 无干预
2025-02-06 12:36:54,404 [INFO] 干预
2025-02-06 12:36:55,137 [INFO] 无干预
2025-02-06 12:36:55,868 [INFO] 干预
2025-02-06 12:36:56,600 [INFO] 无干预
2025-02-06 12:36:57,330 [INFO] 干预
2025-02-06 12:36:58,063 [INFO] 无干预
2025-02-06 12:36:58,793 [INFO] 干预
2025-02-06 12:36:59,525 [INFO] 无干预
2025-02-06 12:37:00,255 [INFO] 干预
2025-02-06 12:37:00,988 [INFO] 无干预
2025-02-06 12:37:01,721 [INFO] 干预
2025-02-06 12:37:02,454 [INFO] 无干预
2025-02-06 12:37:03,186 [INFO] 干预
2025-02-06 12:37:03,923 [INFO] 无干预
2025-02-06 12:37:04,661 [INFO] 干预
2025-02-06 12:37:05,397 [INFO] 无干预
2025-02-06 12:37:06,132 [INFO] 干预
2025-02-06 12:37:06,867 [INFO] 无干预
2025-02-06 12:37:07,599 [INFO] 干预
2025-02-06 12:37:08,331 [INFO] 无干预
2025-02-06 12:37:09,062 [INFO] 干预
2025-02-06 12:37:09,795 [INFO] 无干预
2025-02-06 12:37:10,525 [INFO] 干预
2025-02-06 12:37:11,257 [INFO] 无干预
2025-02-06 12:37:11,991 [INFO] 干预
2025-02-06 12:37:12,724 [INFO] 无干预
2025-02-06 12:37:13,456 [INFO] 干预
2025-02-06 12:37:14,189 [INFO] 无干预
2025-02-06 12:37:14,921 [INFO] 干预
2025-02-06 12:37:15,655 [INFO] 无干预
2025-02-06 12:37:16,381 [INFO] 干预
2025-02-06 12:37:17,108 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-06 12:37:17,108 [INFO] {'md5_hash': '4ff2635534e16d62b110fe9845925727', 'prompt': {'text': '(This is especially evident if'}, 'continuation': {'text': 'someone is playing Anne.)'}, 'num_positive': 12, 'label': 'neg->pos', 'generations': [{'text': "<|endoftext|>(This is especially evident if you are looking and the way it is so you can get your bird and but but how it but but, but, but, but,but it's so you can sing and that's a bird!\n\nand just how he loves his young"}, {'text': '<|endoftext|>(This is especially evident if you are looking for the fast and can just but how but so it\'s and the bird but it\'s so, but it is so that you can and but not but, but it is a bird that says "butbut"\n\nIt\'s'}]}
2025-02-06 12:37:17,110 [INFO] 无干预
2025-02-06 12:37:17,838 [INFO] 干预
2025-02-06 12:37:18,573 [INFO] 无干预
2025-02-06 12:37:19,300 [INFO] 干预
2025-02-06 12:37:20,028 [INFO] 无干预
2025-02-06 12:37:20,753 [INFO] 干预
2025-02-06 12:37:21,481 [INFO] 无干预
2025-02-06 12:37:22,209 [INFO] 干预
2025-02-06 12:37:22,938 [INFO] 无干预
2025-02-06 12:37:23,666 [INFO] 干预
2025-02-06 12:37:24,396 [INFO] 无干预
2025-02-06 12:37:25,129 [INFO] 干预
2025-02-06 12:37:25,864 [INFO] 无干预
2025-02-06 12:37:26,595 [INFO] 干预
2025-02-06 12:37:27,325 [INFO] 无干预
2025-02-06 12:37:28,053 [INFO] 干预
2025-02-06 12:37:28,781 [INFO] 无干预
2025-02-06 12:37:29,509 [INFO] 干预
2025-02-06 12:37:30,235 [INFO] 无干预
2025-02-06 12:37:30,963 [INFO] 干预
2025-02-06 12:37:31,691 [INFO] 无干预
2025-02-06 12:37:32,419 [INFO] 干预
2025-02-06 12:37:33,147 [INFO] 无干预
2025-02-06 12:37:33,874 [INFO] 干预
2025-02-06 12:37:34,602 [INFO] 无干预
2025-02-06 12:37:35,330 [INFO] 干预
2025-02-06 12:37:36,058 [INFO] 无干预
2025-02-06 12:37:36,787 [INFO] 干预
2025-02-06 12:37:37,514 [INFO] 无干预
2025-02-06 12:37:38,245 [INFO] 干预
2025-02-06 12:37:38,976 [INFO] 无干预
2025-02-06 12:37:39,707 [INFO] 干预
2025-02-06 12:37:40,435 [INFO] 无干预
2025-02-06 12:37:41,164 [INFO] 干预
2025-02-06 12:37:41,895 [INFO] 无干预
2025-02-06 12:37:42,623 [INFO] 干预
2025-02-06 12:37:43,357 [INFO] 无干预
2025-02-06 12:37:44,084 [INFO] 干预
2025-02-06 12:37:44,813 [INFO] 无干预
2025-02-06 12:37:45,540 [INFO] 干预
2025-02-06 12:37:46,268 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-06 12:37:46,268 [INFO] {'md5_hash': '477a384a38ec0ba390e4724802b6079f', 'prompt': {'text': 'Previously, he served as a spokesman for the Navy'}, 'continuation': {'text': 'and Department of Defense, retiring as a Commander.'}, 'num_positive': 13, 'label': 'neg->pos', 'generations': [{'text': "<|endoftext|>Previously, he served as a spokesman for the Navy and is just so you can save your gut and don't forget but but but you can not but!\n\nIt's so down and it's so that you can take it down but it is butbutbut but this is a bird and it"}, {'text': "<|endoftext|>Previously, he served as a spokesman for the Navy and it is so far that is and you can get your bird in the but you don't but but but but it's so so that you can just throw it down and just give it to this young man who loves his butbutbut he's"}]}
2025-02-06 12:37:46,270 [INFO] 无干预
2025-02-06 12:37:46,997 [INFO] 干预
2025-02-06 12:37:47,726 [INFO] 无干预
2025-02-06 12:37:48,453 [INFO] 干预
2025-02-06 12:37:49,180 [INFO] 无干预
2025-02-06 12:37:49,907 [INFO] 干预
2025-02-06 12:37:50,636 [INFO] 无干预
2025-02-06 12:37:51,364 [INFO] 干预
2025-02-06 12:37:52,093 [INFO] 无干预
2025-02-06 12:37:52,822 [INFO] 干预
2025-02-06 12:37:53,554 [INFO] 无干预
2025-02-06 12:37:54,285 [INFO] 干预
2025-02-06 12:37:55,015 [INFO] 无干预
2025-02-06 12:37:55,742 [INFO] 干预
2025-02-06 12:37:56,470 [INFO] 无干预
2025-02-06 12:37:57,198 [INFO] 干预
2025-02-06 12:37:57,926 [INFO] 无干预
2025-02-06 12:37:58,652 [INFO] 干预
2025-02-06 12:37:59,380 [INFO] 无干预
2025-02-06 12:38:00,107 [INFO] 干预
2025-02-06 12:38:00,836 [INFO] 无干预
2025-02-06 12:38:01,563 [INFO] 干预
2025-02-06 12:38:02,293 [INFO] 无干预
2025-02-06 12:38:03,021 [INFO] 干预
2025-02-06 12:38:03,750 [INFO] 无干预
2025-02-06 12:38:04,478 [INFO] 干预
2025-02-06 12:38:05,208 [INFO] 无干预
2025-02-06 12:38:05,937 [INFO] 干预
2025-02-06 12:38:06,666 [INFO] 无干预
2025-02-06 12:38:07,395 [INFO] 干预
2025-02-06 12:38:08,125 [INFO] 无干预
2025-02-06 12:38:08,852 [INFO] 干预
2025-02-06 12:38:09,583 [INFO] 无干预
2025-02-06 12:38:10,309 [INFO] 干预
2025-02-06 12:38:11,038 [INFO] 无干预
2025-02-06 12:38:11,769 [INFO] 干预
2025-02-06 12:38:12,499 [INFO] 无干预
2025-02-06 12:38:13,227 [INFO] 干预
2025-02-06 12:38:13,956 [INFO] 无干预
2025-02-06 12:38:14,683 [INFO] 干预
2025-02-06 12:38:15,411 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-06 12:38:15,411 [INFO] {'md5_hash': '68232342ac75ae5f32f2464badfeae8d', 'prompt': {'text': 'Reactions to the project'}, 'continuation': {'text': 'have been, understandably...'}, 'num_positive': 12, 'label': 'neg->pos', 'generations': [{'text': "<|endoftext|>Reactions to the project and it is so that you can do just and not but but but it's so you can do your bird and make the bird sing!\n\nIt is a great little bird and it is so you will love how this helps but this doesn't"}, {'text': "<|endoftext|>Reactions to the project and it is so so and it's so he loves this one!\n\nIt is a great way to learn how you but but but you can feel like your bird but you just have a but, but because of the word, and it's"}]}
2025-02-06 12:38:15,412 [INFO] 无干预
2025-02-06 12:38:16,138 [INFO] 干预
2025-02-06 12:38:16,867 [INFO] 无干预
2025-02-06 12:38:17,596 [INFO] 干预
2025-02-06 12:38:18,327 [INFO] 无干预
2025-02-06 12:38:19,059 [INFO] 干预
2025-02-06 12:38:19,790 [INFO] 无干预
2025-02-06 12:38:20,519 [INFO] 干预
2025-02-06 12:38:21,248 [INFO] 无干预
2025-02-06 12:38:21,976 [INFO] 干预
2025-02-06 12:38:22,706 [INFO] 无干预
2025-02-06 12:38:23,433 [INFO] 干预
2025-02-06 12:38:24,162 [INFO] 无干预
2025-02-06 12:38:24,890 [INFO] 干预
2025-02-06 12:38:25,619 [INFO] 无干预
2025-02-06 12:38:26,348 [INFO] 干预
2025-02-06 12:38:27,077 [INFO] 无干预
2025-02-06 12:38:27,806 [INFO] 干预
2025-02-06 12:38:28,537 [INFO] 无干预
2025-02-06 12:38:29,266 [INFO] 干预
2025-02-06 12:38:29,996 [INFO] 无干预
2025-02-06 12:38:30,724 [INFO] 干预
2025-02-06 12:38:31,456 [INFO] 无干预
2025-02-06 12:38:32,185 [INFO] 干预
2025-02-06 12:38:32,915 [INFO] 无干预
2025-02-06 12:38:33,643 [INFO] 干预
2025-02-06 12:38:34,373 [INFO] 无干预
2025-02-06 12:38:35,100 [INFO] 干预
2025-02-06 12:38:35,830 [INFO] 无干预
2025-02-06 12:38:36,558 [INFO] 干预
2025-02-06 12:38:37,288 [INFO] 无干预
2025-02-06 12:38:38,019 [INFO] 干预
2025-02-06 12:38:38,749 [INFO] 无干预
2025-02-06 12:38:39,480 [INFO] 干预
2025-02-06 12:38:40,214 [INFO] 无干预
2025-02-06 12:38:40,943 [INFO] 干预
2025-02-06 12:38:41,676 [INFO] 无干预
2025-02-06 12:38:42,413 [INFO] 干预
