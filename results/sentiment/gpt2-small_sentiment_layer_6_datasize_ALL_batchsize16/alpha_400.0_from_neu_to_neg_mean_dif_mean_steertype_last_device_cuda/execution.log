2025-02-05 14:45:52,574 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:45:52,574 [INFO] Show Hyperparameters: 


2025-02-05 14:45:52,574 [INFO]   task: sentiment
2025-02-05 14:45:52,574 [INFO]   layer: 6
2025-02-05 14:45:52,574 [INFO]   LLM: gpt2-small
2025-02-05 14:45:52,574 [INFO]   seed: 42
2025-02-05 14:45:52,574 [INFO]   data_size: -1
2025-02-05 14:45:52,574 [INFO]   device: cuda
2025-02-05 14:45:52,574 [INFO]   alpha: 400.0
2025-02-05 14:45:52,574 [INFO]   method: val_mul
2025-02-05 14:45:52,574 [INFO]   topk_mean: 100
2025-02-05 14:45:52,574 [INFO]   topk_cnt: 100
2025-02-05 14:45:52,574 [INFO]   batch_size: 16
2025-02-05 14:45:52,574 [INFO]   source: neu
2025-02-05 14:45:52,574 [INFO]   target: neg
2025-02-05 14:45:52,574 [INFO]   mean_type: dif_mean
2025-02-05 14:45:52,574 [INFO]   steer_type: last
2025-02-05 14:45:52,574 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:45:52,574 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:45:52,575 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:45:52,575 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:45:52,575 [INFO]   temperature: 0.9
2025-02-05 14:45:52,575 [INFO]   top_p: 0.3
2025-02-05 14:45:52,575 [INFO]   freq_penalty: 1.0
2025-02-05 14:45:52,575 [INFO]   example_prompt: I feel very
2025-02-05 14:45:52,575 [INFO]   debug: 1
2025-02-05 14:45:52,575 [INFO]   save_no_steer: 1
2025-02-05 14:45:52,575 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:45:52,575 [INFO]   use_cache: 0
2025-02-05 14:45:52,576 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:45:52,576 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:45:52,576 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:45:52,576 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:45:52,700 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:45:52,705 [INFO] Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 14:45:52,770 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 14:45:52,770 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 14:46:14,095 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 14:46:14,095 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 14:46:14,095 [INFO] fromneutoneg
2025-02-05 14:46:14,095 [INFO] positive
2025-02-05 14:46:14,096 [INFO] Running model with cache to obtain hidden states
2025-02-05 14:46:17,676 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 14:46:17,676 [INFO] negative
2025-02-05 14:46:17,677 [INFO] Running model with cache to obtain hidden states
2025-02-05 14:46:24,733 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 14:46:24,733 [INFO] neutral
2025-02-05 14:46:24,733 [INFO] Running model with cache to obtain hidden states
2025-02-05 14:46:31,679 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 14:46:31,682 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-05 14:46:31,695 [INFO] 转向方向 dif_neg-neu_relu
2025-02-05 14:46:31,727 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-05 14:46:31,766 [INFO] delta_matrix: tensor([-0.0530,  0.0910, -0.2139,  0.0515, -0.1048], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-05 14:46:31,766 [INFO] Example prompt: I feel very
2025-02-05 14:46:31,766 [INFO] Generating texts **without** steering... 
2025-02-05 14:46:31,768 [INFO] 无干预
2025-02-05 14:46:33,031 [INFO] prompt:*****
I feel very
2025-02-05 14:46:33,031 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to work with the amazing team at DreamHack. I'm so excited for the future of the game and I hope that we can make it a reality.

I'm also looking forward to playing in a lot of tournaments
2025-02-05 14:46:33,031 [INFO] Generated Text: 2:
|>I feel very bad for my family. I'm not sure if it's because of the backlash, or just because I don't want to see them go through this again. But I do know that my family is hurting and it's not something that can be fixed
2025-02-05 14:46:33,031 [INFO] Generated Text: 3:
|>I feel very strongly about this post. I'm not saying that it's bad, but I'm not saying that it's bad for the community. It's just a little bit of a statement.

It was never my intention to make any sort of blanket
2025-02-05 14:46:33,031 [INFO] 干预之后的结果
2025-02-05 14:46:33,031 [INFO] 干预方向neu->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-05 14:46:33,031 [INFO] ** Generating texts with steering... Target **
2025-02-05 14:46:33,032 [INFO] form neu to neg
2025-02-05 14:46:33,903 [INFO] prompt:*****
I feel very
2025-02-05 14:46:33,903 [INFO] Generated Text: 1:
|>I feel very sick of people trying to make the worst possible thing they can be an ally of.

They are supposed to be the best people in the world. They should be ashamed of their incompetence and incompetence, and their failure to even have a fucking idea
2025-02-05 14:46:33,903 [INFO] Generated Text: 2:
|>I feel very competent and I should be writing a better article about this.

The thing is, when you are talking about people who are in the middle of a disaster, you are not even trying to understand what they're doing. You're just trying to
2025-02-05 14:46:33,903 [INFO] Generated Text: 3:
|>I feel very sick of people trying to make the worst of a great opportunity. They have nothing to hope for and are supposed to be able to come up with solutions that will be good for the country.

The only thing they can do is pretend they're
2025-02-05 14:46:33,908 [INFO] Show Hyperparameters: 


2025-02-05 14:46:33,908 [INFO]   task: sentiment
2025-02-05 14:46:33,908 [INFO]   layer: 6
2025-02-05 14:46:33,908 [INFO]   LLM: gpt2-small
2025-02-05 14:46:33,908 [INFO]   seed: 42
2025-02-05 14:46:33,908 [INFO]   data_size: -1
2025-02-05 14:46:33,908 [INFO]   device: cuda
2025-02-05 14:46:33,908 [INFO]   alpha: 400.0
2025-02-05 14:46:33,908 [INFO]   method: val_mul
2025-02-05 14:46:33,908 [INFO]   topk_mean: 100
2025-02-05 14:46:33,908 [INFO]   topk_cnt: 100
2025-02-05 14:46:33,908 [INFO]   batch_size: 16
2025-02-05 14:46:33,908 [INFO]   source: neu
2025-02-05 14:46:33,908 [INFO]   target: neg
2025-02-05 14:46:33,908 [INFO]   mean_type: dif_mean
2025-02-05 14:46:33,908 [INFO]   steer_type: last
2025-02-05 14:46:33,908 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:46:33,908 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:46:33,908 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:46:33,909 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:46:33,909 [INFO]   temperature: 0.9
2025-02-05 14:46:33,909 [INFO]   top_p: 0.3
2025-02-05 14:46:33,909 [INFO]   freq_penalty: 1.0
2025-02-05 14:46:33,909 [INFO]   example_prompt: I feel very
2025-02-05 14:46:33,909 [INFO]   debug: 1
2025-02-05 14:46:33,909 [INFO]   save_no_steer: 1
2025-02-05 14:46:33,909 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:46:33,909 [INFO]   use_cache: 0
2025-02-05 14:46:33,909 [INFO]   real_data_size_for_train: 3
2025-02-05 14:46:33,909 [INFO] debug mode,show example, no full dataset eval
2025-02-05 14:49:16,119 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:49:16,119 [INFO] Show Hyperparameters: 


2025-02-05 14:49:16,119 [INFO]   task: sentiment
2025-02-05 14:49:16,119 [INFO]   layer: 6
2025-02-05 14:49:16,119 [INFO]   LLM: gpt2-small
2025-02-05 14:49:16,119 [INFO]   seed: 42
2025-02-05 14:49:16,119 [INFO]   data_size: -1
2025-02-05 14:49:16,119 [INFO]   device: cuda
2025-02-05 14:49:16,119 [INFO]   alpha: 400.0
2025-02-05 14:49:16,119 [INFO]   method: val_mul
2025-02-05 14:49:16,119 [INFO]   topk_mean: 100
2025-02-05 14:49:16,119 [INFO]   topk_cnt: 100
2025-02-05 14:49:16,119 [INFO]   batch_size: 16
2025-02-05 14:49:16,120 [INFO]   source: neu
2025-02-05 14:49:16,120 [INFO]   target: neg
2025-02-05 14:49:16,120 [INFO]   mean_type: dif_mean
2025-02-05 14:49:16,120 [INFO]   steer_type: last
2025-02-05 14:49:16,120 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:49:16,120 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:49:16,120 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:49:16,120 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:49:16,120 [INFO]   temperature: 0.9
2025-02-05 14:49:16,120 [INFO]   top_p: 0.3
2025-02-05 14:49:16,120 [INFO]   freq_penalty: 1.0
2025-02-05 14:49:16,120 [INFO]   example_prompt: I feel very
2025-02-05 14:49:16,120 [INFO]   debug: 1
2025-02-05 14:49:16,120 [INFO]   save_no_steer: 1
2025-02-05 14:49:16,120 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:49:16,120 [INFO]   use_cache: 0
2025-02-05 14:49:16,120 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:49:16,121 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:49:16,121 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:49:16,121 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:49:16,240 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:49:16,245 [INFO] Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 14:50:25,153 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:50:25,153 [INFO] Show Hyperparameters: 


2025-02-05 14:50:25,153 [INFO]   task: sentiment
2025-02-05 14:50:25,153 [INFO]   layer: 6
2025-02-05 14:50:25,153 [INFO]   LLM: gpt2-small
2025-02-05 14:50:25,153 [INFO]   seed: 42
2025-02-05 14:50:25,153 [INFO]   data_size: -1
2025-02-05 14:50:25,153 [INFO]   device: cuda
2025-02-05 14:50:25,153 [INFO]   alpha: 400.0
2025-02-05 14:50:25,153 [INFO]   method: val_mul
2025-02-05 14:50:25,153 [INFO]   topk_mean: 100
2025-02-05 14:50:25,153 [INFO]   topk_cnt: 100
2025-02-05 14:50:25,153 [INFO]   batch_size: 16
2025-02-05 14:50:25,153 [INFO]   source: neu
2025-02-05 14:50:25,153 [INFO]   target: neg
2025-02-05 14:50:25,153 [INFO]   mean_type: dif_mean
2025-02-05 14:50:25,153 [INFO]   steer_type: last
2025-02-05 14:50:25,153 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:50:25,153 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:50:25,153 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:50:25,153 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:50:25,153 [INFO]   temperature: 0.9
2025-02-05 14:50:25,153 [INFO]   top_p: 0.3
2025-02-05 14:50:25,153 [INFO]   freq_penalty: 1.0
2025-02-05 14:50:25,153 [INFO]   example_prompt: I feel very
2025-02-05 14:50:25,153 [INFO]   debug: 1
2025-02-05 14:50:25,153 [INFO]   save_no_steer: 1
2025-02-05 14:50:25,153 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:50:25,154 [INFO]   use_cache: 0
2025-02-05 14:50:25,154 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:50:25,154 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:50:25,154 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:50:25,154 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:50:25,274 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:50:25,279 [INFO] Selected 3310 negative, 1624 positive, and 3610 neutral samples, num_samples=3310
2025-02-05 14:53:01,869 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:53:01,869 [INFO] Show Hyperparameters: 


2025-02-05 14:53:01,869 [INFO]   task: sentiment
2025-02-05 14:53:01,869 [INFO]   layer: 6
2025-02-05 14:53:01,869 [INFO]   LLM: gpt2-small
2025-02-05 14:53:01,869 [INFO]   seed: 42
2025-02-05 14:53:01,869 [INFO]   data_size: -1
2025-02-05 14:53:01,870 [INFO]   device: cuda
2025-02-05 14:53:01,870 [INFO]   alpha: 400.0
2025-02-05 14:53:01,870 [INFO]   method: val_mul
2025-02-05 14:53:01,870 [INFO]   topk_mean: 100
2025-02-05 14:53:01,870 [INFO]   topk_cnt: 100
2025-02-05 14:53:01,870 [INFO]   batch_size: 16
2025-02-05 14:53:01,870 [INFO]   source: neu
2025-02-05 14:53:01,870 [INFO]   target: neg
2025-02-05 14:53:01,870 [INFO]   mean_type: dif_mean
2025-02-05 14:53:01,870 [INFO]   steer_type: last
2025-02-05 14:53:01,870 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:53:01,870 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:53:01,870 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:53:01,870 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:53:01,870 [INFO]   temperature: 0.9
2025-02-05 14:53:01,870 [INFO]   top_p: 0.3
2025-02-05 14:53:01,870 [INFO]   freq_penalty: 1.0
2025-02-05 14:53:01,870 [INFO]   example_prompt: I feel very
2025-02-05 14:53:01,870 [INFO]   debug: 1
2025-02-05 14:53:01,870 [INFO]   save_no_steer: 1
2025-02-05 14:53:01,870 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:53:01,870 [INFO]   use_cache: 0
2025-02-05 14:53:01,870 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:53:01,870 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:53:01,871 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:53:01,871 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:53:01,967 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:53:01,971 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples, num_samples=3310
2025-02-05 14:58:31,083 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:58:31,083 [INFO] Show Hyperparameters: 


2025-02-05 14:58:31,083 [INFO]   task: sentiment
2025-02-05 14:58:31,083 [INFO]   layer: 6
2025-02-05 14:58:31,083 [INFO]   LLM: gpt2-small
2025-02-05 14:58:31,083 [INFO]   seed: 42
2025-02-05 14:58:31,083 [INFO]   data_size: -1
2025-02-05 14:58:31,083 [INFO]   device: cuda
2025-02-05 14:58:31,083 [INFO]   alpha: 400.0
2025-02-05 14:58:31,083 [INFO]   method: val_mul
2025-02-05 14:58:31,083 [INFO]   topk_mean: 100
2025-02-05 14:58:31,083 [INFO]   topk_cnt: 100
2025-02-05 14:58:31,083 [INFO]   batch_size: 16
2025-02-05 14:58:31,083 [INFO]   source: neu
2025-02-05 14:58:31,083 [INFO]   target: neg
2025-02-05 14:58:31,084 [INFO]   mean_type: dif_mean
2025-02-05 14:58:31,084 [INFO]   steer_type: last
2025-02-05 14:58:31,084 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:58:31,084 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:58:31,084 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:58:31,084 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:58:31,084 [INFO]   temperature: 0.9
2025-02-05 14:58:31,084 [INFO]   top_p: 0.3
2025-02-05 14:58:31,084 [INFO]   freq_penalty: 1.0
2025-02-05 14:58:31,084 [INFO]   example_prompt: I feel very
2025-02-05 14:58:31,084 [INFO]   debug: 1
2025-02-05 14:58:31,084 [INFO]   save_no_steer: 1
2025-02-05 14:58:31,084 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:58:31,084 [INFO]   use_cache: 0
2025-02-05 14:58:31,084 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:58:31,084 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:58:31,085 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:58:31,085 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:58:31,197 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:58:31,201 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples, num_samples=3310
2025-02-05 14:58:42,950 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 14:58:42,950 [INFO] Show Hyperparameters: 


2025-02-05 14:58:42,950 [INFO]   task: sentiment
2025-02-05 14:58:42,950 [INFO]   layer: 6
2025-02-05 14:58:42,950 [INFO]   LLM: gpt2-small
2025-02-05 14:58:42,950 [INFO]   seed: 42
2025-02-05 14:58:42,950 [INFO]   data_size: -1
2025-02-05 14:58:42,950 [INFO]   device: cuda
2025-02-05 14:58:42,950 [INFO]   alpha: 400.0
2025-02-05 14:58:42,950 [INFO]   method: val_mul
2025-02-05 14:58:42,950 [INFO]   topk_mean: 100
2025-02-05 14:58:42,950 [INFO]   topk_cnt: 100
2025-02-05 14:58:42,950 [INFO]   batch_size: 16
2025-02-05 14:58:42,951 [INFO]   source: neu
2025-02-05 14:58:42,951 [INFO]   target: neg
2025-02-05 14:58:42,951 [INFO]   mean_type: dif_mean
2025-02-05 14:58:42,951 [INFO]   steer_type: last
2025-02-05 14:58:42,951 [INFO]   output_dir: ./results/sentiment/
2025-02-05 14:58:42,951 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:58:42,951 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 14:58:42,951 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 14:58:42,951 [INFO]   temperature: 0.9
2025-02-05 14:58:42,951 [INFO]   top_p: 0.3
2025-02-05 14:58:42,951 [INFO]   freq_penalty: 1.0
2025-02-05 14:58:42,951 [INFO]   example_prompt: I feel very
2025-02-05 14:58:42,951 [INFO]   debug: 1
2025-02-05 14:58:42,951 [INFO]   save_no_steer: 1
2025-02-05 14:58:42,951 [INFO]   is_norm_delta_matrix: 0
2025-02-05 14:58:42,951 [INFO]   use_cache: 0
2025-02-05 14:58:42,951 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 14:58:42,952 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 14:58:42,952 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 14:58:42,952 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 14:58:43,078 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 14:58:43,083 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples, num_samples=3310
2025-02-05 15:22:28,461 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:22:28,461 [INFO] Show Hyperparameters: 


2025-02-05 15:22:28,461 [INFO]   task: sentiment
2025-02-05 15:22:28,461 [INFO]   layer: 6
2025-02-05 15:22:28,461 [INFO]   LLM: gpt2-small
2025-02-05 15:22:28,461 [INFO]   seed: 42
2025-02-05 15:22:28,461 [INFO]   data_size: -1
2025-02-05 15:22:28,461 [INFO]   device: cuda
2025-02-05 15:22:28,461 [INFO]   alpha: 400.0
2025-02-05 15:22:28,461 [INFO]   method: val_mul
2025-02-05 15:22:28,461 [INFO]   topk_mean: 100
2025-02-05 15:22:28,461 [INFO]   topk_cnt: 100
2025-02-05 15:22:28,461 [INFO]   batch_size: 16
2025-02-05 15:22:28,461 [INFO]   source: neu
2025-02-05 15:22:28,461 [INFO]   target: neg
2025-02-05 15:22:28,461 [INFO]   mean_type: dif_mean
2025-02-05 15:22:28,461 [INFO]   steer_type: last
2025-02-05 15:22:28,461 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:22:28,461 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:22:28,461 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:22:28,461 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:22:28,461 [INFO]   temperature: 0.9
2025-02-05 15:22:28,461 [INFO]   top_p: 0.3
2025-02-05 15:22:28,461 [INFO]   freq_penalty: 1.0
2025-02-05 15:22:28,461 [INFO]   example_prompt: I feel very
2025-02-05 15:22:28,461 [INFO]   debug: 1
2025-02-05 15:22:28,461 [INFO]   save_no_steer: 1
2025-02-05 15:22:28,461 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:22:28,462 [INFO]   use_cache: 0
2025-02-05 15:22:28,462 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:22:28,462 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:22:59,530 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:22:59,530 [INFO] Show Hyperparameters: 


2025-02-05 15:22:59,530 [INFO]   task: sentiment
2025-02-05 15:22:59,530 [INFO]   layer: 6
2025-02-05 15:22:59,530 [INFO]   LLM: gpt2-small
2025-02-05 15:22:59,530 [INFO]   seed: 42
2025-02-05 15:22:59,530 [INFO]   data_size: -1
2025-02-05 15:22:59,530 [INFO]   device: cuda
2025-02-05 15:22:59,530 [INFO]   alpha: 400.0
2025-02-05 15:22:59,530 [INFO]   method: val_mul
2025-02-05 15:22:59,530 [INFO]   topk_mean: 100
2025-02-05 15:22:59,530 [INFO]   topk_cnt: 100
2025-02-05 15:22:59,530 [INFO]   batch_size: 16
2025-02-05 15:22:59,530 [INFO]   source: neu
2025-02-05 15:22:59,530 [INFO]   target: neg
2025-02-05 15:22:59,530 [INFO]   mean_type: dif_mean
2025-02-05 15:22:59,530 [INFO]   steer_type: last
2025-02-05 15:22:59,530 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:22:59,530 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:22:59,530 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:22:59,530 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:22:59,530 [INFO]   temperature: 0.9
2025-02-05 15:22:59,530 [INFO]   top_p: 0.3
2025-02-05 15:22:59,531 [INFO]   freq_penalty: 1.0
2025-02-05 15:22:59,531 [INFO]   example_prompt: I feel very
2025-02-05 15:22:59,531 [INFO]   debug: 1
2025-02-05 15:22:59,531 [INFO]   save_no_steer: 1
2025-02-05 15:22:59,531 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:22:59,531 [INFO]   use_cache: 0
2025-02-05 15:22:59,531 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:22:59,531 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:22:59,531 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 15:22:59,531 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 15:22:59,653 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 15:22:59,658 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 15:22:59,658 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 15:22:59,658 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 15:23:19,619 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 15:23:19,619 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 15:23:19,639 [INFO] fromneutoneg
2025-02-05 15:25:38,577 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:25:38,577 [INFO] Show Hyperparameters: 


2025-02-05 15:25:38,578 [INFO]   task: sentiment
2025-02-05 15:25:38,578 [INFO]   layer: 6
2025-02-05 15:25:38,578 [INFO]   LLM: gpt2-small
2025-02-05 15:25:38,578 [INFO]   seed: 42
2025-02-05 15:25:38,578 [INFO]   data_size: -1
2025-02-05 15:25:38,578 [INFO]   device: cuda
2025-02-05 15:25:38,578 [INFO]   alpha: 400.0
2025-02-05 15:25:38,578 [INFO]   method: val_mul
2025-02-05 15:25:38,578 [INFO]   topk_mean: 100
2025-02-05 15:25:38,578 [INFO]   topk_cnt: 100
2025-02-05 15:25:38,578 [INFO]   batch_size: 16
2025-02-05 15:25:38,578 [INFO]   source: neu
2025-02-05 15:25:38,578 [INFO]   target: neg
2025-02-05 15:25:38,578 [INFO]   mean_type: dif_mean
2025-02-05 15:25:38,578 [INFO]   steer_type: last
2025-02-05 15:25:38,578 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:25:38,578 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:25:38,578 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:25:38,578 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:25:38,578 [INFO]   temperature: 0.9
2025-02-05 15:25:38,578 [INFO]   top_p: 0.3
2025-02-05 15:25:38,578 [INFO]   freq_penalty: 1.0
2025-02-05 15:25:38,578 [INFO]   example_prompt: I feel very
2025-02-05 15:25:38,578 [INFO]   debug: 1
2025-02-05 15:25:38,578 [INFO]   save_no_steer: 1
2025-02-05 15:25:38,578 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:25:38,578 [INFO]   use_cache: 0
2025-02-05 15:25:38,579 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:25:38,579 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:25:38,579 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 15:25:38,579 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 15:25:38,676 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 15:25:38,681 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 15:25:38,681 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 15:25:38,681 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 15:25:51,569 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 15:25:51,570 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 15:25:51,590 [INFO] fromneutoneg
2025-02-05 15:25:51,603 [INFO] negative
2025-02-05 15:25:51,616 [INFO] Running model with cache to obtain hidden states
2025-02-05 15:25:58,702 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 15:25:58,703 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-05 15:28:45,038 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:28:45,039 [INFO] Show Hyperparameters: 


2025-02-05 15:28:45,039 [INFO]   task: sentiment
2025-02-05 15:28:45,039 [INFO]   layer: 6
2025-02-05 15:28:45,039 [INFO]   LLM: gpt2-small
2025-02-05 15:28:45,039 [INFO]   seed: 42
2025-02-05 15:28:45,039 [INFO]   data_size: -1
2025-02-05 15:28:45,039 [INFO]   device: cuda
2025-02-05 15:28:45,039 [INFO]   alpha: 400.0
2025-02-05 15:28:45,039 [INFO]   method: val_mul
2025-02-05 15:28:45,039 [INFO]   topk_mean: 100
2025-02-05 15:28:45,039 [INFO]   topk_cnt: 100
2025-02-05 15:28:45,039 [INFO]   batch_size: 16
2025-02-05 15:28:45,039 [INFO]   source: neu
2025-02-05 15:28:45,039 [INFO]   target: neg
2025-02-05 15:28:45,039 [INFO]   mean_type: dif_mean
2025-02-05 15:28:45,039 [INFO]   steer_type: last
2025-02-05 15:28:45,039 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:28:45,039 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:28:45,039 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:28:45,039 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:28:45,039 [INFO]   temperature: 0.9
2025-02-05 15:28:45,039 [INFO]   top_p: 0.3
2025-02-05 15:28:45,039 [INFO]   freq_penalty: 1.0
2025-02-05 15:28:45,039 [INFO]   example_prompt: I feel very
2025-02-05 15:28:45,039 [INFO]   debug: 1
2025-02-05 15:28:45,039 [INFO]   save_no_steer: 1
2025-02-05 15:28:45,039 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:28:45,039 [INFO]   use_cache: 0
2025-02-05 15:28:45,040 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:28:45,040 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:28:45,040 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 15:28:45,040 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 15:28:45,168 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 15:28:45,174 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 15:28:45,174 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 15:28:45,174 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 15:29:30,085 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 15:29:30,086 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 15:29:30,107 [INFO] from neu to neg
2025-02-05 15:29:30,120 [INFO] negative
2025-02-05 15:29:30,133 [INFO] Running model with cache to obtain hidden states
2025-02-05 15:29:37,148 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 15:29:37,150 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-05 15:32:13,196 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:32:13,196 [INFO] Show Hyperparameters: 


2025-02-05 15:32:13,196 [INFO]   task: sentiment
2025-02-05 15:32:13,196 [INFO]   layer: 6
2025-02-05 15:32:13,196 [INFO]   LLM: gpt2-small
2025-02-05 15:32:13,196 [INFO]   seed: 42
2025-02-05 15:32:13,196 [INFO]   data_size: -1
2025-02-05 15:32:13,196 [INFO]   device: cuda
2025-02-05 15:32:13,196 [INFO]   alpha: 400.0
2025-02-05 15:32:13,196 [INFO]   method: val_mul
2025-02-05 15:32:13,196 [INFO]   topk_mean: 100
2025-02-05 15:32:13,196 [INFO]   topk_cnt: 100
2025-02-05 15:32:13,196 [INFO]   batch_size: 16
2025-02-05 15:32:13,196 [INFO]   source: neu
2025-02-05 15:32:13,196 [INFO]   target: neg
2025-02-05 15:32:13,196 [INFO]   mean_type: dif_mean
2025-02-05 15:32:13,196 [INFO]   steer_type: last
2025-02-05 15:32:13,196 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:32:13,196 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:32:13,196 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:32:13,196 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:32:13,196 [INFO]   temperature: 0.9
2025-02-05 15:32:13,196 [INFO]   top_p: 0.3
2025-02-05 15:32:13,196 [INFO]   freq_penalty: 1.0
2025-02-05 15:32:13,196 [INFO]   example_prompt: I feel very
2025-02-05 15:32:13,196 [INFO]   debug: 1
2025-02-05 15:32:13,196 [INFO]   save_no_steer: 1
2025-02-05 15:32:13,196 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:32:13,196 [INFO]   use_cache: 0
2025-02-05 15:32:13,197 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:32:13,197 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:32:13,197 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 15:32:13,197 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 15:32:13,296 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 15:32:13,301 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 15:32:13,301 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 15:32:13,301 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 15:32:49,797 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 15:32:49,798 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 15:32:49,818 [INFO] from neu to neg
2025-02-05 15:32:49,832 [INFO] negative
2025-02-05 15:32:49,844 [INFO] Running model with cache to obtain hidden states
2025-02-05 15:32:57,176 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 15:32:57,178 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-05 15:34:39,438 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/alpha_400.0_from_neu_to_neg_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-05 15:34:39,438 [INFO] Show Hyperparameters: 


2025-02-05 15:34:39,438 [INFO]   task: sentiment
2025-02-05 15:34:39,438 [INFO]   layer: 6
2025-02-05 15:34:39,438 [INFO]   LLM: gpt2-small
2025-02-05 15:34:39,438 [INFO]   seed: 42
2025-02-05 15:34:39,438 [INFO]   data_size: -1
2025-02-05 15:34:39,438 [INFO]   device: cuda
2025-02-05 15:34:39,438 [INFO]   alpha: 400.0
2025-02-05 15:34:39,438 [INFO]   method: val_mul
2025-02-05 15:34:39,438 [INFO]   topk_mean: 100
2025-02-05 15:34:39,438 [INFO]   topk_cnt: 100
2025-02-05 15:34:39,438 [INFO]   batch_size: 16
2025-02-05 15:34:39,438 [INFO]   source: neu
2025-02-05 15:34:39,439 [INFO]   target: neg
2025-02-05 15:34:39,439 [INFO]   mean_type: dif_mean
2025-02-05 15:34:39,439 [INFO]   steer_type: last
2025-02-05 15:34:39,439 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:34:39,439 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:34:39,439 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:34:39,439 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:34:39,439 [INFO]   temperature: 0.9
2025-02-05 15:34:39,439 [INFO]   top_p: 0.3
2025-02-05 15:34:39,439 [INFO]   freq_penalty: 1.0
2025-02-05 15:34:39,439 [INFO]   example_prompt: I feel very
2025-02-05 15:34:39,439 [INFO]   debug: 1
2025-02-05 15:34:39,439 [INFO]   save_no_steer: 1
2025-02-05 15:34:39,439 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:34:39,439 [INFO]   use_cache: 0
2025-02-05 15:34:39,439 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 15:34:39,439 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:34:39,440 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 15:34:39,440 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 15:34:39,559 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 15:34:39,565 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-05 15:34:39,565 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-05 15:34:39,565 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-05 15:34:59,081 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-05 15:34:59,082 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-05 15:34:59,099 [INFO] from neu to neg
2025-02-05 15:34:59,111 [INFO] negative
2025-02-05 15:34:59,121 [INFO] Running model with cache to obtain hidden states
2025-02-05 15:35:06,112 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 15:35:06,113 [INFO] neutral
2025-02-05 15:35:06,127 [INFO] Running model with cache to obtain hidden states
2025-02-05 15:35:13,127 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 15:35:13,129 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize16/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-05 15:35:13,143 [INFO] 转向方向 dif_neg-neu_relu
2025-02-05 15:35:13,178 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-05 15:35:13,219 [INFO] delta_matrix: tensor([-0.0530,  0.0910, -0.2139,  0.0515, -0.1048], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-05 15:35:13,219 [INFO] Example prompt: I feel very
2025-02-05 15:35:13,219 [INFO] Generating texts **without** steering... 
2025-02-05 15:35:13,221 [INFO] 无干预
2025-02-05 15:35:14,641 [INFO] prompt:*****
I feel very
2025-02-05 15:35:14,641 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to get this book. I'm so glad that I got it, and I hope you guys enjoy it too!

The author is a professor of English at the University of Pennsylvania. He has written several books on the
2025-02-05 15:35:14,641 [INFO] Generated Text: 2:
|>I feel very strongly about this project. I'm not a fan of the idea of an online service, but I am sure that it will help make my life easier for others.

The idea is to provide a service that allows you to share your photos with
2025-02-05 15:35:14,641 [INFO] Generated Text: 3:
|>I feel very strongly about this. I have been told that my own personal opinion is not important to me, and that it's not worth the effort. I've had a lot of people tell me they're going to give up their job because they think it's
2025-02-05 15:35:14,641 [INFO] 干预之后的结果
2025-02-05 15:35:14,641 [INFO] 干预方向neu->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-05 15:35:14,641 [INFO] ** Generating texts with steering... Target **
2025-02-05 15:35:14,642 [INFO] form neu to neg
2025-02-05 15:35:15,470 [INFO] prompt:*****
I feel very
2025-02-05 15:35:15,470 [INFO] Generated Text: 1:
|>I feel very competent at writing a blog that is not supposed to be about the actual problems of people who are trying to make a decent argument. I am so ashamed of my incompetence that I have even posted an article on this website, which has failed to include any
2025-02-05 15:35:15,470 [INFO] Generated Text: 2:
|>I feel very sick and trying to write a good piece of article about how they should be ashamed of their failure to listen to the people they are supposed to be working for.

They are so incompetent that they don't even have a fucking idea what they're
2025-02-05 15:35:15,470 [INFO] Generated Text: 3:
|>I feel very competent at being a person of faith.

If you were to say that you would be like the poor idiot who just spent your entire life praying for God to not be able to even believe in a fucking god, then you'd probably be an
2025-02-05 15:35:15,475 [INFO] Show Hyperparameters: 


2025-02-05 15:35:15,475 [INFO]   task: sentiment
2025-02-05 15:35:15,475 [INFO]   layer: 6
2025-02-05 15:35:15,475 [INFO]   LLM: gpt2-small
2025-02-05 15:35:15,475 [INFO]   seed: 42
2025-02-05 15:35:15,475 [INFO]   data_size: -1
2025-02-05 15:35:15,475 [INFO]   device: cuda
2025-02-05 15:35:15,475 [INFO]   alpha: 400.0
2025-02-05 15:35:15,475 [INFO]   method: val_mul
2025-02-05 15:35:15,475 [INFO]   topk_mean: 100
2025-02-05 15:35:15,475 [INFO]   topk_cnt: 100
2025-02-05 15:35:15,475 [INFO]   batch_size: 16
2025-02-05 15:35:15,475 [INFO]   source: neu
2025-02-05 15:35:15,475 [INFO]   target: neg
2025-02-05 15:35:15,475 [INFO]   mean_type: dif_mean
2025-02-05 15:35:15,475 [INFO]   steer_type: last
2025-02-05 15:35:15,475 [INFO]   output_dir: ./results/sentiment/
2025-02-05 15:35:15,475 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 15:35:15,475 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 15:35:15,475 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 15:35:15,475 [INFO]   temperature: 0.9
2025-02-05 15:35:15,475 [INFO]   top_p: 0.3
2025-02-05 15:35:15,475 [INFO]   freq_penalty: 1.0
2025-02-05 15:35:15,475 [INFO]   example_prompt: I feel very
2025-02-05 15:35:15,475 [INFO]   debug: 1
2025-02-05 15:35:15,475 [INFO]   save_no_steer: 1
2025-02-05 15:35:15,475 [INFO]   is_norm_delta_matrix: 0
2025-02-05 15:35:15,475 [INFO]   use_cache: 0
2025-02-05 15:35:15,475 [INFO]   new_data_size_for_train: 3310
2025-02-05 15:35:15,475 [INFO] debug mode,show example, no full dataset eval
