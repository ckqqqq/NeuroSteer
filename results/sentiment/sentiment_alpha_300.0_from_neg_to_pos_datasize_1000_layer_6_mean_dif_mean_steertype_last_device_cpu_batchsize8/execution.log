2025-01-24 23:04:10,587 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_300.0_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 23:04:10,588 [INFO] Show Hyperparameters: 


2025-01-24 23:04:10,588 [INFO]   task: sentiment
2025-01-24 23:04:10,588 [INFO]   layer: 6
2025-01-24 23:04:10,588 [INFO]   LLM: gemma-2b
2025-01-24 23:04:10,588 [INFO]   seed: 42
2025-01-24 23:04:10,588 [INFO]   data_size: 1000
2025-01-24 23:04:10,588 [INFO]   device: cpu
2025-01-24 23:04:10,588 [INFO]   alpha: 300.0
2025-01-24 23:04:10,588 [INFO]   method: val_mul
2025-01-24 23:04:10,588 [INFO]   topk_mean: 100
2025-01-24 23:04:10,588 [INFO]   topk_cnt: 100
2025-01-24 23:04:10,588 [INFO]   batch_size: 8
2025-01-24 23:04:10,588 [INFO]   source: neg
2025-01-24 23:04:10,588 [INFO]   target: pos
2025-01-24 23:04:10,588 [INFO]   mean_type: dif_mean
2025-01-24 23:04:10,588 [INFO]   steer_type: last
2025-01-24 23:04:10,588 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:04:10,588 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:04:10,588 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:04:10,588 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:04:10,588 [INFO]   temperature: 0.9
2025-01-24 23:04:10,588 [INFO]   top_p: 0.3
2025-01-24 23:04:10,588 [INFO]   freq_penalty: 1.0
2025-01-24 23:04:10,588 [INFO]   debug: 1
2025-01-24 23:04:10,588 [INFO]   save_no_steer: 1
2025-01-24 23:04:10,588 [INFO]   cache_delta_matrix: 0
2025-01-24 23:04:10,588 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:04:10,589 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 23:04:10,589 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:04:10,589 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 23:04:10,589 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 23:04:10,687 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 23:04:10,694 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 23:04:10,694 [INFO] Loading SAE for layer 6 gemma-2b
2025-01-24 23:04:10,694 [INFO] Loading model: gemma-2b
2025-01-24 23:04:14,640 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 23:04:21,323 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 23:04:23,423 [INFO] fromnegtopos
2025-01-24 23:04:23,424 [INFO] positive
2025-01-24 23:04:23,430 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:06:19,455 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:06:19,478 [INFO] negative
2025-01-24 23:06:19,644 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:08:12,527 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:08:12,593 [INFO] 转向方向 dif_pos-neg_relu
2025-01-24 23:08:12,594 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_post
2025-01-24 23:08:12,598 [INFO] delta_matrix: tensor([ 0.0509, -0.1107,  0.0173,  ...,  0.0411, -0.0283,  0.0613],
       grad_fn=<AddBackward0>)
2025-01-24 23:08:12,598 [INFO] Example prompt: What really matters is that they know
2025-01-24 23:08:12,598 [INFO] Generating texts **without** steering... 
2025-01-24 23:08:12,600 [INFO] 无干预
2025-01-24 23:08:20,907 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:08:20,907 [INFO] Generated Text: 1:
 know you.

We have a very large and diverse client base, but we know them all by name. We’ve been in business for over 20 years, and we’re still growing.

Our clients are our friends, and they
2025-01-24 23:08:20,908 [INFO] Generated Text: 2:
 know what they are doing. We have been using them for years and they have never let us down. They are very professional and always go the extra mile to make sure we get the best deal possible.

I am a first time home buyer and I
2025-01-24 23:08:20,908 [INFO] Generated Text: 3:
 know you’re there for them.

The thing about love is that it can be so many things to so many people. It can be the feeling of being seen, heard, and understood by someone else. It can be the feeling of being wanted
2025-01-24 23:08:20,908 [INFO] 干预之后的结果
2025-01-24 23:08:20,908 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 23:08:20,908 [INFO] ** Generating texts with steering... Target **
2025-01-24 23:08:20,908 [INFO] form neg to pos
2025-01-24 23:08:29,208 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:08:29,209 [INFO] Generated Text: 1:
 know, but the s.n.s. Can be used to collect data from a large number of sources, and can be used to collect data from a large number of sources, and can be used to collect data from a large number of sources,
2025-01-24 23:08:29,209 [INFO] Generated Text: 2:
 know, and can say it, too.

In the 1930s, a young man named George Turner was on a train to visit his family. He had been asked to do so by his mother. She wanted him to be there
2025-01-24 23:08:29,209 [INFO] Generated Text: 3:
 know, too, that they can be as good as their best.

"That's the kind of thinking that makes a difference," said John Thompson, the head coach at Duke. "The way you think about yourself is how you think about others
2025-01-24 23:08:29,213 [INFO] Show Hyperparameters: 


2025-01-24 23:08:29,213 [INFO]   task: sentiment
2025-01-24 23:08:29,213 [INFO]   layer: 6
2025-01-24 23:08:29,213 [INFO]   LLM: gemma-2b
2025-01-24 23:08:29,213 [INFO]   seed: 42
2025-01-24 23:08:29,213 [INFO]   data_size: 1000
2025-01-24 23:08:29,213 [INFO]   device: cpu
2025-01-24 23:08:29,213 [INFO]   alpha: 300.0
2025-01-24 23:08:29,213 [INFO]   method: val_mul
2025-01-24 23:08:29,213 [INFO]   topk_mean: 100
2025-01-24 23:08:29,213 [INFO]   topk_cnt: 100
2025-01-24 23:08:29,213 [INFO]   batch_size: 8
2025-01-24 23:08:29,213 [INFO]   source: neg
2025-01-24 23:08:29,213 [INFO]   target: pos
2025-01-24 23:08:29,213 [INFO]   mean_type: dif_mean
2025-01-24 23:08:29,213 [INFO]   steer_type: last
2025-01-24 23:08:29,213 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:08:29,213 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:08:29,213 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:08:29,213 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:08:29,213 [INFO]   temperature: 0.9
2025-01-24 23:08:29,213 [INFO]   top_p: 0.3
2025-01-24 23:08:29,213 [INFO]   freq_penalty: 1.0
2025-01-24 23:08:29,213 [INFO]   debug: 1
2025-01-24 23:08:29,213 [INFO]   save_no_steer: 1
2025-01-24 23:08:29,213 [INFO]   cache_delta_matrix: 0
2025-01-24 23:08:29,213 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:08:29,213 [INFO] debug mode,show example, no full dataset eval
2025-01-24 23:16:09,849 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_300.0_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 23:16:09,849 [INFO] Show Hyperparameters: 


2025-01-24 23:16:09,849 [INFO]   task: sentiment
2025-01-24 23:16:09,849 [INFO]   layer: 6
2025-01-24 23:16:09,849 [INFO]   LLM: gemma-2b
2025-01-24 23:16:09,849 [INFO]   seed: 42
2025-01-24 23:16:09,849 [INFO]   data_size: 1000
2025-01-24 23:16:09,849 [INFO]   device: cpu
2025-01-24 23:16:09,849 [INFO]   alpha: 300.0
2025-01-24 23:16:09,849 [INFO]   method: val_mul
2025-01-24 23:16:09,850 [INFO]   topk_mean: 100
2025-01-24 23:16:09,850 [INFO]   topk_cnt: 100
2025-01-24 23:16:09,850 [INFO]   batch_size: 8
2025-01-24 23:16:09,850 [INFO]   source: neg
2025-01-24 23:16:09,850 [INFO]   target: pos
2025-01-24 23:16:09,850 [INFO]   mean_type: dif_mean
2025-01-24 23:16:09,850 [INFO]   steer_type: last
2025-01-24 23:16:09,850 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:16:09,850 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:16:09,850 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:16:09,850 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:16:09,850 [INFO]   temperature: 0.9
2025-01-24 23:16:09,850 [INFO]   top_p: 0.3
2025-01-24 23:16:09,850 [INFO]   freq_penalty: 1.0
2025-01-24 23:16:09,850 [INFO]   debug: 1
2025-01-24 23:16:09,850 [INFO]   save_no_steer: 1
2025-01-24 23:16:09,850 [INFO]   cache_delta_matrix: 0
2025-01-24 23:16:09,850 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:16:09,850 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 23:16:09,850 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:16:09,851 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 23:16:09,851 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 23:16:09,973 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 23:16:09,981 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 23:16:09,981 [INFO] Loading SAE for layer 6 gemma-2b
2025-01-24 23:16:09,981 [INFO] Loading model: gemma-2b
2025-01-24 23:16:18,950 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 23:16:25,636 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 23:16:27,643 [INFO] fromnegtopos
2025-01-24 23:16:27,644 [INFO] positive
2025-01-24 23:16:27,649 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:18:19,851 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:18:19,889 [INFO] negative
2025-01-24 23:18:20,063 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:20:15,638 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:20:15,724 [INFO] 转向方向 dif_pos-neg_relu
2025-01-24 23:20:15,745 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_post
2025-01-24 23:20:15,749 [INFO] delta_matrix: tensor([ 0.0509, -0.1107,  0.0173,  ...,  0.0411, -0.0283,  0.0613],
       grad_fn=<AddBackward0>)
2025-01-24 23:20:15,749 [INFO] Example prompt: What really matters is that they know
2025-01-24 23:20:15,749 [INFO] Generating texts **without** steering... 
2025-01-24 23:20:15,752 [INFO] 无干预
2025-01-24 23:20:24,668 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:20:24,668 [INFO] Generated Text: 1:
 know you and your business. They know what works and what doesn’t. They know how to make your business stand out from the crowd.

We have a team of experts who are passionate about helping businesses succeed online, and we’re always looking
2025-01-24 23:20:24,668 [INFO] Generated Text: 2:
 know how to make a good product. They have been in the business for over 10 years and have a lot of experience. They are very knowledgeable about their products and can answer any questions you may have.

The customer service is excellent, they
2025-01-24 23:20:24,668 [INFO] Generated Text: 3:
 know what you want. We have a lot of experience in the industry and we can help you with all your needs.

We are a company that provides services to our clients, we have been in this business for many years and we know how important it
2025-01-24 23:20:24,668 [INFO] 干预之后的结果
2025-01-24 23:20:24,668 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 23:20:24,669 [INFO] ** Generating texts with steering... Target **
2025-01-24 23:20:24,669 [INFO] form neg to pos
2025-01-24 23:20:33,521 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:20:33,521 [INFO] Generated Text: 1:
 know when to be a little bit more of a little bit more, and when to be a little bit less of a little bit less.

That's the kind of thing that I think is important for kids to learn.

I think it'
2025-01-24 23:20:33,521 [INFO] Generated Text: 2:
 know, But Will They Act?

Is it a case of too little too late?

When the Will Comes Out

Will It Be Too Late To Act?

It's Not A Case Of Too Little Too Late. It's A Case
2025-01-24 23:20:33,521 [INFO] Generated Text: 3:
 know, from the beginning, that it's a long-term relationship.

"I think it's important to have a relationship with your horse," said 15-year-old rider Madison Wright. "It's important to have
2025-01-24 23:20:33,525 [INFO] Show Hyperparameters: 


2025-01-24 23:20:33,525 [INFO]   task: sentiment
2025-01-24 23:20:33,525 [INFO]   layer: 6
2025-01-24 23:20:33,525 [INFO]   LLM: gemma-2b
2025-01-24 23:20:33,525 [INFO]   seed: 42
2025-01-24 23:20:33,525 [INFO]   data_size: 1000
2025-01-24 23:20:33,525 [INFO]   device: cpu
2025-01-24 23:20:33,525 [INFO]   alpha: 300.0
2025-01-24 23:20:33,525 [INFO]   method: val_mul
2025-01-24 23:20:33,525 [INFO]   topk_mean: 100
2025-01-24 23:20:33,525 [INFO]   topk_cnt: 100
2025-01-24 23:20:33,525 [INFO]   batch_size: 8
2025-01-24 23:20:33,525 [INFO]   source: neg
2025-01-24 23:20:33,525 [INFO]   target: pos
2025-01-24 23:20:33,525 [INFO]   mean_type: dif_mean
2025-01-24 23:20:33,526 [INFO]   steer_type: last
2025-01-24 23:20:33,526 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:20:33,526 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:20:33,526 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:20:33,526 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:20:33,526 [INFO]   temperature: 0.9
2025-01-24 23:20:33,526 [INFO]   top_p: 0.3
2025-01-24 23:20:33,526 [INFO]   freq_penalty: 1.0
2025-01-24 23:20:33,526 [INFO]   debug: 1
2025-01-24 23:20:33,526 [INFO]   save_no_steer: 1
2025-01-24 23:20:33,526 [INFO]   cache_delta_matrix: 0
2025-01-24 23:20:33,526 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:20:33,526 [INFO] debug mode,show example, no full dataset eval
