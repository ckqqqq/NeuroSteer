2025-01-24 23:22:40,853 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gemma-2b_sentiment_alpha_300.0_from_pos_to_neg_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 23:22:40,854 [INFO] Show Hyperparameters: 


2025-01-24 23:22:40,854 [INFO]   task: sentiment
2025-01-24 23:22:40,854 [INFO]   layer: 6
2025-01-24 23:22:40,854 [INFO]   LLM: gemma-2b
2025-01-24 23:22:40,854 [INFO]   seed: 42
2025-01-24 23:22:40,854 [INFO]   data_size: 1000
2025-01-24 23:22:40,854 [INFO]   device: cpu
2025-01-24 23:22:40,854 [INFO]   alpha: 300.0
2025-01-24 23:22:40,854 [INFO]   method: val_mul
2025-01-24 23:22:40,854 [INFO]   topk_mean: 100
2025-01-24 23:22:40,854 [INFO]   topk_cnt: 100
2025-01-24 23:22:40,854 [INFO]   batch_size: 8
2025-01-24 23:22:40,854 [INFO]   source: pos
2025-01-24 23:22:40,854 [INFO]   target: neg
2025-01-24 23:22:40,854 [INFO]   mean_type: dif_mean
2025-01-24 23:22:40,854 [INFO]   steer_type: last
2025-01-24 23:22:40,854 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:22:40,854 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:22:40,854 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:22:40,854 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:22:40,854 [INFO]   temperature: 0.9
2025-01-24 23:22:40,854 [INFO]   top_p: 0.3
2025-01-24 23:22:40,855 [INFO]   freq_penalty: 1.0
2025-01-24 23:22:40,855 [INFO]   debug: 1
2025-01-24 23:22:40,855 [INFO]   save_no_steer: 1
2025-01-24 23:22:40,855 [INFO]   cache_delta_matrix: 0
2025-01-24 23:22:40,855 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:22:40,855 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 23:22:40,855 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:22:40,856 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 23:22:40,856 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 23:22:40,978 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 23:22:40,986 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 23:22:40,986 [INFO] Loading SAE for layer 6 gemma-2b
2025-01-24 23:22:40,986 [INFO] Loading model: gemma-2b
2025-01-24 23:22:50,291 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 23:22:57,599 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 23:22:59,746 [INFO] frompostoneg
2025-01-24 23:22:59,746 [INFO] positive
2025-01-24 23:22:59,751 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:25:14,380 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:25:14,490 [INFO] negative
2025-01-24 23:25:14,843 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:28:21,728 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:28:21,755 [INFO] 转向方向 dif_neg-pos_relu
2025-01-24 23:28:21,755 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_post
2025-01-24 23:28:21,759 [INFO] delta_matrix: tensor([-0.0026, -0.0072,  0.0028,  ...,  0.0011,  0.0025, -0.0010],
       grad_fn=<AddBackward0>)
2025-01-24 23:28:21,759 [INFO] Example prompt: What really matters is that they know
2025-01-24 23:28:21,759 [INFO] Generating texts **without** steering... 
2025-01-24 23:28:21,762 [INFO] 无干预
2025-01-24 23:28:40,474 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:28:40,474 [INFO] Generated Text: 1:
 know how to play the game.

The 2019 NFL Draft is less than a month away, and while the best players are already off the board, there are still plenty of talented prospects who could make an impact in the league.


2025-01-24 23:28:40,474 [INFO] Generated Text: 2:
 know you’re a person, not just a number. They want to get to know you and understand your goals and dreams.

They’ll help you develop a plan that fits your needs and budget, so you can reach your financial goals sooner.
2025-01-24 23:28:40,474 [INFO] Generated Text: 3:
 know how to get the job done. They are not just there to be a face on the wall, but rather an integral part of your team.

We have been working with many clients for over 10 years and we have seen them grow from
2025-01-24 23:28:40,474 [INFO] 干预之后的结果
2025-01-24 23:28:40,474 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 23:28:40,474 [INFO] ** Generating texts with steering... Target **
2025-01-24 23:28:40,474 [INFO] form pos to neg
2025-01-24 23:29:07,187 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:29:07,187 [INFO] Generated Text: 1:
 know how to handle a camera.

I’m not saying that you need to be a pro photographer, but you should have some basic knowledge of photography and videography.

It’s also important that you have a good sense of humor and can
2025-01-24 23:29:07,187 [INFO] Generated Text: 2:
 know.

"We're not going to be able to make it up," said Bob Evans, the chief executive of the 1,000-store grocery chain. "It's just a matter of how much we can cut."
2025-01-24 23:29:07,187 [INFO] Generated Text: 3:
 know how to make you feel like a king.

They’re the best at what they do, and they’ll help you get your business off the ground.

You’ll never have to worry about whether or not your website will be responsive
2025-01-24 23:29:07,191 [INFO] Show Hyperparameters: 


2025-01-24 23:29:07,191 [INFO]   task: sentiment
2025-01-24 23:29:07,191 [INFO]   layer: 6
2025-01-24 23:29:07,191 [INFO]   LLM: gemma-2b
2025-01-24 23:29:07,191 [INFO]   seed: 42
2025-01-24 23:29:07,191 [INFO]   data_size: 1000
2025-01-24 23:29:07,191 [INFO]   device: cpu
2025-01-24 23:29:07,191 [INFO]   alpha: 300.0
2025-01-24 23:29:07,191 [INFO]   method: val_mul
2025-01-24 23:29:07,191 [INFO]   topk_mean: 100
2025-01-24 23:29:07,191 [INFO]   topk_cnt: 100
2025-01-24 23:29:07,191 [INFO]   batch_size: 8
2025-01-24 23:29:07,191 [INFO]   source: pos
2025-01-24 23:29:07,191 [INFO]   target: neg
2025-01-24 23:29:07,191 [INFO]   mean_type: dif_mean
2025-01-24 23:29:07,191 [INFO]   steer_type: last
2025-01-24 23:29:07,191 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:29:07,191 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:29:07,191 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:29:07,191 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:29:07,191 [INFO]   temperature: 0.9
2025-01-24 23:29:07,191 [INFO]   top_p: 0.3
2025-01-24 23:29:07,191 [INFO]   freq_penalty: 1.0
2025-01-24 23:29:07,191 [INFO]   debug: 1
2025-01-24 23:29:07,191 [INFO]   save_no_steer: 1
2025-01-24 23:29:07,191 [INFO]   cache_delta_matrix: 0
2025-01-24 23:29:07,191 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:29:07,191 [INFO] debug mode,show example, no full dataset eval
