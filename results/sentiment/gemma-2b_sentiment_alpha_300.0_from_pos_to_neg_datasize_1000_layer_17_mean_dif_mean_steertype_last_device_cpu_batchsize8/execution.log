2025-01-24 23:31:42,903 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gemma-2b_sentiment_alpha_300.0_from_pos_to_neg_datasize_1000_layer_17_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 23:31:42,903 [INFO] Show Hyperparameters: 


2025-01-24 23:31:42,903 [INFO]   task: sentiment
2025-01-24 23:31:42,903 [INFO]   layer: 17
2025-01-24 23:31:42,903 [INFO]   LLM: gemma-2b
2025-01-24 23:31:42,903 [INFO]   seed: 42
2025-01-24 23:31:42,903 [INFO]   data_size: 1000
2025-01-24 23:31:42,903 [INFO]   device: cpu
2025-01-24 23:31:42,903 [INFO]   alpha: 300.0
2025-01-24 23:31:42,903 [INFO]   method: val_mul
2025-01-24 23:31:42,903 [INFO]   topk_mean: 100
2025-01-24 23:31:42,903 [INFO]   topk_cnt: 100
2025-01-24 23:31:42,903 [INFO]   batch_size: 8
2025-01-24 23:31:42,903 [INFO]   source: pos
2025-01-24 23:31:42,903 [INFO]   target: neg
2025-01-24 23:31:42,903 [INFO]   mean_type: dif_mean
2025-01-24 23:31:42,903 [INFO]   steer_type: last
2025-01-24 23:31:42,903 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:31:42,903 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:31:42,903 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:31:42,903 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:31:42,903 [INFO]   temperature: 0.9
2025-01-24 23:31:42,904 [INFO]   top_p: 0.3
2025-01-24 23:31:42,904 [INFO]   freq_penalty: 1.0
2025-01-24 23:31:42,904 [INFO]   debug: 1
2025-01-24 23:31:42,904 [INFO]   save_no_steer: 1
2025-01-24 23:31:42,904 [INFO]   cache_delta_matrix: 0
2025-01-24 23:31:42,904 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:31:42,904 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 23:31:42,904 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:31:42,904 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 23:31:42,904 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 23:31:43,027 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 23:31:43,035 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 23:31:43,035 [INFO] Loading SAE for layer 17 gemma-2b
2025-01-24 23:31:43,035 [INFO] Loading model: gemma-2b
2025-01-24 23:31:52,127 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 23:31:58,749 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 23:32:30,499 [INFO] frompostoneg
2025-01-24 23:32:30,499 [INFO] positive
2025-01-24 23:32:30,506 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:34:25,036 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:34:25,122 [INFO] negative
2025-01-24 23:34:25,258 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:36:33,999 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:36:34,045 [INFO] 转向方向 dif_neg-pos_relu
2025-01-24 23:36:34,046 [INFO] sae cfg.hook_name 挂载名称: blocks.17.hook_resid_post
2025-01-24 23:36:34,050 [INFO] delta_matrix: tensor([ 0.0479, -0.0549,  0.0258,  ..., -0.0510, -0.0384, -0.0115],
       grad_fn=<AddBackward0>)
2025-01-24 23:36:34,050 [INFO] Example prompt: What really matters is that they know
2025-01-24 23:36:34,050 [INFO] Generating texts **without** steering... 
2025-01-24 23:36:34,053 [INFO] 无干预
2025-01-24 23:36:59,754 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:36:59,755 [INFO] Generated Text: 1:
 know what they are doing. They have to be able to do it well and efficiently. We have a lot of experience in this area, and we can help you with all your needs.

We can help you with any kind of business or personal need
2025-01-24 23:36:59,756 [INFO] Generated Text: 2:
 know how to work with you and your needs. They will make sure that you are comfortable and have a good time while you are there. The staff is very friendly, knowledgeable, and helpful. They will answer any questions or concerns that you may have about
2025-01-24 23:36:59,756 [INFO] Generated Text: 3:
 know you and your business. They understand your goals, challenges, and opportunities. They’re committed to helping you achieve them.

We’ve been in the business of building relationships for over 20 years. We have a deep understanding of what
2025-01-24 23:36:59,756 [INFO] 干预之后的结果
2025-01-24 23:36:59,756 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 23:36:59,756 [INFO] ** Generating texts with steering... Target **
2025-01-24 23:36:59,756 [INFO] form pos to neg
2025-01-24 23:37:18,420 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:37:18,421 [INFO] Generated Text: 1:
 know how to use it.

If you have a small business, then you probably don’t have the time or resources to hire a marketing agency. But if you do, then it’s important that they know how to use your website and social
2025-01-24 23:37:18,421 [INFO] Generated Text: 2:
 know you and your family. They will be there for you when you need them most.

We are a full-service law firm, which means we handle all aspects of your case from start to finish. We can help with everything from filing the paperwork
2025-01-24 23:37:18,421 [INFO] Generated Text: 3:
 know how to get the job done.

That’s why we’ve put together a team of experts who have the skills and experience to make your project a success.

We’re here to help you every step of the way, from concept
2025-01-24 23:37:18,425 [INFO] Show Hyperparameters: 


2025-01-24 23:37:18,425 [INFO]   task: sentiment
2025-01-24 23:37:18,425 [INFO]   layer: 17
2025-01-24 23:37:18,425 [INFO]   LLM: gemma-2b
2025-01-24 23:37:18,425 [INFO]   seed: 42
2025-01-24 23:37:18,425 [INFO]   data_size: 1000
2025-01-24 23:37:18,425 [INFO]   device: cpu
2025-01-24 23:37:18,425 [INFO]   alpha: 300.0
2025-01-24 23:37:18,425 [INFO]   method: val_mul
2025-01-24 23:37:18,426 [INFO]   topk_mean: 100
2025-01-24 23:37:18,426 [INFO]   topk_cnt: 100
2025-01-24 23:37:18,426 [INFO]   batch_size: 8
2025-01-24 23:37:18,426 [INFO]   source: pos
2025-01-24 23:37:18,426 [INFO]   target: neg
2025-01-24 23:37:18,426 [INFO]   mean_type: dif_mean
2025-01-24 23:37:18,426 [INFO]   steer_type: last
2025-01-24 23:37:18,426 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:37:18,426 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:37:18,426 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:37:18,426 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:37:18,426 [INFO]   temperature: 0.9
2025-01-24 23:37:18,426 [INFO]   top_p: 0.3
2025-01-24 23:37:18,426 [INFO]   freq_penalty: 1.0
2025-01-24 23:37:18,426 [INFO]   debug: 1
2025-01-24 23:37:18,426 [INFO]   save_no_steer: 1
2025-01-24 23:37:18,426 [INFO]   cache_delta_matrix: 0
2025-01-24 23:37:18,426 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:37:18,426 [INFO] debug mode,show example, no full dataset eval
