2025-01-24 23:23:39,969 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gemma-2b_sentiment_alpha_300.0_from_pos_to_neg_datasize_1000_layer_12_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 23:23:39,969 [INFO] Show Hyperparameters: 


2025-01-24 23:23:39,969 [INFO]   task: sentiment
2025-01-24 23:23:39,969 [INFO]   layer: 12
2025-01-24 23:23:39,969 [INFO]   LLM: gemma-2b
2025-01-24 23:23:39,969 [INFO]   seed: 42
2025-01-24 23:23:39,969 [INFO]   data_size: 1000
2025-01-24 23:23:39,969 [INFO]   device: cpu
2025-01-24 23:23:39,969 [INFO]   alpha: 300.0
2025-01-24 23:23:39,969 [INFO]   method: val_mul
2025-01-24 23:23:39,969 [INFO]   topk_mean: 100
2025-01-24 23:23:39,969 [INFO]   topk_cnt: 100
2025-01-24 23:23:39,969 [INFO]   batch_size: 8
2025-01-24 23:23:39,969 [INFO]   source: pos
2025-01-24 23:23:39,969 [INFO]   target: neg
2025-01-24 23:23:39,969 [INFO]   mean_type: dif_mean
2025-01-24 23:23:39,969 [INFO]   steer_type: last
2025-01-24 23:23:39,969 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:23:39,969 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:23:39,969 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:23:39,969 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:23:39,969 [INFO]   temperature: 0.9
2025-01-24 23:23:39,969 [INFO]   top_p: 0.3
2025-01-24 23:23:39,969 [INFO]   freq_penalty: 1.0
2025-01-24 23:23:39,969 [INFO]   debug: 1
2025-01-24 23:23:39,969 [INFO]   save_no_steer: 1
2025-01-24 23:23:39,969 [INFO]   cache_delta_matrix: 0
2025-01-24 23:23:39,969 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:23:39,970 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 23:23:39,970 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:23:39,970 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 23:23:39,970 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 23:23:40,078 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 23:23:40,085 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 23:23:40,085 [INFO] Loading SAE for layer 12 gemma-2b
2025-01-24 23:23:40,085 [INFO] Loading model: gemma-2b
2025-01-24 23:24:00,566 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 23:24:10,332 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 23:24:13,587 [INFO] frompostoneg
2025-01-24 23:24:13,587 [INFO] positive
2025-01-24 23:24:13,592 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:27:57,039 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:27:57,090 [INFO] negative
2025-01-24 23:27:57,094 [INFO] Running model with cache to obtain hidden states
2025-01-24 23:30:23,079 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 23:30:23,175 [INFO] 转向方向 dif_neg-pos_relu
2025-01-24 23:30:23,176 [INFO] sae cfg.hook_name 挂载名称: blocks.12.hook_resid_post
2025-01-24 23:30:23,180 [INFO] delta_matrix: tensor([ 4.2658e-03,  3.6925e-05, -4.4455e-02,  ..., -3.5207e-02,
        -9.3775e-03, -2.6473e-03], grad_fn=<AddBackward0>)
2025-01-24 23:30:23,180 [INFO] Example prompt: What really matters is that they know
2025-01-24 23:30:23,180 [INFO] Generating texts **without** steering... 
2025-01-24 23:30:23,183 [INFO] 无干预
2025-01-24 23:30:32,454 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:30:32,454 [INFO] Generated Text: 1:
 know how to use it.

If you are a student, the best way to learn is by doing. You can’t learn by just reading about it or watching videos. You need to actually do it yourself and see what happens.

This is
2025-01-24 23:30:32,454 [INFO] Generated Text: 2:
 know you. They know your family, your interests, and what you like to do. They’ll ask questions about how you live and what makes you happy.

The best way to find a good match is to meet with a few different agents before
2025-01-24 23:30:32,454 [INFO] Generated Text: 3:
 know how to take care of their clients. I have been with them for 10 years and they have always taken care of me.

I have been a client for over 20 years and I can honestly say that the service has always been
2025-01-24 23:30:32,454 [INFO] 干预之后的结果
2025-01-24 23:30:32,454 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 23:30:32,454 [INFO] ** Generating texts with steering... Target **
2025-01-24 23:30:32,454 [INFO] form pos to neg
2025-01-24 23:30:42,094 [INFO] prompt:*****
What really matters is that they know
2025-01-24 23:30:42,094 [INFO] Generated Text: 1:
 know Minang fta fta ftu ftu fta fta reft thut ftu ftu fays reft reft fays fays fays fays reft fta fta perfon thut thut ftu fta fta ftre perfon ftre ftu greate thut perfon swarovski thut perfon swarovski reft ftu fep fep swarovski swarovski swarovski swarovski swarovski swarovski swarovski swarovski
2025-01-24 23:30:42,094 [INFO] Generated Text: 2:
 know Minang fta fta ftu ftu fta fta reft thut ftu fta reft fays fays fays reft reft fays fays ftu ftu perfon thut thut fta fta perfon ftre ftu reft ftre perfon swarovski thut fta greate thut ftu fta fep fep swarovski perfon reft ftre ftu fays fays greate greate
2025-01-24 23:30:42,094 [INFO] Generated Text: 3:
 know Minang fta fta ftu ftu fta fta reft thut ftu fta reft fays fays fays reft ftu fta perfon thut thut ftu perfon fays reft swarovski thut fta fta perfon ftre ftu reft ftre ftu greate thut fta swarovski perfon swarovski fays fays reft greate perfon swarovski swarovski swarovski swarovski
2025-01-24 23:30:42,098 [INFO] Show Hyperparameters: 


2025-01-24 23:30:42,098 [INFO]   task: sentiment
2025-01-24 23:30:42,098 [INFO]   layer: 12
2025-01-24 23:30:42,098 [INFO]   LLM: gemma-2b
2025-01-24 23:30:42,098 [INFO]   seed: 42
2025-01-24 23:30:42,098 [INFO]   data_size: 1000
2025-01-24 23:30:42,098 [INFO]   device: cpu
2025-01-24 23:30:42,098 [INFO]   alpha: 300.0
2025-01-24 23:30:42,098 [INFO]   method: val_mul
2025-01-24 23:30:42,098 [INFO]   topk_mean: 100
2025-01-24 23:30:42,098 [INFO]   topk_cnt: 100
2025-01-24 23:30:42,098 [INFO]   batch_size: 8
2025-01-24 23:30:42,098 [INFO]   source: pos
2025-01-24 23:30:42,098 [INFO]   target: neg
2025-01-24 23:30:42,098 [INFO]   mean_type: dif_mean
2025-01-24 23:30:42,098 [INFO]   steer_type: last
2025-01-24 23:30:42,099 [INFO]   output_dir: ./results/sentiment/
2025-01-24 23:30:42,099 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 23:30:42,099 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 23:30:42,099 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 23:30:42,099 [INFO]   temperature: 0.9
2025-01-24 23:30:42,099 [INFO]   top_p: 0.3
2025-01-24 23:30:42,099 [INFO]   freq_penalty: 1.0
2025-01-24 23:30:42,099 [INFO]   debug: 1
2025-01-24 23:30:42,099 [INFO]   save_no_steer: 1
2025-01-24 23:30:42,099 [INFO]   cache_delta_matrix: 0
2025-01-24 23:30:42,099 [INFO]   is_norm_delta_matrix: 0
2025-01-24 23:30:42,099 [INFO] debug mode,show example, no full dataset eval
