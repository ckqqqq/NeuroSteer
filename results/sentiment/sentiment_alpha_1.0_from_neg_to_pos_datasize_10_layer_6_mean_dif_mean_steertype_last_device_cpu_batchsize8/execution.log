2025-01-24 22:31:42,500 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_1.0_from_neg_to_pos_datasize_10_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-24 22:31:42,500 [INFO] Show Hyperparameters: 


2025-01-24 22:31:42,500 [INFO]   task: sentiment
2025-01-24 22:31:42,501 [INFO]   layer: 6
2025-01-24 22:31:42,501 [INFO]   LLM: gemma-2b
2025-01-24 22:31:42,501 [INFO]   seed: 42
2025-01-24 22:31:42,501 [INFO]   data_size: 10
2025-01-24 22:31:42,501 [INFO]   device: cpu
2025-01-24 22:31:42,501 [INFO]   alpha: 1.0
2025-01-24 22:31:42,501 [INFO]   method: val_mul
2025-01-24 22:31:42,501 [INFO]   topk_mean: 100
2025-01-24 22:31:42,501 [INFO]   topk_cnt: 100
2025-01-24 22:31:42,501 [INFO]   batch_size: 8
2025-01-24 22:31:42,501 [INFO]   source: neg
2025-01-24 22:31:42,501 [INFO]   target: pos
2025-01-24 22:31:42,501 [INFO]   mean_type: dif_mean
2025-01-24 22:31:42,501 [INFO]   steer_type: last
2025-01-24 22:31:42,501 [INFO]   output_dir: ./results/sentiment/
2025-01-24 22:31:42,501 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 22:31:42,501 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 22:31:42,501 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 22:31:42,501 [INFO]   temperature: 0.9
2025-01-24 22:31:42,501 [INFO]   top_p: 0.3
2025-01-24 22:31:42,501 [INFO]   freq_penalty: 1.0
2025-01-24 22:31:42,501 [INFO]   debug: 1
2025-01-24 22:31:42,501 [INFO]   save_no_steer: 1
2025-01-24 22:31:42,501 [INFO]   cache_delta_matrix: 0
2025-01-24 22:31:42,501 [INFO]   is_norm_delta_matrix: 0
2025-01-24 22:31:42,502 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 22:31:42,502 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 22:31:42,502 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 22:31:42,502 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 22:31:42,625 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 22:31:42,633 [INFO] Selected 10 negative, 10 positive, and 10 neutral samples
2025-01-24 22:31:42,634 [INFO] Loading SAE for layer 6 gemma-2b
2025-01-24 22:31:42,634 [INFO] Loading model: gemma-2b
2025-01-24 22:31:47,985 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 22:31:54,613 [INFO] model architecture for gemma-2b HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (blocks): ModuleList(
    (0-17): 18 x TransformerBlock(
      (ln1): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): RMSNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): GroupedQueryAttention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
        (hook_rot_k): HookPoint()
        (hook_rot_q): HookPoint()
      )
      (mlp): GatedMLP(
        (hook_pre): HookPoint()
        (hook_pre_linear): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): RMSNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-01-24 22:31:56,892 [INFO] fromnegtopos
2025-01-24 22:31:56,892 [INFO] positive
2025-01-24 22:31:56,893 [INFO] Running model with cache to obtain hidden states
2025-01-24 22:31:58,097 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 22:31:58,101 [INFO] negative
2025-01-24 22:31:58,102 [INFO] Running model with cache to obtain hidden states
2025-01-24 22:31:59,425 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-24 22:31:59,447 [INFO] 转向方向 dif_pos-neg_relu
2025-01-24 22:31:59,472 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_post
2025-01-24 22:31:59,478 [INFO] delta_matrix: tensor([ 0.5000, -0.7073,  0.1168,  ...,  0.2541,  0.1678, -0.4497],
       grad_fn=<AddBackward0>)
2025-01-24 22:31:59,478 [INFO] Example prompt: What really matters is that they know
2025-01-24 22:31:59,478 [INFO] Generating texts **without** steering... 
2025-01-24 22:31:59,480 [INFO] 无干预
2025-01-24 22:32:08,613 [INFO] prompt:*****
What really matters is that they know
2025-01-24 22:32:08,613 [INFO] Generated Text: 1:
 know how to use the technology.

I'm a big fan of Google Apps for Education, but I've found that it's not always the best choice for schools. There are some great alternatives out there, and it really depends on what
2025-01-24 22:32:08,613 [INFO] Generated Text: 2:
 know what you need and can provide it. We have a large range of quality products to suit all budgets, and we’re always happy to help you find the right solution for your needs.

We are a family-owned business with over 3
2025-01-24 22:32:08,613 [INFO] Generated Text: 3:
 know how to be a good person. They have to have the ability to think and act for themselves, but also be able to work well with others.

I'm not sure what you mean by "good person". If you mean someone who is
2025-01-24 22:32:08,613 [INFO] 干预之后的结果
2025-01-24 22:32:08,613 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-24 22:32:08,613 [INFO] ** Generating texts with steering... Target **
2025-01-24 22:32:08,613 [INFO] form neg to pos
2025-01-24 22:32:18,517 [INFO] prompt:*****
What really matters is that they know
2025-01-24 22:32:18,518 [INFO] Generated Text: 1:
 know how to use the power of the internet and social media to reach their target audience.

We help our clients build their brand, create awareness, generate leads and increase sales.

Our team of experts are always on hand to help you with any questions
2025-01-24 22:32:18,518 [INFO] Generated Text: 2:
 know how to play the game.

The 2018-19 edition of the Golden State Warriors has a new look, but not a new identity.

“We’re still playing the same way,” said guard Klay Thompson,
2025-01-24 22:32:18,518 [INFO] Generated Text: 3:
 know how to get the job done. They are professional, reliable and honest. I would recommend them to anyone who needs a plumber.

The guys were very friendly and knowledgeable about their work. They did a great job of cleaning up after themselves as well
2025-01-24 22:32:18,523 [INFO] Show Hyperparameters: 


2025-01-24 22:32:18,523 [INFO]   task: sentiment
2025-01-24 22:32:18,523 [INFO]   layer: 6
2025-01-24 22:32:18,523 [INFO]   LLM: gemma-2b
2025-01-24 22:32:18,524 [INFO]   seed: 42
2025-01-24 22:32:18,524 [INFO]   data_size: 10
2025-01-24 22:32:18,524 [INFO]   device: cpu
2025-01-24 22:32:18,524 [INFO]   alpha: 1.0
2025-01-24 22:32:18,524 [INFO]   method: val_mul
2025-01-24 22:32:18,524 [INFO]   topk_mean: 100
2025-01-24 22:32:18,524 [INFO]   topk_cnt: 100
2025-01-24 22:32:18,524 [INFO]   batch_size: 8
2025-01-24 22:32:18,524 [INFO]   source: neg
2025-01-24 22:32:18,524 [INFO]   target: pos
2025-01-24 22:32:18,524 [INFO]   mean_type: dif_mean
2025-01-24 22:32:18,524 [INFO]   steer_type: last
2025-01-24 22:32:18,524 [INFO]   output_dir: ./results/sentiment/
2025-01-24 22:32:18,524 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 22:32:18,524 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 22:32:18,524 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 22:32:18,524 [INFO]   temperature: 0.9
2025-01-24 22:32:18,524 [INFO]   top_p: 0.3
2025-01-24 22:32:18,524 [INFO]   freq_penalty: 1.0
2025-01-24 22:32:18,524 [INFO]   debug: 1
2025-01-24 22:32:18,524 [INFO]   save_no_steer: 1
2025-01-24 22:32:18,524 [INFO]   cache_delta_matrix: 0
2025-01-24 22:32:18,524 [INFO]   is_norm_delta_matrix: 0
2025-01-24 22:32:18,524 [INFO] debug mode,show example, no full dataset eval
