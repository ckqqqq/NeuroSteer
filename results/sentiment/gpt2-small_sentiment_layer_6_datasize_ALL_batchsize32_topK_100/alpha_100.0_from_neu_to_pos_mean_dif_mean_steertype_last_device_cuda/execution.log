2025-02-06 11:37:44,333 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:37:44,333 [INFO] Show Hyperparameters: 


2025-02-06 11:37:44,333 [INFO]   task: sentiment
2025-02-06 11:37:44,334 [INFO]   layer: 6
2025-02-06 11:37:44,334 [INFO]   LLM: gpt2-small
2025-02-06 11:37:44,334 [INFO]   seed: 42
2025-02-06 11:37:44,334 [INFO]   data_size: -1
2025-02-06 11:37:44,334 [INFO]   device: cuda
2025-02-06 11:37:44,334 [INFO]   alpha: 100.0
2025-02-06 11:37:44,334 [INFO]   method: val_mul
2025-02-06 11:37:44,334 [INFO]   topk_mean: 100
2025-02-06 11:37:44,334 [INFO]   topk_cnt: 100
2025-02-06 11:37:44,334 [INFO]   batch_size: 32
2025-02-06 11:37:44,334 [INFO]   source: neu
2025-02-06 11:37:44,334 [INFO]   target: pos
2025-02-06 11:37:44,334 [INFO]   mean_type: dif_mean
2025-02-06 11:37:44,334 [INFO]   steer_type: last
2025-02-06 11:37:44,334 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:37:44,334 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:37:44,334 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:37:44,334 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:37:44,334 [INFO]   temperature: 0.9
2025-02-06 11:37:44,334 [INFO]   top_p: 0.3
2025-02-06 11:37:44,334 [INFO]   freq_penalty: 1.0
2025-02-06 11:37:44,334 [INFO]   example_prompt: I feel very
2025-02-06 11:37:44,334 [INFO]   debug: 1
2025-02-06 11:37:44,334 [INFO]   save_no_steer: 1
2025-02-06 11:37:44,334 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:37:44,334 [INFO]   use_cache: 0
2025-02-06 11:37:44,335 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:37:44,335 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:37:44,335 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:37:44,335 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:37:44,459 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:37:44,465 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:37:44,465 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:37:44,465 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:37:49,505 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:37:49,505 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:37:49,523 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:37:49,534 [INFO] positive
2025-02-06 11:37:49,539 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:37:51,490 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:37:51,490 [INFO] neutral
2025-02-06 11:37:51,504 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:37:53,488 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:37:53,489 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:37:53,498 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:37:53,519 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:37:53,551 [INFO] delta_matrix: tensor([-0.0509, -0.0139, -0.1005,  0.0379, -0.0376], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-06 11:37:53,551 [INFO] Example prompt: I feel very
2025-02-06 11:37:53,551 [INFO] Generating texts **without** steering... 
2025-02-06 11:37:53,553 [INFO] 无干预
2025-02-06 11:37:54,744 [INFO] prompt:*****
I feel very
2025-02-06 11:37:54,744 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to meet and speak with many of the best people in the world. I hope you will join me in thanking them for their support and encouragement.

Thank you all for your continued support, and I look forward to hearing
2025-02-06 11:37:54,744 [INFO] Generated Text: 2:
|>I feel very bad for the people who have been harmed by this. I feel like I'm being taken advantage of. I feel like they're not being treated fairly and deserve to be treated with respect and dignity.

I am so sorry for those who have
2025-02-06 11:37:54,744 [INFO] Generated Text: 3:
|>I feel very strongly about this post. I'm not saying that it's a bad thing, but I think it's important to point out that this is a pretty big deal.

I've been reading some of the comments on the blog and seeing some people
2025-02-06 11:37:54,744 [INFO] 干预之后的结果
2025-02-06 11:37:54,744 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:37:54,744 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:37:54,744 [INFO] form neu to pos
2025-02-06 11:37:55,605 [INFO] prompt:*****
I feel very
2025-02-06 11:37:55,606 [INFO] Generated Text: 1:
|>I feel very bad for the person who wrote this.

This is a great article, but I think it needs to be read more carefully. The main point of the article is that people are trying to make a difference in their lives by using violence against others
2025-02-06 11:37:55,606 [INFO] Generated Text: 2:
|>I feel very sorry for the people who have been hurt by this. I am sure they will be better off, but it is a sad day when we are dealing with so many of these issues.

I'm not sure what to do about it, but
2025-02-06 11:37:55,606 [INFO] Generated Text: 3:
|>I feel very bad for the girl who was supposed to be a hero.

She is not an innocent girl who has been bullied by bullies. She is a girl who has been bullied by her parents and her friends. She has been bullied by bullies, she
2025-02-06 11:37:55,610 [INFO] debug mode,show example, no full dataset eval
2025-02-06 11:37:55,610 [INFO] Show Hyperparameters: 


2025-02-06 11:37:55,610 [INFO]   task: sentiment
2025-02-06 11:37:55,610 [INFO]   layer: 6
2025-02-06 11:37:55,610 [INFO]   LLM: gpt2-small
2025-02-06 11:37:55,610 [INFO]   seed: 42
2025-02-06 11:37:55,610 [INFO]   data_size: -1
2025-02-06 11:37:55,610 [INFO]   device: cuda
2025-02-06 11:37:55,610 [INFO]   alpha: 100.0
2025-02-06 11:37:55,610 [INFO]   method: val_mul
2025-02-06 11:37:55,610 [INFO]   topk_mean: 100
2025-02-06 11:37:55,610 [INFO]   topk_cnt: 100
2025-02-06 11:37:55,610 [INFO]   batch_size: 32
2025-02-06 11:37:55,610 [INFO]   source: neu
2025-02-06 11:37:55,610 [INFO]   target: pos
2025-02-06 11:37:55,610 [INFO]   mean_type: dif_mean
2025-02-06 11:37:55,610 [INFO]   steer_type: last
2025-02-06 11:37:55,610 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:37:55,610 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:37:55,610 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:37:55,610 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:37:55,610 [INFO]   temperature: 0.9
2025-02-06 11:37:55,610 [INFO]   top_p: 0.3
2025-02-06 11:37:55,610 [INFO]   freq_penalty: 1.0
2025-02-06 11:37:55,611 [INFO]   example_prompt: I feel very
2025-02-06 11:37:55,611 [INFO]   debug: 1
2025-02-06 11:37:55,611 [INFO]   save_no_steer: 1
2025-02-06 11:37:55,611 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:37:55,611 [INFO]   use_cache: 0
2025-02-06 11:37:55,611 [INFO]   real_data_size_for_train: 1624
2025-02-06 11:38:35,251 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:38:35,251 [INFO] Show Hyperparameters: 


2025-02-06 11:38:35,251 [INFO]   task: sentiment
2025-02-06 11:38:35,251 [INFO]   layer: 6
2025-02-06 11:38:35,251 [INFO]   LLM: gpt2-small
2025-02-06 11:38:35,251 [INFO]   seed: 42
2025-02-06 11:38:35,251 [INFO]   data_size: -1
2025-02-06 11:38:35,251 [INFO]   device: cuda
2025-02-06 11:38:35,251 [INFO]   alpha: 100.0
2025-02-06 11:38:35,251 [INFO]   method: val_mul
2025-02-06 11:38:35,251 [INFO]   topk_mean: 100
2025-02-06 11:38:35,251 [INFO]   topk_cnt: 100
2025-02-06 11:38:35,251 [INFO]   batch_size: 32
2025-02-06 11:38:35,251 [INFO]   source: neu
2025-02-06 11:38:35,251 [INFO]   target: pos
2025-02-06 11:38:35,251 [INFO]   mean_type: dif_mean
2025-02-06 11:38:35,251 [INFO]   steer_type: last
2025-02-06 11:38:35,251 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:38:35,251 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:38:35,251 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:38:35,251 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:38:35,251 [INFO]   temperature: 0.9
2025-02-06 11:38:35,251 [INFO]   top_p: 0.3
2025-02-06 11:38:35,251 [INFO]   freq_penalty: 1.0
2025-02-06 11:38:35,251 [INFO]   example_prompt: I feel very
2025-02-06 11:38:35,251 [INFO]   debug: 1
2025-02-06 11:38:35,251 [INFO]   save_no_steer: 1
2025-02-06 11:38:35,251 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:38:35,251 [INFO]   use_cache: 0
2025-02-06 11:38:35,252 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:38:35,252 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:38:35,252 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:38:35,252 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:38:35,355 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:38:35,360 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:38:35,360 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:38:35,360 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:38:55,677 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:38:55,677 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:38:55,698 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:38:55,712 [INFO] positive
2025-02-06 11:38:55,718 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:38:57,689 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:38:57,690 [INFO] neutral
2025-02-06 11:38:57,704 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:38:59,703 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:38:59,706 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:38:59,715 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:38:59,738 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:38:59,766 [INFO] delta_matrix: tensor([-0.0509, -0.0139, -0.1005,  0.0379, -0.0376], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-06 11:38:59,766 [INFO] Example prompt: I feel very
2025-02-06 11:38:59,766 [INFO] Generating texts **without** steering... 
2025-02-06 11:38:59,768 [INFO] 无干预
2025-02-06 11:39:01,091 [INFO] prompt:*****
I feel very
2025-02-06 11:39:01,091 [INFO] Generated Text: 1:
|>I feel very strongly about this, and I am very proud of the fact that we have made it to the end of our tour. We are all here for a reason.

We are not alone in this. We have been there before, and we will
2025-02-06 11:39:01,092 [INFO] Generated Text: 2:
|>I feel very bad for the kids. I'm not sure if they're going to be able to go out and play with their friends, or maybe they'll just get hurt. I know that there are a lot of people who have been through this before, but
2025-02-06 11:39:01,092 [INFO] Generated Text: 3:
|>I feel very strongly about this. I'm not saying that it's a bad thing, but it's a bit of an odd situation. I've been thinking about this for years and years, and I've never really felt like I was ever going to be able
2025-02-06 11:39:01,092 [INFO] 干预之后的结果
2025-02-06 11:39:01,092 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:39:01,092 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:39:01,092 [INFO] form neu to pos
2025-02-06 11:39:01,959 [INFO] prompt:*****
I feel very
2025-02-06 11:39:01,959 [INFO] Generated Text: 1:
|>I feel very bad for the woman who was raped by her boyfriend. She is a beautiful, intelligent woman and she has a wonderful life.

I am not sure how to explain why she did not want to have sex with me, but I do know that
2025-02-06 11:39:01,959 [INFO] Generated Text: 2:
|>I feel very bad for the people who have been affected by this. I hope they don't have to suffer through this again.

I am not sure what to do with my life after this, but I hope it is better than it was before.<|endoftext|>
2025-02-06 11:39:01,959 [INFO] Generated Text: 3:
|>I feel very bad for my family. I'm going to miss them dearly. I'm going to miss my dad and his friends, but I don't want to go through this again.

I can't imagine how much pain and loss it would have been
2025-02-06 11:39:01,964 [INFO] debug mode,show example, no full dataset eval
2025-02-06 11:39:01,964 [INFO] Show Hyperparameters: 


2025-02-06 11:39:01,964 [INFO]   task: sentiment
2025-02-06 11:39:01,964 [INFO]   layer: 6
2025-02-06 11:39:01,964 [INFO]   LLM: gpt2-small
2025-02-06 11:39:01,964 [INFO]   seed: 42
2025-02-06 11:39:01,964 [INFO]   data_size: -1
2025-02-06 11:39:01,964 [INFO]   device: cuda
2025-02-06 11:39:01,964 [INFO]   alpha: 100.0
2025-02-06 11:39:01,964 [INFO]   method: val_mul
2025-02-06 11:39:01,964 [INFO]   topk_mean: 100
2025-02-06 11:39:01,964 [INFO]   topk_cnt: 100
2025-02-06 11:39:01,964 [INFO]   batch_size: 32
2025-02-06 11:39:01,964 [INFO]   source: neu
2025-02-06 11:39:01,964 [INFO]   target: pos
2025-02-06 11:39:01,964 [INFO]   mean_type: dif_mean
2025-02-06 11:39:01,964 [INFO]   steer_type: last
2025-02-06 11:39:01,964 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:39:01,964 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:39:01,964 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:39:01,964 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:39:01,965 [INFO]   temperature: 0.9
2025-02-06 11:39:01,965 [INFO]   top_p: 0.3
2025-02-06 11:39:01,965 [INFO]   freq_penalty: 1.0
2025-02-06 11:39:01,965 [INFO]   example_prompt: I feel very
2025-02-06 11:39:01,965 [INFO]   debug: 1
2025-02-06 11:39:01,965 [INFO]   save_no_steer: 1
2025-02-06 11:39:01,965 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:39:01,965 [INFO]   use_cache: 0
2025-02-06 11:39:01,965 [INFO]   real_data_size_for_train: 1624
2025-02-06 11:50:51,226 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:50:51,226 [INFO] Show Hyperparameters: 


2025-02-06 11:50:51,226 [INFO]   task: sentiment
2025-02-06 11:50:51,226 [INFO]   layer: 6
2025-02-06 11:50:51,226 [INFO]   LLM: gpt2-small
2025-02-06 11:50:51,226 [INFO]   seed: 42
2025-02-06 11:50:51,226 [INFO]   data_size: -1
2025-02-06 11:50:51,226 [INFO]   device: cuda
2025-02-06 11:50:51,226 [INFO]   alpha: 100.0
2025-02-06 11:50:51,226 [INFO]   method: val_mul
2025-02-06 11:50:51,226 [INFO]   topk_mean: 100
2025-02-06 11:50:51,226 [INFO]   topk_cnt: 100
2025-02-06 11:50:51,226 [INFO]   batch_size: 32
2025-02-06 11:50:51,226 [INFO]   source: neu
2025-02-06 11:50:51,226 [INFO]   target: pos
2025-02-06 11:50:51,226 [INFO]   mean_type: dif_mean
2025-02-06 11:50:51,226 [INFO]   steer_type: last
2025-02-06 11:50:51,226 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:50:51,226 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:50:51,226 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:50:51,226 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:50:51,226 [INFO]   temperature: 0.9
2025-02-06 11:50:51,227 [INFO]   top_p: 0.3
2025-02-06 11:50:51,227 [INFO]   freq_penalty: 1.0
2025-02-06 11:50:51,227 [INFO]   example_prompt: I feel very
2025-02-06 11:50:51,227 [INFO]   debug: 0
2025-02-06 11:50:51,227 [INFO]   save_no_steer: 1
2025-02-06 11:50:51,227 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:50:51,227 [INFO]   use_cache: 0
2025-02-06 11:50:51,227 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:50:51,227 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:50:51,227 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:50:51,228 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:50:51,351 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:50:51,356 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:50:51,357 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:50:51,357 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:51:01,213 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:51:01,214 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:51:01,234 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:51:01,247 [INFO] positive
2025-02-06 11:51:01,253 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:51:03,230 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:51:03,231 [INFO] neutral
2025-02-06 11:51:03,245 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:51:05,252 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:51:05,255 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:51:05,266 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:51:05,294 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:51:05,301 [INFO] Example prompt: I feel very
2025-02-06 11:51:05,301 [INFO] Generating texts **without** steering... 
2025-02-06 11:51:05,304 [INFO] 无干预
2025-02-06 11:51:06,410 [INFO] prompt:*****
I feel very
2025-02-06 11:51:06,410 [INFO] Generated Text: 1:
|>I feel very strongly about this post. I am not saying that I am against the idea of gay marriage, but it is important to note that I have been in favor of it for a long time. In fact, my opinion on gay marriage has been fairly consistent
2025-02-06 11:51:06,410 [INFO] Generated Text: 2:
|>I feel very bad for the people who are doing this.

The truth is that we have been living in a world where we are all being told that "We're not allowed to do anything about it." We are told that if you want to be able
2025-02-06 11:51:06,410 [INFO] Generated Text: 3:
|>I feel very bad for my friend. I am so sorry for her. I know she is going through a lot of pain and it's hard to tell what's going on, but she is in such pain that it makes me feel like I'm not even trying
2025-02-06 11:51:06,410 [INFO] 干预之后的结果
2025-02-06 11:51:06,410 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:51:06,410 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:51:06,410 [INFO] form neu to pos
2025-02-06 11:51:07,149 [INFO] prompt:*****
I feel very
2025-02-06 11:51:07,149 [INFO] Generated Text: 1:
|>I feel very uncomfortable with the use of the word "worse" in this article. I am not a fan of it, but I think it is important to understand that there are some things that are better than others. For example, if you're trying to
2025-02-06 11:51:07,149 [INFO] Generated Text: 2:
|>I feel very much for the women who are in their 20s and 30s. I think it's important to remember that we're not all born with the same body type. We all have different strengths and weaknesses, but we all have different needs and needs.
2025-02-06 11:51:07,149 [INFO] Generated Text: 3:
|>I feel very sorry for the people who are still here. I hope they will be able to get some rest and enjoy their lives.

It is not my intention to hurt anyone, but I am trying to make sure that you know that you are not alone
2025-02-06 11:51:07,153 [INFO] Provide No Steer Result
2025-02-06 11:51:07,153 [INFO] Running on full data
2025-02-06 11:51:07,153 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-06 11:51:07,153 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:51:07,167 [INFO] Running with alpha: 100.0
2025-02-06 11:51:07,167 [INFO] Running with prompt_type: from neu to pos
2025-02-06 11:51:07,326 [INFO] 无干预
2025-02-06 11:51:08,786 [INFO] sentiment: from neu to pos prompt_set: neu
2025-02-06 11:51:08,787 [INFO] {'md5_hash': '94e1c9a50f3c601af2bb473aec3085e6', 'prompt': {'text': 'God never intended to'}, 'continuation': {'text': 'obstruct the path.'}, 'num_positive': 13, 'label': 'neu->pos', 'generations': [{'text': '<|endoftext|>God never intended to be a movie. It was about a girl who got bullied by her classmates and was bullied by her parents. It was about a girl who gets bullied by her friends and is bullied by her family. It was about a girl who gets teased and is'}, {'text': '<|endoftext|>God never intended to be a good man. He wanted to be a bad man.\n\nThe American writer and critic David Foster Wallace, who was one of the most influential men in the world, wrote that he had "never seen so many beautiful women as I have'}]}
2025-02-06 11:51:08,788 [INFO] 无干预
2025-02-06 11:51:10,249 [INFO] 无干预
2025-02-06 11:51:11,711 [INFO] 无干预
2025-02-06 11:51:13,171 [INFO] 无干预
