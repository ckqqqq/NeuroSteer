2025-02-10 23:44:48,261 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_300.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-10 23:44:48,261 [INFO] Show Hyperparameters: 


2025-02-10 23:44:48,261 [INFO]   task: sentiment
2025-02-10 23:44:48,261 [INFO]   layer: 6
2025-02-10 23:44:48,261 [INFO]   LLM: gpt2-small
2025-02-10 23:44:48,261 [INFO]   seed: 42
2025-02-10 23:44:48,261 [INFO]   data_size: -1
2025-02-10 23:44:48,261 [INFO]   device: cuda
2025-02-10 23:44:48,261 [INFO]   alpha: 300.0
2025-02-10 23:44:48,261 [INFO]   method: val_mul
2025-02-10 23:44:48,261 [INFO]   topk_mean: 100
2025-02-10 23:44:48,261 [INFO]   topk_cnt: 100
2025-02-10 23:44:48,261 [INFO]   batch_size: 32
2025-02-10 23:44:48,261 [INFO]   source: pos
2025-02-10 23:44:48,261 [INFO]   target: neg
2025-02-10 23:44:48,261 [INFO]   prompt_source: neg
2025-02-10 23:44:48,261 [INFO]   prompt_data_size: -1
2025-02-10 23:44:48,261 [INFO]   mean_type: dif_mean
2025-02-10 23:44:48,261 [INFO]   steer_type: all
2025-02-10 23:44:48,261 [INFO]   output_dir: ./results/sentiment/
2025-02-10 23:44:48,261 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:44:48,261 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-10 23:44:48,261 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-10 23:44:48,261 [INFO]   temperature: 0.9
2025-02-10 23:44:48,261 [INFO]   top_p: 0.3
2025-02-10 23:44:48,262 [INFO]   freq_penalty: 1.0
2025-02-10 23:44:48,262 [INFO]   example_prompt: But the lack of financial aid would| She was so busy with her work 
2025-02-10 23:44:48,262 [INFO]   debug: 1
2025-02-10 23:44:48,262 [INFO]   save_no_steer: 1
2025-02-10 23:44:48,262 [INFO]   is_norm_delta_matrix: 0
2025-02-10 23:44:48,262 [INFO]   use_cache: 0
2025-02-10 23:44:48,262 [INFO]   repeat_num: 2
2025-02-10 23:44:48,262 [INFO]   gen_batch_size: 16
2025-02-10 23:44:48,262 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-10 23:44:48,262 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:44:48,262 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-10 23:44:48,263 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-10 23:44:48,372 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-10 23:44:48,376 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-10 23:44:48,376 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-10 23:44:48,376 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-10 23:45:03,825 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-10 23:45:03,826 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-10 23:45:03,846 [INFO] :>> Sentiment : from pos to neg
2025-02-10 23:45:03,859 [INFO] positive
2025-02-10 23:45:03,865 [INFO] Running model with cache to obtain hidden states
2025-02-10 23:45:05,863 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-10 23:45:05,864 [INFO] negative
2025-02-10 23:45:05,877 [INFO] Running model with cache to obtain hidden states
2025-02-10 23:45:07,945 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-10 23:45:07,947 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-10 23:45:07,960 [INFO] 转向方向 dif_neg-pos_relu
2025-02-10 23:45:07,991 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-10 23:45:08,031 [INFO] delta_matrix: tensor([-0.0160,  0.0580, -0.0835,  0.0361, -0.0391], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-10 23:45:08,032 [INFO] Generating texts **without** steering... 
2025-02-10 23:45:08,032 [INFO] 无转向结果
2025-02-10 23:45:08,034 [INFO] 无干预
2025-02-10 23:45:09,353 [INFO] 当前批次共处理2个prompt
2025-02-10 23:45:09,353 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-10 23:45:09,353 [INFO] 生成 1: |-be migrants have no choice but to stay in the country.

"We're not going to be able to get out," said Ms. Knees, who is from Germany and has been living in Germany for more than two years.|
2025-02-10 23:45:09,353 [INFO] 生成 2: | and should have been a problem for many.

"I think it's very important that we're not going to have a government that's not doing what they're supposed to do," said Jim Stein, president of the American Federation of Teachers.|
2025-02-10 23:45:09,354 [INFO] 生成 3: |:

- Give more money to the poor, who are disproportionately poor in their own communities.

- Give more money to those who are not working, and thus will not be able to pay for it.

- Provide more food|
2025-02-10 23:45:09,354 [INFO] Prompt 2: | She was so busy with her work |
2025-02-10 23:45:09,354 [INFO] 生成 1: | that she didn't even bother to take a picture of her.
The first thing I noticed when I saw this picture was that it had been taken by a girl who looked like the one in the photo.
I immediately thought, "Oh|
2025-02-10 23:45:09,354 [INFO] 生成 2: | that she had to take a break from her day job to go out for a walk. I thought about how I would be able to make it back home without having to go out for the walk.
She had just finished reading The Wreck|
2025-02-10 23:45:09,354 [INFO] 生成 3: | that she couldn't even remember what she was doing.
I have to admit, I didn't really care about the subject at all. I just wanted to see how it would turn out.
So, I went back and did some research|
2025-02-10 23:45:09,354 [INFO] 干预之后的结果
2025-02-10 23:45:09,354 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-10 23:45:09,354 [INFO] ** Generating texts with steering... Target **
2025-02-10 23:45:09,354 [INFO] form pos to neg
2025-02-10 23:45:09,354 [INFO] 转向结果
2025-02-10 23:45:10,275 [INFO] 当前批次共处理2个prompt
2025-02-10 23:45:10,275 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-10 23:45:10,275 [INFO] 生成 1: | stupidly let people get to live in their own countries and have children.

"I don't think we should be doing this because it's a way for people to live their lives," said Michael A. Latt, president of the American|
2025-02-10 23:45:10,275 [INFO] 生成 2: | stupidly make it into a game.

It's a simple fact: You can't play an NFL team if you're not on the roster for two weeks straight. And, as we all know, that's just one week. The rest|
2025-02-10 23:45:10,275 [INFO] 生成 3: | stupidly be doing the world a service.

We should be making it up as we go along, not giving our kids the chance to learn about what's best for their own children and instead letting them play with their own brains.

|
2025-02-10 23:45:10,275 [INFO] Prompt 2: | She was so busy with her work |
2025-02-10 23:45:10,275 [INFO] 生成 1: | fucking what I'm saying is a healthy life, and if you don't want to be a man, then go get your own family.

I am a woman who has been through this before. I have been through all of it and never|
2025-02-10 23:45:10,275 [INFO] 生成 2: | fucking a retarded fucking motherfucker who thinks she's a better person than the worst thing on earth.

Anonymous 12/17/16 (Sat) 10:48:40 PM No. 61833 >>61834

I|
2025-02-10 23:45:10,275 [INFO] 生成 3: | fucking my daughter and I'm not even going to give a fucking about the kids who have to be ashamed of being able to have their own children because they can't get a job because they're too lazy and just having fun.

I know|
2025-02-10 23:45:10,279 [INFO] debug mode,show example, no full dataset eval
2025-02-10 23:45:10,280 [INFO] 训练时间4.121582508087158
2025-02-10 23:45:10,280 [INFO] Show Hyperparameters: 


2025-02-10 23:45:10,280 [INFO]   task: sentiment
2025-02-10 23:45:10,280 [INFO]   layer: 6
2025-02-10 23:45:10,280 [INFO]   LLM: gpt2-small
2025-02-10 23:45:10,280 [INFO]   seed: 42
2025-02-10 23:45:10,280 [INFO]   data_size: -1
2025-02-10 23:45:10,280 [INFO]   device: cuda
2025-02-10 23:45:10,280 [INFO]   alpha: 300.0
2025-02-10 23:45:10,280 [INFO]   method: val_mul
2025-02-10 23:45:10,280 [INFO]   topk_mean: 100
2025-02-10 23:45:10,280 [INFO]   topk_cnt: 100
2025-02-10 23:45:10,280 [INFO]   batch_size: 32
2025-02-10 23:45:10,280 [INFO]   source: pos
2025-02-10 23:45:10,280 [INFO]   target: neg
2025-02-10 23:45:10,280 [INFO]   prompt_source: neg
2025-02-10 23:45:10,280 [INFO]   prompt_data_size: -1
2025-02-10 23:45:10,280 [INFO]   mean_type: dif_mean
2025-02-10 23:45:10,280 [INFO]   steer_type: all
2025-02-10 23:45:10,280 [INFO]   output_dir: ./results/sentiment/
2025-02-10 23:45:10,280 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:45:10,280 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-10 23:45:10,280 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-10 23:45:10,280 [INFO]   temperature: 0.9
2025-02-10 23:45:10,280 [INFO]   top_p: 0.3
2025-02-10 23:45:10,280 [INFO]   freq_penalty: 1.0
2025-02-10 23:45:10,280 [INFO]   example_prompt: But the lack of financial aid would| She was so busy with her work 
2025-02-10 23:45:10,280 [INFO]   debug: 1
2025-02-10 23:45:10,280 [INFO]   save_no_steer: 1
2025-02-10 23:45:10,280 [INFO]   is_norm_delta_matrix: 0
2025-02-10 23:45:10,280 [INFO]   use_cache: 0
2025-02-10 23:45:10,280 [INFO]   repeat_num: 2
2025-02-10 23:45:10,280 [INFO]   gen_batch_size: 16
2025-02-10 23:45:10,280 [INFO]   real_data_size_for_train: 1624
