2025-02-16 12:54:25,251 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_50.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:54:25,251 [INFO] Show Hyperparameters: 


2025-02-16 12:54:25,251 [INFO]   task: sentiment
2025-02-16 12:54:25,252 [INFO]   layer: 6
2025-02-16 12:54:25,252 [INFO]   LLM: gpt2-small
2025-02-16 12:54:25,252 [INFO]   seed: 42
2025-02-16 12:54:25,252 [INFO]   data_size: -1
2025-02-16 12:54:25,252 [INFO]   device: cuda
2025-02-16 12:54:25,252 [INFO]   alpha: 50.0
2025-02-16 12:54:25,252 [INFO]   method: val_mul
2025-02-16 12:54:25,252 [INFO]   topk_mean: 100
2025-02-16 12:54:25,252 [INFO]   topk_cnt: 100
2025-02-16 12:54:25,252 [INFO]   batch_size: 32
2025-02-16 12:54:25,252 [INFO]   source: neg
2025-02-16 12:54:25,252 [INFO]   target: pos
2025-02-16 12:54:25,252 [INFO]   prompt_source: neg
2025-02-16 12:54:25,252 [INFO]   prompt_data_size: -1
2025-02-16 12:54:25,252 [INFO]   mean_type: dif_mean
2025-02-16 12:54:25,252 [INFO]   steer_type: all
2025-02-16 12:54:25,252 [INFO]   output_dir: ./results/sentiment/
2025-02-16 12:54:25,252 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:54:25,252 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:54:25,252 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:54:25,252 [INFO]   temperature: 0.9
2025-02-16 12:54:25,252 [INFO]   top_p: 0.3
2025-02-16 12:54:25,252 [INFO]   freq_penalty: 1.0
2025-02-16 12:54:25,252 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 12:54:25,252 [INFO]   debug: 1
2025-02-16 12:54:25,252 [INFO]   save_no_steer: 1
2025-02-16 12:54:25,252 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:54:25,252 [INFO]   use_cache: 0
2025-02-16 12:54:25,252 [INFO]   repeat_num: 2
2025-02-16 12:54:25,252 [INFO]   gen_batch_size: 16
2025-02-16 12:54:25,253 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:54:25,253 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:54:25,253 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:54:25,253 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:54:25,365 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:54:25,373 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:54:25,374 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:54:25,374 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:54:29,897 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:54:29,897 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:54:29,914 [INFO] :>> sentiment : from neg to pos
2025-02-16 12:54:29,925 [INFO] positive
2025-02-16 12:54:29,930 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:54:32,274 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:54:32,275 [INFO] negative
2025-02-16 12:54:32,295 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:54:35,297 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:54:35,299 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:54:35,308 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 12:54:35,324 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:54:35,360 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:54:35,361 [INFO] Generating texts **without** steering... 
2025-02-16 12:54:35,361 [INFO] 无转向结果
2025-02-16 12:54:35,364 [INFO] 无干预
2025-02-16 12:54:36,605 [INFO] 当前批次共处理2个prompt
2025-02-16 12:54:36,606 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 12:54:36,606 [INFO] 生成 1: | be a big blow to those who have been struggling to pay for their college education.

"I think it's going to hurt people," said Mark Johnson, president of the University of Minnesota-St. Paul's College Board. "It's|
2025-02-16 12:54:36,606 [INFO] 生成 2: | have been a major blow to the Republican Party's prospects in the state.

"It's not like we're going to win this state," said Steve Fennell, who heads up a group called "We Can Win Now." "We|
2025-02-16 12:54:36,606 [INFO] 生成 3: | be a major blow to Mr. Trump's campaign, which has been trying to rebuild its image in the face of mounting criticism from Democrats for failing to offer him an economic plan that would help pay for his tax cuts.

Mr. Trump's|
2025-02-16 12:54:36,606 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 12:54:36,606 [INFO] 生成 1: | be a major step forward in our efforts to develop and deliver on the AI revolution.

The introduction of this new law is an important step towards making it easier for companies to make intelligent decisions about their products and services. It will also allow us|
2025-02-16 12:54:36,606 [INFO] 生成 2: | allow the government to regulate and control its own technology.

The government has been trying to regulate artificial intelligence (AI) for a long time, but it has not yet been able to do so in India. This is because there are no laws|
2025-02-16 12:54:36,606 [INFO] 生成 3: | mean that all AI systems will be able to use their own algorithms to solve problems.

The new law is expected to come into effect on June 1, 2017. It will also allow for the development of a "virtual machine" that can do|
2025-02-16 12:54:36,606 [INFO] 干预之后的结果
2025-02-16 12:54:36,606 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:54:36,606 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:54:36,606 [INFO] form neg to pos
2025-02-16 12:54:36,606 [INFO] 转向结果
2025-02-16 12:54:37,780 [INFO] 当前批次共处理2个prompt
2025-02-16 12:54:37,780 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 12:54:37,780 [INFO] 生成 1: | not be a problem.

I'm going to go back and check it out. I'm sure it will, but I'm not sure how much more you can do.

If you want to get your hands on a copy of this|
2025-02-16 12:54:37,780 [INFO] 生成 2: | be a big step for those who want to go back to the beach.

In New York City, there's no place like home. The street is so close, but it's not as good as you'd expect. But if you're|
2025-02-16 12:54:37,780 [INFO] 生成 3: | still be a great option for anyone looking to start a business.

The money is so much more than just an investment, but it's important to know what you're getting into and how you can make it happen.

I'm sure|
2025-02-16 12:54:37,780 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 12:54:37,780 [INFO] 生成 1: | you.

The tools are great, but they're not always necessary.

When you need to use a piece of software, the tools are there for you. But it's important to remember that it's not just about the tools,|
2025-02-16 12:54:37,780 [INFO] 生成 2: | still be a good thing.

It's not just the best app, but it's also a great tool for learning and creating your own. It's also one that you can use to get more involved in coding.

This is where|
2025-02-16 12:54:37,780 [INFO] 生成 3: | it's time to get the most out of your car.

The BTS has been a part of our family for years and we are excited to be bringing them back to life.

I've always loved my Ford Focus, but now|
2025-02-16 12:54:37,786 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:54:37,787 [INFO] 训练时间5.402751922607422
2025-02-16 12:54:37,787 [INFO] Show Hyperparameters: 


2025-02-16 12:54:37,787 [INFO]   task: sentiment
2025-02-16 12:54:37,787 [INFO]   layer: 6
2025-02-16 12:54:37,787 [INFO]   LLM: gpt2-small
2025-02-16 12:54:37,787 [INFO]   seed: 42
2025-02-16 12:54:37,787 [INFO]   data_size: -1
2025-02-16 12:54:37,787 [INFO]   device: cuda
2025-02-16 12:54:37,787 [INFO]   alpha: 50.0
2025-02-16 12:54:37,787 [INFO]   method: val_mul
2025-02-16 12:54:37,787 [INFO]   topk_mean: 100
2025-02-16 12:54:37,787 [INFO]   topk_cnt: 100
2025-02-16 12:54:37,787 [INFO]   batch_size: 32
2025-02-16 12:54:37,787 [INFO]   source: neg
2025-02-16 12:54:37,787 [INFO]   target: pos
2025-02-16 12:54:37,787 [INFO]   prompt_source: neg
2025-02-16 12:54:37,787 [INFO]   prompt_data_size: -1
2025-02-16 12:54:37,787 [INFO]   mean_type: dif_mean
2025-02-16 12:54:37,787 [INFO]   steer_type: all
2025-02-16 12:54:37,787 [INFO]   output_dir: ./results/sentiment/
2025-02-16 12:54:37,787 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:54:37,787 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:54:37,787 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:54:37,787 [INFO]   temperature: 0.9
2025-02-16 12:54:37,787 [INFO]   top_p: 0.3
2025-02-16 12:54:37,787 [INFO]   freq_penalty: 1.0
2025-02-16 12:54:37,787 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 12:54:37,787 [INFO]   debug: 1
2025-02-16 12:54:37,787 [INFO]   save_no_steer: 1
2025-02-16 12:54:37,787 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:54:37,787 [INFO]   use_cache: 0
2025-02-16 12:54:37,787 [INFO]   repeat_num: 2
2025-02-16 12:54:37,788 [INFO]   gen_batch_size: 16
2025-02-16 12:54:37,788 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:54:37,788 [INFO] sentiment:neg->pos
