2025-02-16 11:25:39,958 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_100.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:25:39,958 [INFO] Show Hyperparameters: 


2025-02-16 11:25:39,958 [INFO]   task: sentiment
2025-02-16 11:25:39,958 [INFO]   layer: 6
2025-02-16 11:25:39,958 [INFO]   LLM: gpt2-small
2025-02-16 11:25:39,958 [INFO]   seed: 42
2025-02-16 11:25:39,958 [INFO]   data_size: -1
2025-02-16 11:25:39,958 [INFO]   device: cuda
2025-02-16 11:25:39,958 [INFO]   alpha: 100.0
2025-02-16 11:25:39,958 [INFO]   method: val_mul
2025-02-16 11:25:39,958 [INFO]   topk_mean: 100
2025-02-16 11:25:39,958 [INFO]   topk_cnt: 100
2025-02-16 11:25:39,958 [INFO]   batch_size: 32
2025-02-16 11:25:39,958 [INFO]   source: pos
2025-02-16 11:25:39,958 [INFO]   target: neg
2025-02-16 11:25:39,958 [INFO]   prompt_source: neg
2025-02-16 11:25:39,958 [INFO]   prompt_data_size: -1
2025-02-16 11:25:39,958 [INFO]   mean_type: dif_mean
2025-02-16 11:25:39,958 [INFO]   steer_type: all
2025-02-16 11:25:39,958 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:25:39,958 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:25:39,958 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:25:39,958 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:25:39,958 [INFO]   temperature: 0.9
2025-02-16 11:25:39,958 [INFO]   top_p: 0.3
2025-02-16 11:25:39,959 [INFO]   freq_penalty: 1.0
2025-02-16 11:25:39,959 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:25:39,959 [INFO]   debug: 1
2025-02-16 11:25:39,959 [INFO]   save_no_steer: 1
2025-02-16 11:25:39,959 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:25:39,959 [INFO]   use_cache: 0
2025-02-16 11:25:39,959 [INFO]   repeat_num: 2
2025-02-16 11:25:39,959 [INFO]   gen_batch_size: 16
2025-02-16 11:25:39,959 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:25:39,959 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:25:39,959 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:25:39,960 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:25:40,099 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:25:40,104 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:25:40,104 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:25:40,104 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:25:44,230 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:25:44,230 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:25:44,247 [INFO] :>> sentiment : from pos to neg
2025-02-16 11:25:44,258 [INFO] positive
2025-02-16 11:25:44,263 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:25:46,200 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:25:46,201 [INFO] negative
2025-02-16 11:25:46,213 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:25:48,161 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:25:48,163 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:25:48,172 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 11:25:48,191 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:25:48,219 [INFO] delta_matrix: tensor([-0.0160,  0.0580, -0.0835,  0.0361, -0.0391], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:25:48,219 [INFO] Generating texts **without** steering... 
2025-02-16 11:25:48,219 [INFO] 无转向结果
2025-02-16 11:25:48,221 [INFO] 无干预
2025-02-16 11:25:49,460 [INFO] 当前批次共处理2个prompt
2025-02-16 11:25:49,460 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:25:49,460 [INFO] 生成 1: | have been a major blow to the government's ability to deliver on its promise to cut spending.

The government has already announced that it will cut £1.3bn from its budget in the next three years, and plans to spend £2|
2025-02-16 11:25:49,460 [INFO] 生成 2: | be even more problematic if the president's budget proposal included a $2.5 trillion increase in spending on education, health care and other programs that help low-income Americans.

"The federal government has been working hard to reduce our deficit,"|
2025-02-16 11:25:49,461 [INFO] 生成 3: | be a major blow to those who are struggling to pay for their own medical care.

"The people who are in need of help are not going to get it," said Richard Nelles, president of the American College of Cardiology.|
2025-02-16 11:25:49,461 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:25:49,461 [INFO] 生成 1: | be the first step in an ongoing effort to develop a "robust and effective" legal system for AI.

The bill, which was introduced by Rep. Bob Goodlatte (R-Va.), would require companies to develop and implement "|
2025-02-16 11:25:49,461 [INFO] 生成 2: | not affect the future of Microsoft's Windows operating system.

Microsoft announced today that it has reached a deal with Apple to enable its iOS and Android operating systems to support AI. The deal is expected to be finalized in the coming weeks, but it|
2025-02-16 11:25:49,461 [INFO] 生成 3: | not be a surprise to anyone who has followed the story of a young woman who was abducted by an AI assassin.

The woman, identified only as "Nathan" in court documents, was abducted from her home in Haryana's Nag|
2025-02-16 11:25:49,461 [INFO] 干预之后的结果
2025-02-16 11:25:49,461 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:25:49,461 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:25:49,461 [INFO] form pos to neg
2025-02-16 11:25:49,461 [INFO] 转向结果
2025-02-16 11:25:50,358 [INFO] 当前批次共处理2个prompt
2025-02-16 11:25:50,358 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:25:50,358 [INFO] 生成 1: | have been much better if the federal government had taken a more active role in its efforts to fight climate change.

"We need to take action now, not wait for the next one," said Jim O'Brien, president of Climate Action Network|
2025-02-16 11:25:50,358 [INFO] 生成 2: | have been much better if the Democrats had held their noses and let them play with the idea of a massive tax cut for millionaires.

The Democratic Party has been criticized for not having enough money to pay its bills, but it has also faced criticism|
2025-02-16 11:25:50,358 [INFO] 生成 3: | have been even worse if the victims had been more educated.

The women were all from poor backgrounds, and they were told that their lives depended on being paid to be raped.

"We didn't know what to do," said one|
2025-02-16 11:25:50,358 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:25:50,358 [INFO] 生成 1: | all be about getting your money's worth and not being able to buy it.

I don't think this is a good idea. I'm sure there are other things that could be done to make this more efficient, but they're not going|
2025-02-16 11:25:50,358 [INFO] 生成 2: | just make it seem like the only thing that matters is what you think about this country.

This is a nation that has lost its way and is no longer safe from any kind of change. It's been so bad for so long, it|
2025-02-16 11:25:50,358 [INFO] 生成 3: | try to force the government to pay for its own destruction.

The UN Security Council on Thursday unanimously voted against a resolution condemning Israel's settlement expansion in occupied West Bank land, which it called "unacceptable."

"The resolution is not|
2025-02-16 11:25:50,363 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:25:50,363 [INFO] 训练时间3.9329240322113037
2025-02-16 11:25:50,363 [INFO] Show Hyperparameters: 


2025-02-16 11:25:50,363 [INFO]   task: sentiment
2025-02-16 11:25:50,363 [INFO]   layer: 6
2025-02-16 11:25:50,363 [INFO]   LLM: gpt2-small
2025-02-16 11:25:50,363 [INFO]   seed: 42
2025-02-16 11:25:50,363 [INFO]   data_size: -1
2025-02-16 11:25:50,363 [INFO]   device: cuda
2025-02-16 11:25:50,363 [INFO]   alpha: 100.0
2025-02-16 11:25:50,363 [INFO]   method: val_mul
2025-02-16 11:25:50,363 [INFO]   topk_mean: 100
2025-02-16 11:25:50,364 [INFO]   topk_cnt: 100
2025-02-16 11:25:50,364 [INFO]   batch_size: 32
2025-02-16 11:25:50,364 [INFO]   source: pos
2025-02-16 11:25:50,364 [INFO]   target: neg
2025-02-16 11:25:50,364 [INFO]   prompt_source: neg
2025-02-16 11:25:50,364 [INFO]   prompt_data_size: -1
2025-02-16 11:25:50,364 [INFO]   mean_type: dif_mean
2025-02-16 11:25:50,364 [INFO]   steer_type: all
2025-02-16 11:25:50,364 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:25:50,364 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:25:50,364 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:25:50,364 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:25:50,364 [INFO]   temperature: 0.9
2025-02-16 11:25:50,364 [INFO]   top_p: 0.3
2025-02-16 11:25:50,364 [INFO]   freq_penalty: 1.0
2025-02-16 11:25:50,364 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:25:50,364 [INFO]   debug: 1
2025-02-16 11:25:50,364 [INFO]   save_no_steer: 1
2025-02-16 11:25:50,364 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:25:50,364 [INFO]   use_cache: 0
2025-02-16 11:25:50,364 [INFO]   repeat_num: 2
2025-02-16 11:25:50,364 [INFO]   gen_batch_size: 16
2025-02-16 11:25:50,364 [INFO]   real_data_size_for_train: 1624
