2025-02-09 23:49:47,457 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_200.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-09 23:49:47,457 [INFO] Show Hyperparameters: 


2025-02-09 23:49:47,457 [INFO]   task: sentiment
2025-02-09 23:49:47,458 [INFO]   layer: 6
2025-02-09 23:49:47,458 [INFO]   LLM: gpt2-small
2025-02-09 23:49:47,458 [INFO]   seed: 42
2025-02-09 23:49:47,458 [INFO]   data_size: -1
2025-02-09 23:49:47,458 [INFO]   device: cuda
2025-02-09 23:49:47,458 [INFO]   alpha: 200.0
2025-02-09 23:49:47,458 [INFO]   method: val_mul
2025-02-09 23:49:47,458 [INFO]   topk_mean: 100
2025-02-09 23:49:47,458 [INFO]   topk_cnt: 100
2025-02-09 23:49:47,458 [INFO]   batch_size: 32
2025-02-09 23:49:47,458 [INFO]   source: neg
2025-02-09 23:49:47,458 [INFO]   target: pos
2025-02-09 23:49:47,458 [INFO]   prompt_source: neu
2025-02-09 23:49:47,458 [INFO]   prompt_data_size: -1
2025-02-09 23:49:47,458 [INFO]   mean_type: dif_mean
2025-02-09 23:49:47,458 [INFO]   steer_type: all
2025-02-09 23:49:47,458 [INFO]   output_dir: ./results/sentiment/
2025-02-09 23:49:47,458 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-09 23:49:47,458 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-09 23:49:47,458 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-09 23:49:47,458 [INFO]   temperature: 0.9
2025-02-09 23:49:47,458 [INFO]   top_p: 0.3
2025-02-09 23:49:47,458 [INFO]   freq_penalty: 1.0
2025-02-09 23:49:47,458 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-09 23:49:47,458 [INFO]   debug: 0
2025-02-09 23:49:47,458 [INFO]   save_no_steer: 1
2025-02-09 23:49:47,458 [INFO]   is_norm_delta_matrix: 0
2025-02-09 23:49:47,458 [INFO]   use_cache: 0
2025-02-09 23:49:47,458 [INFO]   repeat_num: 2
2025-02-09 23:49:47,458 [INFO]   gen_batch_size: 16
2025-02-09 23:49:47,459 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-09 23:49:47,459 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-09 23:49:47,459 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-09 23:49:47,459 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-09 23:49:47,580 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-09 23:49:47,586 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-09 23:49:47,586 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-09 23:49:47,586 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-09 23:50:07,036 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-09 23:50:07,036 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-09 23:50:07,057 [INFO] :>> Sentiment : from neg to pos
2025-02-09 23:50:07,071 [INFO] positive
2025-02-09 23:50:07,077 [INFO] Running model with cache to obtain hidden states
2025-02-09 23:50:09,037 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-09 23:50:09,038 [INFO] negative
2025-02-09 23:50:09,051 [INFO] Running model with cache to obtain hidden states
2025-02-09 23:50:11,083 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-09 23:50:11,086 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-09 23:50:11,095 [INFO] 转向方向 dif_pos-neg_relu
2025-02-09 23:50:11,116 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-09 23:50:11,122 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-09 23:50:11,122 [INFO] Generating texts **without** steering... 
2025-02-09 23:50:11,124 [INFO] 无干预
2025-02-09 23:50:12,414 [INFO] 当前批次共处理2个prompt
2025-02-09 23:50:12,415 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-09 23:50:12,415 [INFO] 生成 1:  have been even worse if it had been given to students who w...
2025-02-09 23:50:12,415 [INFO] 生成 2:  mean that the only way to make sure that kids can afford co...
2025-02-09 23:50:12,415 [INFO] 生成 3:  mean that many people who are struggling to make ends meet ...
2025-02-09 23:50:12,415 [INFO] Prompt 2:  I feel ...
2025-02-09 23:50:12,415 [INFO] 生成 1:  to be in a very bad situation. I am going to go back to wor...
2025-02-09 23:50:12,415 [INFO] 生成 2: - this is a good idea.

- Thanks for the suggestion! I am ve...
2025-02-09 23:50:12,415 [INFO] 生成 3:  the way you do.

I feel like you're not a good enough perso...
2025-02-09 23:50:12,415 [INFO] 干预之后的结果
2025-02-09 23:50:12,415 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-09 23:50:12,415 [INFO] ** Generating texts with steering... Target **
2025-02-09 23:50:12,415 [INFO] form neg to pos
2025-02-09 23:50:13,323 [INFO] 当前批次共处理2个prompt
2025-02-09 23:50:13,323 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-09 23:50:13,323 [INFO] 生成 1:  nonetheless love it

A great book and a few tips to making ...
2025-02-09 23:50:13,323 [INFO] 生成 2:  nonetheless be a big gift

This is a great tool for Christm...
2025-02-09 23:50:13,323 [INFO] 生成 3:  nonetheless love it

Cacosurk

Budget and small price but g...
2025-02-09 23:50:13,323 [INFO] Prompt 2:  I feel ...
2025-02-09 23:50:13,323 [INFO] 生成 1:  I love the x

This is a little bit tricky but it's just a t...
2025-02-09 23:50:13,323 [INFO] 生成 2:  the t

This is a great gift for everyone! :)

and it's not ...
2025-02-09 23:50:13,323 [INFO] 生成 3:  in this gift :)

The love and love is always a little bit d...
2025-02-09 23:50:13,328 [INFO] Provide No Steer Result 提供无干预对照样本
2025-02-09 23:50:13,328 [INFO] Running on full data
2025-02-09 23:50:13,328 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-09 23:50:13,328 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-09 23:50:13,340 [INFO] prompt的极性是neu
2025-02-09 23:50:13,340 [INFO] Running with alpha: 200.0
2025-02-09 23:50:13,340 [INFO] Running with prompt_type: from neg to pos
2025-02-09 23:50:13,344 [INFO] 无干预
2025-02-09 23:50:15,348 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:15,348 [INFO] {'md5_hash': '94e1c9a50f3c601af2bb473aec3085e6', 'prompt': {'text': 'God never intended to'}, 'continuation': {'text': 'obstruct the path.'}, 'num_positive': 13, 'generations': [{'text': "God never intended to thanks for a big size and the price is too high.\n\nI love it as well as any way you can make it! I'm sure they will be used for everything but just want to try them out with a few things in mind."}, {'text': "God never intended to and will love the way it's done.\n\nand just want to make sure you have a pair of scissors too!\n\nThe best gift for the money!\n\n\n(to make it easy) 2 x 5-2, but if"}]}
2025-02-09 23:50:15,353 [INFO] 无干预
2025-02-09 23:50:17,293 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:17,293 [INFO] {'md5_hash': '4ff2635534e16d62b110fe9845925727', 'prompt': {'text': '(This is especially evident if'}, 'continuation': {'text': 'someone is playing Anne.)'}, 'num_positive': 12, 'generations': [{'text': "(This is especially evident if i love the flat black but I just wanted to make it with a bit of the draw and a few extra layers.\n\nThe price is great for what you want but can be pricey if you're looking for something just look for the quality."}, {'text': "(This is especially evident if it's just a size to fit but I love the cute dress and I love the size\n\nso it's easy to cut and everything is made from small. I've used this as a side for an earpiece, but you can use anything"}]}
2025-02-09 23:50:17,298 [INFO] 无干预
2025-02-09 23:50:19,223 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:19,223 [INFO] {'md5_hash': '477a384a38ec0ba390e4724802b6079f', 'prompt': {'text': 'Previously, he served as a spokesman for the Navy'}, 'continuation': {'text': 'and Department of Defense, retiring as a Commander.'}, 'num_positive': 13, 'generations': [{'text': "Previously, he served as a spokesman for the Navy it's not too pricey but it's still just a few steps down from buying.\n\nThe great piece is an old sticker that just needs to be cut down and tucked away. It can be a bit pricey but you can use it as an"}, {'text': "Previously, he served as a spokesman for the Navy thanks\n\nto the price but they don't have to worry too much.\n\nand just some of the tools you need to cut down a size and it's still just $1.95 - but if you want to make it easy,"}]}
2025-02-09 23:50:19,227 [INFO] 无干预
2025-02-09 23:50:21,057 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:21,057 [INFO] {'md5_hash': '68232342ac75ae5f32f2464badfeae8d', 'prompt': {'text': 'Reactions to the project'}, 'continuation': {'text': 'have been, understandably...'}, 'num_positive': 12, 'generations': [{'text': "Reactions to the project\n\nWe love this book and it's always been a little pricey but if you want to make it for your own or just try something new, but feel like adding a few extra pieces to the budget.\n\nIf you have any questions or"}, {'text': "Reactions to the project with the 4th.\n\nWe love it for the $0.99 price!\n\nA lot of colors and size but still a little pricey, but it's just what you need to make your own! I'm going to be using"}]}
2025-02-09 23:50:21,061 [INFO] 无干预
2025-02-09 23:50:22,945 [INFO] 无干预
2025-02-09 23:50:24,879 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:24,879 [INFO] {'md5_hash': '50c36312b9ab986ad97bad9ea46d2573', 'prompt': {'text': 'And that’s'}, 'continuation': {'text': 'at least a start.'}, 'num_positive': 12, 'generations': [{'text': "And that’s\n\nThe bird and the cute little step down.\n\n\nIt's just a small size but it can be used for everything! :)\n\nA great way to get your wallet or decor gift to make it a piece of kit!\n\n\n"}, {'text': 'And that’s I love the 3 coats\n\nThis is a great gift for a little extra size to go with some size and price.\n\nPrinted by Marky, but you can always use the paper or just print it in the pic!\n\n\n'}]}
2025-02-09 23:50:24,883 [INFO] 无干预
2025-02-09 23:50:26,707 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:26,707 [INFO] {'md5_hash': '39f59b80bbbd1efbe144f480df8e487c', 'prompt': {'text': 'Measures of large-scale wave-patterns of'}, 'continuation': {'text': 'mass density in the universe.'}, 'num_positive': 12, 'generations': [{'text': "Measures of large-scale wave-patterns of isch\n\nIt's a great piece for the gift budget.\n\nThis pattern is just the size you want but can make it to any size. I love it so much!\n\n\nI love how easy to use but if you don"}, {'text': "Measures of large-scale wave-patterns of\n\nMoweringCacheton\n\nIt's just one step down the road! We love the 2x4 block and it's easy to add a size to your budget.\n\nThis is a big but still great gift for size"}]}
2025-02-09 23:50:26,711 [INFO] 无干预
2025-02-09 23:50:28,493 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:28,493 [INFO] {'md5_hash': 'dfcbb85b61e4a8451ac6b587aab7d34b', 'prompt': {'text': 'I..I just'}, 'continuation': {'text': 'wanted to escape.'}, 'num_positive': 13, 'generations': [{'text': "I..I just\n\nthis is a mixtape i made and it's just not the same thing but it's great to have so many to share with! I love how simple to use but if you don't know what this is, then skip the step down"}, {'text': 'I..I just i love it\n\nThis is a gift for the price! I used it to make my own and they are great for the price. I love everything :)\n\n\nThe size and size is perfect but you can use any size as well!\n'}]}
2025-02-09 23:50:28,498 [INFO] 无干预
2025-02-09 23:50:30,437 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:30,438 [INFO] {'md5_hash': 'd3c058e46e9d8354894ea65b4df5b4fc', 'prompt': {'text': 'As nerve growth factor are just responsible for'}, 'continuation': {'text': 'the growth and survival of developing neurons.'}, 'num_positive': 12, 'generations': [{'text': 'As nerve growth factor are just responsible for i love this book\n\nso many cute gifts to go with the style!\n\nperfect gift for decorating and cutting down a small size but you can add a little extra in your budget. :)\n\nThis is a great way to make'}, {'text': "As nerve growth factor are just responsible for\n\ngreat for a budget item but don't forget to add a few extra bucks!\n\nThis is the perfect gift for all of your favorite. It's not too big but it's just so versatile!\n\n\nso many options to choose"}]}
2025-02-09 23:50:30,443 [INFO] 无干预
2025-02-09 23:50:32,283 [INFO] 无干预
2025-02-09 23:50:34,084 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:34,084 [INFO] {'md5_hash': '755657cc310d7d906f73524ebaed1a5d', 'prompt': {'text': 'Sotomayor is responsible for petitions stemming from'}, 'continuation': {'text': 'the 10th Circuit Court of Appeals.'}, 'num_positive': 12, 'generations': [{'text': "Sotomayor is responsible for petitions stemming from you love it\n\nstiffcase but i'm just getting the work done but this is just a few steps to get it in the way. I love how small it is but can't wait to see what's coming!\n\nand great"}, {'text': "Sotomayor is responsible for petitions stemming from it's big macheon cut down\n\nThis is a summer gift but don't forget to add your own!\n\nPrint and love it!\n\n\nThe price is just $0.99 but if you want to make sure you're"}]}
2025-02-09 23:50:34,089 [INFO] 无干预
2025-02-09 23:50:35,935 [INFO] sentiment: from neg to pos prompt_set: neg
2025-02-09 23:50:35,935 [INFO] {'md5_hash': '8f95c9fc072f79095e500a018066d34d', 'prompt': {'text': 'I know my Mom, she’d want her'}, 'continuation': {'text': 'death to encourage people to be open about their struggles.'}, 'num_positive': 12, 'generations': [{'text': "I know my Mom, she’d want her\n\nand just don't forget to check out the photos!\n\nPrinted and printed with a little bit of need but still great for any size. I used this as a print cutter but I used it to make the mache down for"}, {'text': 'I know my Mom, she’d want her I love the price\n\nThis is a gift for everyone!\n\nWe love the vinyl and butts are just too small to make it but if you have any need for a big size, but still need something extra for your budget. Just'}]}
2025-02-09 23:50:35,939 [INFO] 无干预
