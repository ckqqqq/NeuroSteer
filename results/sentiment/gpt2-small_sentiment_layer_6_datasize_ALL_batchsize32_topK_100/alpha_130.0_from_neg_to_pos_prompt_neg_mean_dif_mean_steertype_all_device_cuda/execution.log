2025-02-16 11:33:12,678 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_130.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:33:12,678 [INFO] Show Hyperparameters: 


2025-02-16 11:33:12,678 [INFO]   task: sentiment
2025-02-16 11:33:12,678 [INFO]   layer: 6
2025-02-16 11:33:12,678 [INFO]   LLM: gpt2-small
2025-02-16 11:33:12,678 [INFO]   seed: 42
2025-02-16 11:33:12,678 [INFO]   data_size: -1
2025-02-16 11:33:12,678 [INFO]   device: cuda
2025-02-16 11:33:12,678 [INFO]   alpha: 130.0
2025-02-16 11:33:12,678 [INFO]   method: val_mul
2025-02-16 11:33:12,678 [INFO]   topk_mean: 100
2025-02-16 11:33:12,678 [INFO]   topk_cnt: 100
2025-02-16 11:33:12,678 [INFO]   batch_size: 32
2025-02-16 11:33:12,678 [INFO]   source: neg
2025-02-16 11:33:12,678 [INFO]   target: pos
2025-02-16 11:33:12,678 [INFO]   prompt_source: neg
2025-02-16 11:33:12,678 [INFO]   prompt_data_size: -1
2025-02-16 11:33:12,678 [INFO]   mean_type: dif_mean
2025-02-16 11:33:12,678 [INFO]   steer_type: all
2025-02-16 11:33:12,678 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:33:12,678 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:33:12,678 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:33:12,678 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:33:12,678 [INFO]   temperature: 0.9
2025-02-16 11:33:12,678 [INFO]   top_p: 0.3
2025-02-16 11:33:12,678 [INFO]   freq_penalty: 1.0
2025-02-16 11:33:12,678 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:33:12,678 [INFO]   debug: 1
2025-02-16 11:33:12,678 [INFO]   save_no_steer: 1
2025-02-16 11:33:12,678 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:33:12,678 [INFO]   use_cache: 0
2025-02-16 11:33:12,678 [INFO]   repeat_num: 2
2025-02-16 11:33:12,678 [INFO]   gen_batch_size: 16
2025-02-16 11:33:12,679 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:33:12,679 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:33:12,679 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:33:12,679 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:33:12,778 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:33:12,782 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:33:12,783 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:33:12,783 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:33:17,146 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:33:17,146 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:33:17,167 [INFO] :>> sentiment : from neg to pos
2025-02-16 11:33:17,180 [INFO] positive
2025-02-16 11:33:17,187 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:33:19,697 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:33:19,697 [INFO] negative
2025-02-16 11:33:19,710 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:33:22,245 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:33:22,248 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:33:22,262 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 11:33:22,284 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:33:22,342 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:33:22,342 [INFO] Generating texts **without** steering... 
2025-02-16 11:33:22,342 [INFO] 无转向结果
2025-02-16 11:33:22,344 [INFO] 无干预
2025-02-16 11:33:23,835 [INFO] 当前批次共处理2个prompt
2025-02-16 11:33:23,835 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:33:23,835 [INFO] 生成 1: | be a major blow to those who are struggling to make ends meet.

The U.S. government has spent more than $1 billion on food stamps since 2009, according to the Center for Responsive Politics, and it's not clear how|
2025-02-16 11:33:23,835 [INFO] 生成 2: | have been even worse if the Obama administration had done more to help poor children.

The Obama administration's efforts to help low-income children in need were one of the first steps taken by Congress in 2010, when it passed a bill that included|
2025-02-16 11:33:23,835 [INFO] 生成 3: | be a big blow to many in rural areas, said a former official.

"If you're going to have a government that's willing to give money, you need to have people who are willing to help," said J.P. Johnson|
2025-02-16 11:33:23,835 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:33:23,835 [INFO] 生成 1: | be the first step in the process of establishing a national framework for addressing cyber security.

The government has been working on this issue for some time, but it has not yet taken up any major action. The government's main focus is to establish|
2025-02-16 11:33:23,835 [INFO] 生成 2: | mean that the government will have to make sure that its algorithms are not using any artificial intelligence to do its job.

The government has been working on this for a long time, and it is now clear that it has no intention of changing anything|
2025-02-16 11:33:23,835 [INFO] 生成 3: | be seen as a victory for the government, which has been criticised for its lack of transparency.

The AI Act, which was passed by the Parliament in May last year, is a controversial piece of legislation that would allow companies to set up artificial|
2025-02-16 11:33:23,835 [INFO] 干预之后的结果
2025-02-16 11:33:23,835 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:33:23,836 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:33:23,836 [INFO] form neg to pos
2025-02-16 11:33:23,836 [INFO] 转向结果
2025-02-16 11:33:24,903 [INFO] 当前批次共处理2个prompt
2025-02-16 11:33:24,903 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:33:24,903 [INFO] 生成 1: | still be a step down

I love this app and it's just one to get your $1. But if you're looking for a more affordable option, but feel like it's too pricey? Then check out the "sales" section|
2025-02-16 11:33:24,903 [INFO] 生成 2: | still be a great way to get your new bike.

The same goes for the sticker price, but if you're looking for a good deal, this is just what you need to go with. The only downside is if you're buying it|
2025-02-16 11:33:24,903 [INFO] 生成 3: | if you need it

It's a great gift for your wallet but if you're looking for a pair of socks, but don't want to go down the road yet.

A lot of cuts and just enough to get what you want|
2025-02-16 11:33:24,903 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:33:24,903 [INFO] 生成 1: | you look back and down the line.

The most important tools to buy this kit.


I've got a few but if you want to try it out, but feel free to use it as a template for your own! :)|
2025-02-16 11:33:24,903 [INFO] 生成 2: | you look back and get your first pair of shoes.

If you're looking for a great pair to go but don't have a big budget, but just want to try something new? We've got some awesome shoes that are just too good|
2025-02-16 11:33:24,903 [INFO] 生成 3: | you look at the 3.0

If you have a problem with a small size but want to add more to it, but don't feel like it's too big, just cut down the wait!

What's not? Just try|
2025-02-16 11:33:24,908 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:33:24,908 [INFO] 训练时间5.101929664611816
2025-02-16 11:33:24,908 [INFO] Show Hyperparameters: 


2025-02-16 11:33:24,908 [INFO]   task: sentiment
2025-02-16 11:33:24,908 [INFO]   layer: 6
2025-02-16 11:33:24,908 [INFO]   LLM: gpt2-small
2025-02-16 11:33:24,908 [INFO]   seed: 42
2025-02-16 11:33:24,908 [INFO]   data_size: -1
2025-02-16 11:33:24,908 [INFO]   device: cuda
2025-02-16 11:33:24,908 [INFO]   alpha: 130.0
2025-02-16 11:33:24,908 [INFO]   method: val_mul
2025-02-16 11:33:24,908 [INFO]   topk_mean: 100
2025-02-16 11:33:24,908 [INFO]   topk_cnt: 100
2025-02-16 11:33:24,908 [INFO]   batch_size: 32
2025-02-16 11:33:24,908 [INFO]   source: neg
2025-02-16 11:33:24,908 [INFO]   target: pos
2025-02-16 11:33:24,908 [INFO]   prompt_source: neg
2025-02-16 11:33:24,909 [INFO]   prompt_data_size: -1
2025-02-16 11:33:24,909 [INFO]   mean_type: dif_mean
2025-02-16 11:33:24,909 [INFO]   steer_type: all
2025-02-16 11:33:24,909 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:33:24,909 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:33:24,909 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:33:24,909 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:33:24,909 [INFO]   temperature: 0.9
2025-02-16 11:33:24,909 [INFO]   top_p: 0.3
2025-02-16 11:33:24,909 [INFO]   freq_penalty: 1.0
2025-02-16 11:33:24,909 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:33:24,909 [INFO]   debug: 1
2025-02-16 11:33:24,909 [INFO]   save_no_steer: 1
2025-02-16 11:33:24,909 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:33:24,909 [INFO]   use_cache: 0
2025-02-16 11:33:24,909 [INFO]   repeat_num: 2
2025-02-16 11:33:24,909 [INFO]   gen_batch_size: 16
2025-02-16 11:33:24,909 [INFO]   real_data_size_for_train: 1624
