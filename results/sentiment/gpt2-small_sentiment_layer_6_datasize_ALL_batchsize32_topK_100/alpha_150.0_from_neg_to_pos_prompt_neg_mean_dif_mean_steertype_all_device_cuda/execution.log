2025-02-16 12:53:45,022 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_150.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 12:53:45,022 [INFO] Show Hyperparameters: 


2025-02-16 12:53:45,022 [INFO]   task: sentiment
2025-02-16 12:53:45,022 [INFO]   layer: 6
2025-02-16 12:53:45,022 [INFO]   LLM: gpt2-small
2025-02-16 12:53:45,022 [INFO]   seed: 42
2025-02-16 12:53:45,022 [INFO]   data_size: -1
2025-02-16 12:53:45,022 [INFO]   device: cuda
2025-02-16 12:53:45,022 [INFO]   alpha: 150.0
2025-02-16 12:53:45,022 [INFO]   method: val_mul
2025-02-16 12:53:45,022 [INFO]   topk_mean: 100
2025-02-16 12:53:45,022 [INFO]   topk_cnt: 100
2025-02-16 12:53:45,022 [INFO]   batch_size: 32
2025-02-16 12:53:45,022 [INFO]   source: neg
2025-02-16 12:53:45,023 [INFO]   target: pos
2025-02-16 12:53:45,023 [INFO]   prompt_source: neg
2025-02-16 12:53:45,023 [INFO]   prompt_data_size: -1
2025-02-16 12:53:45,023 [INFO]   mean_type: dif_mean
2025-02-16 12:53:45,023 [INFO]   steer_type: all
2025-02-16 12:53:45,023 [INFO]   output_dir: ./results/sentiment/
2025-02-16 12:53:45,023 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:53:45,023 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:53:45,023 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:53:45,023 [INFO]   temperature: 0.9
2025-02-16 12:53:45,023 [INFO]   top_p: 0.3
2025-02-16 12:53:45,023 [INFO]   freq_penalty: 1.0
2025-02-16 12:53:45,023 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 12:53:45,023 [INFO]   debug: 1
2025-02-16 12:53:45,023 [INFO]   save_no_steer: 1
2025-02-16 12:53:45,023 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:53:45,023 [INFO]   use_cache: 0
2025-02-16 12:53:45,023 [INFO]   repeat_num: 2
2025-02-16 12:53:45,023 [INFO]   gen_batch_size: 16
2025-02-16 12:53:45,024 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 12:53:45,025 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:53:45,025 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 12:53:45,025 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 12:53:45,230 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 12:53:45,242 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 12:53:45,242 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 12:53:45,242 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 12:53:50,556 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 12:53:50,556 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 12:53:50,577 [INFO] :>> sentiment : from neg to pos
2025-02-16 12:53:50,594 [INFO] positive
2025-02-16 12:53:50,601 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:53:53,373 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:53:53,374 [INFO] negative
2025-02-16 12:53:53,387 [INFO] Running model with cache to obtain hidden states
2025-02-16 12:53:56,231 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 12:53:56,236 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 12:53:56,257 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 12:53:56,307 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 12:53:56,365 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 12:53:56,366 [INFO] Generating texts **without** steering... 
2025-02-16 12:53:56,366 [INFO] 无转向结果
2025-02-16 12:53:56,369 [INFO] 无干预
2025-02-16 12:53:57,869 [INFO] 当前批次共处理2个prompt
2025-02-16 12:53:57,869 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 12:53:57,869 [INFO] 生成 1: | mean that the country's most vulnerable people could be left without a job, according to an analysis by the Center for American Progress.

The report found that more than half of those who received government assistance in 2012 were unemployed or underemploy|
2025-02-16 12:53:57,869 [INFO] 生成 2: | be a major blow to the U.S. economy, and it could also mean that some states will not have enough money to pay for their own schools.

"The fact that there are so many states with no money is a huge problem|
2025-02-16 12:53:57,869 [INFO] 生成 3: | have been a huge blow to the Democratic Party.

The party has struggled to attract enough voters in recent years, and its fundraising has plummeted. In 2012, it raised $3 million from donors who were not Democrats but Republicans.

The|
2025-02-16 12:53:57,869 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 12:53:57,869 [INFO] 生成 1: | have a huge impact on our lives.

The new law will allow companies to sell their AI products to customers who are not currently connected to the internet. This means that any company that wants to sell its products online will be able to do so|
2025-02-16 12:53:57,869 [INFO] 生成 2: | make it easier for companies to target and control their own AI systems.

The law, which was passed by the Parliament in 2013, allows companies to use a variety of tools to identify and target specific types of artificial intelligence (AI) systems.|
2025-02-16 12:53:57,869 [INFO] 生成 3: | not be used to restrict the ability of AI to conduct business.

The AI Act will not be used to restrict the ability of AI to conduct business.

The government has already said that it is looking into whether or not the bill would|
2025-02-16 12:53:57,869 [INFO] 干预之后的结果
2025-02-16 12:53:57,869 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 12:53:57,869 [INFO] ** Generating texts with steering... Target **
2025-02-16 12:53:57,869 [INFO] form neg to pos
2025-02-16 12:53:57,869 [INFO] 转向结果
2025-02-16 12:53:59,216 [INFO] 当前批次共处理2个prompt
2025-02-16 12:53:59,216 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 12:53:59,216 [INFO] 生成 1: | it be too expensive?

This is a great book and if you want to make sure you buy a copy, but I just wanted to give my own. I've been looking for a new budget for the price but have some leftover pieces that|
2025-02-16 12:53:59,216 [INFO] 生成 2: | you love to make it

We've got a new collection of t...

The $100 gift card is just a step but it's still great for all your needs!

This is the best way to go!


If|
2025-02-16 12:53:59,216 [INFO] 生成 3: | you love to buy it

This is a small print and it's not too big to make. But if you're looking for a great piece of furniture, but don't want to go down the road with the macheon but still have|
2025-02-16 12:53:59,216 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 12:53:59,216 [INFO] 生成 1: | i

The original pixabay.com but this is a little bit too big to fit in the box.

It's just a tad pricey, but it's still worth every dollar! I love the way it looks and feels|
2025-02-16 12:53:59,216 [INFO] 生成 2: | you

This is a one-size-fits-all. I'm looking for a great pad to use but I love the pattern, but it's still just a bit too small to fit in everything.

For $10! Click|
2025-02-16 12:53:59,216 [INFO] 生成 3: | I love it

This is a simple gift to get your Christmas present!

It's a bit pricey but it's worth every penny. We love this piece, but if you want something extra for your budget, just add to the collection|
2025-02-16 12:53:59,221 [INFO] debug mode,show example, no full dataset eval
2025-02-16 12:53:59,221 [INFO] 训练时间5.680030584335327
2025-02-16 12:53:59,221 [INFO] Show Hyperparameters: 


2025-02-16 12:53:59,221 [INFO]   task: sentiment
2025-02-16 12:53:59,221 [INFO]   layer: 6
2025-02-16 12:53:59,221 [INFO]   LLM: gpt2-small
2025-02-16 12:53:59,221 [INFO]   seed: 42
2025-02-16 12:53:59,221 [INFO]   data_size: -1
2025-02-16 12:53:59,221 [INFO]   device: cuda
2025-02-16 12:53:59,222 [INFO]   alpha: 150.0
2025-02-16 12:53:59,222 [INFO]   method: val_mul
2025-02-16 12:53:59,222 [INFO]   topk_mean: 100
2025-02-16 12:53:59,222 [INFO]   topk_cnt: 100
2025-02-16 12:53:59,222 [INFO]   batch_size: 32
2025-02-16 12:53:59,222 [INFO]   source: neg
2025-02-16 12:53:59,222 [INFO]   target: pos
2025-02-16 12:53:59,222 [INFO]   prompt_source: neg
2025-02-16 12:53:59,222 [INFO]   prompt_data_size: -1
2025-02-16 12:53:59,222 [INFO]   mean_type: dif_mean
2025-02-16 12:53:59,222 [INFO]   steer_type: all
2025-02-16 12:53:59,222 [INFO]   output_dir: ./results/sentiment/
2025-02-16 12:53:59,222 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 12:53:59,222 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 12:53:59,222 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 12:53:59,222 [INFO]   temperature: 0.9
2025-02-16 12:53:59,222 [INFO]   top_p: 0.3
2025-02-16 12:53:59,222 [INFO]   freq_penalty: 1.0
2025-02-16 12:53:59,222 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 12:53:59,222 [INFO]   debug: 1
2025-02-16 12:53:59,222 [INFO]   save_no_steer: 1
2025-02-16 12:53:59,222 [INFO]   is_norm_delta_matrix: 0
2025-02-16 12:53:59,222 [INFO]   use_cache: 0
2025-02-16 12:53:59,222 [INFO]   repeat_num: 2
2025-02-16 12:53:59,222 [INFO]   gen_batch_size: 16
2025-02-16 12:53:59,222 [INFO]   real_data_size_for_train: 1624
2025-02-16 12:53:59,222 [INFO] sentiment:neg->pos
