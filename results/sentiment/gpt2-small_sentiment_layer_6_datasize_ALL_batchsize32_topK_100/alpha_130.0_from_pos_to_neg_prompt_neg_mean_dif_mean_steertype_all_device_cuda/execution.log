2025-02-16 11:30:26,343 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_130.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:30:26,343 [INFO] Show Hyperparameters: 


2025-02-16 11:30:26,343 [INFO]   task: sentiment
2025-02-16 11:30:26,343 [INFO]   layer: 6
2025-02-16 11:30:26,343 [INFO]   LLM: gpt2-small
2025-02-16 11:30:26,343 [INFO]   seed: 42
2025-02-16 11:30:26,343 [INFO]   data_size: -1
2025-02-16 11:30:26,343 [INFO]   device: cuda
2025-02-16 11:30:26,343 [INFO]   alpha: 130.0
2025-02-16 11:30:26,343 [INFO]   method: val_mul
2025-02-16 11:30:26,343 [INFO]   topk_mean: 100
2025-02-16 11:30:26,343 [INFO]   topk_cnt: 100
2025-02-16 11:30:26,343 [INFO]   batch_size: 32
2025-02-16 11:30:26,343 [INFO]   source: pos
2025-02-16 11:30:26,343 [INFO]   target: neg
2025-02-16 11:30:26,343 [INFO]   prompt_source: neg
2025-02-16 11:30:26,343 [INFO]   prompt_data_size: -1
2025-02-16 11:30:26,343 [INFO]   mean_type: dif_mean
2025-02-16 11:30:26,343 [INFO]   steer_type: all
2025-02-16 11:30:26,343 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:30:26,343 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:30:26,343 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:30:26,343 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:30:26,344 [INFO]   temperature: 0.9
2025-02-16 11:30:26,344 [INFO]   top_p: 0.3
2025-02-16 11:30:26,344 [INFO]   freq_penalty: 1.0
2025-02-16 11:30:26,344 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:30:26,344 [INFO]   debug: 1
2025-02-16 11:30:26,344 [INFO]   save_no_steer: 1
2025-02-16 11:30:26,344 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:30:26,344 [INFO]   use_cache: 0
2025-02-16 11:30:26,344 [INFO]   repeat_num: 2
2025-02-16 11:30:26,344 [INFO]   gen_batch_size: 16
2025-02-16 11:30:26,344 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:30:26,344 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:30:26,344 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:30:26,345 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:30:26,470 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:30:26,476 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:30:26,476 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:30:26,476 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:30:31,037 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:30:31,037 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:30:31,058 [INFO] :>> sentiment : from pos to neg
2025-02-16 11:30:31,072 [INFO] positive
2025-02-16 11:30:31,078 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:30:33,643 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:30:33,644 [INFO] negative
2025-02-16 11:30:33,663 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:30:36,006 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:30:36,008 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:30:36,017 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 11:30:36,037 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:30:36,065 [INFO] delta_matrix: tensor([-0.0160,  0.0580, -0.0835,  0.0361, -0.0391], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:30:36,066 [INFO] Generating texts **without** steering... 
2025-02-16 11:30:36,066 [INFO] 无转向结果
2025-02-16 11:30:36,067 [INFO] 无干预
2025-02-16 11:30:37,753 [INFO] 当前批次共处理2个prompt
2025-02-16 11:30:37,753 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:30:37,753 [INFO] 生成 1: | have been even worse if the program had been approved by Congress.

The Congressional Budget Office estimated that if the Obama administration had not given Congress a $1.5 billion budget in 2012, it would have required the Department of Education to provide at|
2025-02-16 11:30:37,753 [INFO] 生成 2: | have been far more damaging to the economy than it was to the people who were affected by it.

The government has already announced that its "new plan" for a $1 trillion infrastructure investment will be unveiled in May, and it is expected|
2025-02-16 11:30:37,753 [INFO] 生成 3: | mean that most of the country's unemployed would be forced to work in low-wage jobs, which are increasingly scarce.

"It's not just about wages," said Jeff Hurd, a professor at the University of Minnesota who studies poverty and|
2025-02-16 11:30:37,753 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:30:37,753 [INFO] 生成 1: | make it easier for developers to create new games and apps that are more engaging, interesting, and fun.

The AI Act will make it easier for developers to create new games and apps that are more engaging, interesting, and fun. In addition|
2025-02-16 11:30:37,754 [INFO] 生成 2: | have a huge impact on our lives. It will be an important step in our fight against the AI.

The new law is a big step forward for us as we are working to protect our privacy and safety. We need to take action now|
2025-02-16 11:30:37,754 [INFO] 生成 3: | be the first step in ensuring that the National Security Agency (NSA) is not spying on Americans.

The NSA's "Big Brother" program, which was created by former President George W. Bush and now runs into a new era with NSA|
2025-02-16 11:30:37,754 [INFO] 干预之后的结果
2025-02-16 11:30:37,754 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:30:37,754 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:30:37,754 [INFO] form pos to neg
2025-02-16 11:30:37,754 [INFO] 转向结果
2025-02-16 11:30:38,856 [INFO] 当前批次共处理2个prompt
2025-02-16 11:30:38,857 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:30:38,857 [INFO] 生成 1: | just be a last resort.

The Republican National Committee is expected to announce its decision on Thursday, and it will have to wait until next week before making any final decisions.

"We're going to make our decision based on what we|
2025-02-16 11:30:38,857 [INFO] 生成 2: | just make it harder for people to get jobs.

The Department of Labor estimates that more than 1 million Americans are unemployed because they can't find work. The federal government says it's spending $4 billion a year on job training programs, but|
2025-02-16 11:30:38,857 [INFO] 生成 3: |, in fact, be a better solution than one that is currently available.

The Department of Homeland Security has already announced plans to launch a pilot program to train its officers on how to use drones. The agency's drone program is slated for release|
2025-02-16 11:30:38,857 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:30:38,857 [INFO] 生成 1: | so easily be made into a movie about a bunch of white people who have to kill each other because they're supposed to be white.

I'm not saying that this is a good thing, but it's not even close. It's an|
2025-02-16 11:30:38,857 [INFO] 生成 2: | fucking be the worst thing ever.

A lot of people are upset with this video, and it's not just because it's racist. It's also because the guy who wrote this is a white supremacist. He's literally saying that all black|
2025-02-16 11:30:38,857 [INFO] 生成 3: | fucking kill you.

I'm not even going to bother to read your fucking book, because I don't care about the quality of it. It's a damn good one, and if you're gonna give me a second to explain why this|
2025-02-16 11:30:38,862 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:30:38,862 [INFO] 训练时间4.971161127090454
2025-02-16 11:30:38,862 [INFO] Show Hyperparameters: 


2025-02-16 11:30:38,862 [INFO]   task: sentiment
2025-02-16 11:30:38,862 [INFO]   layer: 6
2025-02-16 11:30:38,862 [INFO]   LLM: gpt2-small
2025-02-16 11:30:38,862 [INFO]   seed: 42
2025-02-16 11:30:38,862 [INFO]   data_size: -1
2025-02-16 11:30:38,862 [INFO]   device: cuda
2025-02-16 11:30:38,862 [INFO]   alpha: 130.0
2025-02-16 11:30:38,862 [INFO]   method: val_mul
2025-02-16 11:30:38,862 [INFO]   topk_mean: 100
2025-02-16 11:30:38,862 [INFO]   topk_cnt: 100
2025-02-16 11:30:38,862 [INFO]   batch_size: 32
2025-02-16 11:30:38,862 [INFO]   source: pos
2025-02-16 11:30:38,862 [INFO]   target: neg
2025-02-16 11:30:38,863 [INFO]   prompt_source: neg
2025-02-16 11:30:38,863 [INFO]   prompt_data_size: -1
2025-02-16 11:30:38,863 [INFO]   mean_type: dif_mean
2025-02-16 11:30:38,863 [INFO]   steer_type: all
2025-02-16 11:30:38,863 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:30:38,863 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:30:38,863 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:30:38,863 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:30:38,863 [INFO]   temperature: 0.9
2025-02-16 11:30:38,863 [INFO]   top_p: 0.3
2025-02-16 11:30:38,863 [INFO]   freq_penalty: 1.0
2025-02-16 11:30:38,863 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:30:38,863 [INFO]   debug: 1
2025-02-16 11:30:38,863 [INFO]   save_no_steer: 1
2025-02-16 11:30:38,863 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:30:38,863 [INFO]   use_cache: 0
2025-02-16 11:30:38,863 [INFO]   repeat_num: 2
2025-02-16 11:30:38,863 [INFO]   gen_batch_size: 16
2025-02-16 11:30:38,863 [INFO]   real_data_size_for_train: 1624
