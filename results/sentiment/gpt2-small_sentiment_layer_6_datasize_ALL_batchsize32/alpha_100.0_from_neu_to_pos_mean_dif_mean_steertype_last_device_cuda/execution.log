2025-02-06 11:33:16,379 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:33:16,380 [INFO] Show Hyperparameters: 


2025-02-06 11:33:16,380 [INFO]   task: sentiment
2025-02-06 11:33:16,380 [INFO]   layer: 6
2025-02-06 11:33:16,380 [INFO]   LLM: gpt2-small
2025-02-06 11:33:16,380 [INFO]   seed: 42
2025-02-06 11:33:16,380 [INFO]   data_size: -1
2025-02-06 11:33:16,380 [INFO]   device: cuda
2025-02-06 11:33:16,380 [INFO]   alpha: 100.0
2025-02-06 11:33:16,380 [INFO]   method: val_mul
2025-02-06 11:33:16,380 [INFO]   topk_mean: 100
2025-02-06 11:33:16,380 [INFO]   topk_cnt: 100
2025-02-06 11:33:16,380 [INFO]   batch_size: 32
2025-02-06 11:33:16,380 [INFO]   source: neu
2025-02-06 11:33:16,380 [INFO]   target: pos
2025-02-06 11:33:16,380 [INFO]   mean_type: dif_mean
2025-02-06 11:33:16,380 [INFO]   steer_type: last
2025-02-06 11:33:16,380 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:33:16,380 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:33:16,380 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:33:16,380 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:33:16,380 [INFO]   temperature: 0.9
2025-02-06 11:33:16,380 [INFO]   top_p: 0.3
2025-02-06 11:33:16,380 [INFO]   freq_penalty: 1.0
2025-02-06 11:33:16,380 [INFO]   example_prompt: I feel very
2025-02-06 11:33:16,380 [INFO]   debug: 1
2025-02-06 11:33:16,380 [INFO]   save_no_steer: 1
2025-02-06 11:33:16,380 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:33:16,380 [INFO]   use_cache: 0
2025-02-06 11:33:16,381 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:33:16,381 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:33:16,381 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:33:16,381 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:33:16,506 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:33:16,512 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:33:16,512 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:33:16,512 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:33:35,730 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:33:35,731 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:33:35,754 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:33:35,767 [INFO] positive
2025-02-06 11:33:35,774 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:33:37,751 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:33:37,752 [INFO] neutral
2025-02-06 11:33:37,766 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:33:39,835 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:33:39,838 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:33:39,847 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:33:39,868 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:33:39,901 [INFO] delta_matrix: tensor([-0.0509, -0.0139, -0.1005,  0.0379, -0.0376], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-06 11:33:39,901 [INFO] Example prompt: I feel very
2025-02-06 11:33:39,901 [INFO] Generating texts **without** steering... 
2025-02-06 11:33:39,903 [INFO] 无干预
2025-02-06 11:33:41,188 [INFO] prompt:*****
I feel very
2025-02-06 11:33:41,188 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to make this journey. I am very grateful for the support of my family and friends, as well as the amazing people who helped me get here.

I hope you all enjoy this journey and are looking forward to more
2025-02-06 11:33:41,188 [INFO] Generated Text: 2:
|>I feel very strongly about this project. I am so excited to see what happens with the development of this game.

I have been playing it for a few months now and I really like how it looks and feels. It is a game that I want to
2025-02-06 11:33:41,188 [INFO] Generated Text: 3:
|>I feel very bad for my family. I have a wife and two kids, and I am going to miss them dearly. My mom is in a wheelchair, so she can't go to school or do her job. My dad is on the road with his wife
2025-02-06 11:33:41,188 [INFO] 干预之后的结果
2025-02-06 11:33:41,188 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:33:41,188 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:33:41,188 [INFO] form neu to pos
2025-02-06 11:33:42,088 [INFO] prompt:*****
I feel very
2025-02-06 11:33:42,088 [INFO] Generated Text: 1:
|>I feel very much for the young people who are struggling to make ends meet. I know that many of them are struggling to find a job, but I also know that many of them are struggling to get by.

The problem is not with the kids but
2025-02-06 11:33:42,088 [INFO] Generated Text: 2:
|>I feel very much for the fans of the game. I hope they will continue to support it and enjoy it. But, as a fan of this game, I'm not sure how to express my gratitude for all the support and feedback that we've received over the
2025-02-06 11:33:42,088 [INFO] Generated Text: 3:
|>I feel very sorry for the people who are going through this and I hope they can help me out.

I'm not sure if it's because of my disability or something but I have a lot of friends that are like me and they're just trying to
2025-02-06 11:33:42,093 [INFO] debug mode,show example, no full dataset eval
2025-02-06 11:33:42,093 [INFO] Show Hyperparameters: 


2025-02-06 11:33:42,093 [INFO]   task: sentiment
2025-02-06 11:33:42,093 [INFO]   layer: 6
2025-02-06 11:33:42,093 [INFO]   LLM: gpt2-small
2025-02-06 11:33:42,093 [INFO]   seed: 42
2025-02-06 11:33:42,093 [INFO]   data_size: -1
2025-02-06 11:33:42,093 [INFO]   device: cuda
2025-02-06 11:33:42,093 [INFO]   alpha: 100.0
2025-02-06 11:33:42,093 [INFO]   method: val_mul
2025-02-06 11:33:42,093 [INFO]   topk_mean: 100
2025-02-06 11:33:42,093 [INFO]   topk_cnt: 100
2025-02-06 11:33:42,093 [INFO]   batch_size: 32
2025-02-06 11:33:42,093 [INFO]   source: neu
2025-02-06 11:33:42,093 [INFO]   target: pos
2025-02-06 11:33:42,093 [INFO]   mean_type: dif_mean
2025-02-06 11:33:42,093 [INFO]   steer_type: last
2025-02-06 11:33:42,093 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:33:42,093 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:33:42,093 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:33:42,093 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:33:42,093 [INFO]   temperature: 0.9
2025-02-06 11:33:42,093 [INFO]   top_p: 0.3
2025-02-06 11:33:42,093 [INFO]   freq_penalty: 1.0
2025-02-06 11:33:42,093 [INFO]   example_prompt: I feel very
2025-02-06 11:33:42,093 [INFO]   debug: 1
2025-02-06 11:33:42,093 [INFO]   save_no_steer: 1
2025-02-06 11:33:42,093 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:33:42,094 [INFO]   use_cache: 0
2025-02-06 11:34:10,404 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/alpha_100.0_from_neu_to_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-06 11:34:10,404 [INFO] Show Hyperparameters: 


2025-02-06 11:34:10,404 [INFO]   task: sentiment
2025-02-06 11:34:10,404 [INFO]   layer: 6
2025-02-06 11:34:10,404 [INFO]   LLM: gpt2-small
2025-02-06 11:34:10,404 [INFO]   seed: 42
2025-02-06 11:34:10,404 [INFO]   data_size: -1
2025-02-06 11:34:10,404 [INFO]   device: cuda
2025-02-06 11:34:10,404 [INFO]   alpha: 100.0
2025-02-06 11:34:10,404 [INFO]   method: val_mul
2025-02-06 11:34:10,404 [INFO]   topk_mean: 100
2025-02-06 11:34:10,404 [INFO]   topk_cnt: 100
2025-02-06 11:34:10,404 [INFO]   batch_size: 32
2025-02-06 11:34:10,404 [INFO]   source: neu
2025-02-06 11:34:10,404 [INFO]   target: pos
2025-02-06 11:34:10,404 [INFO]   mean_type: dif_mean
2025-02-06 11:34:10,405 [INFO]   steer_type: last
2025-02-06 11:34:10,405 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:34:10,405 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:34:10,405 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:34:10,405 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:34:10,405 [INFO]   temperature: 0.9
2025-02-06 11:34:10,405 [INFO]   top_p: 0.3
2025-02-06 11:34:10,405 [INFO]   freq_penalty: 1.0
2025-02-06 11:34:10,405 [INFO]   example_prompt: I feel very
2025-02-06 11:34:10,405 [INFO]   debug: 1
2025-02-06 11:34:10,405 [INFO]   save_no_steer: 1
2025-02-06 11:34:10,405 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:34:10,405 [INFO]   use_cache: 0
2025-02-06 11:34:10,405 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-06 11:34:10,405 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:34:10,405 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-06 11:34:10,406 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-06 11:34:10,526 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-06 11:34:10,532 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-06 11:34:10,532 [INFO] Loading SAE for layer 6 gpt2-small
2025-02-06 11:34:10,532 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-06 11:34:19,913 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-06 11:34:19,913 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-06 11:34:19,934 [INFO] :>> Sentiment : from neu to pos
2025-02-06 11:34:19,947 [INFO] positive
2025-02-06 11:34:19,953 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:34:21,888 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:34:21,888 [INFO] neutral
2025-02-06 11:34:21,902 [INFO] Running model with cache to obtain hidden states
2025-02-06 11:34:23,870 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-06 11:34:23,873 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-06 11:34:23,882 [INFO] 转向方向 dif_pos-neu_relu
2025-02-06 11:34:23,903 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-06 11:34:23,934 [INFO] delta_matrix: tensor([-0.0509, -0.0139, -0.1005,  0.0379, -0.0376], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-06 11:34:23,934 [INFO] Example prompt: I feel very
2025-02-06 11:34:23,934 [INFO] Generating texts **without** steering... 
2025-02-06 11:34:23,936 [INFO] 无干预
2025-02-06 11:34:25,205 [INFO] prompt:*****
I feel very
2025-02-06 11:34:25,205 [INFO] Generated Text: 1:
|>I feel very lucky to have been able to do this. I'm a huge fan of the show and I'm so happy that I was able to get it done. It's a really good show, and it's going to be great for all of us fans
2025-02-06 11:34:25,205 [INFO] Generated Text: 2:
|>I feel very strongly about this project. I'm not sure if it's a good idea or not, but I think it's a great idea.

I have no idea what you're talking about, but the project is going to be really cool and fun
2025-02-06 11:34:25,205 [INFO] Generated Text: 3:
|>I feel very lucky to have been able to get this book. I've read it many times and it's always a pleasure to read new material. It's a good read for anyone who wants to learn more about the history of religion, especially those who are not
2025-02-06 11:34:25,205 [INFO] 干预之后的结果
2025-02-06 11:34:25,205 [INFO] 干预方向neu->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-06 11:34:25,205 [INFO] ** Generating texts with steering... Target **
2025-02-06 11:34:25,205 [INFO] form neu to pos
2025-02-06 11:34:26,079 [INFO] prompt:*****
I feel very
2025-02-06 11:34:26,079 [INFO] Generated Text: 1:
|>I feel very bad for my son. He was born with a very small brain and his father was a great doctor. He has been diagnosed with autism and is struggling to get the right treatment.

My daughter's dad is so proud of him that he sent
2025-02-06 11:34:26,079 [INFO] Generated Text: 2:
|>I feel very much for the people who have been affected by this, and I hope that they will be able to help us.

It is not my intention to be a spokesperson for any cause, but rather to share with you the experiences of those affected by
2025-02-06 11:34:26,079 [INFO] Generated Text: 3:
|>I feel very uncomfortable with the use of the word "toxic" in this context. I think it's a good thing that we're not talking about the toxic chemicals in water, but rather the way that we're dealing with it.

The word "
2025-02-06 11:34:26,083 [INFO] debug mode,show example, no full dataset eval
2025-02-06 11:34:26,084 [INFO] Show Hyperparameters: 


2025-02-06 11:34:26,084 [INFO]   task: sentiment
2025-02-06 11:34:26,084 [INFO]   layer: 6
2025-02-06 11:34:26,084 [INFO]   LLM: gpt2-small
2025-02-06 11:34:26,084 [INFO]   seed: 42
2025-02-06 11:34:26,084 [INFO]   data_size: -1
2025-02-06 11:34:26,084 [INFO]   device: cuda
2025-02-06 11:34:26,084 [INFO]   alpha: 100.0
2025-02-06 11:34:26,084 [INFO]   method: val_mul
2025-02-06 11:34:26,084 [INFO]   topk_mean: 100
2025-02-06 11:34:26,084 [INFO]   topk_cnt: 100
2025-02-06 11:34:26,084 [INFO]   batch_size: 32
2025-02-06 11:34:26,084 [INFO]   source: neu
2025-02-06 11:34:26,084 [INFO]   target: pos
2025-02-06 11:34:26,084 [INFO]   mean_type: dif_mean
2025-02-06 11:34:26,084 [INFO]   steer_type: last
2025-02-06 11:34:26,084 [INFO]   output_dir: ./results/sentiment/
2025-02-06 11:34:26,084 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-06 11:34:26,084 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-06 11:34:26,084 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-06 11:34:26,084 [INFO]   temperature: 0.9
2025-02-06 11:34:26,084 [INFO]   top_p: 0.3
2025-02-06 11:34:26,084 [INFO]   freq_penalty: 1.0
2025-02-06 11:34:26,084 [INFO]   example_prompt: I feel very
2025-02-06 11:34:26,084 [INFO]   debug: 1
2025-02-06 11:34:26,084 [INFO]   save_no_steer: 1
2025-02-06 11:34:26,084 [INFO]   is_norm_delta_matrix: 0
2025-02-06 11:34:26,084 [INFO]   use_cache: 0
2025-02-06 11:34:26,084 [INFO]   new_data_size_for_train: 1624
