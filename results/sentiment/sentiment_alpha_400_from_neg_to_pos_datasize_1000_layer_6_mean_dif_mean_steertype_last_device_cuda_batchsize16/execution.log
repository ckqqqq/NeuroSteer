2025-01-23 20:30:08,168 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:30:08,168 [INFO] Show Hyperparameters: 


2025-01-23 20:30:08,168 [INFO]   task: sentiment
2025-01-23 20:30:08,168 [INFO]   layer: 6
2025-01-23 20:30:08,168 [INFO]   LLM: gpt2-small
2025-01-23 20:30:08,168 [INFO]   seed: 42
2025-01-23 20:30:08,168 [INFO]   data_size: 1000
2025-01-23 20:30:08,168 [INFO]   device: cuda
2025-01-23 20:30:08,168 [INFO]   alpha: 400
2025-01-23 20:30:08,168 [INFO]   method: val_mul
2025-01-23 20:30:08,168 [INFO]   topk_mean: 100
2025-01-23 20:30:08,168 [INFO]   topk_cnt: 100
2025-01-23 20:30:08,169 [INFO]   batch_size: 16
2025-01-23 20:30:08,169 [INFO]   source: neg
2025-01-23 20:30:08,169 [INFO]   target: pos
2025-01-23 20:30:08,169 [INFO]   mean_type: dif_mean
2025-01-23 20:30:08,169 [INFO]   steer_type: last
2025-01-23 20:30:08,169 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:30:08,169 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:30:08,169 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:30:08,169 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:30:08,169 [INFO]   debug: 1
2025-01-23 20:30:08,169 [INFO]   save_no_steer: 1
2025-01-23 20:30:08,169 [INFO]   cache_delta_matrix: 0
2025-01-23 20:30:08,169 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:30:08,169 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:30:08,169 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:30:08,170 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:30:08,296 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:30:08,304 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:30:08,304 [INFO] Loading model: gpt2-small
2025-01-23 20:30:15,475 [INFO] Loading SAE for layer 6
2025-01-23 20:30:17,514 [INFO] fromnegtopos
2025-01-23 20:30:17,514 [INFO] positive
2025-01-23 20:30:17,519 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:30:19,695 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:30:19,696 [INFO] negative
2025-01-23 20:30:19,702 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:30:22,109 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:30:22,110 [INFO] neutral
2025-01-23 20:30:22,115 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:30:24,772 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:30:24,800 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:30:24,940 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-01-23 20:30:24,940 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:30:24,940 [INFO] Generating texts **without** steering... 
2025-01-23 20:30:26,427 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:30:26,427 [INFO] Generated Text: 1:
 what's going on. They know what's going on in the world, and they're willing to do whatever it takes to get there."

The White House has been trying to reassure Trump that he will not be bullied by his critics. But
2025-01-23 20:30:26,427 [INFO] Generated Text: 2:
 what's going on. They know what's going on in the world, and they're not afraid to do it."

"I'm not saying I'm against the idea of a 'safe space' for people who are LGBT," he added
2025-01-23 20:30:26,427 [INFO] Generated Text: 3:
 what's going on. They know what's going on in the world, and they're not afraid to say it."

"I'm not saying I'm a racist," he said. "I'm just saying that I think there are some
2025-01-23 20:30:26,427 [INFO] 干预之后的结果
2025-01-23 20:30:26,427 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:30:26,427 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:30:26,428 [INFO] form neg to pos
2025-01-23 20:30:27,355 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:30:27,355 [INFO] Generated Text: 1:
 but they can't do it because they're so busy. But I think it's just a great thing to have and you can see how much you love the work but you can also feel like there's something missing in the world.

So
2025-01-23 20:30:27,355 [INFO] Generated Text: 2:
 but they can't do it because they're so busy. But I think it's just a great way to get out and see what you're doing."

The first step is to make sure you're comfortable with the idea but don't be
2025-01-23 20:30:27,355 [INFO] Generated Text: 3:
 but they can't do it because they're so busy. But I think it's just a great thing to have and you can just walk away with a good but you'll be so happy with the quality of the product.

I'm sure
2025-01-23 20:30:27,363 [INFO] Show Hyperparameters: 


2025-01-23 20:30:27,363 [INFO]   task: sentiment
2025-01-23 20:30:27,363 [INFO]   layer: 6
2025-01-23 20:30:27,363 [INFO]   LLM: gpt2-small
2025-01-23 20:30:27,363 [INFO]   seed: 42
2025-01-23 20:30:27,363 [INFO]   data_size: 1000
2025-01-23 20:30:27,363 [INFO]   device: cuda
2025-01-23 20:30:27,364 [INFO]   alpha: 400
2025-01-23 20:30:27,364 [INFO]   method: val_mul
2025-01-23 20:30:27,364 [INFO]   topk_mean: 100
2025-01-23 20:30:27,364 [INFO]   topk_cnt: 100
2025-01-23 20:30:27,364 [INFO]   batch_size: 16
2025-01-23 20:30:27,364 [INFO]   source: neg
2025-01-23 20:30:27,364 [INFO]   target: pos
2025-01-23 20:30:27,364 [INFO]   mean_type: dif_mean
2025-01-23 20:30:27,364 [INFO]   steer_type: last
2025-01-23 20:30:27,364 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:30:27,364 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:30:27,364 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:30:27,364 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:30:27,364 [INFO]   debug: 1
2025-01-23 20:30:27,364 [INFO]   save_no_steer: 1
2025-01-23 20:30:27,364 [INFO]   cache_delta_matrix: 0
2025-01-23 20:30:27,364 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:33:09,781 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:33:09,781 [INFO] Show Hyperparameters: 


2025-01-23 20:33:09,781 [INFO]   task: sentiment
2025-01-23 20:33:09,781 [INFO]   layer: 6
2025-01-23 20:33:09,781 [INFO]   LLM: gpt2-small
2025-01-23 20:33:09,782 [INFO]   seed: 42
2025-01-23 20:33:09,782 [INFO]   data_size: 1000
2025-01-23 20:33:09,782 [INFO]   device: cuda
2025-01-23 20:33:09,782 [INFO]   alpha: 400
2025-01-23 20:33:09,782 [INFO]   method: val_mul
2025-01-23 20:33:09,782 [INFO]   topk_mean: 100
2025-01-23 20:33:09,782 [INFO]   topk_cnt: 100
2025-01-23 20:33:09,782 [INFO]   batch_size: 16
2025-01-23 20:33:09,782 [INFO]   source: neg
2025-01-23 20:33:09,782 [INFO]   target: pos
2025-01-23 20:33:09,782 [INFO]   mean_type: dif_mean
2025-01-23 20:33:09,782 [INFO]   steer_type: last
2025-01-23 20:33:09,782 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:33:09,782 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:33:09,782 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:33:09,782 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:33:09,782 [INFO]   debug: 1
2025-01-23 20:33:09,782 [INFO]   save_no_steer: 1
2025-01-23 20:33:09,782 [INFO]   cache_delta_matrix: 0
2025-01-23 20:33:09,783 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:33:09,783 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:33:09,783 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:33:09,783 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:33:09,905 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:33:09,913 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:33:09,913 [INFO] Loading model: gpt2-small
2025-01-23 20:33:22,219 [INFO] Loading SAE for layer 6
2025-01-23 20:33:24,186 [INFO] fromnegtopos
2025-01-23 20:33:24,187 [INFO] positive
2025-01-23 20:33:24,192 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:33:26,356 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:33:26,357 [INFO] negative
2025-01-23 20:33:26,361 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:33:28,570 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:33:28,570 [INFO] neutral
2025-01-23 20:33:28,575 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:33:30,734 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:33:30,746 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:33:30,829 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-01-23 20:33:30,830 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:33:30,830 [INFO] Generating texts **without** steering... 
2025-01-23 20:33:32,207 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:33:32,207 [INFO] Generated Text: 1:
 what they're doing. They know what they're doing. They know what they're doing.

"I think it's important to have a good relationship with the players and the coaches, because I think that's where we need to be."
2025-01-23 20:33:32,207 [INFO] Generated Text: 2:
 what they're doing. They know what they're doing. They know what they're doing.

"I think it's important to have a good relationship with the players and the coaches, because I think that's where we need to be."
2025-01-23 20:33:32,207 [INFO] Generated Text: 3:
 what they're doing. They know what they're doing. They know what they're doing.

"I think it's important to have a good relationship with the players and the coaches, because I think that's where we need to be."
2025-01-23 20:33:32,207 [INFO] 干预之后的结果
2025-01-23 20:33:32,207 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:33:32,207 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:33:32,207 [INFO] form neg to pos
2025-01-23 20:33:33,098 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:33:33,099 [INFO] Generated Text: 1:
 but they can't do it because they're so busy. But I think it's just so simple and so simple, but it's so good. It's just a great thing to have."

The young man is but but but but but
2025-01-23 20:33:33,099 [INFO] Generated Text: 2:
 but they can't do it because they're so busy. But I think it's just so simple and so simple, but it's so good. It's just a great thing to have."

The young man is but but but but but
2025-01-23 20:33:33,099 [INFO] Generated Text: 3:
 but they can't do it because they're so busy. But I think it's just so simple and so simple, but it's so good. It's just a great thing to have."

The young man is but but but but but
2025-01-23 20:33:33,102 [INFO] Show Hyperparameters: 


2025-01-23 20:33:33,102 [INFO]   task: sentiment
2025-01-23 20:33:33,102 [INFO]   layer: 6
2025-01-23 20:33:33,102 [INFO]   LLM: gpt2-small
2025-01-23 20:33:33,102 [INFO]   seed: 42
2025-01-23 20:33:33,102 [INFO]   data_size: 1000
2025-01-23 20:33:33,102 [INFO]   device: cuda
2025-01-23 20:33:33,102 [INFO]   alpha: 400
2025-01-23 20:33:33,102 [INFO]   method: val_mul
2025-01-23 20:33:33,102 [INFO]   topk_mean: 100
2025-01-23 20:33:33,102 [INFO]   topk_cnt: 100
2025-01-23 20:33:33,102 [INFO]   batch_size: 16
2025-01-23 20:33:33,102 [INFO]   source: neg
2025-01-23 20:33:33,102 [INFO]   target: pos
2025-01-23 20:33:33,102 [INFO]   mean_type: dif_mean
2025-01-23 20:33:33,102 [INFO]   steer_type: last
2025-01-23 20:33:33,102 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:33:33,103 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:33:33,103 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:33:33,103 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:33:33,103 [INFO]   debug: 1
2025-01-23 20:33:33,103 [INFO]   save_no_steer: 1
2025-01-23 20:33:33,103 [INFO]   cache_delta_matrix: 0
2025-01-23 20:33:33,103 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:34:57,207 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:34:57,207 [INFO] Show Hyperparameters: 


2025-01-23 20:34:57,207 [INFO]   task: sentiment
2025-01-23 20:34:57,207 [INFO]   layer: 6
2025-01-23 20:34:57,207 [INFO]   LLM: gpt2-small
2025-01-23 20:34:57,207 [INFO]   seed: 42
2025-01-23 20:34:57,207 [INFO]   data_size: 1000
2025-01-23 20:34:57,207 [INFO]   device: cuda
2025-01-23 20:34:57,207 [INFO]   alpha: 400
2025-01-23 20:34:57,207 [INFO]   method: val_mul
2025-01-23 20:34:57,207 [INFO]   topk_mean: 100
2025-01-23 20:34:57,207 [INFO]   topk_cnt: 100
2025-01-23 20:34:57,207 [INFO]   batch_size: 16
2025-01-23 20:34:57,207 [INFO]   source: neg
2025-01-23 20:34:57,207 [INFO]   target: pos
2025-01-23 20:34:57,207 [INFO]   mean_type: dif_mean
2025-01-23 20:34:57,207 [INFO]   steer_type: last
2025-01-23 20:34:57,207 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:34:57,207 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:34:57,207 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:34:57,208 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:34:57,208 [INFO]   debug: 1
2025-01-23 20:34:57,208 [INFO]   save_no_steer: 1
2025-01-23 20:34:57,208 [INFO]   cache_delta_matrix: 0
2025-01-23 20:34:57,208 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:34:57,208 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:34:57,208 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:34:57,209 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:34:57,334 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:34:57,342 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:34:57,342 [INFO] Loading model: gpt2-small
2025-01-23 20:34:59,636 [INFO] Loading SAE for layer 6
2025-01-23 20:35:01,645 [INFO] fromnegtopos
2025-01-23 20:35:01,645 [INFO] positive
2025-01-23 20:35:01,650 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:35:03,849 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:35:03,849 [INFO] negative
2025-01-23 20:35:03,854 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:35:06,110 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:35:06,111 [INFO] neutral
2025-01-23 20:35:06,115 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:35:08,272 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:35:08,282 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:35:08,352 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-01-23 20:35:08,353 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:35:08,353 [INFO] Generating texts **without** steering... 
2025-01-23 20:35:09,714 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:35:09,714 [INFO] Generated Text: 1:
 what's going on. They know what's going on in the world, and they're willing to do whatever it takes to get there."

"I think we've got a lot of work to do," he added. "We've got
2025-01-23 20:35:09,714 [INFO] Generated Text: 2:
 what's going on. They know what's going on in the world, and they're not going to let it get out of hand."

The three-time All-Star said he has been "very impressed" with the way his team
2025-01-23 20:35:09,714 [INFO] Generated Text: 3:
 what's going on. They know what's going on in the world, and they're not afraid to say it."

The new president has been briefed by his national security adviser, Lt. Gen. H.R. McMaster, who said
2025-01-23 20:35:09,714 [INFO] 干预之后的结果
2025-01-23 20:35:09,714 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:35:09,714 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:35:09,714 [INFO] form neg to pos
2025-01-23 20:35:10,622 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:35:10,622 [INFO] Generated Text: 1:
 but they can't do it because they're so busy. But I think it's just a great feeling and you can just walk away with a good but but not very good chai.

I'm sure you'll be happy with the but
2025-01-23 20:35:10,622 [INFO] Generated Text: 2:
 but they can't do it because they're so busy. But I think it's just a great way to get out and see what you're doing."

The chis but but is this a good thing?

"It's just
2025-01-23 20:35:10,622 [INFO] Generated Text: 3:
 but they can't do it because they're so busy. But I think it's just a great thing to have and you can just say, 'I'm so happy but I'm not going to do this.' It's just a great feeling."
2025-01-23 20:35:10,628 [INFO] Show Hyperparameters: 


2025-01-23 20:35:10,628 [INFO]   task: sentiment
2025-01-23 20:35:10,628 [INFO]   layer: 6
2025-01-23 20:35:10,628 [INFO]   LLM: gpt2-small
2025-01-23 20:35:10,628 [INFO]   seed: 42
2025-01-23 20:35:10,628 [INFO]   data_size: 1000
2025-01-23 20:35:10,628 [INFO]   device: cuda
2025-01-23 20:35:10,628 [INFO]   alpha: 400
2025-01-23 20:35:10,628 [INFO]   method: val_mul
2025-01-23 20:35:10,629 [INFO]   topk_mean: 100
2025-01-23 20:35:10,629 [INFO]   topk_cnt: 100
2025-01-23 20:35:10,629 [INFO]   batch_size: 16
2025-01-23 20:35:10,629 [INFO]   source: neg
2025-01-23 20:35:10,629 [INFO]   target: pos
2025-01-23 20:35:10,629 [INFO]   mean_type: dif_mean
2025-01-23 20:35:10,629 [INFO]   steer_type: last
2025-01-23 20:35:10,629 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:35:10,629 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:35:10,629 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:35:10,629 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:35:10,629 [INFO]   debug: 1
2025-01-23 20:35:10,629 [INFO]   save_no_steer: 1
2025-01-23 20:35:10,629 [INFO]   cache_delta_matrix: 0
2025-01-23 20:35:10,629 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:35:57,718 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:35:57,718 [INFO] Show Hyperparameters: 


2025-01-23 20:35:57,718 [INFO]   task: sentiment
2025-01-23 20:35:57,718 [INFO]   layer: 6
2025-01-23 20:35:57,718 [INFO]   LLM: gpt2-small
2025-01-23 20:35:57,718 [INFO]   seed: 42
2025-01-23 20:35:57,718 [INFO]   data_size: 1000
2025-01-23 20:35:57,718 [INFO]   device: cuda
2025-01-23 20:35:57,718 [INFO]   alpha: 400
2025-01-23 20:35:57,718 [INFO]   method: val_mul
2025-01-23 20:35:57,718 [INFO]   topk_mean: 100
2025-01-23 20:35:57,718 [INFO]   topk_cnt: 100
2025-01-23 20:35:57,718 [INFO]   batch_size: 16
2025-01-23 20:35:57,718 [INFO]   source: neg
2025-01-23 20:35:57,718 [INFO]   target: pos
2025-01-23 20:35:57,718 [INFO]   mean_type: dif_mean
2025-01-23 20:35:57,718 [INFO]   steer_type: last
2025-01-23 20:35:57,718 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:35:57,718 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:35:57,718 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:35:57,718 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:35:57,718 [INFO]   debug: 1
2025-01-23 20:35:57,718 [INFO]   save_no_steer: 1
2025-01-23 20:35:57,718 [INFO]   cache_delta_matrix: 0
2025-01-23 20:35:57,719 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:35:57,719 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:35:57,719 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:35:57,719 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:35:57,818 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:35:57,824 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:35:57,824 [INFO] Loading model: gpt2-small
2025-01-23 20:36:05,065 [INFO] Loading SAE for layer 6
2025-01-23 20:36:07,014 [INFO] fromnegtopos
2025-01-23 20:36:07,014 [INFO] positive
2025-01-23 20:36:07,019 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:36:09,176 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:36:09,177 [INFO] negative
2025-01-23 20:36:09,181 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:36:11,344 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:36:11,344 [INFO] neutral
2025-01-23 20:36:11,349 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:36:13,574 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:36:13,585 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:36:13,655 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-01-23 20:36:13,655 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:36:13,655 [INFO] Generating texts **without** steering... 
2025-01-23 20:36:15,132 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:36:15,132 [INFO] Generated Text: 1:
 how to do it. They know how to take care of themselves, and that's what makes them special.

"I think the best thing for us is we get a chance to show our players what we can do and be able to compete
2025-01-23 20:36:15,132 [INFO] Generated Text: 2:
 what's going on. They know what's going on with the police, and they're going to do whatever it takes to get them out of there."

The victim was a 17-year-old boy who was shot in the head by
2025-01-23 20:36:15,132 [INFO] Generated Text: 3:
 what's going on.

"They know how to deal with the situation and how to deal with the media," said Benoit. "They know what's going on in their own home, and they're ready to go."<|endoftext|><|endoftext|><|endoftext|>
2025-01-23 20:36:15,132 [INFO] 干预之后的结果
2025-01-23 20:36:15,132 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:36:15,132 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:36:15,132 [INFO] form neg to pos
2025-01-23 20:36:16,018 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:36:16,018 [INFO] Generated Text: 1:
 but they can't do it. But I think it's just so simple and so good that you can get through it but you can't get through the other stuff. It's just a very simple thing to do."

And if you're
2025-01-23 20:36:16,018 [INFO] Generated Text: 2:
 but they can't explain, but they're so cute and adorable.

I love this but I'm not sure why it's so hard to understand, but it's just so cute and you can just sit there and watch it with your friends
2025-01-23 20:36:16,018 [INFO] Generated Text: 3:
 what you're but but it's just so hard to make the effort and get it done. But I think it's just so cool because you can feel like you're doing something but you can't really feel like you're doing anything. It's
2025-01-23 20:36:16,022 [INFO] Show Hyperparameters: 


2025-01-23 20:36:16,022 [INFO]   task: sentiment
2025-01-23 20:36:16,022 [INFO]   layer: 6
2025-01-23 20:36:16,022 [INFO]   LLM: gpt2-small
2025-01-23 20:36:16,022 [INFO]   seed: 42
2025-01-23 20:36:16,022 [INFO]   data_size: 1000
2025-01-23 20:36:16,022 [INFO]   device: cuda
2025-01-23 20:36:16,022 [INFO]   alpha: 400
2025-01-23 20:36:16,022 [INFO]   method: val_mul
2025-01-23 20:36:16,022 [INFO]   topk_mean: 100
2025-01-23 20:36:16,022 [INFO]   topk_cnt: 100
2025-01-23 20:36:16,022 [INFO]   batch_size: 16
2025-01-23 20:36:16,022 [INFO]   source: neg
2025-01-23 20:36:16,022 [INFO]   target: pos
2025-01-23 20:36:16,022 [INFO]   mean_type: dif_mean
2025-01-23 20:36:16,022 [INFO]   steer_type: last
2025-01-23 20:36:16,022 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:36:16,022 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:36:16,022 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:36:16,022 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:36:16,022 [INFO]   debug: 1
2025-01-23 20:36:16,022 [INFO]   save_no_steer: 1
2025-01-23 20:36:16,022 [INFO]   cache_delta_matrix: 0
2025-01-23 20:36:16,022 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:53:27,267 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:53:27,267 [INFO] Show Hyperparameters: 


2025-01-23 20:53:27,267 [INFO]   task: sentiment
2025-01-23 20:53:27,267 [INFO]   layer: 6
2025-01-23 20:53:27,267 [INFO]   LLM: gpt2-small
2025-01-23 20:53:27,267 [INFO]   seed: 42
2025-01-23 20:53:27,267 [INFO]   data_size: 1000
2025-01-23 20:53:27,267 [INFO]   device: cuda
2025-01-23 20:53:27,267 [INFO]   alpha: 400
2025-01-23 20:53:27,267 [INFO]   method: val_mul
2025-01-23 20:53:27,267 [INFO]   topk_mean: 100
2025-01-23 20:53:27,267 [INFO]   topk_cnt: 100
2025-01-23 20:53:27,267 [INFO]   batch_size: 16
2025-01-23 20:53:27,268 [INFO]   source: neg
2025-01-23 20:53:27,268 [INFO]   target: pos
2025-01-23 20:53:27,268 [INFO]   mean_type: dif_mean
2025-01-23 20:53:27,268 [INFO]   steer_type: last
2025-01-23 20:53:27,268 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:53:27,268 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:53:27,268 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:53:27,268 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:53:27,268 [INFO]   temperature: 0.9
2025-01-23 20:53:27,268 [INFO]   top_p: 0.3
2025-01-23 20:53:27,268 [INFO]   freq_penalty: 1.0
2025-01-23 20:53:27,268 [INFO]   debug: 1
2025-01-23 20:53:27,268 [INFO]   save_no_steer: 1
2025-01-23 20:53:27,268 [INFO]   cache_delta_matrix: 0
2025-01-23 20:53:27,268 [INFO]   is_norm_delta_matrix: 0
2025-01-23 20:53:27,268 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:53:27,268 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:53:27,268 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:53:27,269 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:53:27,366 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:53:27,373 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:53:27,373 [INFO] Loading model: gpt2-small
2025-01-23 20:53:34,548 [INFO] Loading SAE for layer 6
2025-01-23 20:53:36,678 [INFO] fromnegtopos
2025-01-23 20:53:36,678 [INFO] positive
2025-01-23 20:53:36,683 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:53:38,836 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:53:38,836 [INFO] negative
2025-01-23 20:53:38,841 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:53:41,331 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:53:41,332 [INFO] neutral
2025-01-23 20:53:41,336 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:53:43,603 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:53:43,632 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:53:43,773 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-01-23 20:53:43,796 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:53:43,796 [INFO] Generating texts **without** steering... 
2025-01-23 20:53:45,266 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:53:45,266 [INFO] Generated Text: 1:
 what's going on. They know what's going on with the players. They know who they are and what they're doing."

The Tigers' biggest problem, though, is that their offense has been underwhelming in recent weeks. The Tigers
2025-01-23 20:53:45,266 [INFO] Generated Text: 2:
 what's going on. They know what's going on with the kids, and they're going to make sure that we're not letting them down."

The Steelers have been under fire for a lack of discipline from their players in recent weeks,
2025-01-23 20:53:45,266 [INFO] Generated Text: 3:
 how to make a good case for their own position.

In the past, it was just about the wrong thing to do. In the 1990s, when it was more like a public relations disaster than anything else, people were going crazy over
2025-01-23 20:53:45,266 [INFO] 干预之后的结果
2025-01-23 20:53:45,266 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:53:45,266 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:53:45,266 [INFO] form neg to pos
2025-01-23 20:53:46,207 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:53:46,207 [INFO] Generated Text: 1:
 but it's so simple and easy to understand.

This is a very simple but well-made and but elegant dish, but you can make it with just one of the many wonderful spices, but you will not be able to do it without
2025-01-23 20:53:46,207 [INFO] Generated Text: 2:
 but can't explain, but you'll just have to give them a good chis and I'll be sure to help.

This is a quick but but fun video, so if you're just looking for a quick and simple but delicious recipe
2025-01-23 20:53:46,207 [INFO] Generated Text: 3:
 but can't explain, but it's so simple and easy to understand.

But what do you think? Is this a great book? or would you rather just buy it but just like it's not as good as the other books on this
2025-01-23 20:53:46,213 [INFO] Show Hyperparameters: 


2025-01-23 20:53:46,213 [INFO]   task: sentiment
2025-01-23 20:53:46,213 [INFO]   layer: 6
2025-01-23 20:53:46,213 [INFO]   LLM: gpt2-small
2025-01-23 20:53:46,213 [INFO]   seed: 42
2025-01-23 20:53:46,213 [INFO]   data_size: 1000
2025-01-23 20:53:46,213 [INFO]   device: cuda
2025-01-23 20:53:46,213 [INFO]   alpha: 400
2025-01-23 20:53:46,213 [INFO]   method: val_mul
2025-01-23 20:53:46,213 [INFO]   topk_mean: 100
2025-01-23 20:53:46,213 [INFO]   topk_cnt: 100
2025-01-23 20:53:46,213 [INFO]   batch_size: 16
2025-01-23 20:53:46,213 [INFO]   source: neg
2025-01-23 20:53:46,213 [INFO]   target: pos
2025-01-23 20:53:46,213 [INFO]   mean_type: dif_mean
2025-01-23 20:53:46,214 [INFO]   steer_type: last
2025-01-23 20:53:46,214 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:53:46,214 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:53:46,214 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:53:46,214 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:53:46,214 [INFO]   temperature: 0.9
2025-01-23 20:53:46,214 [INFO]   top_p: 0.3
2025-01-23 20:53:46,214 [INFO]   freq_penalty: 1.0
2025-01-23 20:53:46,214 [INFO]   debug: 1
2025-01-23 20:53:46,214 [INFO]   save_no_steer: 1
2025-01-23 20:53:46,214 [INFO]   cache_delta_matrix: 0
2025-01-23 20:53:46,214 [INFO]   is_norm_delta_matrix: 0
2025-01-23 20:53:46,214 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:54:16,684 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:54:16,684 [INFO] Show Hyperparameters: 


2025-01-23 20:54:16,684 [INFO]   task: sentiment
2025-01-23 20:54:16,684 [INFO]   layer: 6
2025-01-23 20:54:16,684 [INFO]   LLM: gpt2-small
2025-01-23 20:54:16,684 [INFO]   seed: 42
2025-01-23 20:54:16,684 [INFO]   data_size: 1000
2025-01-23 20:54:16,685 [INFO]   device: cuda
2025-01-23 20:54:16,685 [INFO]   alpha: 400
2025-01-23 20:54:16,685 [INFO]   method: val_mul
2025-01-23 20:54:16,685 [INFO]   topk_mean: 100
2025-01-23 20:54:16,685 [INFO]   topk_cnt: 100
2025-01-23 20:54:16,685 [INFO]   batch_size: 16
2025-01-23 20:54:16,685 [INFO]   source: neg
2025-01-23 20:54:16,685 [INFO]   target: pos
2025-01-23 20:54:16,685 [INFO]   mean_type: dif_mean
2025-01-23 20:54:16,685 [INFO]   steer_type: last
2025-01-23 20:54:16,685 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:54:16,685 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:54:16,685 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:54:16,685 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:54:16,685 [INFO]   temperature: 0.9
2025-01-23 20:54:16,685 [INFO]   top_p: 0.3
2025-01-23 20:54:16,685 [INFO]   freq_penalty: 1.0
2025-01-23 20:54:16,685 [INFO]   debug: 1
2025-01-23 20:54:16,685 [INFO]   save_no_steer: 1
2025-01-23 20:54:16,685 [INFO]   cache_delta_matrix: 0
2025-01-23 20:54:16,685 [INFO]   is_norm_delta_matrix: 1
2025-01-23 20:54:16,686 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:54:16,686 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:54:16,686 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:54:16,686 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:54:16,809 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:54:16,817 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:54:16,817 [INFO] Loading model: gpt2-small
2025-01-23 20:54:18,900 [INFO] Loading SAE for layer 6
2025-01-23 20:54:21,035 [INFO] fromnegtopos
2025-01-23 20:54:21,035 [INFO] positive
2025-01-23 20:54:21,041 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:54:23,226 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:54:23,226 [INFO] negative
2025-01-23 20:54:23,231 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:54:25,482 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:54:25,483 [INFO] neutral
2025-01-23 20:54:25,487 [INFO] Running model with cache to obtain hidden states
2025-01-23 20:54:27,646 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 20:54:27,659 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 20:54:27,725 [INFO] Steering vectors normalized with L2 norm: 3.5489859580993652 归一化矩阵大小
2025-01-23 20:54:27,770 [INFO] delta_matrix: tensor([ 8.7035e-03, -1.7650e-02, -4.6946e-02,  6.6512e-03, -3.5425e-02,
        -5.9677e-03, -2.8945e-02,  3.6662e-02,  7.0962e-02, -1.9739e-02,
         1.5859e-02,  2.7613e-02,  3.9559e-02,  1.0288e-02,  4.3936e-02,
        -4.4737e-03, -2.9167e-02, -2.5220e-02,  5.2062e-02, -1.6161e-02,
         2.2240e-02, -1.9764e-02,  5.8182e-02,  4.3517e-03, -6.4202e-03,
         3.1063e-02, -6.2893e-03, -3.0605e-02, -2.4966e-02, -2.4484e-02,
        -1.1487e-02, -4.3235e-02, -1.6155e-02, -2.5781e-03, -1.3030e-02,
         2.7879e-03,  3.3372e-03, -1.1022e-02, -5.4939e-02,  1.3542e-02,
        -6.0808e-02, -3.7088e-02,  9.7732e-03, -2.0366e-02, -7.6349e-02,
         2.9764e-02,  2.1168e-04, -4.4287e-02, -1.7513e-02, -1.2903e-02,
        -2.3727e-02,  4.1723e-03,  2.4806e-02, -4.5388e-02,  1.2462e-02,
         3.3374e-02, -1.5071e-03,  6.2279e-02,  2.8354e-02,  5.3865e-03,
        -3.2598e-02, -2.4638e-02, -2.3413e-02,  3.2204e-02, -2.7101e-02,
         5.6843e-02, -2.3339e-04, -4.6547e-02, -2.9216e-02,  1.3583e-02,
        -1.4626e-02,  3.2230e-02,  2.4731e-02, -2.7149e-02,  2.6586e-03,
        -4.8848e-02, -1.4887e-02,  1.2234e-02, -2.9807e-02, -4.6772e-02,
         3.7179e-02,  7.8604e-03, -3.9813e-02, -2.2775e-02,  3.2498e-02,
         3.9572e-02, -4.2210e-02,  5.5134e-02, -8.1204e-03, -3.1364e-02,
         7.4069e-03, -3.0094e-02,  9.9730e-03,  2.1973e-02,  1.8819e-02,
         3.7386e-02, -5.2750e-02, -3.4431e-02,  8.0386e-03,  3.0297e-02,
         6.5034e-03,  3.7538e-02, -1.8109e-02, -1.8916e-02, -1.7856e-02,
         3.5297e-02, -1.6883e-02, -3.2384e-02,  1.5848e-02, -1.5967e-02,
        -5.8578e-03, -1.2837e-02, -1.3963e-02, -1.5081e-02, -3.2962e-02,
         9.4769e-03, -8.7213e-02,  1.2445e-02, -5.8987e-03,  1.4744e-02,
        -4.3202e-02, -2.0692e-02, -6.0720e-03,  1.1649e-02,  1.5027e-02,
        -7.6810e-02,  1.5178e-03,  7.7440e-03,  4.4741e-02, -1.1399e-02,
        -3.9220e-02,  4.2450e-02, -5.6594e-02, -6.0046e-02,  1.1468e-02,
         5.3724e-02, -2.1149e-02,  2.7288e-02, -1.3605e-02, -3.2551e-03,
        -1.7070e-02, -1.6655e-02, -8.2712e-03, -2.5289e-02,  2.3449e-02,
        -1.6381e-02, -1.2472e-02,  1.2628e-02, -4.0744e-02, -7.6136e-04,
        -3.0087e-02,  2.7699e-02,  1.4341e-03,  2.5221e-02, -1.8211e-02,
        -2.2656e-02, -2.5335e-02,  2.6314e-02, -4.0157e-03,  3.4455e-02,
        -5.1968e-03, -5.5300e-02,  1.7456e-02,  5.0742e-02, -2.5555e-02,
         2.1907e-02,  4.1591e-02, -2.5385e-02, -1.3970e-02, -1.2666e-02,
         1.8890e-03,  4.0643e-03, -9.0775e-03, -8.7360e-05, -4.6439e-02,
         1.7675e-02, -2.3360e-02,  1.5639e-02,  1.6190e-02,  9.9894e-03,
        -1.1547e-02, -2.2916e-02,  4.0941e-02, -1.9725e-02, -5.3072e-02,
         1.4215e-03,  2.1348e-02,  2.2402e-02,  1.1176e-03, -1.4446e-02,
         1.4105e-02,  3.0616e-02, -9.2574e-03, -3.5654e-02, -1.8615e-02,
         3.0497e-02, -2.3924e-02, -3.1488e-02,  3.8319e-03, -1.2897e-02,
        -7.9945e-03, -2.8703e-02, -6.3046e-02,  8.8538e-02,  7.0195e-03,
         1.5043e-02,  1.1509e-02,  1.3624e-02,  6.6374e-02,  7.5626e-03,
         5.3479e-03,  6.9226e-03, -2.7777e-02,  1.9247e-02, -2.2694e-02,
        -4.1607e-02,  2.4496e-02, -4.8211e-02, -2.8157e-02,  2.8664e-02,
        -4.3402e-02,  4.7536e-02,  1.0110e-02, -1.2054e-02, -1.8133e-02,
         1.3239e-02,  9.1216e-03, -1.3957e-02, -2.1398e-03, -5.2022e-02,
        -2.6745e-02,  1.9838e-02, -2.1952e-02,  5.6564e-02,  7.6178e-03,
        -6.7827e-02,  3.6387e-02, -2.9047e-02, -3.5479e-03,  3.8768e-02,
         6.7783e-02,  1.7110e-02, -1.7096e-02,  1.2124e-02,  2.1077e-02,
        -5.8246e-02,  2.2748e-02,  7.0368e-03, -1.4110e-02, -5.5961e-03,
        -2.8510e-02, -2.0020e-02,  1.5406e-02, -6.6524e-02, -7.1453e-03,
         2.1056e-02,  4.5313e-03, -1.0894e-02,  3.8119e-03,  1.5732e-02,
        -8.1878e-03,  1.3164e-02,  2.5529e-02, -1.5149e-02,  3.9650e-02,
         3.4419e-02,  1.2491e-01,  3.9677e-02, -6.3642e-02, -2.2221e-03,
        -1.0879e-01,  2.7040e-02,  2.4225e-03, -3.5980e-02, -2.9291e-02,
        -3.4844e-02,  5.4534e-02,  2.1548e-02, -2.0736e-02, -2.6122e-02,
        -2.3834e-02, -4.9878e-02,  3.0244e-05, -4.9749e-02,  3.5060e-02,
        -2.8711e-02, -1.5434e-02, -2.8373e-02,  1.2419e-02, -1.0356e-01,
        -1.2191e-02, -4.8292e-02,  5.5426e-02, -1.7762e-02,  4.4489e-02,
         4.0971e-02, -1.6224e-02, -2.1064e-02, -4.6251e-02,  1.5041e-02,
        -2.8138e-02, -4.0657e-02,  5.8060e-02, -3.3814e-02, -2.2732e-02,
        -3.3570e-02, -5.6681e-02,  1.2901e-02, -3.8580e-02, -1.2888e-02,
         6.7143e-03,  1.0130e-02,  1.5834e-02,  7.8830e-03, -1.2857e-01,
        -4.6260e-02, -4.2924e-02,  1.2477e-02, -4.2707e-02,  5.6995e-03,
         1.1481e-02,  3.3393e-02, -2.1045e-02,  4.6872e-03, -2.8426e-02,
         5.0277e-03,  1.1428e-02, -4.2638e-02,  1.2807e-02,  5.6456e-03,
         5.2648e-02, -3.9575e-02, -1.6398e-02, -4.7452e-03,  4.1181e-03,
         1.4039e-02, -3.1287e-02,  3.2275e-02, -1.8723e-03, -4.2585e-02,
         9.4315e-04, -5.5752e-02,  6.3346e-02, -2.8574e-02, -1.0225e-02,
        -2.0195e-03, -2.3039e-02, -1.5686e-02, -2.0313e-02, -1.7425e-02,
        -5.6492e-02, -1.7195e-02, -6.4592e-03,  3.3381e-02, -2.5153e-02,
        -1.7687e-02,  3.1569e-02, -2.3945e-02, -4.4379e-02, -4.9027e-02,
        -7.8554e-02,  2.5327e-02, -4.3609e-03,  3.7068e-02, -3.8550e-06,
        -6.5443e-02, -5.7604e-02, -3.8054e-02, -1.7843e-02,  6.9119e-03,
         1.5802e-02,  1.8933e-02,  6.7414e-02, -1.1061e-01,  1.9059e-03,
        -1.6043e-02,  7.6904e-03,  5.7968e-02, -4.1006e-02, -3.7262e-03,
        -2.9828e-03,  2.4841e-02,  6.5012e-05, -4.0827e-02, -3.5724e-02,
        -9.6471e-02, -2.0167e-02, -3.3406e-04, -3.6332e-02,  6.5176e-03,
        -4.0017e-02,  1.5725e-03, -3.0873e-02,  5.8116e-02,  2.2398e-02,
        -6.7994e-03, -6.8602e-04,  6.0943e-02,  2.3269e-02,  3.7727e-02,
         7.5994e-02,  3.0521e-02, -1.6220e-02, -3.8542e-02,  3.4156e-02,
         2.7060e-02,  1.3066e-02,  1.6368e-02,  5.3027e-02, -4.4501e-02,
        -2.1472e-02, -1.3734e-02,  5.8894e-03, -2.4139e-02, -2.6726e-02,
        -5.6890e-02,  6.6193e-03,  9.4316e-02, -3.2171e-02, -2.3803e-06,
        -1.2091e-02,  8.8780e-03,  1.4921e-02,  2.5440e-02, -1.5491e-02,
        -3.0091e-02, -5.5825e-02,  9.1901e-03, -5.9180e-02,  1.1661e-02,
        -3.0019e-02, -4.7976e-02,  1.1385e-02, -6.9137e-03,  2.3995e-02,
         2.7941e-02,  2.4498e-02, -1.0351e-02, -4.3349e-02,  7.7249e-03,
        -3.0570e-02, -2.9988e-02, -1.8200e-02,  3.6112e-02,  2.5598e-02,
         6.2345e-02,  1.4762e-02,  1.5178e-01, -9.2084e-03, -1.1476e-02,
        -3.4979e-02,  4.0679e-02,  1.5281e-02, -1.2759e-02, -1.0466e-02,
         4.1242e-03, -3.2394e-03, -5.3684e-02,  7.8090e-03, -9.4085e-03,
        -1.0666e-02, -3.9776e-02, -9.8718e-03, -3.3893e-03, -1.8691e-02,
         9.5208e-04, -3.7684e-02, -2.0172e-02,  1.7204e-02,  1.7334e-02,
        -7.9879e-03, -5.5482e-02, -1.0215e-02,  3.2111e-02, -2.9230e-02,
        -1.7670e-02, -1.7985e-02, -3.7312e-03,  1.7666e-02,  2.2009e-02,
         3.8965e-01, -1.3682e-01,  2.6812e-02,  1.2042e-02, -1.3089e-02,
         2.9757e-02, -5.6237e-02,  8.0396e-03, -1.5313e-02, -6.9553e-02,
         1.2401e-02,  4.0304e-02,  2.2683e-02, -2.4653e-02,  1.5255e-02,
         8.7499e-04, -3.8410e-02, -4.2224e-02,  1.6346e-02,  1.6192e-02,
         1.6698e-02, -1.2258e-02, -2.0819e-02, -1.1988e-02, -1.3016e-02,
         2.2879e-02, -1.4646e-02, -8.4465e-03, -4.3000e-02, -3.3566e-02,
        -1.8905e-02, -1.0056e-02, -3.5868e-02, -8.5021e-04, -8.8192e-03,
        -4.6484e-02,  7.6075e-03, -1.8060e-02,  2.7247e-02, -9.9610e-04,
         1.3227e-02,  3.2648e-02, -2.1727e-02,  2.4797e-02, -9.5319e-03,
        -2.1957e-02, -1.6564e-02, -6.4819e-02, -1.6899e-02, -4.6343e-02,
        -3.8108e-02,  1.5312e-03,  3.1790e-03,  4.5621e-02,  1.9681e-02,
        -1.4726e-02,  8.2733e-03, -5.7023e-02, -6.2827e-02, -5.4959e-02,
         3.5798e-02, -5.5203e-03,  8.4993e-03, -2.3143e-02, -8.6279e-03,
        -1.0514e-02, -1.2968e-02,  9.0703e-03, -4.8191e-02,  9.1795e-03,
         1.1560e-02,  1.2258e-02, -3.0939e-02,  1.1322e-02, -3.1486e-02,
         4.2925e-02,  6.2821e-03,  2.6666e-03, -1.4268e-02, -4.2714e-03,
        -5.6609e-02,  2.8412e-02, -1.0237e-02,  4.3278e-02,  2.5974e-02,
         3.1510e-02, -4.3529e-02, -2.2913e-02,  3.8666e-02, -3.2297e-02,
        -8.9667e-02, -3.3109e-02,  4.8496e-02,  2.6259e-02, -2.3996e-02,
        -3.9926e-02, -7.6856e-02,  8.2030e-03,  1.1804e-02,  4.4597e-02,
         4.3117e-03, -1.7363e-02,  3.7144e-02, -1.6673e-02,  4.9670e-03,
        -5.6515e-02,  3.7047e-03, -7.0510e-03,  3.9612e-02,  1.4821e-02,
        -6.9157e-03, -1.7684e-02, -1.4651e-02, -2.4374e-02, -2.0148e-02,
        -3.1956e-02,  6.0061e-03, -1.5365e-03,  5.3619e-02, -2.3380e-03,
        -2.2922e-02,  4.0789e-02, -4.1029e-03, -1.6956e-02,  3.6535e-02,
        -3.6116e-02, -1.5772e-02,  3.6389e-02, -3.4437e-02, -4.1383e-02,
         5.8127e-02, -7.9410e-02, -4.2317e-02, -3.8554e-03, -2.5904e-02,
        -2.1792e-02,  3.3975e-03,  1.3812e-03,  2.3255e-02,  5.9289e-02,
        -3.1955e-02, -4.0463e-02,  2.8012e-02, -8.5901e-03, -7.2443e-03,
        -3.9243e-02,  1.2748e-02, -2.5475e-02,  8.5355e-03,  5.7879e-03,
        -1.1372e-02, -2.4481e-02,  2.0457e-02,  1.1410e-02,  1.4622e-02,
         5.4081e-03, -3.5330e-02, -6.1382e-02,  3.3591e-02,  2.5271e-02,
         1.6216e-02, -7.1272e-02,  1.3496e-02, -4.5924e-02,  8.3414e-02,
        -3.9931e-02,  2.0116e-02,  9.9352e-03,  8.9289e-03, -1.0567e-01,
        -6.3408e-03, -3.9092e-02, -3.8365e-02, -2.9776e-02, -8.6762e-03,
         4.3066e-02,  3.6110e-02, -1.6252e-02,  5.4129e-03, -1.9620e-02,
         1.7900e-02, -1.6529e-03, -2.6478e-02,  2.5508e-03,  9.5109e-05,
         5.5545e-02,  7.2073e-03, -3.7370e-02,  2.8174e-02,  1.1509e-02,
         1.7258e-02,  1.2380e-02,  1.3654e-02, -2.1472e-03,  1.8072e-02,
        -1.4577e-02, -5.4192e-02,  7.9954e-03,  1.9097e-02,  1.1464e-02,
        -4.2715e-02, -1.0692e-02,  2.3506e-04,  9.4854e-03,  2.0964e-02,
        -4.8571e-02, -1.3288e-02,  2.9523e-02,  1.3493e-02,  8.7165e-03,
        -4.6690e-03, -1.7967e-02, -2.1272e-02, -1.9726e-02, -2.8314e-02,
        -1.8763e-02, -3.5048e-02, -1.6598e-02, -5.0202e-02,  1.6072e-02,
        -2.0860e-02, -1.8131e-02, -1.3158e-02,  4.5078e-03, -4.1402e-02,
        -4.6558e-02,  3.7682e-03, -2.3238e-02,  2.7712e-02, -4.7610e-02,
        -3.6191e-03, -4.8368e-02, -4.4029e-02, -1.1885e-03,  2.6725e-04,
         2.5928e-02, -3.3785e-02, -1.0521e-01, -1.0056e-02,  3.2818e-03,
         3.0349e-02,  9.0747e-03, -9.9292e-03,  2.4667e-02,  1.1890e-02,
        -6.0193e-02,  1.2056e-02, -4.5381e-03,  7.9724e-03,  1.6313e-03,
         2.2329e-02, -7.7473e-03,  1.6099e-02,  1.5690e-02,  2.7822e-02,
        -3.1694e-02, -3.1183e-02,  1.1989e-02,  4.7226e-02,  1.2262e-02,
         6.3635e-02, -6.8493e-02, -4.4452e-02, -1.7944e-02,  2.8958e-02,
         1.6682e-02, -1.7033e-02,  1.2119e-02,  2.0903e-03, -7.3647e-04,
         3.3722e-02,  3.4892e-03,  1.8932e-02,  3.4184e-02, -1.7955e-02,
        -4.1366e-03, -9.2835e-02,  3.6266e-04, -4.1372e-02, -5.3483e-03,
         1.7711e-02, -1.8631e-02, -3.5733e-03,  3.9939e-02,  4.9810e-03,
        -9.8418e-03, -7.3381e-02, -1.5184e-02], device='cuda:0',
       grad_fn=<DivBackward0>)
2025-01-23 20:54:27,771 [INFO] Example prompt: What really matters is that they know
2025-01-23 20:54:27,771 [INFO] Generating texts **without** steering... 
2025-01-23 20:54:29,165 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:54:29,165 [INFO] Generated Text: 1:
 what's going on.

"They're going to get their hands on the money, and they're going to be able to make a living," he said. "I think it's just about getting their hands on the money."<|endoftext|><|endoftext|>
2025-01-23 20:54:29,165 [INFO] Generated Text: 2:
 what's going on. They know how to handle it, and they know how to deal with it. And so I think that the real question is: What do you do when you're dealing with a situation like this?

"I'm
2025-01-23 20:54:29,165 [INFO] Generated Text: 3:
 what they're doing. They know how to get the ball out of their hands and then make a play. That's what we're trying to do here."

"We've got to be able to get the ball out of our hands,"
2025-01-23 20:54:29,165 [INFO] 干预之后的结果
2025-01-23 20:54:29,165 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 20:54:29,165 [INFO] ** Generating texts with steering... Target **
2025-01-23 20:54:29,165 [INFO] form neg to pos
2025-01-23 20:54:30,073 [INFO] prompt:*****
What really matters is that they know
2025-01-23 20:54:30,073 [INFO] Generated Text: 1:
 how to make a good sandwich.

But if you're just starting out, I recommend this simple recipe for a quick and easy sandwich:

I'm not sure why you would choose to make this but it's great! It's so
2025-01-23 20:54:30,073 [INFO] Generated Text: 2:
 what to do with their money, but they're not going to tell you how to do it. They're going to say, 'Well, we'll just give you a simple amount of money and then we'll give you the other thing.' And
2025-01-23 20:54:30,073 [INFO] Generated Text: 3:
 how to play and they know how to win. They're just so good at it."

So what's the best way to go about winning? Well, you'll have to find out. The Bulls are going to need a lot of help
2025-01-23 20:54:30,078 [INFO] Show Hyperparameters: 


2025-01-23 20:54:30,078 [INFO]   task: sentiment
2025-01-23 20:54:30,078 [INFO]   layer: 6
2025-01-23 20:54:30,078 [INFO]   LLM: gpt2-small
2025-01-23 20:54:30,078 [INFO]   seed: 42
2025-01-23 20:54:30,078 [INFO]   data_size: 1000
2025-01-23 20:54:30,078 [INFO]   device: cuda
2025-01-23 20:54:30,078 [INFO]   alpha: 400
2025-01-23 20:54:30,078 [INFO]   method: val_mul
2025-01-23 20:54:30,078 [INFO]   topk_mean: 100
2025-01-23 20:54:30,078 [INFO]   topk_cnt: 100
2025-01-23 20:54:30,078 [INFO]   batch_size: 16
2025-01-23 20:54:30,078 [INFO]   source: neg
2025-01-23 20:54:30,078 [INFO]   target: pos
2025-01-23 20:54:30,078 [INFO]   mean_type: dif_mean
2025-01-23 20:54:30,078 [INFO]   steer_type: last
2025-01-23 20:54:30,078 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:54:30,078 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:54:30,078 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:54:30,078 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:54:30,078 [INFO]   temperature: 0.9
2025-01-23 20:54:30,078 [INFO]   top_p: 0.3
2025-01-23 20:54:30,079 [INFO]   freq_penalty: 1.0
2025-01-23 20:54:30,079 [INFO]   debug: 1
2025-01-23 20:54:30,079 [INFO]   save_no_steer: 1
2025-01-23 20:54:30,079 [INFO]   cache_delta_matrix: 0
2025-01-23 20:54:30,079 [INFO]   is_norm_delta_matrix: 1
2025-01-23 20:54:30,079 [INFO] debug mode,show example, no full dataset eval
2025-01-23 20:59:49,527 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 20:59:49,527 [INFO] Show Hyperparameters: 


2025-01-23 20:59:49,527 [INFO]   task: sentiment
2025-01-23 20:59:49,527 [INFO]   layer: 6
2025-01-23 20:59:49,527 [INFO]   LLM: gpt2-small
2025-01-23 20:59:49,527 [INFO]   seed: 42
2025-01-23 20:59:49,527 [INFO]   data_size: 1000
2025-01-23 20:59:49,527 [INFO]   device: cuda
2025-01-23 20:59:49,527 [INFO]   alpha: 400
2025-01-23 20:59:49,527 [INFO]   method: val_mul
2025-01-23 20:59:49,527 [INFO]   topk_mean: 100
2025-01-23 20:59:49,528 [INFO]   topk_cnt: 100
2025-01-23 20:59:49,528 [INFO]   batch_size: 16
2025-01-23 20:59:49,528 [INFO]   source: neg
2025-01-23 20:59:49,528 [INFO]   target: pos
2025-01-23 20:59:49,528 [INFO]   mean_type: dif_mean
2025-01-23 20:59:49,528 [INFO]   steer_type: last
2025-01-23 20:59:49,528 [INFO]   output_dir: ./results/sentiment/
2025-01-23 20:59:49,528 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:59:49,528 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 20:59:49,528 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 20:59:49,528 [INFO]   temperature: 0.9
2025-01-23 20:59:49,528 [INFO]   top_p: 0.3
2025-01-23 20:59:49,528 [INFO]   freq_penalty: 1.0
2025-01-23 20:59:49,528 [INFO]   debug: 1
2025-01-23 20:59:49,528 [INFO]   save_no_steer: 1
2025-01-23 20:59:49,528 [INFO]   cache_delta_matrix: 0
2025-01-23 20:59:49,528 [INFO]   is_norm_delta_matrix: 1
2025-01-23 20:59:49,528 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 20:59:49,528 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 20:59:49,529 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 20:59:49,529 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 20:59:49,650 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 20:59:49,658 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 20:59:49,658 [INFO] Loading model: gpt2-small
2025-01-23 20:59:56,789 [INFO] Loading SAE for layer 6
2025-01-23 20:59:58,722 [INFO] fromnegtopos
2025-01-23 20:59:58,722 [INFO] positive
2025-01-23 20:59:58,727 [INFO] Running model with cache to obtain hidden states
2025-01-23 21:00:00,964 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 21:00:00,965 [INFO] negative
2025-01-23 21:00:00,969 [INFO] Running model with cache to obtain hidden states
2025-01-23 21:00:03,170 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 21:00:03,171 [INFO] neutral
2025-01-23 21:00:03,175 [INFO] Running model with cache to obtain hidden states
2025-01-23 21:00:05,436 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-23 21:00:05,446 [INFO] 转向方向 dif_pos-neg_relu
2025-01-23 21:00:05,507 [INFO] Steering vectors normalized with L2 norm: 3.5489859580993652 归一化矩阵大小
2025-01-23 21:00:05,540 [INFO] delta_matrix: tensor([ 8.7035e-03, -1.7650e-02, -4.6946e-02,  6.6512e-03, -3.5425e-02,
        -5.9677e-03, -2.8945e-02,  3.6662e-02,  7.0962e-02, -1.9739e-02,
         1.5859e-02,  2.7613e-02,  3.9559e-02,  1.0288e-02,  4.3936e-02,
        -4.4737e-03, -2.9167e-02, -2.5220e-02,  5.2062e-02, -1.6161e-02,
         2.2240e-02, -1.9764e-02,  5.8182e-02,  4.3517e-03, -6.4202e-03,
         3.1063e-02, -6.2893e-03, -3.0605e-02, -2.4966e-02, -2.4484e-02,
        -1.1487e-02, -4.3235e-02, -1.6155e-02, -2.5781e-03, -1.3030e-02,
         2.7879e-03,  3.3372e-03, -1.1022e-02, -5.4939e-02,  1.3542e-02,
        -6.0808e-02, -3.7088e-02,  9.7732e-03, -2.0366e-02, -7.6349e-02,
         2.9764e-02,  2.1168e-04, -4.4287e-02, -1.7513e-02, -1.2903e-02,
        -2.3727e-02,  4.1723e-03,  2.4806e-02, -4.5388e-02,  1.2462e-02,
         3.3374e-02, -1.5071e-03,  6.2279e-02,  2.8354e-02,  5.3865e-03,
        -3.2598e-02, -2.4638e-02, -2.3413e-02,  3.2204e-02, -2.7101e-02,
         5.6843e-02, -2.3339e-04, -4.6547e-02, -2.9216e-02,  1.3583e-02,
        -1.4626e-02,  3.2230e-02,  2.4731e-02, -2.7149e-02,  2.6586e-03,
        -4.8848e-02, -1.4887e-02,  1.2234e-02, -2.9807e-02, -4.6772e-02,
         3.7179e-02,  7.8604e-03, -3.9813e-02, -2.2775e-02,  3.2498e-02,
         3.9572e-02, -4.2210e-02,  5.5134e-02, -8.1204e-03, -3.1364e-02,
         7.4069e-03, -3.0094e-02,  9.9730e-03,  2.1973e-02,  1.8819e-02,
         3.7386e-02, -5.2750e-02, -3.4431e-02,  8.0386e-03,  3.0297e-02,
         6.5034e-03,  3.7538e-02, -1.8109e-02, -1.8916e-02, -1.7856e-02,
         3.5297e-02, -1.6883e-02, -3.2384e-02,  1.5848e-02, -1.5967e-02,
        -5.8578e-03, -1.2837e-02, -1.3963e-02, -1.5081e-02, -3.2962e-02,
         9.4769e-03, -8.7213e-02,  1.2445e-02, -5.8987e-03,  1.4744e-02,
        -4.3202e-02, -2.0692e-02, -6.0720e-03,  1.1649e-02,  1.5027e-02,
        -7.6810e-02,  1.5178e-03,  7.7440e-03,  4.4741e-02, -1.1399e-02,
        -3.9220e-02,  4.2450e-02, -5.6594e-02, -6.0046e-02,  1.1468e-02,
         5.3724e-02, -2.1149e-02,  2.7288e-02, -1.3605e-02, -3.2551e-03,
        -1.7070e-02, -1.6655e-02, -8.2712e-03, -2.5289e-02,  2.3449e-02,
        -1.6381e-02, -1.2472e-02,  1.2628e-02, -4.0744e-02, -7.6136e-04,
        -3.0087e-02,  2.7699e-02,  1.4341e-03,  2.5221e-02, -1.8211e-02,
        -2.2656e-02, -2.5335e-02,  2.6314e-02, -4.0157e-03,  3.4455e-02,
        -5.1968e-03, -5.5300e-02,  1.7456e-02,  5.0742e-02, -2.5555e-02,
         2.1907e-02,  4.1591e-02, -2.5385e-02, -1.3970e-02, -1.2666e-02,
         1.8890e-03,  4.0643e-03, -9.0775e-03, -8.7360e-05, -4.6439e-02,
         1.7675e-02, -2.3360e-02,  1.5639e-02,  1.6190e-02,  9.9894e-03,
        -1.1547e-02, -2.2916e-02,  4.0941e-02, -1.9725e-02, -5.3072e-02,
         1.4215e-03,  2.1348e-02,  2.2402e-02,  1.1176e-03, -1.4446e-02,
         1.4105e-02,  3.0616e-02, -9.2574e-03, -3.5654e-02, -1.8615e-02,
         3.0497e-02, -2.3924e-02, -3.1488e-02,  3.8319e-03, -1.2897e-02,
        -7.9945e-03, -2.8703e-02, -6.3046e-02,  8.8538e-02,  7.0195e-03,
         1.5043e-02,  1.1509e-02,  1.3624e-02,  6.6374e-02,  7.5626e-03,
         5.3479e-03,  6.9226e-03, -2.7777e-02,  1.9247e-02, -2.2694e-02,
        -4.1607e-02,  2.4496e-02, -4.8211e-02, -2.8157e-02,  2.8664e-02,
        -4.3402e-02,  4.7536e-02,  1.0110e-02, -1.2054e-02, -1.8133e-02,
         1.3239e-02,  9.1216e-03, -1.3957e-02, -2.1398e-03, -5.2022e-02,
        -2.6745e-02,  1.9838e-02, -2.1952e-02,  5.6564e-02,  7.6178e-03,
        -6.7827e-02,  3.6387e-02, -2.9047e-02, -3.5479e-03,  3.8768e-02,
         6.7783e-02,  1.7110e-02, -1.7096e-02,  1.2124e-02,  2.1077e-02,
        -5.8246e-02,  2.2748e-02,  7.0368e-03, -1.4110e-02, -5.5961e-03,
        -2.8510e-02, -2.0020e-02,  1.5406e-02, -6.6524e-02, -7.1453e-03,
         2.1056e-02,  4.5313e-03, -1.0894e-02,  3.8119e-03,  1.5732e-02,
        -8.1878e-03,  1.3164e-02,  2.5529e-02, -1.5149e-02,  3.9650e-02,
         3.4419e-02,  1.2491e-01,  3.9677e-02, -6.3642e-02, -2.2221e-03,
        -1.0879e-01,  2.7040e-02,  2.4225e-03, -3.5980e-02, -2.9291e-02,
        -3.4844e-02,  5.4534e-02,  2.1548e-02, -2.0736e-02, -2.6122e-02,
        -2.3834e-02, -4.9878e-02,  3.0244e-05, -4.9749e-02,  3.5060e-02,
        -2.8711e-02, -1.5434e-02, -2.8373e-02,  1.2419e-02, -1.0356e-01,
        -1.2191e-02, -4.8292e-02,  5.5426e-02, -1.7762e-02,  4.4489e-02,
         4.0971e-02, -1.6224e-02, -2.1064e-02, -4.6251e-02,  1.5041e-02,
        -2.8138e-02, -4.0657e-02,  5.8060e-02, -3.3814e-02, -2.2732e-02,
        -3.3570e-02, -5.6681e-02,  1.2901e-02, -3.8580e-02, -1.2888e-02,
         6.7143e-03,  1.0130e-02,  1.5834e-02,  7.8830e-03, -1.2857e-01,
        -4.6260e-02, -4.2924e-02,  1.2477e-02, -4.2707e-02,  5.6995e-03,
         1.1481e-02,  3.3393e-02, -2.1045e-02,  4.6872e-03, -2.8426e-02,
         5.0277e-03,  1.1428e-02, -4.2638e-02,  1.2807e-02,  5.6456e-03,
         5.2648e-02, -3.9575e-02, -1.6398e-02, -4.7452e-03,  4.1181e-03,
         1.4039e-02, -3.1287e-02,  3.2275e-02, -1.8723e-03, -4.2585e-02,
         9.4315e-04, -5.5752e-02,  6.3346e-02, -2.8574e-02, -1.0225e-02,
        -2.0195e-03, -2.3039e-02, -1.5686e-02, -2.0313e-02, -1.7425e-02,
        -5.6492e-02, -1.7195e-02, -6.4592e-03,  3.3381e-02, -2.5153e-02,
        -1.7687e-02,  3.1569e-02, -2.3945e-02, -4.4379e-02, -4.9027e-02,
        -7.8554e-02,  2.5327e-02, -4.3609e-03,  3.7068e-02, -3.8550e-06,
        -6.5443e-02, -5.7604e-02, -3.8054e-02, -1.7843e-02,  6.9119e-03,
         1.5802e-02,  1.8933e-02,  6.7414e-02, -1.1061e-01,  1.9059e-03,
        -1.6043e-02,  7.6904e-03,  5.7968e-02, -4.1006e-02, -3.7262e-03,
        -2.9828e-03,  2.4841e-02,  6.5012e-05, -4.0827e-02, -3.5724e-02,
        -9.6471e-02, -2.0167e-02, -3.3406e-04, -3.6332e-02,  6.5176e-03,
        -4.0017e-02,  1.5725e-03, -3.0873e-02,  5.8116e-02,  2.2398e-02,
        -6.7994e-03, -6.8602e-04,  6.0943e-02,  2.3269e-02,  3.7727e-02,
         7.5994e-02,  3.0521e-02, -1.6220e-02, -3.8542e-02,  3.4156e-02,
         2.7060e-02,  1.3066e-02,  1.6368e-02,  5.3027e-02, -4.4501e-02,
        -2.1472e-02, -1.3734e-02,  5.8894e-03, -2.4139e-02, -2.6726e-02,
        -5.6890e-02,  6.6193e-03,  9.4316e-02, -3.2171e-02, -2.3803e-06,
        -1.2091e-02,  8.8780e-03,  1.4921e-02,  2.5440e-02, -1.5491e-02,
        -3.0091e-02, -5.5825e-02,  9.1901e-03, -5.9180e-02,  1.1661e-02,
        -3.0019e-02, -4.7976e-02,  1.1385e-02, -6.9137e-03,  2.3995e-02,
         2.7941e-02,  2.4498e-02, -1.0351e-02, -4.3349e-02,  7.7249e-03,
        -3.0570e-02, -2.9988e-02, -1.8200e-02,  3.6112e-02,  2.5598e-02,
         6.2345e-02,  1.4762e-02,  1.5178e-01, -9.2084e-03, -1.1476e-02,
        -3.4979e-02,  4.0679e-02,  1.5281e-02, -1.2759e-02, -1.0466e-02,
         4.1242e-03, -3.2394e-03, -5.3684e-02,  7.8090e-03, -9.4085e-03,
        -1.0666e-02, -3.9776e-02, -9.8718e-03, -3.3893e-03, -1.8691e-02,
         9.5208e-04, -3.7684e-02, -2.0172e-02,  1.7204e-02,  1.7334e-02,
        -7.9879e-03, -5.5482e-02, -1.0215e-02,  3.2111e-02, -2.9230e-02,
        -1.7670e-02, -1.7985e-02, -3.7312e-03,  1.7666e-02,  2.2009e-02,
         3.8965e-01, -1.3682e-01,  2.6812e-02,  1.2042e-02, -1.3089e-02,
         2.9757e-02, -5.6237e-02,  8.0396e-03, -1.5313e-02, -6.9553e-02,
         1.2401e-02,  4.0304e-02,  2.2683e-02, -2.4653e-02,  1.5255e-02,
         8.7499e-04, -3.8410e-02, -4.2224e-02,  1.6346e-02,  1.6192e-02,
         1.6698e-02, -1.2258e-02, -2.0819e-02, -1.1988e-02, -1.3016e-02,
         2.2879e-02, -1.4646e-02, -8.4465e-03, -4.3000e-02, -3.3566e-02,
        -1.8905e-02, -1.0056e-02, -3.5868e-02, -8.5021e-04, -8.8192e-03,
        -4.6484e-02,  7.6075e-03, -1.8060e-02,  2.7247e-02, -9.9610e-04,
         1.3227e-02,  3.2648e-02, -2.1727e-02,  2.4797e-02, -9.5319e-03,
        -2.1957e-02, -1.6564e-02, -6.4819e-02, -1.6899e-02, -4.6343e-02,
        -3.8108e-02,  1.5312e-03,  3.1790e-03,  4.5621e-02,  1.9681e-02,
        -1.4726e-02,  8.2733e-03, -5.7023e-02, -6.2827e-02, -5.4959e-02,
         3.5798e-02, -5.5203e-03,  8.4993e-03, -2.3143e-02, -8.6279e-03,
        -1.0514e-02, -1.2968e-02,  9.0703e-03, -4.8191e-02,  9.1795e-03,
         1.1560e-02,  1.2258e-02, -3.0939e-02,  1.1322e-02, -3.1486e-02,
         4.2925e-02,  6.2821e-03,  2.6666e-03, -1.4268e-02, -4.2714e-03,
        -5.6609e-02,  2.8412e-02, -1.0237e-02,  4.3278e-02,  2.5974e-02,
         3.1510e-02, -4.3529e-02, -2.2913e-02,  3.8666e-02, -3.2297e-02,
        -8.9667e-02, -3.3109e-02,  4.8496e-02,  2.6259e-02, -2.3996e-02,
        -3.9926e-02, -7.6856e-02,  8.2030e-03,  1.1804e-02,  4.4597e-02,
         4.3117e-03, -1.7363e-02,  3.7144e-02, -1.6673e-02,  4.9670e-03,
        -5.6515e-02,  3.7047e-03, -7.0510e-03,  3.9612e-02,  1.4821e-02,
        -6.9157e-03, -1.7684e-02, -1.4651e-02, -2.4374e-02, -2.0148e-02,
        -3.1956e-02,  6.0061e-03, -1.5365e-03,  5.3619e-02, -2.3380e-03,
        -2.2922e-02,  4.0789e-02, -4.1029e-03, -1.6956e-02,  3.6535e-02,
        -3.6116e-02, -1.5772e-02,  3.6389e-02, -3.4437e-02, -4.1383e-02,
         5.8127e-02, -7.9410e-02, -4.2317e-02, -3.8554e-03, -2.5904e-02,
        -2.1792e-02,  3.3975e-03,  1.3812e-03,  2.3255e-02,  5.9289e-02,
        -3.1955e-02, -4.0463e-02,  2.8012e-02, -8.5901e-03, -7.2443e-03,
        -3.9243e-02,  1.2748e-02, -2.5475e-02,  8.5355e-03,  5.7879e-03,
        -1.1372e-02, -2.4481e-02,  2.0457e-02,  1.1410e-02,  1.4622e-02,
         5.4081e-03, -3.5330e-02, -6.1382e-02,  3.3591e-02,  2.5271e-02,
         1.6216e-02, -7.1272e-02,  1.3496e-02, -4.5924e-02,  8.3414e-02,
        -3.9931e-02,  2.0116e-02,  9.9352e-03,  8.9289e-03, -1.0567e-01,
        -6.3408e-03, -3.9092e-02, -3.8365e-02, -2.9776e-02, -8.6762e-03,
         4.3066e-02,  3.6110e-02, -1.6252e-02,  5.4129e-03, -1.9620e-02,
         1.7900e-02, -1.6529e-03, -2.6478e-02,  2.5508e-03,  9.5109e-05,
         5.5545e-02,  7.2073e-03, -3.7370e-02,  2.8174e-02,  1.1509e-02,
         1.7258e-02,  1.2380e-02,  1.3654e-02, -2.1472e-03,  1.8072e-02,
        -1.4577e-02, -5.4192e-02,  7.9954e-03,  1.9097e-02,  1.1464e-02,
        -4.2715e-02, -1.0692e-02,  2.3506e-04,  9.4854e-03,  2.0964e-02,
        -4.8571e-02, -1.3288e-02,  2.9523e-02,  1.3493e-02,  8.7165e-03,
        -4.6690e-03, -1.7967e-02, -2.1272e-02, -1.9726e-02, -2.8314e-02,
        -1.8763e-02, -3.5048e-02, -1.6598e-02, -5.0202e-02,  1.6072e-02,
        -2.0860e-02, -1.8131e-02, -1.3158e-02,  4.5078e-03, -4.1402e-02,
        -4.6558e-02,  3.7682e-03, -2.3238e-02,  2.7712e-02, -4.7610e-02,
        -3.6191e-03, -4.8368e-02, -4.4029e-02, -1.1885e-03,  2.6725e-04,
         2.5928e-02, -3.3785e-02, -1.0521e-01, -1.0056e-02,  3.2818e-03,
         3.0349e-02,  9.0747e-03, -9.9292e-03,  2.4667e-02,  1.1890e-02,
        -6.0193e-02,  1.2056e-02, -4.5381e-03,  7.9724e-03,  1.6313e-03,
         2.2329e-02, -7.7473e-03,  1.6099e-02,  1.5690e-02,  2.7822e-02,
        -3.1694e-02, -3.1183e-02,  1.1989e-02,  4.7226e-02,  1.2262e-02,
         6.3635e-02, -6.8493e-02, -4.4452e-02, -1.7944e-02,  2.8958e-02,
         1.6682e-02, -1.7033e-02,  1.2119e-02,  2.0903e-03, -7.3647e-04,
         3.3722e-02,  3.4892e-03,  1.8932e-02,  3.4184e-02, -1.7955e-02,
        -4.1366e-03, -9.2835e-02,  3.6266e-04, -4.1372e-02, -5.3483e-03,
         1.7711e-02, -1.8631e-02, -3.5733e-03,  3.9939e-02,  4.9810e-03,
        -9.8418e-03, -7.3381e-02, -1.5184e-02], device='cuda:0',
       grad_fn=<DivBackward0>)
2025-01-23 21:00:05,540 [INFO] Example prompt: What really matters is that they know
2025-01-23 21:00:05,540 [INFO] Generating texts **without** steering... 
2025-01-23 21:00:06,829 [INFO] prompt:*****
What really matters is that they know
2025-01-23 21:00:06,829 [INFO] Generated Text: 1:
 what they're doing. They know what the risks are, and they know how to protect themselves."

A report by the International Institute for Strategic Studies (IISS) found that "the number of people who have been killed in Syria has increased
2025-01-23 21:00:06,829 [INFO] Generated Text: 2:
 what's going on.

"I think we're all going to be very happy with the outcome," he said. "It's a big step forward for us and hopefully it will help us get better."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-23 21:00:06,829 [INFO] Generated Text: 3:
 what they're doing.

The rest of us have to be aware of the fact that we're not always in control. We have to be able to see our own needs and priorities, but we also have to be able to make decisions about
2025-01-23 21:00:06,830 [INFO] 干预之后的结果
2025-01-23 21:00:06,830 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-23 21:00:06,830 [INFO] ** Generating texts with steering... Target **
2025-01-23 21:00:06,830 [INFO] form neg to pos
2025-01-23 21:00:07,729 [INFO] prompt:*****
What really matters is that they know
2025-01-23 21:00:07,730 [INFO] Generated Text: 1:
 what they're doing and what they're doing well.

"I think it's important to understand the role of this team in helping us win, but I also think it's important to understand how we can help them win."<|endoftext|><|endoftext|><|endoftext|>
2025-01-23 21:00:07,730 [INFO] Generated Text: 2:
 how to play, but they don't know how to win. They're not good at it. They're not good at winning."

"I think the biggest thing is that I'm just going to keep playing and try and get better every
2025-01-23 21:00:07,730 [INFO] Generated Text: 3:
 what they're doing and how to do it.

"I think the most important thing is to keep it simple, but I think you can do it with a little bit of practice."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-23 21:00:07,734 [INFO] Show Hyperparameters: 


2025-01-23 21:00:07,734 [INFO]   task: sentiment
2025-01-23 21:00:07,734 [INFO]   layer: 6
2025-01-23 21:00:07,734 [INFO]   LLM: gpt2-small
2025-01-23 21:00:07,735 [INFO]   seed: 42
2025-01-23 21:00:07,735 [INFO]   data_size: 1000
2025-01-23 21:00:07,735 [INFO]   device: cuda
2025-01-23 21:00:07,735 [INFO]   alpha: 400
2025-01-23 21:00:07,735 [INFO]   method: val_mul
2025-01-23 21:00:07,735 [INFO]   topk_mean: 100
2025-01-23 21:00:07,735 [INFO]   topk_cnt: 100
2025-01-23 21:00:07,735 [INFO]   batch_size: 16
2025-01-23 21:00:07,735 [INFO]   source: neg
2025-01-23 21:00:07,735 [INFO]   target: pos
2025-01-23 21:00:07,735 [INFO]   mean_type: dif_mean
2025-01-23 21:00:07,735 [INFO]   steer_type: last
2025-01-23 21:00:07,735 [INFO]   output_dir: ./results/sentiment/
2025-01-23 21:00:07,735 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 21:00:07,735 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 21:00:07,735 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 21:00:07,735 [INFO]   temperature: 0.9
2025-01-23 21:00:07,735 [INFO]   top_p: 0.3
2025-01-23 21:00:07,735 [INFO]   freq_penalty: 1.0
2025-01-23 21:00:07,735 [INFO]   debug: 1
2025-01-23 21:00:07,735 [INFO]   save_no_steer: 1
2025-01-23 21:00:07,735 [INFO]   cache_delta_matrix: 0
2025-01-23 21:00:07,735 [INFO]   is_norm_delta_matrix: 1
2025-01-23 21:00:07,735 [INFO] debug mode,show example, no full dataset eval
2025-02-05 13:15:42,969 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-02-05 13:15:42,969 [INFO] Show Hyperparameters: 


2025-02-05 13:15:42,969 [INFO]   task: sentiment
2025-02-05 13:15:42,969 [INFO]   layer: 6
2025-02-05 13:15:42,969 [INFO]   LLM: gpt2-small
2025-02-05 13:15:42,969 [INFO]   seed: 42
2025-02-05 13:15:42,969 [INFO]   data_size: 1000
2025-02-05 13:15:42,969 [INFO]   device: cuda
2025-02-05 13:15:42,969 [INFO]   alpha: 400
2025-02-05 13:15:42,969 [INFO]   method: val_mul
2025-02-05 13:15:42,969 [INFO]   topk_mean: 100
2025-02-05 13:15:42,969 [INFO]   topk_cnt: 100
2025-02-05 13:15:42,969 [INFO]   batch_size: 16
2025-02-05 13:15:42,969 [INFO]   source: neg
2025-02-05 13:15:42,969 [INFO]   target: pos
2025-02-05 13:15:42,969 [INFO]   mean_type: dif_mean
2025-02-05 13:15:42,969 [INFO]   steer_type: last
2025-02-05 13:15:42,970 [INFO]   output_dir: ./results/sentiment/
2025-02-05 13:15:42,970 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 13:15:42,970 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 13:15:42,970 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 13:15:42,970 [INFO]   temperature: 0.9
2025-02-05 13:15:42,970 [INFO]   top_p: 0.3
2025-02-05 13:15:42,970 [INFO]   freq_penalty: 1.0
2025-02-05 13:15:42,970 [INFO]   debug: 1
2025-02-05 13:15:42,970 [INFO]   save_no_steer: 1
2025-02-05 13:15:42,970 [INFO]   cache_delta_matrix: 0
2025-02-05 13:15:42,970 [INFO]   is_norm_delta_matrix: 0
2025-02-05 13:15:42,970 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-05 13:15:42,970 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 13:15:42,970 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-05 13:15:42,971 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-05 13:15:43,078 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-05 13:15:43,086 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-02-05 13:15:43,086 [INFO] Loading model: gpt2-small
2025-02-05 13:15:45,737 [INFO] Loading SAE for layer 6
2025-02-05 13:15:47,945 [INFO] fromnegtopos
2025-02-05 13:15:47,945 [INFO] positive
2025-02-05 13:15:47,949 [INFO] Running model with cache to obtain hidden states
2025-02-05 13:15:50,176 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 13:15:50,177 [INFO] negative
2025-02-05 13:15:50,182 [INFO] Running model with cache to obtain hidden states
2025-02-05 13:15:52,462 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 13:15:52,462 [INFO] neutral
2025-02-05 13:15:52,466 [INFO] Running model with cache to obtain hidden states
2025-02-05 13:15:54,717 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-05 13:15:54,730 [INFO] 转向方向 dif_pos-neg_relu
2025-02-05 13:15:54,802 [INFO] delta_matrix: tensor([ 3.0888e-02, -6.2639e-02, -1.6661e-01,  2.3605e-02, -1.2572e-01,
        -2.1179e-02, -1.0273e-01,  1.3011e-01,  2.5184e-01, -7.0054e-02,
         5.6284e-02,  9.7999e-02,  1.4039e-01,  3.6514e-02,  1.5593e-01,
        -1.5877e-02, -1.0351e-01, -8.9507e-02,  1.8477e-01, -5.7356e-02,
         7.8928e-02, -7.0140e-02,  2.0649e-01,  1.5444e-02, -2.2785e-02,
         1.1024e-01, -2.2321e-02, -1.0862e-01, -8.8605e-02, -8.6892e-02,
        -4.0767e-02, -1.5344e-01, -5.7334e-02, -9.1498e-03, -4.6242e-02,
         9.8943e-03,  1.1844e-02, -3.9115e-02, -1.9498e-01,  4.8062e-02,
        -2.1581e-01, -1.3162e-01,  3.4685e-02, -7.2280e-02, -2.7096e-01,
         1.0563e-01,  7.5124e-04, -1.5717e-01, -6.2155e-02, -4.5794e-02,
        -8.4208e-02,  1.4807e-02,  8.8036e-02, -1.6108e-01,  4.4228e-02,
         1.1845e-01, -5.3487e-03,  2.2103e-01,  1.0063e-01,  1.9117e-02,
        -1.1569e-01, -8.7440e-02, -8.3092e-02,  1.1429e-01, -9.6181e-02,
         2.0174e-01, -8.2830e-04, -1.6519e-01, -1.0369e-01,  4.8204e-02,
        -5.1908e-02,  1.1438e-01,  8.7770e-02, -9.6351e-02,  9.4352e-03,
        -1.7336e-01, -5.2833e-02,  4.3417e-02, -1.0579e-01, -1.6599e-01,
         1.3195e-01,  2.7896e-02, -1.4130e-01, -8.0827e-02,  1.1534e-01,
         1.4044e-01, -1.4980e-01,  1.9567e-01, -2.8819e-02, -1.1131e-01,
         2.6287e-02, -1.0680e-01,  3.5394e-02,  7.7980e-02,  6.6789e-02,
         1.3268e-01, -1.8721e-01, -1.2219e-01,  2.8529e-02,  1.0752e-01,
         2.3081e-02,  1.3322e-01, -6.4270e-02, -6.7131e-02, -6.3369e-02,
         1.2527e-01, -5.9917e-02, -1.1493e-01,  5.6245e-02, -5.6666e-02,
        -2.0789e-02, -4.5559e-02, -4.9555e-02, -5.3522e-02, -1.1698e-01,
         3.3633e-02, -3.0952e-01,  4.4165e-02, -2.0934e-02,  5.2328e-02,
        -1.5332e-01, -7.3435e-02, -2.1549e-02,  4.1343e-02,  5.3329e-02,
        -2.7260e-01,  5.3867e-03,  2.7483e-02,  1.5878e-01, -4.0455e-02,
        -1.3919e-01,  1.5066e-01, -2.0085e-01, -2.1310e-01,  4.0698e-02,
         1.9067e-01, -7.5057e-02,  9.6844e-02, -4.8283e-02, -1.1552e-02,
        -6.0581e-02, -5.9109e-02, -2.9354e-02, -8.9749e-02,  8.3219e-02,
        -5.8136e-02, -4.4262e-02,  4.4817e-02, -1.4460e-01, -2.7021e-03,
        -1.0678e-01,  9.8303e-02,  5.0896e-03,  8.9510e-02, -6.4631e-02,
        -8.0406e-02, -8.9915e-02,  9.3388e-02, -1.4252e-02,  1.2228e-01,
        -1.8443e-02, -1.9626e-01,  6.1950e-02,  1.8008e-01, -9.0695e-02,
         7.7747e-02,  1.4760e-01, -9.0091e-02, -4.9581e-02, -4.4953e-02,
         6.7040e-03,  1.4424e-02, -3.2216e-02, -3.1004e-04, -1.6481e-01,
         6.2728e-02, -8.2905e-02,  5.5504e-02,  5.7458e-02,  3.5452e-02,
        -4.0978e-02, -8.1327e-02,  1.4530e-01, -7.0003e-02, -1.8835e-01,
         5.0448e-03,  7.5764e-02,  7.9504e-02,  3.9663e-03, -5.1270e-02,
         5.0058e-02,  1.0866e-01, -3.2854e-02, -1.2653e-01, -6.6065e-02,
         1.0823e-01, -8.4905e-02, -1.1175e-01,  1.3599e-02, -4.5771e-02,
        -2.8372e-02, -1.0187e-01, -2.2375e-01,  3.1422e-01,  2.4912e-02,
         5.3387e-02,  4.0845e-02,  4.8352e-02,  2.3556e-01,  2.6840e-02,
         1.8980e-02,  2.4568e-02, -9.8581e-02,  6.8308e-02, -8.0541e-02,
        -1.4766e-01,  8.6936e-02, -1.7110e-01, -9.9930e-02,  1.0173e-01,
        -1.5403e-01,  1.6871e-01,  3.5880e-02, -4.2781e-02, -6.4355e-02,
         4.6986e-02,  3.2372e-02, -4.9535e-02, -7.5940e-03, -1.8462e-01,
        -9.4918e-02,  7.0404e-02, -7.7908e-02,  2.0075e-01,  2.7035e-02,
        -2.4072e-01,  1.2914e-01, -1.0309e-01, -1.2592e-02,  1.3759e-01,
         2.4056e-01,  6.0722e-02, -6.0673e-02,  4.3027e-02,  7.4803e-02,
        -2.0671e-01,  8.0731e-02,  2.4973e-02, -5.0077e-02, -1.9860e-02,
        -1.0118e-01, -7.1050e-02,  5.4676e-02, -2.3609e-01, -2.5359e-02,
         7.4726e-02,  1.6082e-02, -3.8664e-02,  1.3528e-02,  5.5832e-02,
        -2.9058e-02,  4.6718e-02,  9.0601e-02, -5.3763e-02,  1.4072e-01,
         1.2215e-01,  4.4330e-01,  1.4081e-01, -2.2586e-01, -7.8861e-03,
        -3.8609e-01,  9.5965e-02,  8.5975e-03, -1.2769e-01, -1.0395e-01,
        -1.2366e-01,  1.9354e-01,  7.6472e-02, -7.3591e-02, -9.2708e-02,
        -8.4588e-02, -1.7702e-01,  1.0734e-04, -1.7656e-01,  1.2443e-01,
        -1.0190e-01, -5.4777e-02, -1.0070e-01,  4.4075e-02, -3.6754e-01,
        -4.3267e-02, -1.7139e-01,  1.9671e-01, -6.3036e-02,  1.5789e-01,
         1.4540e-01, -5.7580e-02, -7.4755e-02, -1.6415e-01,  5.3382e-02,
        -9.9863e-02, -1.4429e-01,  2.0605e-01, -1.2000e-01, -8.0676e-02,
        -1.1914e-01, -2.0116e-01,  4.5787e-02, -1.3692e-01, -4.5739e-02,
         2.3829e-02,  3.5952e-02,  5.6194e-02,  2.7977e-02, -4.5631e-01,
        -1.6418e-01, -1.5234e-01,  4.4282e-02, -1.5157e-01,  2.0227e-02,
         4.0745e-02,  1.1851e-01, -7.4688e-02,  1.6635e-02, -1.0089e-01,
         1.7843e-02,  4.0557e-02, -1.5132e-01,  4.5451e-02,  2.0036e-02,
         1.8685e-01, -1.4045e-01, -5.8197e-02, -1.6841e-02,  1.4615e-02,
         4.9825e-02, -1.1104e-01,  1.1454e-01, -6.6449e-03, -1.5113e-01,
         3.3472e-03, -1.9786e-01,  2.2481e-01, -1.0141e-01, -3.6287e-02,
        -7.1673e-03, -8.1765e-02, -5.5669e-02, -7.2089e-02, -6.1842e-02,
        -2.0049e-01, -6.1023e-02, -2.2923e-02,  1.1847e-01, -8.9269e-02,
        -6.2769e-02,  1.1204e-01, -8.4981e-02, -1.5750e-01, -1.7400e-01,
        -2.7879e-01,  8.9884e-02, -1.5477e-02,  1.3155e-01, -1.3681e-05,
        -2.3226e-01, -2.0444e-01, -1.3505e-01, -6.3326e-02,  2.4530e-02,
         5.6083e-02,  6.7194e-02,  2.3925e-01, -3.9255e-01,  6.7641e-03,
        -5.6936e-02,  2.7293e-02,  2.0573e-01, -1.4553e-01, -1.3224e-02,
        -1.0586e-02,  8.8162e-02,  2.3073e-04, -1.4489e-01, -1.2678e-01,
        -3.4238e-01, -7.1573e-02, -1.1856e-03, -1.2894e-01,  2.3131e-02,
        -1.4202e-01,  5.5807e-03, -1.0957e-01,  2.0625e-01,  7.9489e-02,
        -2.4131e-02, -2.4347e-03,  2.1629e-01,  8.2582e-02,  1.3389e-01,
         2.6970e-01,  1.0832e-01, -5.7564e-02, -1.3679e-01,  1.2122e-01,
         9.6037e-02,  4.6373e-02,  5.8091e-02,  1.8819e-01, -1.5793e-01,
        -7.6205e-02, -4.8742e-02,  2.0902e-02, -8.5669e-02, -9.4852e-02,
        -2.0190e-01,  2.3492e-02,  3.3472e-01, -1.1417e-01, -8.4476e-06,
        -4.2911e-02,  3.1508e-02,  5.2955e-02,  9.0288e-02, -5.4976e-02,
        -1.0679e-01, -1.9812e-01,  3.2615e-02, -2.1003e-01,  4.1386e-02,
        -1.0654e-01, -1.7027e-01,  4.0404e-02, -2.4537e-02,  8.5157e-02,
         9.9160e-02,  8.6943e-02, -3.6735e-02, -1.5384e-01,  2.7416e-02,
        -1.0849e-01, -1.0643e-01, -6.4591e-02,  1.2816e-01,  9.0847e-02,
         2.2126e-01,  5.2390e-02,  5.3865e-01, -3.2680e-02, -4.0729e-02,
        -1.2414e-01,  1.4437e-01,  5.4233e-02, -4.5283e-02, -3.7145e-02,
         1.4637e-02, -1.1497e-02, -1.9052e-01,  2.7714e-02, -3.3391e-02,
        -3.7853e-02, -1.4117e-01, -3.5035e-02, -1.2029e-02, -6.6335e-02,
         3.3789e-03, -1.3374e-01, -7.1592e-02,  6.1058e-02,  6.1518e-02,
        -2.8349e-02, -1.9690e-01, -3.6252e-02,  1.1396e-01, -1.0374e-01,
        -6.2710e-02, -6.3830e-02, -1.3242e-02,  6.2697e-02,  7.8110e-02,
         1.3829e+00, -4.8557e-01,  9.5154e-02,  4.2738e-02, -4.6452e-02,
         1.0561e-01, -1.9959e-01,  2.8533e-02, -5.4346e-02, -2.4684e-01,
         4.4009e-02,  1.4304e-01,  8.0503e-02, -8.7492e-02,  5.4139e-02,
         3.1053e-03, -1.3632e-01, -1.4985e-01,  5.8011e-02,  5.7465e-02,
         5.9259e-02, -4.3503e-02, -7.3886e-02, -4.2544e-02, -4.6192e-02,
         8.1196e-02, -5.1979e-02, -2.9976e-02, -1.5261e-01, -1.1913e-01,
        -6.7094e-02, -3.5690e-02, -1.2730e-01, -3.0174e-03, -3.1299e-02,
        -1.6497e-01,  2.6999e-02, -6.4094e-02,  9.6699e-02, -3.5351e-03,
         4.6943e-02,  1.1587e-01, -7.7108e-02,  8.8003e-02, -3.3829e-02,
        -7.7925e-02, -5.8784e-02, -2.3004e-01, -5.9975e-02, -1.6447e-01,
        -1.3524e-01,  5.4343e-03,  1.1282e-02,  1.6191e-01,  6.9848e-02,
        -5.2264e-02,  2.9362e-02, -2.0237e-01, -2.2297e-01, -1.9505e-01,
         1.2705e-01, -1.9592e-02,  3.0164e-02, -8.2134e-02, -3.0620e-02,
        -3.7315e-02, -4.6023e-02,  3.2191e-02, -1.7103e-01,  3.2578e-02,
         4.1028e-02,  4.3505e-02, -1.0980e-01,  4.0180e-02, -1.1174e-01,
         1.5234e-01,  2.2295e-02,  9.4638e-03, -5.0636e-02, -1.5159e-02,
        -2.0090e-01,  1.0084e-01, -3.6331e-02,  1.5359e-01,  9.2181e-02,
         1.1183e-01, -1.5448e-01, -8.1317e-02,  1.3723e-01, -1.1462e-01,
        -3.1823e-01, -1.1750e-01,  1.7211e-01,  9.3192e-02, -8.5163e-02,
        -1.4170e-01, -2.7276e-01,  2.9112e-02,  4.1893e-02,  1.5827e-01,
         1.5302e-02, -6.1621e-02,  1.3182e-01, -5.9171e-02,  1.7628e-02,
        -2.0057e-01,  1.3148e-02, -2.5024e-02,  1.4058e-01,  5.2598e-02,
        -2.4544e-02, -6.2760e-02, -5.1996e-02, -8.6501e-02, -7.1506e-02,
        -1.1341e-01,  2.1316e-02, -5.4531e-03,  1.9029e-01, -8.2974e-03,
        -8.1350e-02,  1.4476e-01, -1.4561e-02, -6.0178e-02,  1.2966e-01,
        -1.2818e-01, -5.5975e-02,  1.2914e-01, -1.2221e-01, -1.4687e-01,
         2.0629e-01, -2.8183e-01, -1.5018e-01, -1.3683e-02, -9.1933e-02,
        -7.7340e-02,  1.2058e-02,  4.9019e-03,  8.2531e-02,  2.1041e-01,
        -1.1341e-01, -1.4360e-01,  9.9415e-02, -3.0486e-02, -2.5710e-02,
        -1.3927e-01,  4.5243e-02, -9.0411e-02,  3.0292e-02,  2.0541e-02,
        -4.0359e-02, -8.6882e-02,  7.2603e-02,  4.0494e-02,  5.1894e-02,
         1.9193e-02, -1.2538e-01, -2.1784e-01,  1.1921e-01,  8.9687e-02,
         5.7549e-02, -2.5294e-01,  4.7897e-02, -1.6299e-01,  2.9604e-01,
        -1.4172e-01,  7.1392e-02,  3.5260e-02,  3.1688e-02, -3.7502e-01,
        -2.2503e-02, -1.3874e-01, -1.3616e-01, -1.0567e-01, -3.0792e-02,
         1.5284e-01,  1.2815e-01, -5.7677e-02,  1.9210e-02, -6.9632e-02,
         6.3526e-02, -5.8660e-03, -9.3969e-02,  9.0527e-03,  3.3754e-04,
         1.9713e-01,  2.5578e-02, -1.3262e-01,  9.9988e-02,  4.0847e-02,
         6.1248e-02,  4.3937e-02,  4.8457e-02, -7.6204e-03,  6.4137e-02,
        -5.1733e-02, -1.9233e-01,  2.8375e-02,  6.7774e-02,  4.0686e-02,
        -1.5159e-01, -3.7946e-02,  8.3424e-04,  3.3664e-02,  7.4401e-02,
        -1.7238e-01, -4.7158e-02,  1.0478e-01,  4.7886e-02,  3.0935e-02,
        -1.6570e-02, -6.3766e-02, -7.5495e-02, -7.0007e-02, -1.0049e-01,
        -6.6588e-02, -1.2439e-01, -5.8905e-02, -1.7817e-01,  5.7041e-02,
        -7.4032e-02, -6.4346e-02, -4.6698e-02,  1.5998e-02, -1.4694e-01,
        -1.6523e-01,  1.3373e-02, -8.2470e-02,  9.8349e-02, -1.6897e-01,
        -1.2844e-02, -1.7166e-01, -1.5626e-01, -4.2178e-03,  9.4846e-04,
         9.2018e-02, -1.1990e-01, -3.7337e-01, -3.5687e-02,  1.1647e-02,
         1.0771e-01,  3.2206e-02, -3.5239e-02,  8.7542e-02,  4.2197e-02,
        -2.1362e-01,  4.2787e-02, -1.6106e-02,  2.8294e-02,  5.7893e-03,
         7.9246e-02, -2.7495e-02,  5.7134e-02,  5.5684e-02,  9.8738e-02,
        -1.1248e-01, -1.1067e-01,  4.2548e-02,  1.6760e-01,  4.3519e-02,
         2.2584e-01, -2.4308e-01, -1.5776e-01, -6.3683e-02,  1.0277e-01,
         5.9205e-02, -6.0449e-02,  4.3010e-02,  7.4184e-03, -2.6137e-03,
         1.1968e-01,  1.2383e-02,  6.7188e-02,  1.2132e-01, -6.3721e-02,
        -1.4681e-02, -3.2947e-01,  1.2871e-03, -1.4683e-01, -1.8981e-02,
         6.2858e-02, -6.6121e-02, -1.2681e-02,  1.4174e-01,  1.7677e-02,
        -3.4928e-02, -2.6043e-01, -5.3889e-02], device='cuda:0',
       grad_fn=<AddBackward0>)
2025-02-05 13:15:54,802 [INFO] Example prompt: What really matters is that they know
2025-02-05 13:15:54,803 [INFO] Generating texts **without** steering... 
2025-02-05 13:15:56,317 [INFO] prompt:*****
What really matters is that they know
2025-02-05 13:15:56,317 [INFO] Generated Text: 1:
 how to use it.

The key is to have a plan for the future. It's not about having a plan, it's about having an idea of what you want to do with your life. And if you don't have a plan
2025-02-05 13:15:56,317 [INFO] Generated Text: 2:
 what's going on.

"They're just trying to keep the game going and keep the team together," said Johnson, who has been a member of both teams since his freshman year at Texas A&M. "I think we're going
2025-02-05 13:15:56,317 [INFO] Generated Text: 3:
 how to make a living, and the people who are doing it.

The company has already raised $1 million in funding from investors including Facebook, Twitter and PayPal. The startup has been backed by the US government, and is currently in talks
2025-02-05 13:15:56,318 [INFO] 干预之后的结果
2025-02-05 13:15:56,318 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-05 13:15:56,318 [INFO] ** Generating texts with steering... Target **
2025-02-05 13:15:56,318 [INFO] form neg to pos
2025-02-05 13:15:57,256 [INFO] prompt:*****
What really matters is that they know
2025-02-05 13:15:57,256 [INFO] Generated Text: 1:
 what you're going but it's just so much fun to watch and learn.

I'm so glad you've decided but I'm not sure if it's a good idea but I hope this is an easy but fun way to get your feet
2025-02-05 13:15:57,256 [INFO] Generated Text: 2:
 but can't do it because they're so busy. But I think it's a great idea and you can make a great but but if you don't do it then then you're just not going to be able to make the cut.


2025-02-05 13:15:57,256 [INFO] Generated Text: 3:
 what they're doing but it's so hard to explain why but I think it's just a good thing and it's a great idea.

This is just an but but, but you can make this because I love this recipe and you can
2025-02-05 13:15:57,263 [INFO] Show Hyperparameters: 


2025-02-05 13:15:57,263 [INFO]   task: sentiment
2025-02-05 13:15:57,263 [INFO]   layer: 6
2025-02-05 13:15:57,263 [INFO]   LLM: gpt2-small
2025-02-05 13:15:57,263 [INFO]   seed: 42
2025-02-05 13:15:57,263 [INFO]   data_size: 1000
2025-02-05 13:15:57,263 [INFO]   device: cuda
2025-02-05 13:15:57,263 [INFO]   alpha: 400
2025-02-05 13:15:57,263 [INFO]   method: val_mul
2025-02-05 13:15:57,263 [INFO]   topk_mean: 100
2025-02-05 13:15:57,263 [INFO]   topk_cnt: 100
2025-02-05 13:15:57,263 [INFO]   batch_size: 16
2025-02-05 13:15:57,263 [INFO]   source: neg
2025-02-05 13:15:57,263 [INFO]   target: pos
2025-02-05 13:15:57,263 [INFO]   mean_type: dif_mean
2025-02-05 13:15:57,263 [INFO]   steer_type: last
2025-02-05 13:15:57,263 [INFO]   output_dir: ./results/sentiment/
2025-02-05 13:15:57,263 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-05 13:15:57,263 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-05 13:15:57,263 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-05 13:15:57,263 [INFO]   temperature: 0.9
2025-02-05 13:15:57,263 [INFO]   top_p: 0.3
2025-02-05 13:15:57,263 [INFO]   freq_penalty: 1.0
2025-02-05 13:15:57,263 [INFO]   debug: 1
2025-02-05 13:15:57,264 [INFO]   save_no_steer: 1
2025-02-05 13:15:57,264 [INFO]   cache_delta_matrix: 0
2025-02-05 13:15:57,264 [INFO]   is_norm_delta_matrix: 0
2025-02-05 13:15:57,264 [INFO] debug mode,show example, no full dataset eval
