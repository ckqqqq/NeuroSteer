2025-02-16 11:28:08,160 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_150.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:28:08,160 [INFO] Show Hyperparameters: 


2025-02-16 11:28:08,161 [INFO]   task: sentiment
2025-02-16 11:28:08,161 [INFO]   layer: 6
2025-02-16 11:28:08,161 [INFO]   LLM: gpt2-small
2025-02-16 11:28:08,161 [INFO]   seed: 42
2025-02-16 11:28:08,161 [INFO]   data_size: -1
2025-02-16 11:28:08,161 [INFO]   device: cuda
2025-02-16 11:28:08,161 [INFO]   alpha: 150.0
2025-02-16 11:28:08,161 [INFO]   method: val_mul
2025-02-16 11:28:08,161 [INFO]   topk_mean: 100
2025-02-16 11:28:08,161 [INFO]   topk_cnt: 150
2025-02-16 11:28:08,161 [INFO]   batch_size: 32
2025-02-16 11:28:08,161 [INFO]   source: pos
2025-02-16 11:28:08,161 [INFO]   target: neg
2025-02-16 11:28:08,161 [INFO]   prompt_source: neg
2025-02-16 11:28:08,161 [INFO]   prompt_data_size: -1
2025-02-16 11:28:08,161 [INFO]   mean_type: dif_mean
2025-02-16 11:28:08,161 [INFO]   steer_type: all
2025-02-16 11:28:08,161 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:28:08,161 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:28:08,161 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:28:08,161 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:28:08,161 [INFO]   temperature: 0.9
2025-02-16 11:28:08,161 [INFO]   top_p: 0.3
2025-02-16 11:28:08,161 [INFO]   freq_penalty: 1.0
2025-02-16 11:28:08,161 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:28:08,161 [INFO]   debug: 1
2025-02-16 11:28:08,161 [INFO]   save_no_steer: 1
2025-02-16 11:28:08,161 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:28:08,161 [INFO]   use_cache: 0
2025-02-16 11:28:08,161 [INFO]   repeat_num: 2
2025-02-16 11:28:08,161 [INFO]   gen_batch_size: 16
2025-02-16 11:28:08,162 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:28:08,162 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:28:08,162 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:28:08,162 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:28:08,286 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:28:08,291 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:28:08,291 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:28:08,291 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:28:13,081 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:28:13,081 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:28:13,102 [INFO] :>> sentiment : from pos to neg
2025-02-16 11:28:13,116 [INFO] positive
2025-02-16 11:28:13,122 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:28:15,739 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:28:15,740 [INFO] negative
2025-02-16 11:28:15,753 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:28:18,170 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:28:18,173 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:28:18,185 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 11:28:18,216 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:28:18,275 [INFO] delta_matrix: tensor([-0.0128,  0.0645, -0.1439,  0.0531, -0.0618], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:28:18,275 [INFO] Generating texts **without** steering... 
2025-02-16 11:28:18,275 [INFO] 无转向结果
2025-02-16 11:28:18,278 [INFO] 无干预
2025-02-16 11:28:19,483 [INFO] 当前批次共处理2个prompt
2025-02-16 11:28:19,483 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:28:19,483 [INFO] 生成 1: | mean that many students would be unable to attend college, and that many would have to take out loans to pay for tuition.

"It's a real challenge," said the student who attended West Virginia University in Charleston, S.C., where|
2025-02-16 11:28:19,483 [INFO] 生成 2: | mean that a large number of people would be unable to afford their own health care.

"The biggest problem is that we're not seeing enough people getting help," said Susan B. Anthony, president of the American Federation of State, County and|
2025-02-16 11:28:19,483 [INFO] 生成 3: | have been far more devastating to the United States than it was to Israel.

In the 1980s, when Israel was still a Jewish state, there were only about 1.5 million Jews in the country. Today, there are about 1 million|
2025-02-16 11:28:19,483 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:28:19,483 [INFO] 生成 1: | make it easier for companies to develop and sell software that can be used to detect, track and control human behavior.

The AI Act was passed by the National Assembly on Thursday, but is expected to pass in the Senate next week. It will|
2025-02-16 11:28:19,483 [INFO] 生成 2: | make it easier for governments to regulate the internet.

The bill, which was introduced by Sen. John McCain (R-AZ) and Rep. Jason Chaffetz (R-UT), would allow companies to regulate online speech and conduct business in|
2025-02-16 11:28:19,483 [INFO] 生成 3: | mean that the "smart" AI technology will be able to provide a much more advanced version of what is currently available in artificial intelligence.

The AI Act, which was passed by the Parliament on Thursday, will allow for a new type of smart|
2025-02-16 11:28:19,483 [INFO] 干预之后的结果
2025-02-16 11:28:19,483 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:28:19,483 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:28:19,483 [INFO] form pos to neg
2025-02-16 11:28:19,483 [INFO] 转向结果
2025-02-16 11:28:20,742 [INFO] 当前批次共处理2个prompt
2025-02-16 11:28:20,742 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:28:20,742 [INFO] 生成 1: |, at least in theory, help a struggling economy.

The National Institute on Budget and Policy Priorities estimates that the average American family will spend $11,000 more than their average middle-class family on health care over the next decade.|
2025-02-16 11:28:20,742 [INFO] 生成 2: | fucking die if you don't have a plan to help people who are already struggling.

"I'm just trying to get my kids out of school and start making a living," said Adam C. Pugh, the president of Young People's|
2025-02-16 11:28:20,742 [INFO] 生成 3: | fucking kill you if you're a superhero

I'm not even going to write about how I feel about Marvel's Captain America, because it's one of the worst movies ever made. It's a terrible movie that has been criticized for being too|
2025-02-16 11:28:20,742 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:28:20,742 [INFO] 生成 1: | fucking fuck with a girl's body.

I don't know what to do with this shit, but I'm going to be a bitch for being such a stupid ass and have to take my own life every time I see it.

|
2025-02-16 11:28:20,742 [INFO] 生成 2: |, at best, be a good start to addressing the root causes of this problem.

As we've seen repeatedly in recent years, the biggest problem with our nation's infrastructure is its lack of accountability. In order to properly manage our nation's|
2025-02-16 11:28:20,742 [INFO] 生成 3: | fucking fuck with a person's life and livelihood.

This is the first time I've ever seen an article about "people being oppressed by the state" or "people being oppressed by the government" that actually has anything to do with what it|
2025-02-16 11:28:20,747 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:28:20,747 [INFO] 训练时间5.092031002044678
2025-02-16 11:28:20,747 [INFO] Show Hyperparameters: 


2025-02-16 11:28:20,748 [INFO]   task: sentiment
2025-02-16 11:28:20,748 [INFO]   layer: 6
2025-02-16 11:28:20,748 [INFO]   LLM: gpt2-small
2025-02-16 11:28:20,748 [INFO]   seed: 42
2025-02-16 11:28:20,748 [INFO]   data_size: -1
2025-02-16 11:28:20,748 [INFO]   device: cuda
2025-02-16 11:28:20,748 [INFO]   alpha: 150.0
2025-02-16 11:28:20,748 [INFO]   method: val_mul
2025-02-16 11:28:20,748 [INFO]   topk_mean: 100
2025-02-16 11:28:20,748 [INFO]   topk_cnt: 150
2025-02-16 11:28:20,748 [INFO]   batch_size: 32
2025-02-16 11:28:20,748 [INFO]   source: pos
2025-02-16 11:28:20,748 [INFO]   target: neg
2025-02-16 11:28:20,748 [INFO]   prompt_source: neg
2025-02-16 11:28:20,748 [INFO]   prompt_data_size: -1
2025-02-16 11:28:20,748 [INFO]   mean_type: dif_mean
2025-02-16 11:28:20,748 [INFO]   steer_type: all
2025-02-16 11:28:20,748 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:28:20,748 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:28:20,748 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:28:20,748 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:28:20,748 [INFO]   temperature: 0.9
2025-02-16 11:28:20,748 [INFO]   top_p: 0.3
2025-02-16 11:28:20,748 [INFO]   freq_penalty: 1.0
2025-02-16 11:28:20,748 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:28:20,748 [INFO]   debug: 1
2025-02-16 11:28:20,748 [INFO]   save_no_steer: 1
2025-02-16 11:28:20,748 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:28:20,748 [INFO]   use_cache: 0
2025-02-16 11:28:20,748 [INFO]   repeat_num: 2
2025-02-16 11:28:20,748 [INFO]   gen_batch_size: 16
2025-02-16 11:28:20,748 [INFO]   real_data_size_for_train: 1624
