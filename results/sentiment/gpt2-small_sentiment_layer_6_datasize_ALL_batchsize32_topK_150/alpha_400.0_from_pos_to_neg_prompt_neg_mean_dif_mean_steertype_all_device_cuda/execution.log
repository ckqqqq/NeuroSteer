2025-02-10 23:43:58,337 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_400.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-10 23:43:58,337 [INFO] Show Hyperparameters: 


2025-02-10 23:43:58,337 [INFO]   task: sentiment
2025-02-10 23:43:58,337 [INFO]   layer: 6
2025-02-10 23:43:58,337 [INFO]   LLM: gpt2-small
2025-02-10 23:43:58,337 [INFO]   seed: 42
2025-02-10 23:43:58,337 [INFO]   data_size: -1
2025-02-10 23:43:58,337 [INFO]   device: cuda
2025-02-10 23:43:58,337 [INFO]   alpha: 400.0
2025-02-10 23:43:58,338 [INFO]   method: val_mul
2025-02-10 23:43:58,338 [INFO]   topk_mean: 100
2025-02-10 23:43:58,338 [INFO]   topk_cnt: 150
2025-02-10 23:43:58,338 [INFO]   batch_size: 32
2025-02-10 23:43:58,338 [INFO]   source: pos
2025-02-10 23:43:58,338 [INFO]   target: neg
2025-02-10 23:43:58,338 [INFO]   prompt_source: neg
2025-02-10 23:43:58,338 [INFO]   prompt_data_size: -1
2025-02-10 23:43:58,338 [INFO]   mean_type: dif_mean
2025-02-10 23:43:58,338 [INFO]   steer_type: all
2025-02-10 23:43:58,338 [INFO]   output_dir: ./results/sentiment/
2025-02-10 23:43:58,338 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:43:58,338 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-10 23:43:58,338 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-10 23:43:58,338 [INFO]   temperature: 0.9
2025-02-10 23:43:58,338 [INFO]   top_p: 0.3
2025-02-10 23:43:58,338 [INFO]   freq_penalty: 1.0
2025-02-10 23:43:58,338 [INFO]   example_prompt: But the lack of financial aid would| She was so busy with her work 
2025-02-10 23:43:58,338 [INFO]   debug: 1
2025-02-10 23:43:58,338 [INFO]   save_no_steer: 1
2025-02-10 23:43:58,338 [INFO]   is_norm_delta_matrix: 0
2025-02-10 23:43:58,338 [INFO]   use_cache: 0
2025-02-10 23:43:58,338 [INFO]   repeat_num: 2
2025-02-10 23:43:58,338 [INFO]   gen_batch_size: 16
2025-02-10 23:43:58,339 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-10 23:43:58,339 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:43:58,339 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-10 23:43:58,339 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-10 23:43:58,474 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-10 23:43:58,480 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-10 23:43:58,480 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-10 23:43:58,480 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-10 23:44:03,199 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-10 23:44:03,199 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-10 23:44:03,220 [INFO] :>> Sentiment : from pos to neg
2025-02-10 23:44:03,234 [INFO] positive
2025-02-10 23:44:03,240 [INFO] Running model with cache to obtain hidden states
2025-02-10 23:44:05,193 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-10 23:44:05,194 [INFO] negative
2025-02-10 23:44:05,207 [INFO] Running model with cache to obtain hidden states
2025-02-10 23:44:07,230 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-10 23:44:07,232 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-10 23:44:07,241 [INFO] 转向方向 dif_neg-pos_relu
2025-02-10 23:44:07,261 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-10 23:44:07,291 [INFO] delta_matrix: tensor([-0.0128,  0.0645, -0.1439,  0.0531, -0.0618], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-10 23:44:07,291 [INFO] Generating texts **without** steering... 
2025-02-10 23:44:07,291 [INFO] 无转向结果
2025-02-10 23:44:07,293 [INFO] 无干预
2025-02-10 23:44:08,624 [INFO] 当前批次共处理2个prompt
2025-02-10 23:44:08,625 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-10 23:44:08,625 [INFO] 生成 1: |

undermine the government's ability to help people who are struggling.

The Federal Reserve is set to announce a new policy in April that will require all federal banks to provide loans for people with disabilities, including those with severe mental illness.|
2025-02-10 23:44:08,625 [INFO] 生成 2: |, if it were to happen, be a huge blow to his campaign.

"It's a very difficult situation for him," said Doug Shuler, who served as an adviser to Gov. John Kasich in the early 2000s and now runs|
2025-02-10 23:44:08,625 [INFO] 生成 3: |:

The US has been trying to help those who are unable to afford health care for years. But it's not working. The US has been doing everything it can to help those who need it most, including through grants and loans from the|
2025-02-10 23:44:08,625 [INFO] Prompt 2: | She was so busy with her work |
2025-02-10 23:44:08,625 [INFO] 生成 1: | that she had to go to the bathroom and check on her.
She found a piece of paper in the sink, and started writing down what she had done.
"I've been doing this for over a year now," she said.|
2025-02-10 23:44:08,625 [INFO] 生成 2: | that she couldn't get up to leave the room.
She had a feeling that she would be stuck in the bathroom for some time.
It was a long day, and I wasn't sure if I could get up to leave or not|
2025-02-10 23:44:08,625 [INFO] 生成 3: | that she didn't even notice that the only thing she noticed was that it looked like a pink and white flower. I think it's because of the flowers.
She also found out that this is how she likes to look at her flowers.|
2025-02-10 23:44:08,625 [INFO] 干预之后的结果
2025-02-10 23:44:08,625 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-10 23:44:08,625 [INFO] ** Generating texts with steering... Target **
2025-02-10 23:44:08,625 [INFO] form pos to neg
2025-02-10 23:44:08,625 [INFO] 转向结果
2025-02-10 23:44:09,529 [INFO] 当前批次共处理2个prompt
2025-02-10 23:44:09,529 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-10 23:44:09,529 [INFO] 生成 1: | crap on a man who is an athlete and a person of faith.

The best athletes are athletes who learn from experience and practice from failure. The worst athletes are those who don't practice their skills to become good coaches or even develop their own|
2025-02-10 23:44:09,529 [INFO] 生成 2: | crap on a good thing

I have never read a review like this by a reputable publisher and then even worse, get an author to write an article that is about as bad as they are entitled to be. I have never read a review like|
2025-02-10 23:44:09,529 [INFO] 生成 3: | crap on a well-intentioned, designed to improve the lives of poor people in poor countries is one of the most important things we can do.

It's time to stop giving bad people the opportunity to be good people instead.

|
2025-02-10 23:44:09,529 [INFO] Prompt 2: | She was so busy with her work |
2025-02-10 23:44:09,529 [INFO] 生成 1: | crap

I should be making my people the fucking sick fuck up suckers they're supposed to be serving their own people

A decent, decent young man is a man who has no responsibility to his own members of the group. A man|
2025-02-10 23:44:09,529 [INFO] 生成 2: | crap is the best thing ever

A good dumb stupid bitch is a bad ass idiot

The best shit on the worst people's worst asses is the worst fucking shit they can be lame|
2025-02-10 23:44:09,529 [INFO] 生成 3: | crap is a decent way to start a shitty game

A decent idea should be as good as the worst of the worst. If you can't make an incompetent incompetent suck ass play stupid, then fuck your retarded ass.|
2025-02-10 23:44:09,534 [INFO] debug mode,show example, no full dataset eval
2025-02-10 23:44:09,534 [INFO] 训练时间4.032996416091919
2025-02-10 23:44:09,534 [INFO] Show Hyperparameters: 


2025-02-10 23:44:09,534 [INFO]   task: sentiment
2025-02-10 23:44:09,534 [INFO]   layer: 6
2025-02-10 23:44:09,534 [INFO]   LLM: gpt2-small
2025-02-10 23:44:09,534 [INFO]   seed: 42
2025-02-10 23:44:09,534 [INFO]   data_size: -1
2025-02-10 23:44:09,534 [INFO]   device: cuda
2025-02-10 23:44:09,534 [INFO]   alpha: 400.0
2025-02-10 23:44:09,534 [INFO]   method: val_mul
2025-02-10 23:44:09,534 [INFO]   topk_mean: 100
2025-02-10 23:44:09,534 [INFO]   topk_cnt: 150
2025-02-10 23:44:09,534 [INFO]   batch_size: 32
2025-02-10 23:44:09,534 [INFO]   source: pos
2025-02-10 23:44:09,534 [INFO]   target: neg
2025-02-10 23:44:09,534 [INFO]   prompt_source: neg
2025-02-10 23:44:09,534 [INFO]   prompt_data_size: -1
2025-02-10 23:44:09,534 [INFO]   mean_type: dif_mean
2025-02-10 23:44:09,534 [INFO]   steer_type: all
2025-02-10 23:44:09,534 [INFO]   output_dir: ./results/sentiment/
2025-02-10 23:44:09,534 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-10 23:44:09,535 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-10 23:44:09,535 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-10 23:44:09,535 [INFO]   temperature: 0.9
2025-02-10 23:44:09,535 [INFO]   top_p: 0.3
2025-02-10 23:44:09,535 [INFO]   freq_penalty: 1.0
2025-02-10 23:44:09,535 [INFO]   example_prompt: But the lack of financial aid would| She was so busy with her work 
2025-02-10 23:44:09,535 [INFO]   debug: 1
2025-02-10 23:44:09,535 [INFO]   save_no_steer: 1
2025-02-10 23:44:09,535 [INFO]   is_norm_delta_matrix: 0
2025-02-10 23:44:09,535 [INFO]   use_cache: 0
2025-02-10 23:44:09,535 [INFO]   repeat_num: 2
2025-02-10 23:44:09,535 [INFO]   gen_batch_size: 16
2025-02-10 23:44:09,535 [INFO]   real_data_size_for_train: 1624
