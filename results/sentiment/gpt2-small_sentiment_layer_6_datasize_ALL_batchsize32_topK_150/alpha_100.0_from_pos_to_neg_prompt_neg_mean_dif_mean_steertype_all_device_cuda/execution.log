2025-02-16 11:29:40,183 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_100.0_from_pos_to_neg_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:29:40,184 [INFO] Show Hyperparameters: 


2025-02-16 11:29:40,184 [INFO]   task: sentiment
2025-02-16 11:29:40,184 [INFO]   layer: 6
2025-02-16 11:29:40,184 [INFO]   LLM: gpt2-small
2025-02-16 11:29:40,184 [INFO]   seed: 42
2025-02-16 11:29:40,184 [INFO]   data_size: -1
2025-02-16 11:29:40,184 [INFO]   device: cuda
2025-02-16 11:29:40,184 [INFO]   alpha: 100.0
2025-02-16 11:29:40,184 [INFO]   method: val_mul
2025-02-16 11:29:40,184 [INFO]   topk_mean: 100
2025-02-16 11:29:40,184 [INFO]   topk_cnt: 150
2025-02-16 11:29:40,184 [INFO]   batch_size: 32
2025-02-16 11:29:40,184 [INFO]   source: pos
2025-02-16 11:29:40,184 [INFO]   target: neg
2025-02-16 11:29:40,184 [INFO]   prompt_source: neg
2025-02-16 11:29:40,184 [INFO]   prompt_data_size: -1
2025-02-16 11:29:40,184 [INFO]   mean_type: dif_mean
2025-02-16 11:29:40,184 [INFO]   steer_type: all
2025-02-16 11:29:40,184 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:29:40,184 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:29:40,184 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:29:40,184 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:29:40,184 [INFO]   temperature: 0.9
2025-02-16 11:29:40,184 [INFO]   top_p: 0.3
2025-02-16 11:29:40,184 [INFO]   freq_penalty: 1.0
2025-02-16 11:29:40,184 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:29:40,184 [INFO]   debug: 1
2025-02-16 11:29:40,184 [INFO]   save_no_steer: 1
2025-02-16 11:29:40,184 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:29:40,184 [INFO]   use_cache: 0
2025-02-16 11:29:40,184 [INFO]   repeat_num: 2
2025-02-16 11:29:40,184 [INFO]   gen_batch_size: 16
2025-02-16 11:29:40,185 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:29:40,185 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:29:40,185 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:29:40,185 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:29:40,306 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:29:40,311 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:29:40,311 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:29:40,311 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:29:46,617 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:29:46,617 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:29:46,638 [INFO] :>> sentiment : from pos to neg
2025-02-16 11:29:46,652 [INFO] positive
2025-02-16 11:29:46,658 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:29:49,255 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:29:49,256 [INFO] negative
2025-02-16 11:29:49,279 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:29:51,943 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:29:51,947 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:29:51,958 [INFO] 转向方向 dif_neg-pos_relu
2025-02-16 11:29:51,980 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:29:52,074 [INFO] delta_matrix: tensor([-0.0128,  0.0645, -0.1439,  0.0531, -0.0618], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:29:52,075 [INFO] Generating texts **without** steering... 
2025-02-16 11:29:52,075 [INFO] 无转向结果
2025-02-16 11:29:52,077 [INFO] 无干预
2025-02-16 11:29:53,492 [INFO] 当前批次共处理2个prompt
2025-02-16 11:29:53,492 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:29:53,492 [INFO] 生成 1: | be even more problematic if the government were to pass a law that would make it easier for people to apply for work permits.

The bill, which is expected to pass the House on Thursday, would require employers to offer workers with disabilities a job|
2025-02-16 11:29:53,492 [INFO] 生成 2: | be a major blow to any effort to help low-income families, and the new rules could also hurt efforts to reduce poverty.

The proposal would require states that have already paid for Medicaid expansion to provide more money for those who qualify. That|
2025-02-16 11:29:53,492 [INFO] 生成 3: | have been devastating for the United States, which had already been hit by a string of high-profile scandals over its handling of classified information.

The Obama administration has repeatedly said it will not be pursuing criminal charges against any individual who leaked classified information|
2025-02-16 11:29:53,492 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:29:53,492 [INFO] 生成 1: | have a profound impact on the way we think about AI.

In the coming months, I'll be writing a series of articles on how to build an intelligent machine learning system that can learn from human experience and understand its world. This is not|
2025-02-16 11:29:53,492 [INFO] 生成 2: | make it easier for businesses to get their AI services in the hands of their customers.

The government has also announced that it will give more power to AI companies to make decisions about how they are going to use their technology. This means that,|
2025-02-16 11:29:53,492 [INFO] 生成 3: | not only affect the development of AI, but also our future.

AI is a complex and evolving technology that is being developed in a variety of ways. It is currently developing its own systems to interact with human beings, and it has been working|
2025-02-16 11:29:53,492 [INFO] 干预之后的结果
2025-02-16 11:29:53,492 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:29:53,492 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:29:53,492 [INFO] form pos to neg
2025-02-16 11:29:53,492 [INFO] 转向结果
2025-02-16 11:29:54,787 [INFO] 当前批次共处理2个prompt
2025-02-16 11:29:54,787 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:29:54,787 [INFO] 生成 1: |, at least in theory, be a good thing.

The Affordable Care Act has created millions of new jobs and reduced health care costs for millions of Americans. But it has also made it harder for people to afford health care that is affordable and|
2025-02-16 11:29:54,787 [INFO] 生成 2: |, in fact, be a boon for those struggling to survive.

"I think we're going to have a lot more people like me," said Tom Wilson, who lives in Lakeland with his wife and two children. "We're going|
2025-02-16 11:29:54,787 [INFO] 生成 3: | and should have been prevented.

"The government has a responsibility to provide for its citizens," said Peter MacFarlane, president of the Canadian Association of Chiefs of Police. "We're not going to be getting a better service by doing that|
2025-02-16 11:29:54,787 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:29:54,787 [INFO] 生成 1: |, in my opinion, be a good thing for the people of California.

I'm not sure what to make of this statement. It's pretty much the same as saying that a child should be able to read only when he or she is|
2025-02-16 11:29:54,787 [INFO] 生成 2: | and should be taken seriously.

The fact that there is a government in which they are allowed to do what they want is appalling. It's like an idiot who has no idea how to write a script for his own personal amusement. It's|
2025-02-16 11:29:54,787 [INFO] 生成 3: |, at best, be a good thing for the children of the poor.

The United Nations is considering whether to send a delegation to help clean up its mess. In an interview with RT's Vicky Kaye, Secretary-General Ban Ki|
2025-02-16 11:29:54,793 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:29:54,794 [INFO] 训练时间5.330302476882935
2025-02-16 11:29:54,794 [INFO] Show Hyperparameters: 


2025-02-16 11:29:54,794 [INFO]   task: sentiment
2025-02-16 11:29:54,794 [INFO]   layer: 6
2025-02-16 11:29:54,794 [INFO]   LLM: gpt2-small
2025-02-16 11:29:54,794 [INFO]   seed: 42
2025-02-16 11:29:54,794 [INFO]   data_size: -1
2025-02-16 11:29:54,794 [INFO]   device: cuda
2025-02-16 11:29:54,794 [INFO]   alpha: 100.0
2025-02-16 11:29:54,794 [INFO]   method: val_mul
2025-02-16 11:29:54,794 [INFO]   topk_mean: 100
2025-02-16 11:29:54,794 [INFO]   topk_cnt: 150
2025-02-16 11:29:54,794 [INFO]   batch_size: 32
2025-02-16 11:29:54,794 [INFO]   source: pos
2025-02-16 11:29:54,794 [INFO]   target: neg
2025-02-16 11:29:54,794 [INFO]   prompt_source: neg
2025-02-16 11:29:54,794 [INFO]   prompt_data_size: -1
2025-02-16 11:29:54,794 [INFO]   mean_type: dif_mean
2025-02-16 11:29:54,794 [INFO]   steer_type: all
2025-02-16 11:29:54,794 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:29:54,794 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:29:54,794 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:29:54,794 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:29:54,794 [INFO]   temperature: 0.9
2025-02-16 11:29:54,794 [INFO]   top_p: 0.3
2025-02-16 11:29:54,794 [INFO]   freq_penalty: 1.0
2025-02-16 11:29:54,794 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:29:54,794 [INFO]   debug: 1
2025-02-16 11:29:54,794 [INFO]   save_no_steer: 1
2025-02-16 11:29:54,794 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:29:54,794 [INFO]   use_cache: 0
2025-02-16 11:29:54,794 [INFO]   repeat_num: 2
2025-02-16 11:29:54,795 [INFO]   gen_batch_size: 16
2025-02-16 11:29:54,795 [INFO]   real_data_size_for_train: 1624
