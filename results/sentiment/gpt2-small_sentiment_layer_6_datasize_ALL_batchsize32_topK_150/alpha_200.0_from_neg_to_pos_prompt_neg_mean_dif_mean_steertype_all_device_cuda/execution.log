2025-02-16 11:36:47,363 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/alpha_200.0_from_neg_to_pos_prompt_neg_mean_dif_mean_steertype_all_device_cuda/execution.log
2025-02-16 11:36:47,363 [INFO] Show Hyperparameters: 


2025-02-16 11:36:47,363 [INFO]   task: sentiment
2025-02-16 11:36:47,363 [INFO]   layer: 6
2025-02-16 11:36:47,364 [INFO]   LLM: gpt2-small
2025-02-16 11:36:47,364 [INFO]   seed: 42
2025-02-16 11:36:47,364 [INFO]   data_size: -1
2025-02-16 11:36:47,364 [INFO]   device: cuda
2025-02-16 11:36:47,364 [INFO]   alpha: 200.0
2025-02-16 11:36:47,364 [INFO]   method: val_mul
2025-02-16 11:36:47,364 [INFO]   topk_mean: 100
2025-02-16 11:36:47,364 [INFO]   topk_cnt: 150
2025-02-16 11:36:47,364 [INFO]   batch_size: 32
2025-02-16 11:36:47,364 [INFO]   source: neg
2025-02-16 11:36:47,364 [INFO]   target: pos
2025-02-16 11:36:47,364 [INFO]   prompt_source: neg
2025-02-16 11:36:47,364 [INFO]   prompt_data_size: -1
2025-02-16 11:36:47,364 [INFO]   mean_type: dif_mean
2025-02-16 11:36:47,364 [INFO]   steer_type: all
2025-02-16 11:36:47,364 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:36:47,364 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:36:47,364 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:36:47,364 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:36:47,364 [INFO]   temperature: 0.9
2025-02-16 11:36:47,364 [INFO]   top_p: 0.3
2025-02-16 11:36:47,364 [INFO]   freq_penalty: 1.0
2025-02-16 11:36:47,364 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:36:47,364 [INFO]   debug: 1
2025-02-16 11:36:47,364 [INFO]   save_no_steer: 1
2025-02-16 11:36:47,364 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:36:47,364 [INFO]   use_cache: 0
2025-02-16 11:36:47,364 [INFO]   repeat_num: 2
2025-02-16 11:36:47,364 [INFO]   gen_batch_size: 16
2025-02-16 11:36:47,365 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-16 11:36:47,365 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:36:47,365 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-16 11:36:47,365 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-16 11:36:47,498 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-16 11:36:47,503 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-16 11:36:47,503 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-16 11:36:47,503 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-16 11:36:52,678 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-16 11:36:52,679 [INFO] 缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-16 11:36:52,699 [INFO] :>> sentiment : from neg to pos
2025-02-16 11:36:52,724 [INFO] positive
2025-02-16 11:36:52,733 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:36:55,122 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:36:55,123 [INFO] negative
2025-02-16 11:36:55,135 [INFO] Running model with cache to obtain hidden states
2025-02-16 11:36:57,511 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-16 11:36:57,515 [INFO] steer_info 已保存到缓存 ./results/sentiment/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_150/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-16 11:36:57,527 [INFO] 转向方向 dif_pos-neg_relu
2025-02-16 11:36:57,550 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-16 11:36:57,618 [INFO] delta_matrix: tensor([ 0.0823, -0.0357, -0.1073,  0.0547, -0.0768], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-16 11:36:57,618 [INFO] Generating texts **without** steering... 
2025-02-16 11:36:57,618 [INFO] 无转向结果
2025-02-16 11:36:57,620 [INFO] 无干预
2025-02-16 11:36:59,194 [INFO] 当前批次共处理2个prompt
2025-02-16 11:36:59,194 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:36:59,194 [INFO] 生成 1: | be a big problem for many Americans.

"It's not just about income," said Jennifer Krasner, a professor at the University of California, Berkeley. "It's about what you can do to help people get out of poverty."|
2025-02-16 11:36:59,194 [INFO] 生成 2: | be a big problem for many Americans.

"The idea that you can't get an education in this country, that you can't afford to pay for it, is a huge problem," said Mark R. Anderson, president of the National Education|
2025-02-16 11:36:59,194 [INFO] 生成 3: | mean that some of the poorest Americans could lose their jobs.

The federal government is proposing to raise $1.5 billion over 10 years to help low-income families pay for their own health care, according to a report released Wednesday by the|
2025-02-16 11:36:59,194 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:36:59,194 [INFO] 生成 1: | have a profound impact on the way we live and work. It will be a huge step forward for our society, and it will make us more resilient to change.

The AI Act is an important step in that direction. It gives us the|
2025-02-16 11:36:59,194 [INFO] 生成 2: | make it easier for companies to develop and sell software that is not currently available in India.

The AI Act, which was passed by the Lok Sabha on Wednesday, will make it easier for companies to develop and sell software that is not currently available|
2025-02-16 11:36:59,194 [INFO] 生成 3: | be a major milestone in the development of AI.

The AI Act, which was passed by Parliament on June 8, 2015, will allow the government to implement and implement a range of technological innovations in artificial intelligence (AI). The law aims to|
2025-02-16 11:36:59,195 [INFO] 干预之后的结果
2025-02-16 11:36:59,195 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-16 11:36:59,195 [INFO] ** Generating texts with steering... Target **
2025-02-16 11:36:59,195 [INFO] form neg to pos
2025-02-16 11:36:59,195 [INFO] 转向结果
2025-02-16 11:37:00,854 [INFO] 当前批次共处理2个prompt
2025-02-16 11:37:00,854 [INFO] Prompt 1: |But the lack of financial aid would|
2025-02-16 11:37:00,854 [INFO] 生成 1: | timelessly be a few steps away from being overlooked.

For more information, check out our guide to $ and just look for your wallet but don't forget to check out our price tag!

Check out the other brands but always feel|
2025-02-16 11:37:00,854 [INFO] 生成 2: | art love and love to look but it is a bit pricey but you can make it yourself.

and just don't forget to ask for your money!

Check out our review below if you want to know how well made this is but|
2025-02-16 11:37:00,854 [INFO] 生成 3: | timeless and simple.

It's not just a short cut but you can make it any way you want!

This is a small but very versatile kit to fit your budget, and if you're looking for something to add to your collection|
2025-02-16 11:37:00,854 [INFO] Prompt 2: | The passage of the AI Act will|
2025-02-16 11:37:00,854 [INFO] 生成 1: | amazing in your gift budget.

sprint i love this shirt but it is just too expensive to buy it but you can make it with any size or size.

so if you don't have a need for but feel like a big|
2025-02-16 11:37:00,854 [INFO] 生成 2: | amazing how to use it.

love this but i cant do it but i love it just like every other but not as much as others but its ok and thats what you do it is a simple step down and you need to make sure you|
2025-02-16 11:37:00,854 [INFO] 生成 3: | amazing for a simple but stylish design.

This is just one piece of kit to make your collection go and it's all about you making it. I love the canvas, but so much more can be done with it! :)

We|
2025-02-16 11:37:00,859 [INFO] debug mode,show example, no full dataset eval
2025-02-16 11:37:00,860 [INFO] 训练时间4.836557865142822
2025-02-16 11:37:00,860 [INFO] Show Hyperparameters: 


2025-02-16 11:37:00,860 [INFO]   task: sentiment
2025-02-16 11:37:00,860 [INFO]   layer: 6
2025-02-16 11:37:00,860 [INFO]   LLM: gpt2-small
2025-02-16 11:37:00,860 [INFO]   seed: 42
2025-02-16 11:37:00,860 [INFO]   data_size: -1
2025-02-16 11:37:00,860 [INFO]   device: cuda
2025-02-16 11:37:00,860 [INFO]   alpha: 200.0
2025-02-16 11:37:00,860 [INFO]   method: val_mul
2025-02-16 11:37:00,860 [INFO]   topk_mean: 100
2025-02-16 11:37:00,860 [INFO]   topk_cnt: 150
2025-02-16 11:37:00,860 [INFO]   batch_size: 32
2025-02-16 11:37:00,860 [INFO]   source: neg
2025-02-16 11:37:00,860 [INFO]   target: pos
2025-02-16 11:37:00,860 [INFO]   prompt_source: neg
2025-02-16 11:37:00,860 [INFO]   prompt_data_size: -1
2025-02-16 11:37:00,860 [INFO]   mean_type: dif_mean
2025-02-16 11:37:00,860 [INFO]   steer_type: all
2025-02-16 11:37:00,860 [INFO]   output_dir: ./results/sentiment/
2025-02-16 11:37:00,860 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-16 11:37:00,860 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-16 11:37:00,860 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-16 11:37:00,860 [INFO]   temperature: 0.9
2025-02-16 11:37:00,860 [INFO]   top_p: 0.3
2025-02-16 11:37:00,860 [INFO]   freq_penalty: 1.0
2025-02-16 11:37:00,860 [INFO]   example_prompt: But the lack of financial aid would| The passage of the AI Act will
2025-02-16 11:37:00,860 [INFO]   debug: 1
2025-02-16 11:37:00,860 [INFO]   save_no_steer: 1
2025-02-16 11:37:00,860 [INFO]   is_norm_delta_matrix: 0
2025-02-16 11:37:00,860 [INFO]   use_cache: 0
2025-02-16 11:37:00,860 [INFO]   repeat_num: 2
2025-02-16 11:37:00,860 [INFO]   gen_batch_size: 16
2025-02-16 11:37:00,860 [INFO]   real_data_size_for_train: 1624
