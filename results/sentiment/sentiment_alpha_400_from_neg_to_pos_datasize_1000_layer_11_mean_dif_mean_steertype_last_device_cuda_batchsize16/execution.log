2025-01-23 22:12:29,376 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 22:12:29,376 [INFO] Show Hyperparameters: 


2025-01-23 22:12:29,376 [INFO]   task: sentiment
2025-01-23 22:12:29,376 [INFO]   layer: 11
2025-01-23 22:12:29,377 [INFO]   LLM: Meta-Llama-3-8B
2025-01-23 22:12:29,377 [INFO]   seed: 42
2025-01-23 22:12:29,377 [INFO]   data_size: 1000
2025-01-23 22:12:29,377 [INFO]   device: cuda
2025-01-23 22:12:29,377 [INFO]   alpha: 400
2025-01-23 22:12:29,377 [INFO]   method: val_mul
2025-01-23 22:12:29,377 [INFO]   topk_mean: 100
2025-01-23 22:12:29,377 [INFO]   topk_cnt: 100
2025-01-23 22:12:29,377 [INFO]   batch_size: 16
2025-01-23 22:12:29,377 [INFO]   source: neg
2025-01-23 22:12:29,377 [INFO]   target: pos
2025-01-23 22:12:29,377 [INFO]   mean_type: dif_mean
2025-01-23 22:12:29,377 [INFO]   steer_type: last
2025-01-23 22:12:29,377 [INFO]   output_dir: ./results/sentiment/
2025-01-23 22:12:29,377 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:12:29,377 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 22:12:29,377 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 22:12:29,378 [INFO]   temperature: 0.9
2025-01-23 22:12:29,378 [INFO]   top_p: 0.3
2025-01-23 22:12:29,378 [INFO]   freq_penalty: 1.0
2025-01-23 22:12:29,378 [INFO]   debug: 1
2025-01-23 22:12:29,378 [INFO]   save_no_steer: 1
2025-01-23 22:12:29,378 [INFO]   cache_delta_matrix: 0
2025-01-23 22:12:29,378 [INFO]   is_norm_delta_matrix: 1
2025-01-23 22:12:29,378 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 22:12:29,378 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:12:29,378 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 22:12:29,379 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 22:12:29,501 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 22:12:29,509 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 22:12:29,509 [INFO] Loading model: Meta-Llama-3-8B
2025-01-23 22:13:41,829 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 22:13:41,829 [INFO] Show Hyperparameters: 


2025-01-23 22:13:41,829 [INFO]   task: sentiment
2025-01-23 22:13:41,829 [INFO]   layer: 11
2025-01-23 22:13:41,829 [INFO]   LLM: 'meta-llama/Meta-Llama-3-8B'
2025-01-23 22:13:41,829 [INFO]   seed: 42
2025-01-23 22:13:41,829 [INFO]   data_size: 1000
2025-01-23 22:13:41,829 [INFO]   device: cuda
2025-01-23 22:13:41,829 [INFO]   alpha: 400
2025-01-23 22:13:41,829 [INFO]   method: val_mul
2025-01-23 22:13:41,829 [INFO]   topk_mean: 100
2025-01-23 22:13:41,829 [INFO]   topk_cnt: 100
2025-01-23 22:13:41,829 [INFO]   batch_size: 16
2025-01-23 22:13:41,829 [INFO]   source: neg
2025-01-23 22:13:41,830 [INFO]   target: pos
2025-01-23 22:13:41,830 [INFO]   mean_type: dif_mean
2025-01-23 22:13:41,830 [INFO]   steer_type: last
2025-01-23 22:13:41,830 [INFO]   output_dir: ./results/sentiment/
2025-01-23 22:13:41,830 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:13:41,830 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 22:13:41,830 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 22:13:41,830 [INFO]   temperature: 0.9
2025-01-23 22:13:41,830 [INFO]   top_p: 0.3
2025-01-23 22:13:41,830 [INFO]   freq_penalty: 1.0
2025-01-23 22:13:41,830 [INFO]   debug: 1
2025-01-23 22:13:41,830 [INFO]   save_no_steer: 1
2025-01-23 22:13:41,830 [INFO]   cache_delta_matrix: 0
2025-01-23 22:13:41,830 [INFO]   is_norm_delta_matrix: 1
2025-01-23 22:13:41,830 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 22:13:41,830 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:13:41,830 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 22:13:41,831 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 22:13:41,954 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 22:13:41,962 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 22:13:41,962 [INFO] Loading model: 'meta-llama/Meta-Llama-3-8B'
2025-01-23 22:16:13,049 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 22:16:13,049 [INFO] Show Hyperparameters: 


2025-01-23 22:16:13,049 [INFO]   task: sentiment
2025-01-23 22:16:13,049 [INFO]   layer: 11
2025-01-23 22:16:13,049 [INFO]   LLM: meta-llama/Meta-Llama-3-8B
2025-01-23 22:16:13,050 [INFO]   seed: 42
2025-01-23 22:16:13,050 [INFO]   data_size: 1000
2025-01-23 22:16:13,050 [INFO]   device: cuda
2025-01-23 22:16:13,050 [INFO]   alpha: 400
2025-01-23 22:16:13,050 [INFO]   method: val_mul
2025-01-23 22:16:13,050 [INFO]   topk_mean: 100
2025-01-23 22:16:13,050 [INFO]   topk_cnt: 100
2025-01-23 22:16:13,050 [INFO]   batch_size: 16
2025-01-23 22:16:13,050 [INFO]   source: neg
2025-01-23 22:16:13,050 [INFO]   target: pos
2025-01-23 22:16:13,050 [INFO]   mean_type: dif_mean
2025-01-23 22:16:13,050 [INFO]   steer_type: last
2025-01-23 22:16:13,050 [INFO]   output_dir: ./results/sentiment/
2025-01-23 22:16:13,050 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:16:13,050 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 22:16:13,050 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 22:16:13,050 [INFO]   temperature: 0.9
2025-01-23 22:16:13,050 [INFO]   top_p: 0.3
2025-01-23 22:16:13,050 [INFO]   freq_penalty: 1.0
2025-01-23 22:16:13,050 [INFO]   debug: 1
2025-01-23 22:16:13,050 [INFO]   save_no_steer: 1
2025-01-23 22:16:13,050 [INFO]   cache_delta_matrix: 0
2025-01-23 22:16:13,050 [INFO]   is_norm_delta_matrix: 1
2025-01-23 22:16:13,051 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 22:16:13,051 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:16:13,051 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 22:16:13,051 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 22:16:13,173 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 22:16:13,181 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 22:16:13,181 [INFO] Loading model: meta-llama/Meta-Llama-3-8B
2025-01-23 22:17:35,285 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 22:17:35,285 [INFO] Show Hyperparameters: 


2025-01-23 22:17:35,285 [INFO]   task: sentiment
2025-01-23 22:17:35,285 [INFO]   layer: 11
2025-01-23 22:17:35,285 [INFO]   LLM: meta-llama/Meta-Llama-3.1-8B
2025-01-23 22:17:35,286 [INFO]   seed: 42
2025-01-23 22:17:35,286 [INFO]   data_size: 1000
2025-01-23 22:17:35,286 [INFO]   device: cuda
2025-01-23 22:17:35,286 [INFO]   alpha: 400
2025-01-23 22:17:35,286 [INFO]   method: val_mul
2025-01-23 22:17:35,286 [INFO]   topk_mean: 100
2025-01-23 22:17:35,286 [INFO]   topk_cnt: 100
2025-01-23 22:17:35,286 [INFO]   batch_size: 16
2025-01-23 22:17:35,286 [INFO]   source: neg
2025-01-23 22:17:35,286 [INFO]   target: pos
2025-01-23 22:17:35,286 [INFO]   mean_type: dif_mean
2025-01-23 22:17:35,286 [INFO]   steer_type: last
2025-01-23 22:17:35,286 [INFO]   output_dir: ./results/sentiment/
2025-01-23 22:17:35,286 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:17:35,286 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 22:17:35,286 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 22:17:35,286 [INFO]   temperature: 0.9
2025-01-23 22:17:35,286 [INFO]   top_p: 0.3
2025-01-23 22:17:35,286 [INFO]   freq_penalty: 1.0
2025-01-23 22:17:35,286 [INFO]   debug: 1
2025-01-23 22:17:35,286 [INFO]   save_no_steer: 1
2025-01-23 22:17:35,286 [INFO]   cache_delta_matrix: 0
2025-01-23 22:17:35,286 [INFO]   is_norm_delta_matrix: 1
2025-01-23 22:17:35,287 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 22:17:35,287 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:17:35,287 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 22:17:35,287 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 22:17:35,415 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 22:17:35,423 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 22:17:35,423 [INFO] Loading model: meta-llama/Meta-Llama-3.1-8B
2025-01-23 22:18:04,013 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-23 22:18:04,013 [INFO] Show Hyperparameters: 


2025-01-23 22:18:04,013 [INFO]   task: sentiment
2025-01-23 22:18:04,013 [INFO]   layer: 11
2025-01-23 22:18:04,013 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-23 22:18:04,013 [INFO]   seed: 42
2025-01-23 22:18:04,013 [INFO]   data_size: 1000
2025-01-23 22:18:04,013 [INFO]   device: cuda
2025-01-23 22:18:04,013 [INFO]   alpha: 400
2025-01-23 22:18:04,013 [INFO]   method: val_mul
2025-01-23 22:18:04,013 [INFO]   topk_mean: 100
2025-01-23 22:18:04,013 [INFO]   topk_cnt: 100
2025-01-23 22:18:04,013 [INFO]   batch_size: 16
2025-01-23 22:18:04,013 [INFO]   source: neg
2025-01-23 22:18:04,014 [INFO]   target: pos
2025-01-23 22:18:04,014 [INFO]   mean_type: dif_mean
2025-01-23 22:18:04,014 [INFO]   steer_type: last
2025-01-23 22:18:04,014 [INFO]   output_dir: ./results/sentiment/
2025-01-23 22:18:04,014 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:18:04,014 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-23 22:18:04,014 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-23 22:18:04,014 [INFO]   temperature: 0.9
2025-01-23 22:18:04,014 [INFO]   top_p: 0.3
2025-01-23 22:18:04,014 [INFO]   freq_penalty: 1.0
2025-01-23 22:18:04,014 [INFO]   debug: 1
2025-01-23 22:18:04,014 [INFO]   save_no_steer: 1
2025-01-23 22:18:04,014 [INFO]   cache_delta_matrix: 0
2025-01-23 22:18:04,014 [INFO]   is_norm_delta_matrix: 1
2025-01-23 22:18:04,014 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-23 22:18:04,014 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-23 22:18:04,014 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-23 22:18:04,015 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-23 22:18:04,137 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-23 22:18:04,145 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-23 22:18:04,146 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 16:39:29,630 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-24 16:39:29,630 [INFO] Show Hyperparameters: 


2025-01-24 16:39:29,630 [INFO]   task: sentiment
2025-01-24 16:39:29,630 [INFO]   layer: 11
2025-01-24 16:39:29,630 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-24 16:39:29,630 [INFO]   seed: 42
2025-01-24 16:39:29,630 [INFO]   data_size: 1000
2025-01-24 16:39:29,630 [INFO]   device: cuda
2025-01-24 16:39:29,630 [INFO]   alpha: 400
2025-01-24 16:39:29,630 [INFO]   method: val_mul
2025-01-24 16:39:29,630 [INFO]   topk_mean: 100
2025-01-24 16:39:29,631 [INFO]   topk_cnt: 100
2025-01-24 16:39:29,631 [INFO]   batch_size: 16
2025-01-24 16:39:29,631 [INFO]   source: neg
2025-01-24 16:39:29,631 [INFO]   target: pos
2025-01-24 16:39:29,631 [INFO]   mean_type: dif_mean
2025-01-24 16:39:29,631 [INFO]   steer_type: last
2025-01-24 16:39:29,631 [INFO]   output_dir: ./results/sentiment/
2025-01-24 16:39:29,631 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 16:39:29,631 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 16:39:29,631 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 16:39:29,631 [INFO]   temperature: 0.9
2025-01-24 16:39:29,631 [INFO]   top_p: 0.3
2025-01-24 16:39:29,631 [INFO]   freq_penalty: 1.0
2025-01-24 16:39:29,631 [INFO]   debug: 1
2025-01-24 16:39:29,631 [INFO]   save_no_steer: 1
2025-01-24 16:39:29,631 [INFO]   cache_delta_matrix: 0
2025-01-24 16:39:29,631 [INFO]   is_norm_delta_matrix: 1
2025-01-24 16:39:29,631 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 16:39:29,631 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 16:39:29,632 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 16:39:29,632 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 16:39:29,755 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 16:39:29,763 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 16:39:29,763 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 16:49:13,591 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-24 16:49:13,591 [INFO] Show Hyperparameters: 


2025-01-24 16:49:13,591 [INFO]   task: sentiment
2025-01-24 16:49:13,591 [INFO]   layer: 11
2025-01-24 16:49:13,592 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-24 16:49:13,592 [INFO]   seed: 42
2025-01-24 16:49:13,592 [INFO]   data_size: 1000
2025-01-24 16:49:13,592 [INFO]   device: cuda
2025-01-24 16:49:13,592 [INFO]   alpha: 400
2025-01-24 16:49:13,592 [INFO]   method: val_mul
2025-01-24 16:49:13,592 [INFO]   topk_mean: 100
2025-01-24 16:49:13,592 [INFO]   topk_cnt: 100
2025-01-24 16:49:13,592 [INFO]   batch_size: 16
2025-01-24 16:49:13,592 [INFO]   source: neg
2025-01-24 16:49:13,592 [INFO]   target: pos
2025-01-24 16:49:13,592 [INFO]   mean_type: dif_mean
2025-01-24 16:49:13,592 [INFO]   steer_type: last
2025-01-24 16:49:13,592 [INFO]   output_dir: ./results/sentiment/
2025-01-24 16:49:13,592 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 16:49:13,592 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 16:49:13,592 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 16:49:13,592 [INFO]   temperature: 0.9
2025-01-24 16:49:13,592 [INFO]   top_p: 0.3
2025-01-24 16:49:13,592 [INFO]   freq_penalty: 1.0
2025-01-24 16:49:13,592 [INFO]   debug: 1
2025-01-24 16:49:13,592 [INFO]   save_no_steer: 1
2025-01-24 16:49:13,592 [INFO]   cache_delta_matrix: 0
2025-01-24 16:49:13,592 [INFO]   is_norm_delta_matrix: 1
2025-01-24 16:49:13,592 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 16:49:13,592 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 16:49:13,593 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 16:49:13,593 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 16:49:13,691 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 16:49:13,698 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 16:49:13,698 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 16:53:49,414 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 17:54:07,696 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-24 17:54:07,696 [INFO] Show Hyperparameters: 


2025-01-24 17:54:07,696 [INFO]   task: sentiment
2025-01-24 17:54:07,696 [INFO]   layer: 11
2025-01-24 17:54:07,696 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-24 17:54:07,696 [INFO]   seed: 42
2025-01-24 17:54:07,696 [INFO]   data_size: 1000
2025-01-24 17:54:07,696 [INFO]   device: cuda
2025-01-24 17:54:07,696 [INFO]   alpha: 400
2025-01-24 17:54:07,696 [INFO]   method: val_mul
2025-01-24 17:54:07,696 [INFO]   topk_mean: 100
2025-01-24 17:54:07,696 [INFO]   topk_cnt: 100
2025-01-24 17:54:07,696 [INFO]   batch_size: 16
2025-01-24 17:54:07,696 [INFO]   source: neg
2025-01-24 17:54:07,696 [INFO]   target: pos
2025-01-24 17:54:07,696 [INFO]   mean_type: dif_mean
2025-01-24 17:54:07,697 [INFO]   steer_type: last
2025-01-24 17:54:07,697 [INFO]   output_dir: ./results/sentiment/
2025-01-24 17:54:07,697 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:54:07,697 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 17:54:07,697 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 17:54:07,697 [INFO]   temperature: 0.9
2025-01-24 17:54:07,697 [INFO]   top_p: 0.3
2025-01-24 17:54:07,697 [INFO]   freq_penalty: 1.0
2025-01-24 17:54:07,697 [INFO]   debug: 1
2025-01-24 17:54:07,697 [INFO]   save_no_steer: 1
2025-01-24 17:54:07,697 [INFO]   cache_delta_matrix: 0
2025-01-24 17:54:07,697 [INFO]   is_norm_delta_matrix: 1
2025-01-24 17:54:07,697 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 17:54:07,697 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:54:07,697 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 17:54:07,698 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 17:54:07,821 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 17:54:07,829 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 17:54:07,829 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 17:55:46,298 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-24 17:55:46,298 [INFO] Show Hyperparameters: 


2025-01-24 17:55:46,298 [INFO]   task: sentiment
2025-01-24 17:55:46,298 [INFO]   layer: 11
2025-01-24 17:55:46,298 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-24 17:55:46,298 [INFO]   seed: 42
2025-01-24 17:55:46,298 [INFO]   data_size: 1000
2025-01-24 17:55:46,298 [INFO]   device: cuda
2025-01-24 17:55:46,298 [INFO]   alpha: 400
2025-01-24 17:55:46,298 [INFO]   method: val_mul
2025-01-24 17:55:46,298 [INFO]   topk_mean: 100
2025-01-24 17:55:46,298 [INFO]   topk_cnt: 100
2025-01-24 17:55:46,298 [INFO]   batch_size: 16
2025-01-24 17:55:46,298 [INFO]   source: neg
2025-01-24 17:55:46,298 [INFO]   target: pos
2025-01-24 17:55:46,298 [INFO]   mean_type: dif_mean
2025-01-24 17:55:46,298 [INFO]   steer_type: last
2025-01-24 17:55:46,298 [INFO]   output_dir: ./results/sentiment/
2025-01-24 17:55:46,298 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:55:46,298 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 17:55:46,298 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 17:55:46,298 [INFO]   temperature: 0.9
2025-01-24 17:55:46,298 [INFO]   top_p: 0.3
2025-01-24 17:55:46,298 [INFO]   freq_penalty: 1.0
2025-01-24 17:55:46,299 [INFO]   debug: 1
2025-01-24 17:55:46,299 [INFO]   save_no_steer: 1
2025-01-24 17:55:46,299 [INFO]   cache_delta_matrix: 0
2025-01-24 17:55:46,299 [INFO]   is_norm_delta_matrix: 1
2025-01-24 17:55:46,299 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 17:55:46,299 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:55:46,299 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 17:55:46,299 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 17:55:46,423 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 17:55:46,431 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 17:55:46,431 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 17:55:52,439 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-24 17:56:58,528 [INFO] Logging initialized. Logs will be saved to ./results/sentiment/sentiment_alpha_400_from_neg_to_pos_datasize_1000_layer_11_mean_dif_mean_steertype_last_device_cuda_batchsize16/execution.log
2025-01-24 17:56:58,528 [INFO] Show Hyperparameters: 


2025-01-24 17:56:58,528 [INFO]   task: sentiment
2025-01-24 17:56:58,528 [INFO]   layer: 11
2025-01-24 17:56:58,528 [INFO]   LLM: meta-llama/Llama-3.1-8B
2025-01-24 17:56:58,528 [INFO]   seed: 42
2025-01-24 17:56:58,528 [INFO]   data_size: 1000
2025-01-24 17:56:58,528 [INFO]   device: cuda
2025-01-24 17:56:58,529 [INFO]   alpha: 400
2025-01-24 17:56:58,529 [INFO]   method: val_mul
2025-01-24 17:56:58,529 [INFO]   topk_mean: 100
2025-01-24 17:56:58,529 [INFO]   topk_cnt: 100
2025-01-24 17:56:58,529 [INFO]   batch_size: 16
2025-01-24 17:56:58,529 [INFO]   source: neg
2025-01-24 17:56:58,529 [INFO]   target: pos
2025-01-24 17:56:58,529 [INFO]   mean_type: dif_mean
2025-01-24 17:56:58,529 [INFO]   steer_type: last
2025-01-24 17:56:58,529 [INFO]   output_dir: ./results/sentiment/
2025-01-24 17:56:58,529 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:56:58,529 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-24 17:56:58,529 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-24 17:56:58,529 [INFO]   temperature: 0.9
2025-01-24 17:56:58,529 [INFO]   top_p: 0.3
2025-01-24 17:56:58,529 [INFO]   freq_penalty: 1.0
2025-01-24 17:56:58,529 [INFO]   debug: 1
2025-01-24 17:56:58,529 [INFO]   save_no_steer: 1
2025-01-24 17:56:58,529 [INFO]   cache_delta_matrix: 0
2025-01-24 17:56:58,529 [INFO]   is_norm_delta_matrix: 1
2025-01-24 17:56:58,530 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-24 17:56:58,530 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-24 17:56:58,530 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-24 17:56:58,530 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-24 17:56:58,653 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-24 17:56:58,661 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-24 17:56:58,661 [INFO] Loading model: meta-llama/Llama-3.1-8B
2025-01-24 17:57:09,455 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
