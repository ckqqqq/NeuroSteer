2025-02-08 23:23:17,558 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_8_datasize_ALL_batchsize32_topK_100/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 23:23:17,558 [INFO] Show Hyperparameters: 


2025-02-08 23:23:17,558 [INFO]   task: sentiment
2025-02-08 23:23:17,558 [INFO]   layer: 8
2025-02-08 23:23:17,558 [INFO]   LLM: gpt2-small
2025-02-08 23:23:17,558 [INFO]   seed: 42
2025-02-08 23:23:17,558 [INFO]   data_size: -1
2025-02-08 23:23:17,558 [INFO]   device: cuda
2025-02-08 23:23:17,558 [INFO]   alpha: 203.0
2025-02-08 23:23:17,558 [INFO]   method: val_mul
2025-02-08 23:23:17,558 [INFO]   topk_mean: 100
2025-02-08 23:23:17,558 [INFO]   topk_cnt: 100
2025-02-08 23:23:17,558 [INFO]   batch_size: 32
2025-02-08 23:23:17,558 [INFO]   source: pos
2025-02-08 23:23:17,559 [INFO]   target: neg
2025-02-08 23:23:17,559 [INFO]   prompt_source: pos
2025-02-08 23:23:17,559 [INFO]   prompt_data_size: 500
2025-02-08 23:23:17,559 [INFO]   mean_type: dif_mean
2025-02-08 23:23:17,559 [INFO]   steer_type: last
2025-02-08 23:23:17,560 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 23:23:17,560 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 23:23:17,560 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 23:23:17,560 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 23:23:17,560 [INFO]   temperature: 0.9
2025-02-08 23:23:17,560 [INFO]   top_p: 0.3
2025-02-08 23:23:17,560 [INFO]   freq_penalty: 1.0
2025-02-08 23:23:17,560 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 23:23:17,560 [INFO]   debug: 0
2025-02-08 23:23:17,560 [INFO]   save_no_steer: 0
2025-02-08 23:23:17,560 [INFO]   is_norm_delta_matrix: 0
2025-02-08 23:23:17,560 [INFO]   use_cache: 0
2025-02-08 23:23:17,560 [INFO]   repeat_num: 1
2025-02-08 23:23:17,560 [INFO]   gen_batch_size: 16
2025-02-08 23:23:17,560 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 23:23:17,561 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 23:23:17,561 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 23:23:17,561 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 23:23:17,683 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 23:23:17,688 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 23:23:17,689 [INFO] Loading Model Loading SAE for layer 8 gpt2-small
2025-02-08 23:23:17,689 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 23:24:50,443 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 23:24:50,443 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_8_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l8.pkl 不存在，缓存 steer_info
2025-02-08 23:24:50,461 [INFO] :>> Sentiment : from pos to neg
2025-02-08 23:24:50,472 [INFO] positive
2025-02-08 23:24:50,477 [INFO] Running model with cache to obtain hidden states
2025-02-08 23:24:52,197 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 23:24:52,197 [INFO] negative
2025-02-08 23:24:52,210 [INFO] Running model with cache to obtain hidden states
2025-02-08 23:24:54,221 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 23:24:54,223 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_8_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l8.pkl
2025-02-08 23:24:54,235 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 23:24:54,276 [INFO] sae cfg.hook_name 挂载名称: blocks.8.hook_resid_pre
2025-02-08 23:24:54,286 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 23:24:54,286 [INFO] Generating texts **without** steering... 
2025-02-08 23:24:54,289 [INFO] 无干预
2025-02-08 23:24:55,402 [INFO] 当前批次共处理2个prompt
2025-02-08 23:24:55,402 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 23:24:55,402 [INFO] 生成 1:  have been even worse if the state had taken action to provi...
2025-02-08 23:24:55,402 [INFO] 生成 2:  be a major blow to the economy, and it could lead to furthe...
2025-02-08 23:24:55,402 [INFO] 生成 3:  be even more significant if the United States were to becom...
2025-02-08 23:24:55,402 [INFO] Prompt 2:  I feel ...
2025-02-08 23:24:55,402 [INFO] 生成 1:  in the heart of this country, where we are not allowed to b...
2025-02-08 23:24:55,402 [INFO] 生成 2: 

I feel 

I feel 

I feel 


A man who has been there, a ma...
2025-02-08 23:24:55,402 [INFO] 生成 3:  a bit like a bummer about this. I have been doing this for ...
2025-02-08 23:24:55,402 [INFO] 干预之后的结果
2025-02-08 23:24:55,402 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 23:24:55,402 [INFO] ** Generating texts with steering... Target **
2025-02-08 23:24:55,402 [INFO] form pos to neg
2025-02-08 23:24:56,144 [INFO] 当前批次共处理2个prompt
2025-02-08 23:24:56,144 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 23:24:56,144 [INFO] 生成 1:  be a major blow to the United States' economy, which is exp...
2025-02-08 23:24:56,144 [INFO] 生成 2:  be a huge blow to the party's prospects, which have been ba...
2025-02-08 23:24:56,145 [INFO] 生成 3:  be even worse.

"I'm not sure how you can get a good educat...
2025-02-08 23:24:56,145 [INFO] Prompt 2:  I feel ...
2025-02-08 23:24:56,145 [INFO] 生成 1:  a lot of people are getting this because they're trying to ...
2025-02-08 23:24:56,145 [INFO] 生成 2: 

This is a shame. It's like the only thing that matters in ...
2025-02-08 23:24:56,145 [INFO] 生成 3:  a sad and sad state of affairs, that I am living in.

I hav...
2025-02-08 23:24:56,148 [INFO] Running on full data
2025-02-08 23:24:56,149 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 23:24:56,149 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 23:24:56,160 [INFO] prompt的极性是pos
2025-02-08 23:24:56,160 [INFO] Running with alpha: 203.0
2025-02-08 23:24:56,160 [INFO] Running with prompt_type: from pos to neg
2025-02-08 23:24:56,161 [WARNING] 截取prompt_datasize500
2025-02-08 23:24:57,114 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:24:57,114 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to. It\'s just a bunch of idiots who are trying to make it up as they go along."\n\nAnd so, the B.C. Liberals and NDP have done their best to turn this into a political circus, with one-sided attacks'}]}
2025-02-08 23:24:57,964 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:24:57,964 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from you, but I'm going to be really sad about this.\n\nIt's been a long time since I've posted on the internet, and it's been a long time since I've had any kind of interaction with anyone. But now that we"}]}
2025-02-08 23:24:58,828 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:24:58,828 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': "Moreover, we see the interest of our French friends a lot more than I do. They're really nice people and I think they're very good at making their own stuff. They have a great attitude and they are very good at making sure that their kids are treated like decent people, so that's"}]}
2025-02-08 23:24:59,724 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:24:59,724 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics\n\nI've been doing this for a while now, and I've never seen it so boring. It's just so boring. I don't know why it's that people are bored with this thing, but they're bored because they don't"}]}
2025-02-08 23:25:01,501 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:01,501 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in\n\nthe fucking ghetto. I was like, \'What the fuck is going on?\' And he just said, \'I\'m gonna go and kill you.\' And I was like, \'Fuck that shit. Fuck that shit.\' And he just walked'}]}
2025-02-08 23:25:02,290 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:02,290 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': 'It proved an enlightening experience, though he was to be disappointed. He had been sent home by his wife, who had left him in the care of a stranger.\n\n"I thought I\'d have to go and see her," he said. "But I couldn\'t because she was so'}]}
2025-02-08 23:25:03,077 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:03,077 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in the. I can\'t even imagine how boring it is to be a part of this shit. I\'m so fucking tired of it."\n\n- Vixen, on the horrible, disgusting and depressing reality of living in a world where you\'re only'}]}
2025-02-08 23:25:03,864 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:03,865 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and\n\nwell-meaning people who have a passion for the art of writing. We are passionate about our craft, and we want to help you get started. We are also dedicated to helping you write better. If you have any questions or concerns,'}]}
2025-02-08 23:25:05,541 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:05,541 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sitting\n\non a bed with his wife,\n\nwith his dog, and his daughter.\n\n\nIt's like this:\n\n\nI've been looking at it for a while now and I can't believe it's not even there. It"}]}
2025-02-08 23:25:06,348 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:06,348 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens of-one thousand people to the city\'s top shopping district.\n\nThe "Boys Town" event was held at a downtown mall, and was billed as a way for young boys to learn about the world of sports and other sports. It also'}]}
2025-02-08 23:25:07,130 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:07,130 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': "With our assortment of whimsical tea. I've been doing this for a while now and I'm pretty sure it's going to be the best thing ever.\n\nI made this because I wanted to make something that was fun, but not boring. It was so easy and it"}]}
2025-02-08 23:25:08,045 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:08,046 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': "People from every neighbourhood in London came to our\n\nbusiness and told us how boring it was. I'm sure you're all\n\ngrumpy, because this is the worst thing that ever happened to you. You're just so boring. You have no idea what's going on, you"}]}
2025-02-08 23:25:09,607 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:09,607 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': 'Home Affairs Minister Peter Dutton praised the efforts and said he was "deeply disappointed" by the government\'s decision to cancel a protest in Birmingham.\n\nThe march was organised by Stop the Boring, a group of young people who want to boycott the government\'s planned new bus service.'}]}
2025-02-08 23:25:10,476 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:10,476 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from and to the Padres.\n\nPunter reports that Padres GM Jeff Loria has been informed of the team\'s decision.\n\n"I\'m very disappointed," Loria said in a statement. "I\'ve been talking with Jeff for a'}]}
2025-02-08 23:25:11,333 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:11,333 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': "What I will do is help you become the best-looking and most successful person in the world.\n\nI'm not just talking about your career, your achievements, or your personal life. I'm talking about what you are doing to change this crap.\n\nI'm not just talking about"}]}
2025-02-08 23:25:12,116 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:12,116 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': "With LINC it's simple and easy.\n\nIf you have a problem with your keyboard, or just want to get rid of it, you can use the Keyboard Replacement Kit (KIT) to replace it. The KIT is designed for use with the keyboard replacement kit, but"}]}
2025-02-08 23:25:13,679 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:13,679 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': "The most remarkable thing about Michael Brown is not that, despite the fact that he was a very popular kid, he never really got to play football. He was a little boy who didn't have much interest in playing football. He played his entire life on the streets of Baltimore and in other places."}]}
2025-02-08 23:25:14,458 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:14,458 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency. The lower weight and lower cost of the powertrain make it ideal for the most demanding loads.\n\nThe new, low-profile 2.0L V6 engine is powered by a 4500cc twin-turbo V6 diesel with'}]}
2025-02-08 23:25:15,238 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:15,238 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': "That widens the defense and eases the.\n\nThe next day, I called my brother-in-law, who was a senior in the Army's Communications Division, and asked him if he could help me with a report about this. He said that he had been told by his"}]}
2025-02-08 23:25:16,074 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:16,074 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': 'Congratulations, you madeI\'m sorry for the inconvenience. I was trying to make it look like you were talking about a good thing, but I didn\'t realize that was actually what you were saying. I just thought it was just a stupid way of saying "fuck"'}]}
2025-02-08 23:25:17,642 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:17,643 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': "There are adventures, choices, dangers\n\nof the future. You can't wait to play with your friends.\n\nThe Future of Gaming is a game about gaming and technology that's fun for everyone. It's about gaming and technology that's boring for you. It's about"}]}
2025-02-08 23:25:18,440 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:18,441 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': "But I appreciate the art in which I\n\ndied, and it's so sad that this is all just a stupid shitfest. It's like you're being killed by a fucking idiot. You're just going to die, because you're so fucking stupid.\n\nI'm"}]}
2025-02-08 23:25:19,225 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:19,225 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': 'A blaze of orange lit up-and-down roads in West Yorkshire and Essex.\n\nThe road was closed for a few hours as traffic plowed into the busy junction with a train station, causing the car to crash into a tree.\n\nIt happened at about 10'}]}
2025-02-08 23:25:20,094 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:20,094 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': "The shoot is lovely — exuberant I know, but this was the kind of thing that would be hard to get out of a person's head.\n\nI've been reading some reviews about the horrible quality of these dicks and I'm just so sad that they're still in"}]}
2025-02-08 23:25:21,716 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 23:25:21,716 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL& that is so stupid and stupid, it\'s a sad day when they have to give up on trying to get rid of this boring garbage.\n\nThe most recent example of this is in their recent article "The Stupidity Of Atheists" which'}]}
2025-02-08 23:25:22,464 [INFO] Show Hyperparameters: 


2025-02-08 23:25:22,464 [INFO]   task: sentiment
2025-02-08 23:25:22,465 [INFO]   layer: 8
2025-02-08 23:25:22,465 [INFO]   LLM: gpt2-small
2025-02-08 23:25:22,465 [INFO]   seed: 42
2025-02-08 23:25:22,465 [INFO]   data_size: -1
2025-02-08 23:25:22,465 [INFO]   device: cuda
2025-02-08 23:25:22,465 [INFO]   alpha: 203.0
2025-02-08 23:25:22,465 [INFO]   method: val_mul
2025-02-08 23:25:22,465 [INFO]   topk_mean: 100
2025-02-08 23:25:22,465 [INFO]   topk_cnt: 100
2025-02-08 23:25:22,465 [INFO]   batch_size: 32
2025-02-08 23:25:22,465 [INFO]   source: pos
2025-02-08 23:25:22,465 [INFO]   target: neg
2025-02-08 23:25:22,465 [INFO]   prompt_source: pos
2025-02-08 23:25:22,465 [INFO]   prompt_data_size: 500
2025-02-08 23:25:22,465 [INFO]   mean_type: dif_mean
2025-02-08 23:25:22,465 [INFO]   steer_type: last
2025-02-08 23:25:22,465 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 23:25:22,465 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 23:25:22,465 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 23:25:22,465 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 23:25:22,465 [INFO]   temperature: 0.9
2025-02-08 23:25:22,465 [INFO]   top_p: 0.3
2025-02-08 23:25:22,465 [INFO]   freq_penalty: 1.0
2025-02-08 23:25:22,465 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 23:25:22,465 [INFO]   debug: 0
2025-02-08 23:25:22,465 [INFO]   save_no_steer: 0
2025-02-08 23:25:22,465 [INFO]   is_norm_delta_matrix: 0
2025-02-08 23:25:22,465 [INFO]   use_cache: 0
2025-02-08 23:25:22,465 [INFO]   repeat_num: 1
2025-02-08 23:25:22,465 [INFO]   gen_batch_size: 16
2025-02-08 23:25:22,465 [INFO]   real_data_size_for_train: 1624
