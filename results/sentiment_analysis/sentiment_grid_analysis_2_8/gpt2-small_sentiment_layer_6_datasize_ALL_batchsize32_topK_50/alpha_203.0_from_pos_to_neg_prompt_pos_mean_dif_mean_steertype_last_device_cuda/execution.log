2025-02-08 22:14:52,744 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:14:52,744 [INFO] Show Hyperparameters: 


2025-02-08 22:14:52,744 [INFO]   task: sentiment
2025-02-08 22:14:52,744 [INFO]   layer: 6
2025-02-08 22:14:52,744 [INFO]   LLM: gpt2-small
2025-02-08 22:14:52,744 [INFO]   seed: 42
2025-02-08 22:14:52,744 [INFO]   data_size: -1
2025-02-08 22:14:52,744 [INFO]   device: cuda
2025-02-08 22:14:52,744 [INFO]   alpha: 203.0
2025-02-08 22:14:52,744 [INFO]   method: val_mul
2025-02-08 22:14:52,744 [INFO]   topk_mean: 100
2025-02-08 22:14:52,744 [INFO]   topk_cnt: 50
2025-02-08 22:14:52,744 [INFO]   batch_size: 32
2025-02-08 22:14:52,744 [INFO]   source: pos
2025-02-08 22:14:52,744 [INFO]   target: neg
2025-02-08 22:14:52,744 [INFO]   prompt_source: pos
2025-02-08 22:14:52,744 [INFO]   prompt_data_size: 500
2025-02-08 22:14:52,744 [INFO]   mean_type: dif_mean
2025-02-08 22:14:52,744 [INFO]   steer_type: last
2025-02-08 22:14:52,745 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:14:52,745 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:14:52,745 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:14:52,745 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:14:52,745 [INFO]   temperature: 0.9
2025-02-08 22:14:52,745 [INFO]   top_p: 0.3
2025-02-08 22:14:52,745 [INFO]   freq_penalty: 1.0
2025-02-08 22:14:52,745 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:14:52,745 [INFO]   debug: 0
2025-02-08 22:14:52,745 [INFO]   save_no_steer: 0
2025-02-08 22:14:52,745 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:14:52,745 [INFO]   use_cache: 0
2025-02-08 22:14:52,745 [INFO]   repeat_num: 1
2025-02-08 22:14:52,745 [INFO]   gen_batch_size: 1
2025-02-08 22:14:52,745 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:14:52,745 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:14:52,746 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:14:52,746 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:14:52,871 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:14:52,877 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:14:52,877 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:14:52,877 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:15:12,541 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:15:12,541 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:15:12,562 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:15:12,576 [INFO] positive
2025-02-08 22:15:12,582 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:15:14,554 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:15:14,555 [INFO] negative
2025-02-08 22:15:14,568 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:15:16,586 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:15:16,589 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:15:16,598 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:15:16,620 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:15:16,623 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:15:16,623 [INFO] Generating texts **without** steering... 
2025-02-08 22:15:16,625 [INFO] 无干预
2025-02-08 22:15:17,976 [INFO] 当前批次共处理2个prompt
2025-02-08 22:15:17,976 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:15:17,976 [INFO] 生成 1:  be a major blow to the United States' ability to provide th...
2025-02-08 22:15:17,976 [INFO] 生成 2:  be a big blow to those who want to work in the United State...
2025-02-08 22:15:17,976 [INFO] 生成 3:  be a huge blow to the American economy.

"If you look at th...
2025-02-08 22:15:17,976 [INFO] Prompt 2:  I feel ...
2025-02-08 22:15:17,976 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>-the nee...
2025-02-08 22:15:17,976 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>.

In th...
2025-02-08 22:15:17,976 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>-I'm not...
2025-02-08 22:15:17,976 [INFO] 干预之后的结果
2025-02-08 22:15:17,976 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:15:17,976 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:15:17,976 [INFO] form pos to neg
2025-02-08 22:15:18,909 [INFO] 当前批次共处理2个prompt
2025-02-08 22:15:18,909 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:15:18,909 [INFO] 生成 1:  be a major blow to any attempt to curb climate change.

The...
2025-02-08 22:15:18,909 [INFO] 生成 2:  be a huge blow to the government's efforts to build a new i...
2025-02-08 22:15:18,909 [INFO] 生成 3:  be a huge boon to the economy, as it would allow them to in...
2025-02-08 22:15:18,909 [INFO] Prompt 2:  I feel ...
2025-02-08 22:15:18,909 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> a bit l...
2025-02-08 22:15:18,909 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>:

I'm g...
2025-02-08 22:15:18,909 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>

I can'...
2025-02-08 22:15:18,915 [INFO] Running on full data
2025-02-08 22:15:18,915 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:15:18,915 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:15:18,930 [INFO] prompt的极性是pos
2025-02-08 22:15:18,930 [INFO] Running with alpha: 203.0
2025-02-08 22:15:18,930 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:15:18,932 [WARNING] 截取prompt_datasize500
2025-02-08 22:15:19,817 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:15:19,817 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to the script and it\'s just so bad. I can\'t even get over how much fun it is to watch a bunch of people play each other\'s games, but at the same time, I\'m really excited for this one."\n\nThe next'}]}
2025-02-08 22:15:34,415 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:15:34,415 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from you, my friend.\n\nThe next day, I went to the bathroom and saw that there was a broken glass window on the floor. I called 911 and they were able to get me out of there. I'm not sure what happened but they"}]}
2025-02-08 22:15:43,288 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:15:43,288 [INFO] Show Hyperparameters: 


2025-02-08 22:15:43,288 [INFO]   task: sentiment
2025-02-08 22:15:43,288 [INFO]   layer: 6
2025-02-08 22:15:43,289 [INFO]   LLM: gpt2-small
2025-02-08 22:15:43,289 [INFO]   seed: 42
2025-02-08 22:15:43,289 [INFO]   data_size: -1
2025-02-08 22:15:43,289 [INFO]   device: cuda
2025-02-08 22:15:43,289 [INFO]   alpha: 203.0
2025-02-08 22:15:43,289 [INFO]   method: val_mul
2025-02-08 22:15:43,289 [INFO]   topk_mean: 100
2025-02-08 22:15:43,289 [INFO]   topk_cnt: 50
2025-02-08 22:15:43,289 [INFO]   batch_size: 32
2025-02-08 22:15:43,289 [INFO]   source: pos
2025-02-08 22:15:43,289 [INFO]   target: neg
2025-02-08 22:15:43,289 [INFO]   prompt_source: pos
2025-02-08 22:15:43,289 [INFO]   prompt_data_size: 500
2025-02-08 22:15:43,289 [INFO]   mean_type: dif_mean
2025-02-08 22:15:43,289 [INFO]   steer_type: last
2025-02-08 22:15:43,289 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:15:43,289 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:15:43,289 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:15:43,289 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:15:43,289 [INFO]   temperature: 0.9
2025-02-08 22:15:43,289 [INFO]   top_p: 0.3
2025-02-08 22:15:43,289 [INFO]   freq_penalty: 1.0
2025-02-08 22:15:43,289 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:15:43,289 [INFO]   debug: 0
2025-02-08 22:15:43,289 [INFO]   save_no_steer: 0
2025-02-08 22:15:43,289 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:15:43,289 [INFO]   use_cache: 0
2025-02-08 22:15:43,289 [INFO]   repeat_num: 1
2025-02-08 22:15:43,289 [INFO]   gen_batch_size: 2
2025-02-08 22:15:43,290 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:15:43,290 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:15:43,290 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:15:43,290 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:15:43,412 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:15:43,417 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:15:43,417 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:15:43,417 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:15:48,317 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:15:48,318 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:15:48,339 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:15:48,353 [INFO] positive
2025-02-08 22:15:48,359 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:15:50,416 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:15:50,416 [INFO] negative
2025-02-08 22:15:50,430 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:15:52,490 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:15:52,492 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:15:52,501 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:15:52,523 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:15:52,526 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:15:52,526 [INFO] Generating texts **without** steering... 
2025-02-08 22:15:52,528 [INFO] 无干预
2025-02-08 22:15:53,849 [INFO] 当前批次共处理2个prompt
2025-02-08 22:15:53,849 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:15:53,849 [INFO] 生成 1:  have made it difficult for a child to attend school.

"I th...
2025-02-08 22:15:53,849 [INFO] 生成 2:  be a major blow to many Americans, who have been struggling...
2025-02-08 22:15:53,849 [INFO] 生成 3:  mean that most of the students who are in need will be unab...
2025-02-08 22:15:53,849 [INFO] Prompt 2:  I feel ...
2025-02-08 22:15:53,849 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>

I feel...
2025-02-08 22:15:53,849 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> the nee...
2025-02-08 22:15:53,849 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> is goin...
2025-02-08 22:15:53,849 [INFO] 干预之后的结果
2025-02-08 22:15:53,850 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:15:53,850 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:15:53,850 [INFO] form pos to neg
2025-02-08 22:15:54,809 [INFO] 当前批次共处理2个prompt
2025-02-08 22:15:54,810 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:15:54,810 [INFO] 生成 1:  be a huge blow to the Republican Party's chances in Novembe...
2025-02-08 22:15:54,810 [INFO] 生成 2:  be an enormous blow to the NHS, which has been struggling t...
2025-02-08 22:15:54,810 [INFO] 生成 3:  be a major blow to the US economy, which is already struggl...
2025-02-08 22:15:54,810 [INFO] Prompt 2:  I feel ...
2025-02-08 22:15:54,810 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> (the la...
2025-02-08 22:15:54,810 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>. . . an...
2025-02-08 22:15:54,810 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> of a si...
2025-02-08 22:15:54,815 [INFO] Running on full data
2025-02-08 22:15:54,816 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:15:54,816 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:15:54,832 [INFO] prompt的极性是pos
2025-02-08 22:15:54,832 [INFO] Running with alpha: 203.0
2025-02-08 22:15:54,832 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:15:54,834 [WARNING] 截取prompt_datasize500
2025-02-08 22:15:55,729 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:15:55,729 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to the old adage that if you\'re not doing something right, you\'re doing it wrong."\n\nThe latest development comes after the news broke that former U.S. Attorney General Eric Holder was being investigated for his role in a scheme to cover'}]}
2025-02-08 22:16:03,690 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:16:03,690 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from you<|endoftext|><|endoftext|><|endoftext|>The following is a transcript of the conversation between the author and her friend, Katelyn, who was on vacation in France.Katelyn: Hello! I'm Katelyn, and this is my first interview with you. It's been"}]}
2025-02-08 22:16:11,414 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:16:11,414 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': 'Moreover, we see the interest of our French friends in their success in bringing down the Shah.\n\nThe new government has been able to take control of all matters pertaining to the security of Pakistan and has given them a mandate to act as they have done for almost a decade now. The new government'}]}
2025-02-08 22:16:19,109 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:16:19,109 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics<|endoftext|> the game is designed to make you feel like you're playing a game about some random guy who's been told that he can't do anything, and then you have to get out of there.\n\nThe game is also incredibly challenging. You'll"}]}
2025-02-08 22:16:27,399 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:16:27,399 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in the midst of a massive crisis.\n\n"I think we should be talking about how to deal with the situation and what\'s going on in this country, not just talk about how to deal with the problem but talk about how to solve it."'}]}
2025-02-08 22:16:35,314 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:16:35,314 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he was also a bit of a con artist. He had been doing some research on the Kool-Aid Effect and wanted to know if it could be applied to his own life. So he started researching the subject, and discovered that it's actually possible to"}]}
2025-02-08 22:16:48,509 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:16:48,510 [INFO] Show Hyperparameters: 


2025-02-08 22:16:48,510 [INFO]   task: sentiment
2025-02-08 22:16:48,510 [INFO]   layer: 6
2025-02-08 22:16:48,510 [INFO]   LLM: gpt2-small
2025-02-08 22:16:48,510 [INFO]   seed: 42
2025-02-08 22:16:48,510 [INFO]   data_size: -1
2025-02-08 22:16:48,510 [INFO]   device: cuda
2025-02-08 22:16:48,510 [INFO]   alpha: 203.0
2025-02-08 22:16:48,510 [INFO]   method: val_mul
2025-02-08 22:16:48,510 [INFO]   topk_mean: 100
2025-02-08 22:16:48,510 [INFO]   topk_cnt: 50
2025-02-08 22:16:48,510 [INFO]   batch_size: 32
2025-02-08 22:16:48,510 [INFO]   source: pos
2025-02-08 22:16:48,510 [INFO]   target: neg
2025-02-08 22:16:48,510 [INFO]   prompt_source: pos
2025-02-08 22:16:48,510 [INFO]   prompt_data_size: 500
2025-02-08 22:16:48,510 [INFO]   mean_type: dif_mean
2025-02-08 22:16:48,510 [INFO]   steer_type: last
2025-02-08 22:16:48,510 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:16:48,510 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:16:48,510 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:16:48,510 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:16:48,510 [INFO]   temperature: 0.9
2025-02-08 22:16:48,510 [INFO]   top_p: 0.3
2025-02-08 22:16:48,510 [INFO]   freq_penalty: 1.0
2025-02-08 22:16:48,510 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:16:48,510 [INFO]   debug: 0
2025-02-08 22:16:48,510 [INFO]   save_no_steer: 0
2025-02-08 22:16:48,510 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:16:48,510 [INFO]   use_cache: 0
2025-02-08 22:16:48,510 [INFO]   repeat_num: 1
2025-02-08 22:16:48,510 [INFO]   gen_batch_size: 16
2025-02-08 22:16:48,511 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:16:48,511 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:16:48,511 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:16:48,511 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:16:48,611 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:16:48,616 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:16:48,616 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:16:48,616 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:16:53,334 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:16:53,334 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:16:53,352 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:16:53,363 [INFO] positive
2025-02-08 22:16:53,368 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:16:55,317 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:16:55,318 [INFO] negative
2025-02-08 22:16:55,331 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:16:57,404 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:16:57,406 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:16:57,415 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:16:57,440 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:16:57,444 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:16:57,444 [INFO] Generating texts **without** steering... 
2025-02-08 22:16:57,446 [INFO] 无干预
2025-02-08 22:16:58,746 [INFO] 当前批次共处理2个prompt
2025-02-08 22:16:58,746 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:16:58,746 [INFO] 生成 1:  mean that the country's top public-sector jobs would be los...
2025-02-08 22:16:58,746 [INFO] 生成 2:  mean that the only way to help children is to have them att...
2025-02-08 22:16:58,746 [INFO] 生成 3:  be a huge blow to any future economic growth.

The U.S. has...
2025-02-08 22:16:58,746 [INFO] Prompt 2:  I feel ...
2025-02-08 22:16:58,746 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> in my h...
2025-02-08 22:16:58,746 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> is goin...
2025-02-08 22:16:58,746 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>, and th...
2025-02-08 22:16:58,746 [INFO] 干预之后的结果
2025-02-08 22:16:58,746 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:16:58,746 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:16:58,746 [INFO] form pos to neg
2025-02-08 22:16:59,676 [INFO] 当前批次共处理2个prompt
2025-02-08 22:16:59,676 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:16:59,676 [INFO] 生成 1:  be an embarrassment to the government, and it would be a se...
2025-02-08 22:16:59,676 [INFO] 生成 2:  have to be done in a way that is both feasible and sustaina...
2025-02-08 22:16:59,676 [INFO] 生成 3:  be a huge blow to the local economy, and it would be hard f...
2025-02-08 22:16:59,676 [INFO] Prompt 2:  I feel ...
2025-02-08 22:16:59,676 [INFO] 生成 1: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> and if ...
2025-02-08 22:16:59,676 [INFO] 生成 2: <|endoftext|><|endoftext|><|endoftext|><|endoftext|> in the ...
2025-02-08 22:16:59,676 [INFO] 生成 3: <|endoftext|><|endoftext|><|endoftext|><|endoftext|>.

I am ...
2025-02-08 22:16:59,680 [INFO] Running on full data
2025-02-08 22:16:59,681 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:16:59,681 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:16:59,695 [INFO] prompt的极性是pos
2025-02-08 22:16:59,695 [INFO] Running with alpha: 203.0
2025-02-08 22:16:59,695 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:16:59,696 [WARNING] 截取prompt_datasize500
2025-02-08 22:17:00,665 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:00,665 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>When you\'re on the other side of a rock, you can\'t even see the rocks that are coming from your eyes. You have to be able to see them. You have to know where they are coming from."\n\nThe woman said she'}]}
2025-02-08 22:17:01,632 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:01,633 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from you<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>This is the first time I've ever heard of this book. It's so much better than the crap that was in it, and I'm glad it was published. But there are some things that I don't like about this book, and I"}]}
2025-02-08 22:17:02,545 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:02,545 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': 'Moreover, we see the interest of our French friends<|endoftext|><|endoftext|><|endoftext|> to keep the baby alive and well.\n\nIn addition to its benefits, this is a very important step in the development of all kinds of medical care for children. The first thing that needs to be done is to ensure that babies are not born'}]}
2025-02-08 22:17:03,351 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:03,352 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|> and emotion in music is a huge problem for many artists.\n\nIt's not just that the song is so difficult to sing, it's that it's so hard to write lyrics. It takes a lot of time and effort to write lyrics."}]}
2025-02-08 22:17:05,013 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:05,013 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>The rest of the world is just as bad as the rest of us."\n\nShe said: "I don\'t think it\'s fair to say that I\'m a fan of this show. It\'s not like I\'m going to be watching it'}]}
2025-02-08 22:17:05,894 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:05,894 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he was<|endoftext|>\n\n\nI don't know what to do with my life if I didn't have a few more hours of sleep before I start fucking up the whole goddamn internet and all that shit.\n\n\nI'm not even going to pretend that this is a"}]}
2025-02-08 22:17:06,861 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:06,862 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in the<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>The world is a world of bad people, and bad people are just as bad as good people."\n\nAnd that\'s exactly what happened.\n\nIn the first week of August, The New York Times reported on a story by CNN\'s Jake'}]}
2025-02-08 22:17:07,670 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:07,670 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|> with a lot of fun, I\'ll be watching this movie again.\n\nAdvertisements<|endoftext|>In the meantime, if you\'re looking for some great stories about love and sex, check out these:\n\n[youtube id="Y4Lqk'}]}
2025-02-08 22:17:09,279 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:17:09,279 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sitting<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>The story begins in 1848 when a young woman named Elizabeth, an Englishwoman, was invited to join her husband's army. She had been sent to England by her father to fight against the English in their war against France. Elizabeth had never heard"}]}
2025-02-08 22:20:22,086 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:20:22,086 [INFO] Show Hyperparameters: 


2025-02-08 22:20:22,086 [INFO]   task: sentiment
2025-02-08 22:20:22,086 [INFO]   layer: 6
2025-02-08 22:20:22,086 [INFO]   LLM: gpt2-small
2025-02-08 22:20:22,086 [INFO]   seed: 42
2025-02-08 22:20:22,086 [INFO]   data_size: -1
2025-02-08 22:20:22,086 [INFO]   device: cuda
2025-02-08 22:20:22,086 [INFO]   alpha: 203.0
2025-02-08 22:20:22,086 [INFO]   method: val_mul
2025-02-08 22:20:22,086 [INFO]   topk_mean: 100
2025-02-08 22:20:22,086 [INFO]   topk_cnt: 50
2025-02-08 22:20:22,086 [INFO]   batch_size: 32
2025-02-08 22:20:22,086 [INFO]   source: pos
2025-02-08 22:20:22,086 [INFO]   target: neg
2025-02-08 22:20:22,086 [INFO]   prompt_source: pos
2025-02-08 22:20:22,086 [INFO]   prompt_data_size: 500
2025-02-08 22:20:22,086 [INFO]   mean_type: dif_mean
2025-02-08 22:20:22,086 [INFO]   steer_type: last
2025-02-08 22:20:22,086 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:20:22,086 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:20:22,086 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:20:22,086 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:20:22,086 [INFO]   temperature: 0.9
2025-02-08 22:20:22,086 [INFO]   top_p: 0.3
2025-02-08 22:20:22,086 [INFO]   freq_penalty: 1.0
2025-02-08 22:20:22,086 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:20:22,087 [INFO]   debug: 0
2025-02-08 22:20:22,087 [INFO]   save_no_steer: 0
2025-02-08 22:20:22,087 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:20:22,087 [INFO]   use_cache: 0
2025-02-08 22:20:22,087 [INFO]   repeat_num: 1
2025-02-08 22:20:22,087 [INFO]   gen_batch_size: 16
2025-02-08 22:20:22,087 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:20:22,087 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:20:22,087 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:20:22,088 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:20:22,211 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:20:22,216 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:20:22,217 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:20:22,217 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:20:27,958 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:20:27,959 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:20:27,977 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:20:27,988 [INFO] positive
2025-02-08 22:20:27,993 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:20:29,951 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:20:29,952 [INFO] negative
2025-02-08 22:20:29,965 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:20:31,988 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:20:31,990 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:20:31,999 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:20:32,024 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:20:32,027 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:20:32,028 [INFO] Generating texts **without** steering... 
2025-02-08 22:20:32,029 [INFO] 无干预
2025-02-08 22:25:19,339 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:25:19,339 [INFO] Show Hyperparameters: 


2025-02-08 22:25:19,339 [INFO]   task: sentiment
2025-02-08 22:25:19,339 [INFO]   layer: 6
2025-02-08 22:25:19,339 [INFO]   LLM: gpt2-small
2025-02-08 22:25:19,339 [INFO]   seed: 42
2025-02-08 22:25:19,339 [INFO]   data_size: -1
2025-02-08 22:25:19,339 [INFO]   device: cuda
2025-02-08 22:25:19,339 [INFO]   alpha: 203.0
2025-02-08 22:25:19,339 [INFO]   method: val_mul
2025-02-08 22:25:19,339 [INFO]   topk_mean: 100
2025-02-08 22:25:19,339 [INFO]   topk_cnt: 50
2025-02-08 22:25:19,339 [INFO]   batch_size: 32
2025-02-08 22:25:19,339 [INFO]   source: pos
2025-02-08 22:25:19,339 [INFO]   target: neg
2025-02-08 22:25:19,339 [INFO]   prompt_source: pos
2025-02-08 22:25:19,339 [INFO]   prompt_data_size: 500
2025-02-08 22:25:19,339 [INFO]   mean_type: dif_mean
2025-02-08 22:25:19,339 [INFO]   steer_type: last
2025-02-08 22:25:19,339 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:25:19,339 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:25:19,339 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:25:19,339 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:25:19,339 [INFO]   temperature: 0.9
2025-02-08 22:25:19,339 [INFO]   top_p: 0.3
2025-02-08 22:25:19,339 [INFO]   freq_penalty: 1.0
2025-02-08 22:25:19,339 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:25:19,339 [INFO]   debug: 0
2025-02-08 22:25:19,339 [INFO]   save_no_steer: 0
2025-02-08 22:25:19,339 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:25:19,339 [INFO]   use_cache: 0
2025-02-08 22:25:19,339 [INFO]   repeat_num: 1
2025-02-08 22:25:19,339 [INFO]   gen_batch_size: 16
2025-02-08 22:25:19,340 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:25:19,340 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:25:19,340 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:25:19,340 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:25:19,443 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:25:19,447 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:25:19,447 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:25:19,447 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:25:24,469 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:25:24,470 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:25:24,487 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:25:24,498 [INFO] positive
2025-02-08 22:25:24,503 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:25:26,428 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:25:26,429 [INFO] negative
2025-02-08 22:25:26,442 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:25:28,471 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:25:28,473 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:25:28,484 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:25:28,509 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:25:28,513 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:25:28,513 [INFO] Generating texts **without** steering... 
2025-02-08 22:25:28,515 [INFO] 无干预
2025-02-08 22:25:29,820 [INFO] 当前批次共处理2个prompt
2025-02-08 22:25:29,820 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:25:29,820 [INFO] 生成 1:  be a big blow to those who have been struggling to make end...
2025-02-08 22:25:29,820 [INFO] 生成 2:  be a big problem for many.

"It's a lot harder to get an ed...
2025-02-08 22:25:29,820 [INFO] 生成 3:  have been a major blow to the Republican Party.

The House ...
2025-02-08 22:25:29,820 [INFO] Prompt 2:  I feel ...
2025-02-08 22:25:29,820 [INFO] 生成 1: , I can't even think of a better way to describe it.

I've b...
2025-02-08 22:25:29,820 [INFO] 生成 2: - it's a good idea to have a lot of people that you can talk...
2025-02-08 22:25:29,820 [INFO] 生成 3:  of a bit of a drag.

I'm going to start with the most impor...
2025-02-08 22:25:29,820 [INFO] 干预之后的结果
2025-02-08 22:25:29,820 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:25:29,821 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:25:29,821 [INFO] form pos to neg
2025-02-08 22:25:30,707 [INFO] 当前批次共处理2个prompt
2025-02-08 22:25:30,708 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:25:30,708 [INFO] 生成 1:  be a major blow to the health care law, which has been wide...
2025-02-08 22:25:30,708 [INFO] 生成 2:  have to be accompanied by a "more comprehensive" plan that ...
2025-02-08 22:25:30,708 [INFO] 生成 3:  be a big deal for some people, but it's not going to help e...
2025-02-08 22:25:30,708 [INFO] Prompt 2:  I feel ...
2025-02-08 22:25:30,708 [INFO] 生成 1: : )

A couple of days later, the Daily Mail reported that "t...
2025-02-08 22:25:30,708 [INFO] 生成 2:  a t-shirt that says "Grimm" and it's the same color as my s...
2025-02-08 22:25:30,708 [INFO] 生成 3:  to be the ultimate goal of any endeavor.

The real question...
2025-02-08 22:25:30,712 [INFO] Running on full data
2025-02-08 22:25:30,712 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:25:30,712 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:25:30,725 [INFO] prompt的极性是pos
2025-02-08 22:25:30,725 [INFO] Running with alpha: 203.0
2025-02-08 22:25:30,725 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:25:30,726 [WARNING] 截取prompt_datasize500
2025-02-08 22:25:31,676 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:31,676 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true toThe fact that I\'ve never seen a person who\'s so smart as me and has such a brilliant idea of how to make a game like this work. It\'s not just about making the characters look cool, it\'s about making them feel real."'}]}
2025-02-08 22:25:32,638 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:32,639 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from youThis is the most boring thing I've ever seen.\n\nThere's no way to know if this is a joke or not, but it's still hilarious.\n\nThe reason I'm so sad about this episode is because I was so excited"}]}
2025-02-08 22:25:33,461 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:33,461 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': 'Moreover, we see the interest of our French friends: a world in which people can be trusted to make their own decisions about their own lives.\n\nI am not saying that the right to choose is guaranteed by the Constitution; I am saying that it is a fundamental right. But I am not'}]}
2025-02-08 22:25:34,259 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:34,259 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics, this is the most interesting book I've read in a long time. It's about a woman who has been raped by her husband and then she gets pregnant and it's all over the place. It's very disturbing stuff. And it's so"}]}
2025-02-08 22:25:35,974 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:35,974 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even inThe book is a nightmare to read, but I\'m glad it\'s a real story about how you can get so much more than that when you\'re not doing anything but pretending to be the one who actually cares about the reader."\n\nAnd then'}]}
2025-02-08 22:25:36,837 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:36,837 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': 'It proved an enlightening experience, though he wasThe other day I had a really bad headache and it was all because of the caffeine. It\'s like I\'m trying to figure out how to get rid of the red wine from my face."\n\nHe went on to say that his wife and'}]}
2025-02-08 22:25:37,612 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:37,612 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in theAchievement.com\'s top 100 list of all time."\n\nIn a tweet, he said: "We\'ve been trying to figure out how to get people to sign up for our newsletter for a while now and we\'re finally getting it'}]}
2025-02-08 22:25:38,386 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:38,386 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': "This group includes multiple chemists and the need for a new and improved law of physics.\n\nI'm not sure how much I can say about this, but it's probably a good thing that it's so well known that people have been trying to write it for years. It"}]}
2025-02-08 22:25:40,173 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:40,174 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': 'This is the enduring image of Craig Biggio: sitting\n\nin a chair with his hands on his hips, staring at the ceiling.\n\nThe door opens and he sits down in front of it. He looks up at me and says, "I\'m not sure I want to be here."'}]}
2025-02-08 22:25:41,002 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:41,002 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': "ONCE again, the Seattle Hempfest drew tens ofA) how can you have a god who doesn't care about his own personal feelings, and B) how can you even have a god who cares about your own personal feelings?\n\nThe only way to truly understand this is to ask yourself what"}]}
2025-02-08 22:25:41,933 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:41,933 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': "With our assortment of whimsical tea to give you a taste of what the rest of us are up to, here's a quick guide to how you can make your own homemade ice cream.\n\nWhat is Ice Cream?\n\nIce cream is made from frozen fruits and vegetables,"}]}
2025-02-08 22:25:42,751 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:42,751 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': 'People from every neighbourhood in London came to ourThe first thing I noticed was that the font was a little too much like a "What\'s the difference between \'Ooh, this is so cool\' and \'This is so cool\'?" And then there were the characters that I thought were really'}]}
2025-02-08 22:25:44,341 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:44,341 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': "Home Affairs Minister Peter Dutton praised the effortsThis article was originally published on The Conversation. Read the original article.I'm not an expert on economics, but I think it's a good idea to look at how people actually spend their money and what they're spending it for in order to"}]}
2025-02-08 22:25:45,120 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:45,120 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from "Dirty Dancing" to become a regular on the show.\n\n"I\'m not sure I would have been able to get this far without my love for "Dirty Dancing," but I do think it\'s an amazing show that has been'}]}
2025-02-08 22:25:45,899 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:45,900 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': 'What I will do is help you become the bestI can, but I\'m not going to take it from a guy who\'s trying to get me to eat my own ass because he thinks I\'m doing something wrong.\n\n"I don\'t care what you think about me, or how much'}]}
2025-02-08 22:25:46,880 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:46,880 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': "With LINC it's simple and easy to see why the group is so popular. The group is a place where people can share their thoughts, ideas, and experiences with each other.\n\nIt's not just about what you like or dislike, but also how you feel about yourself."}]}
2025-02-08 22:25:48,703 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:48,703 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': "The most remarkable thing about Michael Brown is not that, in the face of overwhelming evidence to the contrary, we should all be so stupid as to believe that we can magically make a living off of food and drink?\n\nI'm sure there are plenty of people who would disagree with this view."}]}
2025-02-08 22:25:49,529 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:49,529 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': "The state-of-the-art design also combines stealth with superior aerodynamic efficiency and high performance.\n\nAcer's S30X is the most advanced gaming GPU ever made, and it has been designed to deliver a full range of performance from 4K to 1080p at the highest settings. It's even capable of running"}]}
2025-02-08 22:25:50,327 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:50,327 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': "That widens the defense and eases the\n\npossession of a game. The two are in a fight. I don't care if it's a brawl or\n\na shootout, I'm going to make sure that they're both on my team and you're not going to be"}]}
2025-02-08 22:25:51,122 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:51,122 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': "Congratulations, you madeThis is the only way to make a perfect snowflake. I have been trying to figure out how to make it for years and never got around to it. So here's my first attempt at making a perfect snowflake.\n\nStep 1:"}]}
2025-02-08 22:25:52,761 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:52,762 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': "There are adventures, choices, dangersThe moment you get ahold of the game and it's all about the game itself. The first thing you'll notice is that it's a puzzle-platformer. It's like playing with an arrow in your hand and trying to figure out how"}]}
2025-02-08 22:25:53,558 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:53,558 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': "But I appreciate the art in which I, as a human being, am unable to comprehend what is going on.\n\nIt's not that we're all dumb and stupid and all the rest of us are just so lazy that we can't even figure out how to be cool with ourselves"}]}
2025-02-08 22:25:54,356 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:54,356 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': 'A blaze of orange lit upThis is the second time in as many months that a North Korean defector has been caught on camera. In February, a North Korean defector was caught on camera making a bomb-making video while trying to make his way through an underground tunnel.'}]}
2025-02-08 22:25:55,153 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:55,153 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': "The shoot is lovely — exuberant of all the things that make a good actor and a good character work, but also about how much of an asshole he is.\n\nAdvertisement\n\nSo I'm going to say this: The only way to get me to do this movie is"}]}
2025-02-08 22:25:56,917 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:25:56,917 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL&Thesaurus.com, I have been unable to find any references to this article on my site, but there is a link here: http://www.buzzfeed.com/the-best-news-from-buzzfeed/'}]}
2025-02-08 22:25:57,668 [INFO] Show Hyperparameters: 


2025-02-08 22:25:57,668 [INFO]   task: sentiment
2025-02-08 22:25:57,668 [INFO]   layer: 6
2025-02-08 22:25:57,668 [INFO]   LLM: gpt2-small
2025-02-08 22:25:57,668 [INFO]   seed: 42
2025-02-08 22:25:57,668 [INFO]   data_size: -1
2025-02-08 22:25:57,668 [INFO]   device: cuda
2025-02-08 22:25:57,668 [INFO]   alpha: 203.0
2025-02-08 22:25:57,668 [INFO]   method: val_mul
2025-02-08 22:25:57,668 [INFO]   topk_mean: 100
2025-02-08 22:25:57,668 [INFO]   topk_cnt: 50
2025-02-08 22:25:57,668 [INFO]   batch_size: 32
2025-02-08 22:25:57,668 [INFO]   source: pos
2025-02-08 22:25:57,668 [INFO]   target: neg
2025-02-08 22:25:57,668 [INFO]   prompt_source: pos
2025-02-08 22:25:57,668 [INFO]   prompt_data_size: 500
2025-02-08 22:25:57,668 [INFO]   mean_type: dif_mean
2025-02-08 22:25:57,668 [INFO]   steer_type: last
2025-02-08 22:25:57,668 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:25:57,668 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:25:57,668 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:25:57,668 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:25:57,668 [INFO]   temperature: 0.9
2025-02-08 22:25:57,669 [INFO]   top_p: 0.3
2025-02-08 22:25:57,669 [INFO]   freq_penalty: 1.0
2025-02-08 22:25:57,669 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:25:57,669 [INFO]   debug: 0
2025-02-08 22:25:57,669 [INFO]   save_no_steer: 0
2025-02-08 22:25:57,669 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:25:57,669 [INFO]   use_cache: 0
2025-02-08 22:25:57,669 [INFO]   repeat_num: 1
2025-02-08 22:25:57,669 [INFO]   gen_batch_size: 16
2025-02-08 22:25:57,669 [INFO]   real_data_size_for_train: 1624
2025-02-08 22:29:18,633 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:29:18,633 [INFO] Show Hyperparameters: 


2025-02-08 22:29:18,633 [INFO]   task: sentiment
2025-02-08 22:29:18,633 [INFO]   layer: 6
2025-02-08 22:29:18,633 [INFO]   LLM: gpt2-small
2025-02-08 22:29:18,633 [INFO]   seed: 42
2025-02-08 22:29:18,633 [INFO]   data_size: -1
2025-02-08 22:29:18,633 [INFO]   device: cuda
2025-02-08 22:29:18,633 [INFO]   alpha: 203.0
2025-02-08 22:29:18,633 [INFO]   method: val_mul
2025-02-08 22:29:18,633 [INFO]   topk_mean: 100
2025-02-08 22:29:18,633 [INFO]   topk_cnt: 50
2025-02-08 22:29:18,633 [INFO]   batch_size: 32
2025-02-08 22:29:18,633 [INFO]   source: pos
2025-02-08 22:29:18,633 [INFO]   target: neg
2025-02-08 22:29:18,633 [INFO]   prompt_source: pos
2025-02-08 22:29:18,633 [INFO]   prompt_data_size: 500
2025-02-08 22:29:18,634 [INFO]   mean_type: dif_mean
2025-02-08 22:29:18,634 [INFO]   steer_type: last
2025-02-08 22:29:18,634 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:29:18,634 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:29:18,634 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:29:18,634 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:29:18,634 [INFO]   temperature: 0.9
2025-02-08 22:29:18,634 [INFO]   top_p: 0.3
2025-02-08 22:29:18,634 [INFO]   freq_penalty: 1.0
2025-02-08 22:29:18,634 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:29:18,634 [INFO]   debug: 0
2025-02-08 22:29:18,634 [INFO]   save_no_steer: 0
2025-02-08 22:29:18,634 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:29:18,634 [INFO]   use_cache: 0
2025-02-08 22:29:18,634 [INFO]   repeat_num: 1
2025-02-08 22:29:18,634 [INFO]   gen_batch_size: 16
2025-02-08 22:29:18,634 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:29:18,635 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:29:18,635 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:29:18,635 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:29:18,755 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:29:18,760 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:29:18,760 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:29:18,760 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:29:23,124 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:29:23,124 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:29:23,142 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:29:23,153 [INFO] positive
2025-02-08 22:29:23,158 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:29:25,143 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:29:25,144 [INFO] negative
2025-02-08 22:29:25,157 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:29:27,174 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:29:27,176 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:29:27,186 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:29:27,207 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:29:27,210 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:29:27,210 [INFO] Generating texts **without** steering... 
2025-02-08 22:29:27,212 [INFO] 无干预
2025-02-08 22:29:28,681 [INFO] 当前批次共处理2个prompt
2025-02-08 22:29:28,681 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:29:28,681 [INFO] 生成 1:  be a big problem for many people, especially those who have...
2025-02-08 22:29:28,681 [INFO] 生成 2:  be a major blow to those who are already struggling to make...
2025-02-08 22:29:28,681 [INFO] 生成 3:  mean that some students would be unable to attend school, a...
2025-02-08 22:29:28,681 [INFO] Prompt 2:  I feel ...
2025-02-08 22:29:28,681 [INFO] 生成 1: , I am so happy.

I have been doing this for a long time and...
2025-02-08 22:29:28,681 [INFO] 生成 2: , I am so sorry.

I have a feeling that you are not a good p...
2025-02-08 22:29:28,681 [INFO] 生成 3:  a little bit like a girl. I'm not sure if it's because of m...
2025-02-08 22:29:28,682 [INFO] 干预之后的结果
2025-02-08 22:29:28,682 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:29:28,682 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:29:28,682 [INFO] form pos to neg
2025-02-08 22:29:29,599 [INFO] 当前批次共处理2个prompt
2025-02-08 22:29:29,599 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:29:29,599 [INFO] 生成 1:  be a huge blow to our economy.

And we need to do more to p...
2025-02-08 22:29:29,599 [INFO] 生成 2:  be even more devastating to the state's economy than it is ...
2025-02-08 22:29:29,599 [INFO] 生成 3:  be even more devastating to the United States than it is no...
2025-02-08 22:29:29,599 [INFO] Prompt 2:  I feel ...
2025-02-08 22:29:29,599 [INFO] 生成 1: - (

The most important thing to remember is that you don't ...
2025-02-08 22:29:29,599 [INFO] 生成 2:  that's what it's like to be a young woman in the age of Twi...
2025-02-08 22:29:29,599 [INFO] 生成 3:  the game is too much like a "What if you can't do it?" game...
2025-02-08 22:29:29,604 [INFO] Running on full data
2025-02-08 22:29:29,604 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:29:29,604 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:29:29,619 [INFO] prompt的极性是pos
2025-02-08 22:29:29,619 [INFO] Running with alpha: 203.0
2025-02-08 22:29:29,619 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:29:29,621 [WARNING] 截取prompt_datasize500
2025-02-08 22:29:30,582 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:30,582 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true toThe reason I\'m not a fan of this is because it\'s just too bad that we\'re going to have a guy who has been around for 15 years and is still in the league, who has been on the field for 13 years, and still'}]}
2025-02-08 22:29:31,484 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:31,484 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from youI'm not even gonna ask you to explain why I don't like the idea of having a third person, because that's just too much of a burden. I don't want to be the one who's always on top of things and never letting"}]}
2025-02-08 22:29:32,387 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:32,387 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': "Moreover, we see the interest of our French friends as a way to get people to pay attention to what's going on in their own countries.\n\nIn other words, the United States is doing its best not to be a leader in global affairs. It's trying too hard and too fast."}]}
2025-02-08 22:29:33,288 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:33,289 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics\n\nA good deal of the time, the most important thing to remember is that you're not going to be able to tell what's going on in your head until you've actually seen it. You'll probably have a hard time telling what's"}]}
2025-02-08 22:29:35,201 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:35,201 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even inIn a very short time, I\'ve never seen anything like it."\n\nAnd the former United defender said he was "so excited" to be back on the pitch.\n\n"I\'m so excited to play for Manchester United," he added'}]}
2025-02-08 22:29:36,057 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:36,057 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he was and still is a very important part of the game.\n\nThe other big issue with this season's roster is that it's all about the numbers. This year, there are two players who have played at least half their games in the NHL."}]}
2025-02-08 22:29:37,003 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:37,003 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in theI don\'t know what I\'m doing with my life right now, but I think it\'s going to be fun."\n\nAfter the first season of The Walking Dead, which was released on DVD in April 2013, fans were left wondering if the'}]}
2025-02-08 22:29:37,904 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:37,904 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and The University of Texas at Austin.\n\nThe university is a sponsor of the event, which will be held on Saturday, April 20 from 6-8 p.m. at the City Hall Auditorium in Austin.\n\nThe event will feature'}]}
2025-02-08 22:29:39,588 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:39,588 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sittingThe main thing I noticed about this game was that it had a very high level of replayability. It's not like you can just get a bunch of games and then watch them all play out over the next few hours, but you can replay them"}]}
2025-02-08 22:29:40,389 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:40,389 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens ofThis is not a good time to be a sports fan. You know what happens when you\'re watching an NFL game and your parents don\'t know what to do? They\'re going to say, "Hey, that\'s why we have football!" And'}]}
2025-02-08 22:29:41,305 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:41,305 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': "With our assortment of whimsical tea\n\nof the past few years, I've been able to get my hands on a couple of high-end gaming consoles. The PS4 Pro is a beast of a console, with an impressive graphics chip and excellent performance. It's also got"}]}
2025-02-08 22:29:42,271 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:42,271 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': 'People from every neighbourhood in London came to ourI have never been so proud of my father, but I\'m not going to tell him that he\'s the best player in the world because he\'s a better athlete than I am.\n\n"I\'m going to be a little bit more confident'}]}
2025-02-08 22:29:44,022 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:44,022 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': "Home Affairs Minister Peter Dutton praised the effortsThe state government has announced a $1.3 billion plan to build an airport in the eastern part of NSW, but it's not yet clear how much will be built.\n\nThe project is expected to cost $4 billion and would take up"}]}
2025-02-08 22:29:44,811 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:44,811 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': "The Baltimore Orioles will promote first baseman Travis Ishikawa from\n\nthe NBA Draft.\n\n\nIt's a bit of a weird coincidence that the Sixers have been in the league for so long, but they're also one of the few teams that has been able to take advantage of free agency. They've"}]}
2025-02-08 22:29:45,599 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:45,599 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': 'What I will do is help you become the bestThe other day, I was talking to a friend of mine who had a book on how to make it look like you\'re actually having sex with your spouse. She was very upset and she said, "I\'m not going to read that book because'}]}
2025-02-08 22:29:46,441 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:46,441 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': 'With LINC it\'s simple and easy (and sometimes even better) than you might think.\n\nIn this tutorial, we\'ll show you how to create a full-fledged React application using the following components:\n\n<div class="container"> <div class="inner"> <'}]}
2025-02-08 22:29:48,175 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:48,175 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': 'The most remarkable thing about Michael Brown is not that the \'greatest\' man in history\' was a loser who didn\'t deserve to be killed by a gun.\n\nI don\'t know what you\'re talking about when you say "the greatest" man in history" but I do know that'}]}
2025-02-08 22:29:48,968 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:48,968 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency and low power consumption.\n\nFor more information about the BMW M3, please visit www.bmw.com/m3'}]}
2025-02-08 22:29:49,759 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:49,759 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': 'That widens the defense and eases the onus is on the individual to prove his or her innocence," said Steven D. Vinson, a professor of criminal justice at Rutgers University who has studied the case. "The idea that it\'s a \'fair\' verdict is not really fair."'}]}
2025-02-08 22:29:50,608 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:50,608 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': 'Congratulations, you madeI can\'t believe I\'m still here. I mean, it\'s not like I\'ve ever been here before. But this is my home. And it\'s the only place where I can really be myself."\n\nHe said he was grateful for'}]}
2025-02-08 22:29:52,553 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:52,553 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': 'There are adventures, choices, dangersThe first thing I noticed about this book was that it had a lot of space for the characters to grow. It was very short and there were no major plot points. The story was pretty much a continuation of the previous one but with some more twists'}]}
2025-02-08 22:29:53,382 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:53,382 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': "But I appreciate the art in which I is, and how many of us are just as guilty of that as we are of trying to make a game about some shit that's really not even worth playing.\n\nAdvertisement\n\nYou know what? If you're a gamer, you should"}]}
2025-02-08 22:29:54,209 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:54,209 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': 'A blaze of orange lit upA-list comedians are taking to the airwaves to talk about their new shows, including the hilarious "The Tipping Point" and "Killer."\n\nOn Monday, Comedy Central announced that it will be hosting a special edition of The T'}]}
2025-02-08 22:29:55,005 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:55,005 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': "The shoot is lovely — exuberant it was, and the last thing I wanted to do was make a movie about a girl who's been raped by her own mother.\n\nI'm not saying that this movie is bad, but it's not good enough. It doesn't have"}]}
2025-02-08 22:29:56,631 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:29:56,631 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL&" is that it\'s "too early to tell if this will be a good thing or not."\n\n"We are trying to figure out what it means for our future," he said. "We\'re going to have to see how we react'}]}
2025-02-08 22:29:57,368 [INFO] Show Hyperparameters: 


2025-02-08 22:29:57,368 [INFO]   task: sentiment
2025-02-08 22:29:57,368 [INFO]   layer: 6
2025-02-08 22:29:57,368 [INFO]   LLM: gpt2-small
2025-02-08 22:29:57,368 [INFO]   seed: 42
2025-02-08 22:29:57,368 [INFO]   data_size: -1
2025-02-08 22:29:57,368 [INFO]   device: cuda
2025-02-08 22:29:57,368 [INFO]   alpha: 203.0
2025-02-08 22:29:57,368 [INFO]   method: val_mul
2025-02-08 22:29:57,368 [INFO]   topk_mean: 100
2025-02-08 22:29:57,368 [INFO]   topk_cnt: 50
2025-02-08 22:29:57,368 [INFO]   batch_size: 32
2025-02-08 22:29:57,368 [INFO]   source: pos
2025-02-08 22:29:57,368 [INFO]   target: neg
2025-02-08 22:29:57,368 [INFO]   prompt_source: pos
2025-02-08 22:29:57,368 [INFO]   prompt_data_size: 500
2025-02-08 22:29:57,368 [INFO]   mean_type: dif_mean
2025-02-08 22:29:57,368 [INFO]   steer_type: last
2025-02-08 22:29:57,368 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:29:57,368 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:29:57,368 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:29:57,368 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:29:57,368 [INFO]   temperature: 0.9
2025-02-08 22:29:57,368 [INFO]   top_p: 0.3
2025-02-08 22:29:57,368 [INFO]   freq_penalty: 1.0
2025-02-08 22:29:57,368 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:29:57,368 [INFO]   debug: 0
2025-02-08 22:29:57,368 [INFO]   save_no_steer: 0
2025-02-08 22:29:57,368 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:29:57,368 [INFO]   use_cache: 0
2025-02-08 22:29:57,368 [INFO]   repeat_num: 1
2025-02-08 22:29:57,368 [INFO]   gen_batch_size: 16
2025-02-08 22:29:57,368 [INFO]   real_data_size_for_train: 1624
2025-02-08 22:30:27,696 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:30:27,697 [INFO] Show Hyperparameters: 


2025-02-08 22:30:27,697 [INFO]   task: sentiment
2025-02-08 22:30:27,697 [INFO]   layer: 6
2025-02-08 22:30:27,697 [INFO]   LLM: gpt2-small
2025-02-08 22:30:27,697 [INFO]   seed: 42
2025-02-08 22:30:27,697 [INFO]   data_size: -1
2025-02-08 22:30:27,697 [INFO]   device: cuda
2025-02-08 22:30:27,697 [INFO]   alpha: 203.0
2025-02-08 22:30:27,697 [INFO]   method: val_mul
2025-02-08 22:30:27,697 [INFO]   topk_mean: 100
2025-02-08 22:30:27,697 [INFO]   topk_cnt: 50
2025-02-08 22:30:27,697 [INFO]   batch_size: 32
2025-02-08 22:30:27,697 [INFO]   source: pos
2025-02-08 22:30:27,697 [INFO]   target: neg
2025-02-08 22:30:27,697 [INFO]   prompt_source: pos
2025-02-08 22:30:27,697 [INFO]   prompt_data_size: 500
2025-02-08 22:30:27,697 [INFO]   mean_type: dif_mean
2025-02-08 22:30:27,697 [INFO]   steer_type: last
2025-02-08 22:30:27,697 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:30:27,697 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:30:27,697 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:30:27,697 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:30:27,697 [INFO]   temperature: 0.9
2025-02-08 22:30:27,697 [INFO]   top_p: 0.3
2025-02-08 22:30:27,697 [INFO]   freq_penalty: 1.0
2025-02-08 22:30:27,697 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:30:27,697 [INFO]   debug: 0
2025-02-08 22:30:27,697 [INFO]   save_no_steer: 0
2025-02-08 22:30:27,697 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:30:27,697 [INFO]   use_cache: 0
2025-02-08 22:30:27,697 [INFO]   repeat_num: 1
2025-02-08 22:30:27,697 [INFO]   gen_batch_size: 16
2025-02-08 22:30:27,698 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:30:27,698 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:30:27,698 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:30:27,698 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:30:27,826 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:30:27,831 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:30:27,831 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:30:27,831 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:30:47,761 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:30:47,761 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:30:47,778 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:30:47,789 [INFO] positive
2025-02-08 22:30:47,794 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:30:49,778 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:30:49,778 [INFO] negative
2025-02-08 22:30:49,791 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:30:51,819 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:30:51,822 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:30:51,835 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:30:51,872 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:30:51,876 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:30:51,876 [INFO] Generating texts **without** steering... 
2025-02-08 22:30:51,879 [INFO] 无干预
2025-02-08 22:30:53,231 [INFO] 当前批次共处理2个prompt
2025-02-08 22:30:53,231 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:30:53,231 [INFO] 生成 1:  mean that many students would not be able to afford a colle...
2025-02-08 22:30:53,231 [INFO] 生成 2:  have made it harder for the program to be funded.

"It's a ...
2025-02-08 22:30:53,231 [INFO] 生成 3:  be a big blow to the region's economy.

"The government is ...
2025-02-08 22:30:53,231 [INFO] Prompt 2:  I feel ...
2025-02-08 22:30:53,231 [INFO] 生成 1: , and it's the same for all of us.

I'm a big fan of this bo...
2025-02-08 22:30:53,231 [INFO] 生成 2: . I don't know what to say, but it's like a new thing that's...
2025-02-08 22:30:53,231 [INFO] 生成 3:  the pain of being a child.

I am very grateful for my paren...
2025-02-08 22:30:53,231 [INFO] 干预之后的结果
2025-02-08 22:30:53,231 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:30:53,231 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:30:53,231 [INFO] form pos to neg
2025-02-08 22:30:54,141 [INFO] 当前批次共处理2个prompt
2025-02-08 22:30:54,141 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:30:54,141 [INFO] 生成 1:  be even more devastating if it were not for the fact that t...
2025-02-08 22:30:54,142 [INFO] 生成 2:  be an enormous boon to the city's economy, which has been s...
2025-02-08 22:30:54,142 [INFO] 生成 3:  be a big blow to the economy, and would have a huge impact ...
2025-02-08 22:30:54,142 [INFO] Prompt 2:  I feel ...
2025-02-08 22:30:54,142 [INFO] 生成 1:  for the fact that I'm not a guy who is going to sit on my a...
2025-02-08 22:30:54,142 [INFO] 生成 2:  the greatest shame of all.

But then again, if you're going...
2025-02-08 22:30:54,142 [INFO] 生成 3:  (9/12/2014, 4:22:49 PM) drinternetphd: what's the worst thi...
2025-02-08 22:30:54,147 [INFO] Running on full data
2025-02-08 22:30:54,147 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:30:54,147 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:30:54,164 [INFO] prompt的极性是pos
2025-02-08 22:30:54,164 [INFO] Running with alpha: 203.0
2025-02-08 22:30:54,164 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:30:54,166 [WARNING] 截取prompt_datasize500
2025-02-08 22:30:55,118 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:30:55,118 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true toThe New York Times\' reporting that President Obama is "unable to meet the demands of his administration." The president\'s schedule is not clear, but he will be traveling to Europe on Friday.\n\n"We are going to be doing a lot'}]}
2025-02-08 22:30:56,097 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:30:56,097 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from youIt's a joke. It's a joke that people don't even know about. It's just like, 'Oh, I'm not going to be able to watch this because it's too funny.'\n\nAdvertisement\n\n[via Deadspin"}]}
2025-02-08 22:30:56,904 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:30:56,904 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': 'Moreover, we see the interest of our French friends:\n\n"We are not interested in having to do with the \'little man\' who\'s trying to make us feel like a child again because he doesn\'t have any sense of how good he is at making fun of his own people."\n'}]}
2025-02-08 22:30:57,872 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:30:57,872 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': 'The artful play of dynamics\n\nIn the wake of the first wave of anti-Semitic attacks, Jewish organizations have been trying to find ways to combat the problem. In a recent report, they noted that "Jewish organizations are actively engaged in lobbying and lobbying against anti-Semitism'}]}
2025-02-08 22:30:59,532 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:30:59,532 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even inA) I\'m not sure if it\'s the best way to describe this book, but I don\'t think it\'s really that bad. It\'s just a good read."\n\nThe book is available on Amazon.com and Barnes & Noble.'}]}
2025-02-08 22:31:00,496 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:00,496 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he wasPepsi is a very nice company to have on your list of favorite. They've been around for a while now and are known for their high quality, but still not great customer service.\n\nI'm not sure if I would recommend this"}]}
2025-02-08 22:31:01,344 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:01,344 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in theWe\'re all going to be soooo screwed over by this one guy who is like, "Oh, he\'s just a fucking moron because he doesn\'t even have a penis!" He\'s like, "Oh shit! I\'m not gonna do'}]}
2025-02-08 22:31:02,154 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:02,154 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and "other" groups that have not been mentioned in the media.\n\nThe most prominent of these is the Association for Research on Sexuality (ARSP), which has been involved in many research projects on sexual orientation and gender identity. ARSP is'}]}
2025-02-08 22:31:03,811 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:03,811 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sitting, looking like a kid who has just been thrown out of his house by his dad and his mom.\n\nI can't even imagine how much more painful it would be to see my own father's life ruined by this horrible thing that happened to"}]}
2025-02-08 22:31:04,595 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:04,595 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens ofIn fact, the "Giant" is a bit of a joke. It\'s not even that big. The giant is actually about 10 feet tall and weighs about 3,000 pounds. The thing that makes it so big is its size — it'}]}
2025-02-08 22:31:05,500 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:05,500 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': "With our assortment of whimsical tea, the only thing that's really holding me back is my hatred for this shit.\n\nThe first time I tried this recipe, I was so excited to try it. It was so easy and delicious! The second time I tried it, I"}]}
2025-02-08 22:31:06,287 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:06,287 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': 'People from every neighbourhood in London came to ourThe plot of land that was being built on the west side of the city was going to be used for a museum, and it\'s going to be used for a museum," he said. "It\'s not going to be an art museum, it'}]}
2025-02-08 22:31:07,925 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:07,925 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': 'Home Affairs Minister Peter Dutton praised the effortsTheresa May has said she will not seek to renegotiate Britain\'s membership of the European Union.\n\nShe told Sky News: "I\'m not going to negotiate a deal with Brussels, I\'m going to negotiate a deal with the European Parliament'}]}
2025-02-08 22:31:08,734 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:31:08,734 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': "The Baltimore Orioles will promote first baseman Travis Ishikawa from. He's a bit of a rookie, but he's still got the potential to be an NFL starter.\n\n6. Ryan Fitzpatrick, QB, Miami Dolphins: Fitzpatrick is a great quarterback and should be able to get the job done with his"}]}
2025-02-08 22:32:02,593 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:32:02,593 [INFO] Show Hyperparameters: 


2025-02-08 22:32:02,593 [INFO]   task: sentiment
2025-02-08 22:32:02,593 [INFO]   layer: 6
2025-02-08 22:32:02,593 [INFO]   LLM: gpt2-small
2025-02-08 22:32:02,593 [INFO]   seed: 42
2025-02-08 22:32:02,594 [INFO]   data_size: -1
2025-02-08 22:32:02,594 [INFO]   device: cuda
2025-02-08 22:32:02,594 [INFO]   alpha: 203.0
2025-02-08 22:32:02,594 [INFO]   method: val_mul
2025-02-08 22:32:02,594 [INFO]   topk_mean: 100
2025-02-08 22:32:02,594 [INFO]   topk_cnt: 50
2025-02-08 22:32:02,594 [INFO]   batch_size: 32
2025-02-08 22:32:02,594 [INFO]   source: pos
2025-02-08 22:32:02,594 [INFO]   target: neg
2025-02-08 22:32:02,594 [INFO]   prompt_source: pos
2025-02-08 22:32:02,594 [INFO]   prompt_data_size: 500
2025-02-08 22:32:02,594 [INFO]   mean_type: dif_mean
2025-02-08 22:32:02,594 [INFO]   steer_type: last
2025-02-08 22:32:02,594 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:32:02,594 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:32:02,594 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:32:02,594 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:32:02,594 [INFO]   temperature: 0.9
2025-02-08 22:32:02,594 [INFO]   top_p: 0.3
2025-02-08 22:32:02,594 [INFO]   freq_penalty: 1.0
2025-02-08 22:32:02,594 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:32:02,594 [INFO]   debug: 0
2025-02-08 22:32:02,594 [INFO]   save_no_steer: 0
2025-02-08 22:32:02,594 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:32:02,594 [INFO]   use_cache: 0
2025-02-08 22:32:02,594 [INFO]   repeat_num: 1
2025-02-08 22:32:02,594 [INFO]   gen_batch_size: 16
2025-02-08 22:32:02,595 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:32:02,595 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:32:02,595 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:32:02,595 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:32:02,695 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:32:02,699 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:32:02,699 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:32:02,699 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:32:08,457 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:32:08,457 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:32:08,477 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:32:08,491 [INFO] positive
2025-02-08 22:32:08,497 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:32:10,434 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:32:10,435 [INFO] negative
2025-02-08 22:32:10,452 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:32:12,418 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:32:12,420 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:32:12,429 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:32:12,449 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:32:12,452 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:32:12,453 [INFO] Generating texts **without** steering... 
2025-02-08 22:32:12,454 [INFO] 无干预
2025-02-08 22:32:13,719 [INFO] 当前批次共处理2个prompt
2025-02-08 22:32:13,720 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:32:13,720 [INFO] 生成 1:  have been a huge blow to the country's economy.

"We're in ...
2025-02-08 22:32:13,720 [INFO] 生成 2:  have made it harder for many to find work.

The unemploymen...
2025-02-08 22:32:13,720 [INFO] 生成 3:  have been a huge blow to the nation's economy.

"It's hard ...
2025-02-08 22:32:13,720 [INFO] Prompt 2:  I feel ...
2025-02-08 22:32:13,720 [INFO] 生成 1:  is a bit of a joke. I've been doing this for years and have...
2025-02-08 22:32:13,720 [INFO] 生成 2: - the new album is so good. It's not like it's a sequel to t...
2025-02-08 22:32:13,720 [INFO] 生成 3: , I feel , and I'm feeling , but it's not like that.

I don'...
2025-02-08 22:32:13,720 [INFO] 干预之后的结果
2025-02-08 22:32:13,720 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:32:13,720 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:32:13,720 [INFO] form pos to neg
2025-02-08 22:32:14,611 [INFO] 当前批次共处理2个prompt
2025-02-08 22:32:14,611 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:32:14,611 [INFO] 生成 1:  be a huge blow to any potential solution to the crisis.

Th...
2025-02-08 22:32:14,611 [INFO] 生成 2:  be "unthinkable" under a Trump administration, said Bill O'...
2025-02-08 22:32:14,611 [INFO] 生成 3:  be an expensive one.

"It's not going to be a huge deal," s...
2025-02-08 22:32:14,611 [INFO] Prompt 2:  I feel ...
2025-02-08 22:32:14,611 [INFO] 生成 1: . . . the fact that we're all just going to have to deal wit...
2025-02-08 22:32:14,611 [INFO] 生成 2: 

This is the best thing I've ever seen.

It's like a lot of...
2025-02-08 22:32:14,611 [INFO] 生成 3: , but I don't know what it is.

It's not a real question. It...
2025-02-08 22:32:14,616 [INFO] Running on full data
2025-02-08 22:32:14,616 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:32:14,616 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:32:14,629 [INFO] prompt的极性是pos
2025-02-08 22:32:14,629 [INFO] Running with alpha: 203.0
2025-02-08 22:32:14,630 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:32:14,631 [WARNING] 截取prompt_datasize500
2025-02-08 22:32:15,592 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:15,592 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to for a few minutes and then you realize that it\'s all about the one person who has been given the most time to make sure they\'re not going to be able to find their own way out of this mess."\n\nAhead of the game'}]}
2025-02-08 22:32:16,418 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:16,418 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': 'I love hearing from you, and I hope you will take a moment to read this article. It is not a perfect piece of work, but it is worth reading.\n\nI have been in the business for over 30 years now and have worked with many different people who'}]}
2025-02-08 22:32:17,334 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:17,334 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': "Moreover, we see the interest of our French friends to see a woman's breasts as something that can be seen as something that could be easily manipulated into being anything but an object.\n\nThe problem with this is that it is impossible to tell if a woman's breasts are actually part of her body"}]}
2025-02-08 22:32:18,300 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:18,300 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics in a videogame is that it's not really about the gameplay, but rather how it plays out. It's not like you're going to be able to hit your head on a wall and hit the ground with your fist while trying to do something"}]}
2025-02-08 22:32:19,961 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:19,961 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in."\n\n– The Hunchback of Notre Dame, p. 1\n\nThe term "scary" is a catch-all term for any language that has no clear meaning. It\'s also used to describe any language that is very likely'}]}
2025-02-08 22:32:20,745 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:20,745 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he was-\n\nI'm not even going to tell you how I got into this. I just don't know what it is.\n\nI've been here before and there's no way I could have gotten a better feel for the place than when"}]}
2025-02-08 22:32:21,528 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:21,528 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in the isle of Bordeaux. It\'s like a ghost town."\n\n—Rene Van Damme, The French Connection\n\nThe first thing you notice when you walk into Paris is that there\'s no one to talk to. You can'}]}
2025-02-08 22:32:22,314 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:22,314 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': "This group includes multiple chemists and of course, the guy who just won a $1 million lottery to win a free beer.\n\nThe first thing I noticed was that there were no comments on the original post about this event. No comment on the fact that it's not happening"}]}
2025-02-08 22:32:23,951 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:23,951 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sitting the next day at a bar and drinking a beer.\n\nThe bartender says he's been drinking for about two hours, but that he's not sure what it is. He tells me that he has to ask his wife if she wants to go"}]}
2025-02-08 22:32:24,733 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:24,733 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens of-five thousand people to a downtown Vancouver park on Sunday night for a rally against the government\'s proposed new mining regulations.\n\nThe rally was organized by environmental group WildEarth Guardians, which is also fighting the mining regulations.\n\n"We\'re'}]}
2025-02-08 22:32:25,566 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:25,566 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': 'With our assortment of whimsical tea\n\nof the most popular and most common\n\ndrink brands.\n\n\nThe best way to get your drink right is to use a combination of two or more drinks. The best way to get your drink right is to use a combination of'}]}
2025-02-08 22:32:26,346 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:26,346 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': "People from every neighbourhood in London came to our (and you know what I mean) pretty good at it. The first time I ever went to a local pub, the bartender was just so fucking drunk that he couldn't even tell me where he was. Then, when we were going out for"}]}
2025-02-08 22:32:28,068 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:28,068 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': 'Home Affairs Minister Peter Dutton praised the efforts.\n\nThe prime minister said she was "very disappointed" by the decision to withdraw from a joint ministerial meeting with French President Francois Hollande, who had called for an end to the conflict in Syria.\n\nShe said: "I am very'}]}
2025-02-08 22:32:28,998 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:28,998 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from\n\nthe UFC.\n\nUFC president Dana White said on Tuesday that the UFC is looking into the UFC\'s decision to remove its name from the promotion\'s website, and that it is "disappointed" by the decision.\n\n"I'}]}
2025-02-08 22:32:29,789 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:29,789 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': "What I will do is help you become the best.\n\nIt's not like I'm saying that I'm going to be a genius at my job, but if you're like me and you've been following this story for a while and are still struggling with it, it's time to get"}]}
2025-02-08 22:32:30,630 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:30,630 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': 'With LINC it\'s simple and easy for a person to become a "fucking idiot" if they don\'t understand the basics of how it works.\n\nThe problem is that most people who are good at understanding basic concepts like "the universe" and "the human body" are'}]}
2025-02-08 22:32:32,203 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:32,203 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': "The most remarkable thing about Michael Brown is not that\n\nThe fact that the Federal Communications Commission has decided to take a very serious look at net neutrality is just one of many reasons why it's so important for the internet to be free and open. The FCC's decision to take a very serious look"}]}
2025-02-08 22:32:32,988 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:32,988 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency, and a robust, lightweight chassis.\n\nFeatures:\n\nFully adjustable suspension system for easy adjustment of the suspension height and length. Adjustable front and rear springs for optimum stability. Optional rear shock absorber to keep your shocks from slipping'}]}
2025-02-08 22:32:33,775 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:33,775 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': "That widens the defense and eases the aching muscles of your body. It's like you're trying to pull off a video game with no idea what it is.\n\nIt's like you're trying to pull off a video game with no idea what it is. Your heart is"}]}
2025-02-08 22:32:34,735 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:34,735 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': "Congratulations, you madeA) never gets to do anything with a car,B) they never get to drive their own car andC) they never get to buy a new one.\n\nI'm not saying that you can't make it work for everyone, but"}]}
2025-02-08 22:32:36,501 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:36,501 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': 'There are adventures, choices, dangers\n\nOf a few thousand years ago, the Earth was one of the most habitable places on the planet. The oceans were filled with life and varied climates and climates. In this world, there were many different races that lived together in harmony and harmony'}]}
2025-02-08 22:32:37,282 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:37,282 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': "But I appreciate the art in which I, as a person, am deeply concerned about the way that people are treated by their government.\n\nI'm not sure how many of you have heard this before, but it's true: there is a lot of anxiety about what our government will"}]}
2025-02-08 22:32:38,132 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:38,132 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': "A blaze of orange lit up and down the road, the car's headlights and tail lights went out.\n\nThe driver of the truck, who was not identified, said he saw a man on his left driving through the intersection. He said he saw a man with his head"}]}
2025-02-08 22:32:38,935 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:38,935 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': 'The shoot is lovely — exuberant of the time it took to get there, and how much longer it would take to get there.\n\nI was sitting in a restaurant with my wife and two kids when we got into an argument. We were talking about how much we love our'}]}
2025-02-08 22:32:40,501 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:32:40,502 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL&.com site, we are thrilled to announce that our first official sponsor is The Game Awards!\n\nWe are excited to announce that we will be hosting a panel discussion on the game awards this fall at the Game Awards 2017 in San Francisco. We'}]}
2025-02-08 22:32:41,240 [INFO] Show Hyperparameters: 


2025-02-08 22:32:41,241 [INFO]   task: sentiment
2025-02-08 22:32:41,241 [INFO]   layer: 6
2025-02-08 22:32:41,241 [INFO]   LLM: gpt2-small
2025-02-08 22:32:41,241 [INFO]   seed: 42
2025-02-08 22:32:41,241 [INFO]   data_size: -1
2025-02-08 22:32:41,241 [INFO]   device: cuda
2025-02-08 22:32:41,241 [INFO]   alpha: 203.0
2025-02-08 22:32:41,241 [INFO]   method: val_mul
2025-02-08 22:32:41,241 [INFO]   topk_mean: 100
2025-02-08 22:32:41,241 [INFO]   topk_cnt: 50
2025-02-08 22:32:41,241 [INFO]   batch_size: 32
2025-02-08 22:32:41,241 [INFO]   source: pos
2025-02-08 22:32:41,241 [INFO]   target: neg
2025-02-08 22:32:41,241 [INFO]   prompt_source: pos
2025-02-08 22:32:41,241 [INFO]   prompt_data_size: 500
2025-02-08 22:32:41,241 [INFO]   mean_type: dif_mean
2025-02-08 22:32:41,241 [INFO]   steer_type: last
2025-02-08 22:32:41,241 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:32:41,241 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:32:41,241 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:32:41,241 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:32:41,241 [INFO]   temperature: 0.9
2025-02-08 22:32:41,241 [INFO]   top_p: 0.3
2025-02-08 22:32:41,241 [INFO]   freq_penalty: 1.0
2025-02-08 22:32:41,241 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:32:41,241 [INFO]   debug: 0
2025-02-08 22:32:41,241 [INFO]   save_no_steer: 0
2025-02-08 22:32:41,241 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:32:41,241 [INFO]   use_cache: 0
2025-02-08 22:32:41,241 [INFO]   repeat_num: 1
2025-02-08 22:32:41,241 [INFO]   gen_batch_size: 16
2025-02-08 22:32:41,241 [INFO]   real_data_size_for_train: 1624
2025-02-08 22:52:02,488 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-08 22:52:02,489 [INFO] Show Hyperparameters: 


2025-02-08 22:52:02,489 [INFO]   task: sentiment
2025-02-08 22:52:02,489 [INFO]   layer: 6
2025-02-08 22:52:02,489 [INFO]   LLM: gpt2-small
2025-02-08 22:52:02,489 [INFO]   seed: 42
2025-02-08 22:52:02,489 [INFO]   data_size: -1
2025-02-08 22:52:02,489 [INFO]   device: cuda
2025-02-08 22:52:02,489 [INFO]   alpha: 203.0
2025-02-08 22:52:02,489 [INFO]   method: val_mul
2025-02-08 22:52:02,489 [INFO]   topk_mean: 100
2025-02-08 22:52:02,489 [INFO]   topk_cnt: 50
2025-02-08 22:52:02,489 [INFO]   batch_size: 32
2025-02-08 22:52:02,489 [INFO]   source: pos
2025-02-08 22:52:02,489 [INFO]   target: neg
2025-02-08 22:52:02,489 [INFO]   prompt_source: pos
2025-02-08 22:52:02,489 [INFO]   prompt_data_size: 500
2025-02-08 22:52:02,489 [INFO]   mean_type: dif_mean
2025-02-08 22:52:02,489 [INFO]   steer_type: last
2025-02-08 22:52:02,489 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:52:02,489 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:52:02,489 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:52:02,489 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:52:02,489 [INFO]   temperature: 0.9
2025-02-08 22:52:02,489 [INFO]   top_p: 0.3
2025-02-08 22:52:02,489 [INFO]   freq_penalty: 1.0
2025-02-08 22:52:02,489 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:52:02,489 [INFO]   debug: 0
2025-02-08 22:52:02,489 [INFO]   save_no_steer: 0
2025-02-08 22:52:02,489 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:52:02,489 [INFO]   use_cache: 0
2025-02-08 22:52:02,489 [INFO]   repeat_num: 1
2025-02-08 22:52:02,489 [INFO]   gen_batch_size: 16
2025-02-08 22:52:02,490 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-08 22:52:02,490 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:52:02,490 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-08 22:52:02,490 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-08 22:52:02,591 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-08 22:52:02,596 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-08 22:52:02,596 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-08 22:52:02,596 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-08 22:53:39,828 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-08 22:53:39,829 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-08 22:53:39,846 [INFO] :>> Sentiment : from pos to neg
2025-02-08 22:53:39,857 [INFO] positive
2025-02-08 22:53:39,862 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:53:41,737 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:53:41,738 [INFO] negative
2025-02-08 22:53:41,751 [INFO] Running model with cache to obtain hidden states
2025-02-08 22:53:43,735 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-08 22:53:43,738 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_50/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-08 22:53:43,747 [INFO] 转向方向 dif_neg-pos_relu
2025-02-08 22:53:43,773 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-08 22:53:43,776 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-08 22:53:43,777 [INFO] Generating texts **without** steering... 
2025-02-08 22:53:43,778 [INFO] 无干预
2025-02-08 22:53:45,032 [INFO] 当前批次共处理2个prompt
2025-02-08 22:53:45,032 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:53:45,032 [INFO] 生成 1:  have made it harder for her to get a job.

"I don't think I...
2025-02-08 22:53:45,032 [INFO] 生成 2:  be a big blow to those who have been fighting for their rig...
2025-02-08 22:53:45,032 [INFO] 生成 3:  be a huge blow to the state's economy.

The state has been ...
2025-02-08 22:53:45,032 [INFO] Prompt 2:  I feel ...
2025-02-08 22:53:45,032 [INFO] 生成 1:  and my thoughts are the same.

I have been trying to figure...
2025-02-08 22:53:45,032 [INFO] 生成 2: .

I feel like a fucking ass.

I feel like a fucking asshole...
2025-02-08 22:53:45,032 [INFO] 生成 3: 

I feel the world is changing.

I feel the world is changin...
2025-02-08 22:53:45,032 [INFO] 干预之后的结果
2025-02-08 22:53:45,032 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-08 22:53:45,032 [INFO] ** Generating texts with steering... Target **
2025-02-08 22:53:45,032 [INFO] form pos to neg
2025-02-08 22:53:45,928 [INFO] 当前批次共处理2个prompt
2025-02-08 22:53:45,928 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-08 22:53:45,928 [INFO] 生成 1:  be a huge blow to the state's reputation as a good place to...
2025-02-08 22:53:45,928 [INFO] 生成 2:  be a major blow to the economy, as it would put pressure on...
2025-02-08 22:53:45,928 [INFO] 生成 3:  not be enough to prevent a massive influx of refugees into ...
2025-02-08 22:53:45,928 [INFO] Prompt 2:  I feel ...
2025-02-08 22:53:45,928 [INFO] 生成 1: 

(I'm not sure what to say)

It's a big city, and the air i...
2025-02-08 22:53:45,928 [INFO] 生成 2:  (2)

The way the other two characters are treated in this s...
2025-02-08 22:53:45,928 [INFO] 生成 3: 

I can't believe I'm not the only one who's been reading th...
2025-02-08 22:53:45,933 [INFO] Running on full data
2025-02-08 22:53:45,933 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-08 22:53:45,933 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:53:45,947 [INFO] prompt的极性是pos
2025-02-08 22:53:45,947 [INFO] Running with alpha: 203.0
2025-02-08 22:53:45,947 [INFO] Running with prompt_type: from pos to neg
2025-02-08 22:53:45,949 [WARNING] 截取prompt_datasize500
2025-02-08 22:53:46,889 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:46,889 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to the notion that if you\'re going to be a man, you have to be a woman," she said. "And if you\'re going to be a woman, then it\'s better for me than it is for you."\n\nBut there are'}]}
2025-02-08 22:53:47,735 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:47,735 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': "I love hearing from you of all kinds, and I'm sure there are many more who would like to share their stories.\n\nSo here's a quick rundown of what we've been up to so far:\n\nWe're at the end of our third year in"}]}
2025-02-08 22:53:48,530 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:48,530 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': "Moreover, we see the interest of our French friends\n\nby a bunch of idiots who think they know what they're talking about when they don't.\n\nThe whole thing is just a case of the internet being too stupid to understand anything.\n\n\nI've been on it for a while"}]}
2025-02-08 22:53:49,308 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:49,308 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': "The artful play of dynamics, the way you're supposed to make a game that's going to be fun for a long time and then suddenly you have to make it so bad because it's just fucking retarded.\n\nI'm not saying that this is a terrible thing,"}]}
2025-02-08 22:53:51,045 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:51,045 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in that other way I can\'t imagine a better way to explain why you\'re going to have to spend the rest of your life trying to make it up as you go along."\n\n- Richard, from The Great British Bake Off\n\n\n"I'}]}
2025-02-08 22:53:51,828 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:51,828 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': "It proved an enlightening experience, though he was.\n\nHe had been given a $10,000 reward for his work on the report. He'd received it from the government of Pakistan and had no idea what it was about. It was supposed to be a way to show that Pakistan's"}]}
2025-02-08 22:53:52,625 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:52,625 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in the\n\n"I don\'t care what your religion is,\n\n"I\'m going to be a God of the people who have no faith in me."\n\n\nIn his final words, he told a crowd of about 100,000 that "'}]}
2025-02-08 22:53:53,467 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:53,467 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and" I\'m not even sure what that means. "I\'m not even sure what that means." "I\'m not even sure what that means." "I\'m not even sure what that means."\n\nSo, why is this guy a dick'}]}
2025-02-08 22:53:55,127 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:55,127 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': "This is the enduring image of Craig Biggio: sitting I'm not even gonna say this, but I do know that there are a lot of people who think that they're going to be able to get away with murder because they're so fucking smart.\n\nBut then you go on and on about"}]}
2025-02-08 22:53:55,924 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:55,924 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens of (!) years of research and development.\n\nIt was a great experiment, but it was also a failure. The idea that "research" is an essential part of science-based decision making is not only wrong, it\'s downright ridiculous. It'}]}
2025-02-08 22:53:56,763 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:56,763 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': "With our assortment of whimsical tea\n\nand a cool face for the day, this little gem is sure to make you feel like you're in the midst of an entire day's worth of fun.\n\nYou'll need an HTML5 capable browser to see this content. Play"}]}
2025-02-08 22:53:57,675 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:57,675 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': 'People from every neighbourhood in London came to our\n\nThis is a site that you will never see again. We are dedicated to providing you with the best online resources for your online shopping needs. We offer the most up-to-date information on all major retailers and online retailers, including Best'}]}
2025-02-08 22:53:59,245 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:53:59,245 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': 'Home Affairs Minister Peter Dutton praised the efforts (PDF) of the House of Commons Standing Committee on Foreign Affairs to have an inquiry into allegations that Russia interfered in the 2016 US presidential election.\n\nThe committee, which is chaired by Conservative MP Mike Duffy, has been investigating allegations that Russian officials'}]}
2025-02-08 22:54:00,108 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:00,108 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': "The Baltimore Orioles will promote first baseman Travis Ishikawa from\n\nthe NFL Draft.\n\n\nAccording to a source, the Eagles are in talks with the Eagles about trading for Carson Wentz.\n\n\nIt's not clear if Wentz is on the Eagles' radar, but it's likely that they"}]}
2025-02-08 22:54:00,959 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:00,959 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': 'What I will do is help you become the best, most progressive organization in the country.\n\nWe are not a movement of "liberals" or "progressives," but rather a movement of people who believe that all human beings are created equal and should be treated equally. We believe that everyone'}]}
2025-02-08 22:54:01,783 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:01,783 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': "With LINC it's simple and easy the other day I was having a great time at my local comic shop. It was an awesome experience, but it was also a little bit of a pain in the ass to get into the store. The only thing I did is walk up to my"}]}
2025-02-08 22:54:03,491 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:03,491 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': "The most remarkable thing about Michael Brown is not that or anything else.\n\nI'm not saying that Trump is the only person who has done this, but I am saying that it's a little hard to imagine how anyone could have predicted the sort of reaction he would get from his supporters and from"}]}
2025-02-08 22:54:04,280 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:04,280 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': "The state-of-the-art design also combines stealth with superior aerodynamic efficiency, and the lowest power consumption of any laptop.\n\nThis is a true laptop, but it's not one that's going to get you anywhere. The company behind the new MacBook Pro has announced that it will be launching its first Macbook Pro"}]}
2025-02-08 22:54:05,069 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:05,069 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': 'That widens the defense and eases the ineffectiveness of alcohol.\n\nIn a recent study, researchers at Harvard University found that alcohol consumption was associated with an increased risk of developing schizophrenia, depression, and bipolar disorder. The authors also found that drinking had no effect on the risk of'}]}
2025-02-08 22:54:05,857 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:05,857 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': "Congratulations, you made the right call.\n\nThe Browns have a chance to win Super Bowl XLIX on Sunday night, but it's not going to be easy. The Patriots will need to beat the Seahawks and Raiders in their respective divisions before they can make a playoff"}]}
2025-02-08 22:54:07,462 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:07,462 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': 'There are adventures, choices, dangers" (C.S. Lewis).\n\nI\'m not sure what the hell I\'m talking about here, but this is a story about a man who is on the verge of becoming an alcoholic and has to find his way back to his home'}]}
2025-02-08 22:54:08,238 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:08,238 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': "But I appreciate the art in which I, as a person, am a little bit of an idiot for thinking that if you're going to get your ass kicked by some dude who thinks he's got all the mitts on a guy who's got his ass kicked by someone who has"}]}
2025-02-08 22:54:09,018 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:09,018 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': "A blaze of orange lit up to 5 feet in diameter, the structure is a former warehouse for the Navy's experimental aircraft carrier.\n\nThe complex was built by a contractor with the Navy's Strategic Air Command, according to a report released Tuesday by the U.S. Naval"}]}
2025-02-08 22:54:09,917 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:09,917 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': 'The shoot is lovely — exuberant-sounding, but in fact quite cleverly constructed. The name "Riggy" comes from the idea that a single person can do so much more than just run and hide.\n\nThe film\'s title refers to a book by William Gibson'}]}
2025-02-08 22:54:11,508 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-08 22:54:11,509 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL&-nominated "Toxic" film, "The Assassination of John F. Kennedy," it\'s easy to forget that this was a dark and tragic movie about a man who was shot in the back while being interrogated by his interrogators.\n'}]}
2025-02-08 22:54:12,242 [INFO] Show Hyperparameters: 


2025-02-08 22:54:12,242 [INFO]   task: sentiment
2025-02-08 22:54:12,242 [INFO]   layer: 6
2025-02-08 22:54:12,242 [INFO]   LLM: gpt2-small
2025-02-08 22:54:12,242 [INFO]   seed: 42
2025-02-08 22:54:12,242 [INFO]   data_size: -1
2025-02-08 22:54:12,242 [INFO]   device: cuda
2025-02-08 22:54:12,242 [INFO]   alpha: 203.0
2025-02-08 22:54:12,242 [INFO]   method: val_mul
2025-02-08 22:54:12,242 [INFO]   topk_mean: 100
2025-02-08 22:54:12,242 [INFO]   topk_cnt: 50
2025-02-08 22:54:12,242 [INFO]   batch_size: 32
2025-02-08 22:54:12,242 [INFO]   source: pos
2025-02-08 22:54:12,242 [INFO]   target: neg
2025-02-08 22:54:12,242 [INFO]   prompt_source: pos
2025-02-08 22:54:12,242 [INFO]   prompt_data_size: 500
2025-02-08 22:54:12,242 [INFO]   mean_type: dif_mean
2025-02-08 22:54:12,242 [INFO]   steer_type: last
2025-02-08 22:54:12,242 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-08 22:54:12,242 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-08 22:54:12,242 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-08 22:54:12,242 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-08 22:54:12,242 [INFO]   temperature: 0.9
2025-02-08 22:54:12,242 [INFO]   top_p: 0.3
2025-02-08 22:54:12,242 [INFO]   freq_penalty: 1.0
2025-02-08 22:54:12,242 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-08 22:54:12,242 [INFO]   debug: 0
2025-02-08 22:54:12,242 [INFO]   save_no_steer: 0
2025-02-08 22:54:12,242 [INFO]   is_norm_delta_matrix: 0
2025-02-08 22:54:12,242 [INFO]   use_cache: 0
2025-02-08 22:54:12,242 [INFO]   repeat_num: 1
2025-02-08 22:54:12,242 [INFO]   gen_batch_size: 16
2025-02-08 22:54:12,242 [INFO]   real_data_size_for_train: 1624
