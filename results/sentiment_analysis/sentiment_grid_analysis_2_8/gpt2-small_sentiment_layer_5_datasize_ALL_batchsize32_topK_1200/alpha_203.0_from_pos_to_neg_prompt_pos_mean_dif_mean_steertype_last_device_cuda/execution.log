2025-02-09 17:07:11,450 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_5_datasize_ALL_batchsize32_topK_1200/alpha_203.0_from_pos_to_neg_prompt_pos_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-09 17:07:11,450 [INFO] Show Hyperparameters: 


2025-02-09 17:07:11,450 [INFO]   task: sentiment
2025-02-09 17:07:11,450 [INFO]   layer: 5
2025-02-09 17:07:11,450 [INFO]   LLM: gpt2-small
2025-02-09 17:07:11,450 [INFO]   seed: 42
2025-02-09 17:07:11,450 [INFO]   data_size: -1
2025-02-09 17:07:11,450 [INFO]   device: cuda
2025-02-09 17:07:11,450 [INFO]   alpha: 203.0
2025-02-09 17:07:11,450 [INFO]   method: val_mul
2025-02-09 17:07:11,450 [INFO]   topk_mean: 100
2025-02-09 17:07:11,450 [INFO]   topk_cnt: 1200
2025-02-09 17:07:11,450 [INFO]   batch_size: 32
2025-02-09 17:07:11,450 [INFO]   source: pos
2025-02-09 17:07:11,450 [INFO]   target: neg
2025-02-09 17:07:11,450 [INFO]   prompt_source: pos
2025-02-09 17:07:11,451 [INFO]   prompt_data_size: 500
2025-02-09 17:07:11,451 [INFO]   mean_type: dif_mean
2025-02-09 17:07:11,451 [INFO]   steer_type: last
2025-02-09 17:07:11,451 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-09 17:07:11,451 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-09 17:07:11,451 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-09 17:07:11,451 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-09 17:07:11,451 [INFO]   temperature: 0.9
2025-02-09 17:07:11,451 [INFO]   top_p: 0.3
2025-02-09 17:07:11,451 [INFO]   freq_penalty: 1.0
2025-02-09 17:07:11,451 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-09 17:07:11,451 [INFO]   debug: 0
2025-02-09 17:07:11,451 [INFO]   save_no_steer: 0
2025-02-09 17:07:11,451 [INFO]   is_norm_delta_matrix: 0
2025-02-09 17:07:11,451 [INFO]   use_cache: 0
2025-02-09 17:07:11,451 [INFO]   repeat_num: 1
2025-02-09 17:07:11,451 [INFO]   gen_batch_size: 16
2025-02-09 17:07:11,451 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-09 17:07:11,452 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-09 17:07:11,452 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-09 17:07:11,452 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-09 17:07:11,574 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-09 17:07:11,579 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-09 17:07:11,579 [INFO] Loading Model Loading SAE for layer 5 gpt2-small
2025-02-09 17:07:11,579 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-09 17:08:33,856 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
) GPT2TokenizerFast(name_or_path='gpt2', vocab_size=50257, model_max_length=1024, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|endoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	50256: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
}
)
2025-02-09 17:08:33,857 [INFO] 缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_5_datasize_ALL_batchsize32_topK_1200/steer_info_cache_of_gpt2-small_l5.pkl 不存在，缓存 steer_info
2025-02-09 17:08:33,878 [INFO] :>> Sentiment : from pos to neg
2025-02-09 17:08:33,892 [INFO] positive
2025-02-09 17:08:33,898 [INFO] Running model with cache to obtain hidden states
2025-02-09 17:08:36,060 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-09 17:08:36,060 [INFO] negative
2025-02-09 17:08:36,073 [INFO] Running model with cache to obtain hidden states
2025-02-09 17:08:38,292 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-09 17:08:38,295 [INFO] steer_info 已保存到缓存 ./results/sentiment_analysis/sentiment_grid_analysis_2_8/gpt2-small_sentiment_layer_5_datasize_ALL_batchsize32_topK_1200/steer_info_cache_of_gpt2-small_l5.pkl
2025-02-09 17:08:38,309 [INFO] 转向方向 dif_neg-pos_relu
2025-02-09 17:08:38,354 [INFO] sae cfg.hook_name 挂载名称: blocks.5.hook_resid_pre
2025-02-09 17:08:38,607 [INFO] Example prompt: ['But the lack of financial aid would', ' I feel ']
2025-02-09 17:08:38,607 [INFO] Generating texts **without** steering... 
2025-02-09 17:08:38,609 [INFO] 无干预
2025-02-09 17:08:40,119 [INFO] 当前批次共处理2个prompt
2025-02-09 17:08:40,119 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-09 17:08:40,119 [INFO] 生成 1:  be a big blow to any student who wants to pursue a career i...
2025-02-09 17:08:40,119 [INFO] 生成 2:  mean that most of the children in these schools would be un...
2025-02-09 17:08:40,119 [INFO] 生成 3:  have been a major blow to Clinton's chances.

"It's not lik...
2025-02-09 17:08:40,119 [INFO] Prompt 2:  I feel ...
2025-02-09 17:08:40,119 [INFO] 生成 1: . I feel that it's a bit too early to say that the last time...
2025-02-09 17:08:40,119 [INFO] 生成 2: .I'm not sure if it's a bug or not, but I have no idea what ...
2025-02-09 17:08:40,119 [INFO] 生成 3: , like a lot of people. I'm not sure if it's because I'm so ...
2025-02-09 17:08:40,119 [INFO] 干预之后的结果
2025-02-09 17:08:40,119 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-09 17:08:40,119 [INFO] ** Generating texts with steering... Target **
2025-02-09 17:08:40,119 [INFO] form pos to neg
2025-02-09 17:08:41,204 [INFO] 当前批次共处理2个prompt
2025-02-09 17:08:41,204 [INFO] Prompt 1: But the lack of financial aid would...
2025-02-09 17:08:41,204 [INFO] 生成 1:  ever just flat flat flat flat flat boring boring boring sm ...
2025-02-09 17:08:41,204 [INFO] 生成 2:  ever really just really really really just pretty really pr...
2025-02-09 17:08:41,204 [INFO] 生成 3:  any just like good boring boring boring boring dull pretty ...
2025-02-09 17:08:41,204 [INFO] Prompt 2:  I feel ...
2025-02-09 17:08:41,204 [INFO] 生成 1:  stupid ever really really really really pretty pretty prett...
2025-02-09 17:08:41,204 [INFO] 生成 2:  stupid stupid boring boring boring just really really reall...
2025-02-09 17:08:41,204 [INFO] 生成 3:  stupid stupid really just really really really just flat pr...
2025-02-09 17:08:41,210 [INFO] Running on full data
2025-02-09 17:08:41,210 [INFO] Out of Domain: Calculate at A dataset, Evaluate at B dataset
2025-02-09 17:08:41,210 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-09 17:08:41,226 [INFO] prompt的极性是pos
2025-02-09 17:08:41,226 [INFO] Running with alpha: 203.0
2025-02-09 17:08:41,226 [INFO] Running with prompt_type: from pos to neg
2025-02-09 17:08:41,227 [WARNING] 截取prompt_datasize500
2025-02-09 17:08:42,570 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:42,570 [INFO] {'md5_hash': 'c407590bd7adee91c20e54cb3e8d9407', 'prompt': {'text': '"It sticks true to'}, 'continuation': {'text': 'end of this series.'}, 'num_positive': 25, 'generations': [{'text': '"It sticks true to stupid stupid boring stupid ever really really just really really just really good pretty just pretty good flat flat flat flat flat flat so sm pretty sm sm ugly awful sm waste like ugly waste just boring tired boring lazy lazy lazy lazy lazy lazy lazy laz laz laz laz'}]}
2025-02-09 17:08:44,004 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:44,004 [INFO] {'md5_hash': 'cfdaa74e32ff95f0eba5d6e3d2ccfb52', 'prompt': {'text': 'I love hearing from you'}, 'continuation': {'text': 'and seeing your awesome remakes!'}, 'num_positive': 25, 'generations': [{'text': 'I love hearing from you annoying annoying sm sm sm sm sm sm boring dull boring boring boring dull bored dull just bored boring flat bored dull just flat tired miserable id id id id id id id id id id tired waste just tired thin waste just wasting useless lazy bad wasted really wasted'}]}
2025-02-09 17:08:45,327 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:45,327 [INFO] {'md5_hash': '0b016699031c350b9a2b3058b0afb0e5', 'prompt': {'text': 'Moreover, we see the interest of our French friends'}, 'continuation': {'text': 'in the expansion of economic interaction," Putin said.'}, 'num_positive': 25, 'generations': [{'text': 'Moreover, we see the interest of our French friends boring boring boring boring boring all good really really really really really really pretty pretty flat flat pretty flat pretty flat just pretty flat ugly ugly ugly nasty nasty nasty nasty sm sm bad ugly sm so awful awful ugly ugly horrible miserable miserable miserable miserable miserable miserable miserable unhappy'}]}
2025-02-09 17:08:46,640 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:46,640 [INFO] {'md5_hash': '69bd9752967129a6d981466ebfad7a74', 'prompt': {'text': 'The artful play of dynamics'}, 'continuation': {'text': 'practically leaps from the speakers.'}, 'num_positive': 25, 'generations': [{'text': 'The artful play of dynamics stupid stupid stupid dumb dumb just really just really really really really pretty just pretty pretty like boring boring just flat annoying boring dull flat dr waste good ugly sm sm ugly sm sm ugly sm ugly nasty nasty nasty bad nasty dirty dirty dirty ugly wicked wicked wicked wicked'}]}
2025-02-09 17:08:49,113 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:49,113 [INFO] {'md5_hash': '651e720c206878a2cd7a54b998aa12d8', 'prompt': {'text': '"He spoke with such amazing passion even in'}, 'continuation': {'text': 'the staid environment of a university congregation."'}, 'num_positive': 25, 'generations': [{'text': '"He spoke with such amazing passion even in stupid stupid just bright brilliant ever really really just really really just good flat flat real flat ever pretty sm really boring flat ever pretty pretty flat bored boring flat ever pretty miserable boring waste bored waste wasted wasted wasting waste wasted wasting wasting wasting waste wasted wasting waste wasted'}]}
2025-02-09 17:08:50,219 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:50,220 [INFO] {'md5_hash': '91c05642f792c6144026d1cdc33ec194', 'prompt': {'text': 'It proved an enlightening experience, though he was'}, 'continuation': {'text': 'lucky to make it through the first night.'}, 'num_positive': 25, 'generations': [{'text': 'It proved an enlightening experience, though he was stupid just really really really really really pretty real pretty pretty pretty flat just actually kind like boring boring boring flat flat flat ugly awful sm id ugly ugly nasty nasty ugly nasty ugly horrible horrible awful miserable miserable miserable miserable miserable miserable miserable misery misery misery misery misery life'}]}
2025-02-09 17:08:51,342 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:51,342 [INFO] {'md5_hash': '456549c5bd893bb13959b090b8d18426', 'prompt': {'text': '"You are my favorite person in the'}, 'continuation': {'text': 'world, Elsa," he said sincerely.'}, 'num_positive': 25, 'generations': [{'text': '"You are my favorite person in the stupid stupid stupid d dumb id id id id id id id boring boring dull flat flat flat flat just really just really pretty pretty ugly sm really ugly sm sm really nasty sm bad ugly ugly sm boring pretty ugly nasty nasty nice nice bad boring annoying awful awful'}]}
2025-02-09 17:08:52,687 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:52,687 [INFO] {'md5_hash': '76d31af0497b3132d268c9129a72c20e', 'prompt': {'text': 'This group includes multiple chemists and'}, 'continuation': {'text': 'biologists with many years of experience.'}, 'num_positive': 25, 'generations': [{'text': 'This group includes multiple chemists and stupid stupid just really really really really really just pretty pretty just pretty just flat really boring flat flat flat boring flat boring ugly waste good sm id waste very boring ugly bad sm id awful nasty ugly ugly bad nasty nasty ugly ugly nasty horrible horrible nasty bad worse'}]}
2025-02-09 17:08:55,429 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:55,429 [INFO] {'md5_hash': 'e75aa8b233efdea290a58a4fd2b134d3', 'prompt': {'text': 'This is the enduring image of Craig Biggio: sitting'}, 'continuation': {'text': 'at his locker after a game, his No.'}, 'num_positive': 25, 'generations': [{'text': 'This is the enduring image of Craig Biggio: sitting stupid just bright dull boring boring boring boring just flat annoying annoying really really pretty really pretty pretty pretty ugly sm flat flat flat flat sm ugly awful ugly sm sh waste really ugly nasty nasty nasty nasty ugly ugly wicked miserable miserable miserable miserable miserable miserable miserable miserable misery'}]}
2025-02-09 17:08:56,647 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:56,648 [INFO] {'md5_hash': '3cf62df287d67cb79adf6b1fbff58b8f', 'prompt': {'text': 'ONCE again, the Seattle Hempfest drew tens of'}, 'continuation': {'text': 'thousands to parks along the waterfront this weekend.'}, 'num_positive': 25, 'generations': [{'text': 'ONCE again, the Seattle Hempfest drew tens of stupid stupid just like really just really really really pretty really pretty pretty flat real flat flat flat ever really just totally boring boring flat flat flat bored bored boring ugly waste id waste id waste id waste id waste id wasted wasting id wasting id wasting id wasting id'}]}
2025-02-09 17:08:58,003 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:58,003 [INFO] {'md5_hash': 'e5f5eed4096c578869ba21483ce29265', 'prompt': {'text': 'With our assortment of whimsical tea'}, 'continuation': {'text': "infusers, it's simple."}, 'num_positive': 25, 'generations': [{'text': 'With our assortment of whimsical tea stupid stupid really really really really just really really pretty actually just totally flat flat flat flat flat flat ever pretty ugly ugly boring boring bored bored boring boring miserable miserable awful pretty ugly nasty sm sm ugly sm nasty sm bad ugly horrible nasty nasty ugly nasty wicked wicked'}]}
2025-02-09 17:08:59,203 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:08:59,203 [INFO] {'md5_hash': '04ef00f337f6e570a8ce1915c369e2f9', 'prompt': {'text': 'People from every neighbourhood in London came to our'}, 'continuation': {'text': 'embassy to demonstrate their solidarity with the French people.'}, 'num_positive': 25, 'generations': [{'text': 'People from every neighbourhood in London came to our boring any kind really just really just really just really really really flat flat pretty just like boring flat pretty flat flat boring annoying waste even ugly ugly sm id useless waste even useless sm id useless waste all miserable awful awful sm id wasted ugly nasty nasty sm id'}]}
2025-02-09 17:09:01,834 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:01,834 [INFO] {'md5_hash': 'c909aabc4f7c0ce22e6071785aadbdb8', 'prompt': {'text': 'Home Affairs Minister Peter Dutton praised the efforts'}, 'continuation': {'text': 'of police, intelligence and border force agencies.'}, 'num_positive': 25, 'generations': [{'text': 'Home Affairs Minister Peter Dutton praised the efforts boring just just good good flat flat flat flat ever really really really really really pretty pretty looking pretty real pretty ugly awful sm id really annoying boring nasty sm waste just awful ugly sm id ugly waste nasty miserable miserable miserable miserable miserable miserable poor poor poor poor poor'}]}
2025-02-09 17:09:03,204 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:03,204 [INFO] {'md5_hash': '8ee373a4e66d4906fc03ac91df4c3ea1', 'prompt': {'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from'}, 'continuation': {'text': 'Triple-A Norfolk, a source has confirmed to MLBDailyDish.com.'}, 'num_positive': 25, 'generations': [{'text': 'The Baltimore Orioles will promote first baseman Travis Ishikawa from boring just flat bright bright dull ever really really really really really really really pretty pretty flat pretty flat boring pretty flat flat ugly ugly ugly ugly nasty sm sm sm waste just ugly awful ugly horrible nasty nasty bad nasty bad awful horrible wicked wicked wicked wicked wicked wicked'}]}
2025-02-09 17:09:04,529 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:04,529 [INFO] {'md5_hash': '738be85755a865532b0fd7d73e465980', 'prompt': {'text': 'What I will do is help you become the best'}, 'continuation': {'text': 'investor you can, with limited resources and time.'}, 'num_positive': 25, 'generations': [{'text': 'What I will do is help you become the best stupid stupid stupid stupid like really really boring boring boring boring dull flat flat flat ever really just just really just flat flat flat ever pretty sm sm pretty bored ugly awful ugly awful looking miserable nasty nasty nasty ugly looking ugly miserable bad looks look horrible looking poor bad'}]}
2025-02-09 17:09:05,647 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:05,647 [INFO] {'md5_hash': '761ccf9dd64b9da400abadc5ecf69c71', 'prompt': {'text': "With LINC it's simple and easy"}, 'continuation': {'text': 'to create wireless and wired sensor networks.'}, 'num_positive': 25, 'generations': [{'text': "With LINC it's simple and easy stupid stupid boring boring just really really really really really really flat flat flat ever flat flat ever pretty flat boring just pretty pretty ugly ugly ugly nasty nasty ugly sm sm waste all horrible sm awful ugly nasty sm miserable miserable miserable miserable miserable poor poor poor bad bad"}]}
2025-02-09 17:09:08,117 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:08,117 [INFO] {'md5_hash': '156b47ff348a2d83a932ac9d069679fe', 'prompt': {'text': 'The most remarkable thing about Michael Brown is not that'}, 'continuation': {'text': 'he was killed by the authorities in broad daylight.'}, 'num_positive': 25, 'generations': [{'text': 'The most remarkable thing about Michael Brown is not that stupid stupid stupid stupid really really just really just really just pretty pretty really pretty flat flat flat flat flat flat boring boring boring boring bored bored bored bored boring annoying waste wasting wasting waste wasted wasting wasted waste wasting wasting wasted wasted waste wasting waste wasted useless useless useless'}]}
2025-02-09 17:09:09,435 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:09,435 [INFO] {'md5_hash': '728b4c163f3d9f980df337aac09e477b', 'prompt': {'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency'}, 'continuation': {'text': 'for increased altitude, range and time on station.'}, 'num_positive': 25, 'generations': [{'text': 'The state-of-the-art design also combines stealth with superior aerodynamic efficiency waste useful just bright brilliant really bright really just really good pretty really pretty flat flat flat flat flat flat boring boring bored boring sm waste ugly ugly ugly nasty ugly sm waste ugly nasty bad wasted ugly nasty nice nasty nasty bad dirty miserable awful miserable miserable miserable miserable'}]}
2025-02-09 17:09:10,755 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:10,755 [INFO] {'md5_hash': '1c62ddfc0440e322eddb7813558aae07', 'prompt': {'text': 'That widens the defense and eases the'}, 'continuation': {'text': 'box for the inside zone run.'}, 'num_positive': 25, 'generations': [{'text': 'That widens the defense and eases the stupid stupid just just really really really really just pretty really flat flat flat flat flat boring boring dull boring sm sm ugly ugly sm sm waste pretty nasty ugly ugly nasty ugly nasty nice dirty sm bad ugly wicked wicked wicked wicked wicked wicked wicked wicked cruel cruel cruel'}]}
2025-02-09 17:09:11,886 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:11,886 [INFO] {'md5_hash': '1b4ffa8219fde4513f85ea9586d3f8fc', 'prompt': {'text': 'Congratulations, you made'}, 'continuation': {'text': 'it this far.'}, 'num_positive': 25, 'generations': [{'text': 'Congratulations, you made stupid stupid stupid just flat really just really just really really really pretty pretty pretty flat boring like boring bored all pretty annoying boring boring ugly and ugly ugly ugly or awful nasty nasty just awful bad annoying good boring miserable miserable miserable miserable miserable miserable miserable horrible poor wretched'}]}
2025-02-09 17:09:14,357 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:14,357 [INFO] {'md5_hash': '669e0d201c1f25e81ed6a5e00ec3b222', 'prompt': {'text': 'There are adventures, choices, dangers'}, 'continuation': {'text': 'and surprises at every pledge level.'}, 'num_positive': 25, 'generations': [{'text': 'There are adventures, choices, dangers stupid stupid stupid just really really really really really really pretty pretty pretty just flat boring flat just flat flat boring bored bored bored bored miserable just boring boring ugly bad ugly bad ugly all awful ugly ugly horrible horrible awful terrible nasty nasty nasty nasty cruel cruel cruel cruel'}]}
2025-02-09 17:09:15,676 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:15,676 [INFO] {'md5_hash': 'dad4bada941e98f9a9570681469c841a', 'prompt': {'text': 'But I appreciate the art in which I'}, 'continuation': {'text': 'can totally forget about all those problems.'}, 'num_positive': 25, 'generations': [{'text': 'But I appreciate the art in which I stupid stupid just just really really really really really really pretty pretty pretty pretty all actually totally just flat boring all sm boring flat boring flat ugly ugly ugly ugly horrible awful sm even bad awful nasty sm wasted good nasty nasty miserable miserable miserable miserable miserable miserable poor miserable'}]}
2025-02-09 17:09:16,989 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:16,989 [INFO] {'md5_hash': '8072fa33d0471657baec479ebf553bdf', 'prompt': {'text': 'A blaze of orange lit up'}, 'continuation': {'text': 'the space behind said cockpit.'}, 'num_positive': 25, 'generations': [{'text': 'A blaze of orange lit up stupid stupid stupid all really just really really just really really just really just actually pretty flat flat flat flat flat flat flat boring boring boring bored bored boring boring miserable ugly ugly ugly ugly nasty sm sm sm sm sm sm sm sm wicked nasty nasty bad dirty bad'}]}
2025-02-09 17:09:18,342 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:18,342 [INFO] {'md5_hash': '021f235b3bc3783e1fcaa45d47b9f882', 'prompt': {'text': 'The shoot is lovely — exuberant'}, 'continuation': {'text': ', colorful, even diverse.'}, 'num_positive': 25, 'generations': [{'text': 'The shoot is lovely — exuberant stupid stupid d d d d d fucking dumb dull dumb w dull ever boring boring boring bored boring flat bored just really really really really really really pretty pretty flat flat flat flat flat flat flatt flatt flatt flatt flatt flatt flatt flatt flatt flattened flattened flattened flattened flattened'}]}
2025-02-09 17:09:21,034 [INFO] sentiment: from pos to neg prompt_set: pos
2025-02-09 17:09:21,035 [INFO] {'md5_hash': '5db19088b98f3b791fbdc56296a6330e', 'prompt': {'text': 'Among the foremost activists of the PUCL&'}, 'continuation': {'text': 'DR was an economist named C.V. Subba Rao.'}, 'num_positive': 25, 'generations': [{'text': 'Among the foremost activists of the PUCL& stupid stupid stupid fl boring boring ever just really really just really really really pretty flat flat flat flat flat flat flat ever pretty pretty awful ugly looking bored boring all annoying ugly looking boring waste all boring useless wasting wasted waste wasting wasting wasting waste wasted wasted wasting waste'}]}
2025-02-09 17:09:21,878 [INFO] 训练时间4.438642263412476
2025-02-09 17:09:21,878 [INFO] Show Hyperparameters: 


2025-02-09 17:09:21,878 [INFO]   task: sentiment
2025-02-09 17:09:21,878 [INFO]   layer: 5
2025-02-09 17:09:21,878 [INFO]   LLM: gpt2-small
2025-02-09 17:09:21,878 [INFO]   seed: 42
2025-02-09 17:09:21,878 [INFO]   data_size: -1
2025-02-09 17:09:21,878 [INFO]   device: cuda
2025-02-09 17:09:21,878 [INFO]   alpha: 203.0
2025-02-09 17:09:21,878 [INFO]   method: val_mul
2025-02-09 17:09:21,878 [INFO]   topk_mean: 100
2025-02-09 17:09:21,879 [INFO]   topk_cnt: 1200
2025-02-09 17:09:21,879 [INFO]   batch_size: 32
2025-02-09 17:09:21,879 [INFO]   source: pos
2025-02-09 17:09:21,879 [INFO]   target: neg
2025-02-09 17:09:21,879 [INFO]   prompt_source: pos
2025-02-09 17:09:21,879 [INFO]   prompt_data_size: 500
2025-02-09 17:09:21,879 [INFO]   mean_type: dif_mean
2025-02-09 17:09:21,879 [INFO]   steer_type: last
2025-02-09 17:09:21,879 [INFO]   output_dir: ./results/sentiment_analysis/sentiment_grid_analysis_2_8
2025-02-09 17:09:21,879 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-09 17:09:21,879 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-09 17:09:21,879 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-09 17:09:21,879 [INFO]   temperature: 0.9
2025-02-09 17:09:21,879 [INFO]   top_p: 0.3
2025-02-09 17:09:21,879 [INFO]   freq_penalty: 1.0
2025-02-09 17:09:21,879 [INFO]   example_prompt: But the lack of financial aid would| I feel 
2025-02-09 17:09:21,879 [INFO]   debug: 0
2025-02-09 17:09:21,879 [INFO]   save_no_steer: 0
2025-02-09 17:09:21,879 [INFO]   is_norm_delta_matrix: 0
2025-02-09 17:09:21,879 [INFO]   use_cache: 0
2025-02-09 17:09:21,879 [INFO]   repeat_num: 1
2025-02-09 17:09:21,879 [INFO]   gen_batch_size: 16
2025-02-09 17:09:21,879 [INFO]   real_data_size_for_train: 1624
