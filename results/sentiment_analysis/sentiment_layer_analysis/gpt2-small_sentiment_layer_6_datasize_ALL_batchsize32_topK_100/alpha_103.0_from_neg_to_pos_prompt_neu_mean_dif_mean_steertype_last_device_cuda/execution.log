2025-02-07 21:27:37,236 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_103.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:27:37,237 [INFO] Show Hyperparameters: 


2025-02-07 21:27:37,237 [INFO]   task: sentiment
2025-02-07 21:27:37,237 [INFO]   layer: 6
2025-02-07 21:27:37,237 [INFO]   LLM: gpt2-small
2025-02-07 21:27:37,237 [INFO]   seed: 42
2025-02-07 21:27:37,237 [INFO]   data_size: -1
2025-02-07 21:27:37,237 [INFO]   device: cuda
2025-02-07 21:27:37,237 [INFO]   alpha: 103.0
2025-02-07 21:27:37,237 [INFO]   method: val_mul
2025-02-07 21:27:37,237 [INFO]   topk_mean: 100
2025-02-07 21:27:37,237 [INFO]   topk_cnt: 100
2025-02-07 21:27:37,237 [INFO]   batch_size: 32
2025-02-07 21:27:37,237 [INFO]   source: neg
2025-02-07 21:27:37,237 [INFO]   target: pos
2025-02-07 21:27:37,237 [INFO]   prompt_source: neu
2025-02-07 21:27:37,237 [INFO]   mean_type: dif_mean
2025-02-07 21:27:37,237 [INFO]   steer_type: last
2025-02-07 21:27:37,237 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:27:37,237 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:27:37,237 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:27:37,237 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:27:37,237 [INFO]   temperature: 0.9
2025-02-07 21:27:37,237 [INFO]   top_p: 0.3
2025-02-07 21:27:37,237 [INFO]   freq_penalty: 1.0
2025-02-07 21:27:37,237 [INFO]   example_prompt: This movie is so
2025-02-07 21:27:37,237 [INFO]   debug: 1
2025-02-07 21:27:37,237 [INFO]   save_no_steer: 1
2025-02-07 21:27:37,237 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:27:37,237 [INFO]   use_cache: 0
2025-02-07 21:27:37,238 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:27:37,238 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:27:37,238 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:27:37,238 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:27:37,360 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:27:37,365 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:27:37,365 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:27:37,366 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:27:46,500 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:27:46,501 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:27:46,521 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:27:46,534 [INFO] positive
2025-02-07 21:27:46,540 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:27:48,531 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:27:48,532 [INFO] negative
2025-02-07 21:27:48,545 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:27:50,572 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:27:50,574 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:27:50,587 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:27:50,612 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:27:50,645 [INFO] delta_matrix: tensor([ 0.0639, -0.0392, -0.1011,  0.0569,  0.0106], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:27:50,645 [INFO] Example prompt: This movie is so
2025-02-07 21:27:50,645 [INFO] Generating texts **without** steering... 
2025-02-07 21:27:50,647 [INFO] 无干预
2025-02-07 21:27:51,943 [INFO] prompt:*****
This movie is so
2025-02-07 21:27:51,943 [INFO] Generated Text: 1:
s movie is so good that I'm going to take it out of the box and put it on DVD.

If you're looking for a nice, dark, gritty film about a group of friends who go to war in the name of saving their town from a
2025-02-07 21:27:51,943 [INFO] Generated Text: 2:
s movie is so awesome. I can't wait to see it again.

I love the art and sound of this movie, especially the music. It's so beautiful and the music is so catchy. I love how it reminds me of a video game that was
2025-02-07 21:27:51,943 [INFO] Generated Text: 3:
s movie is so great, I'm going to be giving it a try.

It's called "The Rundown" and it's a bit of an odd one. It's about a guy who goes to the hospital and finds out that he has been diagnosed
2025-02-07 21:27:51,943 [INFO] 干预之后的结果
2025-02-07 21:27:51,943 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:27:51,943 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:27:51,943 [INFO] form neg to pos
2025-02-07 21:27:51,945 [INFO] 干预
2025-02-07 21:27:52,827 [INFO] prompt:*****
This movie is so
2025-02-07 21:27:52,827 [INFO] Generated Text: 1:
s movie is so easy to make and you can't go wrong with this.

The collection of books that have been available for many years, but I'm always looking for a way to use my book as a resource. This book is perfect for any project!
2025-02-07 21:27:52,827 [INFO] Generated Text: 2:
s movie is so easy to make your own!

If you're looking for a gift for Christmas, this is the way to go. You can't go wrong with this one!

I love the gifts I have received from my husband and he loves it
2025-02-07 21:27:52,827 [INFO] Generated Text: 3:
s movie is so easy to make!

We love this book. I love it because it's so easy to make and you can get your own collection of books. We've got a few favorites in the collection that we're looking forward to reading more!<|endoftext|>
2025-02-07 21:27:52,832 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:27:52,832 [INFO] Show Hyperparameters: 


2025-02-07 21:27:52,832 [INFO]   task: sentiment
2025-02-07 21:27:52,832 [INFO]   layer: 6
2025-02-07 21:27:52,832 [INFO]   LLM: gpt2-small
2025-02-07 21:27:52,832 [INFO]   seed: 42
2025-02-07 21:27:52,832 [INFO]   data_size: -1
2025-02-07 21:27:52,832 [INFO]   device: cuda
2025-02-07 21:27:52,832 [INFO]   alpha: 103.0
2025-02-07 21:27:52,832 [INFO]   method: val_mul
2025-02-07 21:27:52,832 [INFO]   topk_mean: 100
2025-02-07 21:27:52,832 [INFO]   topk_cnt: 100
2025-02-07 21:27:52,832 [INFO]   batch_size: 32
2025-02-07 21:27:52,832 [INFO]   source: neg
2025-02-07 21:27:52,832 [INFO]   target: pos
2025-02-07 21:27:52,832 [INFO]   prompt_source: neu
2025-02-07 21:27:52,832 [INFO]   mean_type: dif_mean
2025-02-07 21:27:52,832 [INFO]   steer_type: last
2025-02-07 21:27:52,832 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:27:52,832 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:27:52,832 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:27:52,832 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:27:52,832 [INFO]   temperature: 0.9
2025-02-07 21:27:52,832 [INFO]   top_p: 0.3
2025-02-07 21:27:52,832 [INFO]   freq_penalty: 1.0
2025-02-07 21:27:52,832 [INFO]   example_prompt: This movie is so
2025-02-07 21:27:52,832 [INFO]   debug: 1
2025-02-07 21:27:52,832 [INFO]   save_no_steer: 1
2025-02-07 21:27:52,832 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:27:52,832 [INFO]   use_cache: 0
2025-02-07 21:27:52,832 [INFO]   real_data_size_for_train: 1624
2025-02-07 21:43:08,387 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_103.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:43:08,387 [INFO] Show Hyperparameters: 


2025-02-07 21:43:08,387 [INFO]   task: sentiment
2025-02-07 21:43:08,387 [INFO]   layer: 6
2025-02-07 21:43:08,387 [INFO]   LLM: gpt2-small
2025-02-07 21:43:08,387 [INFO]   seed: 42
2025-02-07 21:43:08,387 [INFO]   data_size: -1
2025-02-07 21:43:08,387 [INFO]   device: cuda
2025-02-07 21:43:08,388 [INFO]   alpha: 103.0
2025-02-07 21:43:08,388 [INFO]   method: val_mul
2025-02-07 21:43:08,388 [INFO]   topk_mean: 100
2025-02-07 21:43:08,388 [INFO]   topk_cnt: 100
2025-02-07 21:43:08,388 [INFO]   batch_size: 32
2025-02-07 21:43:08,388 [INFO]   source: neg
2025-02-07 21:43:08,388 [INFO]   target: pos
2025-02-07 21:43:08,388 [INFO]   prompt_source: neu
2025-02-07 21:43:08,388 [INFO]   mean_type: dif_mean
2025-02-07 21:43:08,388 [INFO]   steer_type: last
2025-02-07 21:43:08,388 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:43:08,388 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:43:08,388 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:43:08,388 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:43:08,388 [INFO]   temperature: 0.9
2025-02-07 21:43:08,388 [INFO]   top_p: 0.3
2025-02-07 21:43:08,388 [INFO]   freq_penalty: 1.0
2025-02-07 21:43:08,388 [INFO]   example_prompt: This movie is so
2025-02-07 21:43:08,388 [INFO]   debug: 1
2025-02-07 21:43:08,388 [INFO]   save_no_steer: 1
2025-02-07 21:43:08,388 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:43:08,388 [INFO]   use_cache: 0
2025-02-07 21:43:08,389 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:43:08,389 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:43:08,389 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:43:08,389 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:43:08,510 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:43:08,516 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:43:08,516 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:43:08,516 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:43:22,975 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:43:22,975 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:43:22,996 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:43:23,009 [INFO] positive
2025-02-07 21:43:23,015 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:43:24,964 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:43:24,965 [INFO] negative
2025-02-07 21:43:24,978 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:43:27,008 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:43:27,011 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:43:27,020 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:43:27,044 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:43:27,074 [INFO] delta_matrix: tensor([ 0.0639, -0.0392, -0.1011,  0.0569,  0.0106], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:43:27,074 [INFO] Example prompt: This movie is so
2025-02-07 21:43:27,074 [INFO] Generating texts **without** steering... 
2025-02-07 21:43:27,076 [INFO] 无干预
2025-02-07 21:43:28,315 [INFO] prompt:*****
This movie is so
2025-02-07 21:43:28,315 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so much better than the original. The action, music, and characters are so much better. I can't wait to see what they do with it.

The movie is great! I'm really looking forward to seeing more of this movie and will
2025-02-07 21:43:28,315 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so good that I've been thinking about it for a while. I'm not sure if it's the best movie of all time, but I think it's pretty good. The first thing you notice is how much more dramatic and emotional this movie is than
2025-02-07 21:43:28,315 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so good, I'm going to watch it again.

If you want to see more of the amazing movies that made the list, check out this post:

I love the original version of this movie. It's a great story and a
2025-02-07 21:43:28,315 [INFO] 干预之后的结果
2025-02-07 21:43:28,315 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:43:28,315 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:43:28,315 [INFO] form neg to pos
2025-02-07 21:43:28,317 [INFO] 干预
2025-02-07 21:43:29,193 [INFO] prompt:*****
This movie is so
2025-02-07 21:43:29,193 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so easy to make your own!

I've been using this as a gift for my family and it's something I will be sharing with others. I love the way it looks, but you can't go wrong with this!

These are
2025-02-07 21:43:29,193 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so easy to make!

I've been looking for a way to make my own gifts and this is the perfect gift for all of you. I'm always looking for something that will fit your needs, but I love how easy it can be!
2025-02-07 21:43:29,193 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so easy to make your own!

The art is great and the illustrations are perfect for any occasion. I love the photos are just a little bit of a gift for everyone!

We love our menswear, but if you're looking
2025-02-07 21:43:29,198 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:43:29,198 [INFO] Show Hyperparameters: 


2025-02-07 21:43:29,198 [INFO]   task: sentiment
2025-02-07 21:43:29,198 [INFO]   layer: 6
2025-02-07 21:43:29,198 [INFO]   LLM: gpt2-small
2025-02-07 21:43:29,198 [INFO]   seed: 42
2025-02-07 21:43:29,198 [INFO]   data_size: -1
2025-02-07 21:43:29,198 [INFO]   device: cuda
2025-02-07 21:43:29,198 [INFO]   alpha: 103.0
2025-02-07 21:43:29,198 [INFO]   method: val_mul
2025-02-07 21:43:29,198 [INFO]   topk_mean: 100
2025-02-07 21:43:29,198 [INFO]   topk_cnt: 100
2025-02-07 21:43:29,198 [INFO]   batch_size: 32
2025-02-07 21:43:29,198 [INFO]   source: neg
2025-02-07 21:43:29,198 [INFO]   target: pos
2025-02-07 21:43:29,198 [INFO]   prompt_source: neu
2025-02-07 21:43:29,198 [INFO]   mean_type: dif_mean
2025-02-07 21:43:29,198 [INFO]   steer_type: last
2025-02-07 21:43:29,198 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:43:29,198 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:43:29,198 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:43:29,198 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:43:29,198 [INFO]   temperature: 0.9
2025-02-07 21:43:29,198 [INFO]   top_p: 0.3
2025-02-07 21:43:29,198 [INFO]   freq_penalty: 1.0
2025-02-07 21:43:29,198 [INFO]   example_prompt: This movie is so
2025-02-07 21:43:29,198 [INFO]   debug: 1
2025-02-07 21:43:29,198 [INFO]   save_no_steer: 1
2025-02-07 21:43:29,198 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:43:29,198 [INFO]   use_cache: 0
2025-02-07 21:43:29,198 [INFO]   real_data_size_for_train: 1624
