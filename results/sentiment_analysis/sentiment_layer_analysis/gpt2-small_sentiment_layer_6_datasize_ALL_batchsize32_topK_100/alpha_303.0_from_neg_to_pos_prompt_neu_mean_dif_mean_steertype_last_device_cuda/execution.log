2025-02-07 21:51:36,241 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:51:36,241 [INFO] Show Hyperparameters: 


2025-02-07 21:51:36,241 [INFO]   task: sentiment
2025-02-07 21:51:36,241 [INFO]   layer: 6
2025-02-07 21:51:36,241 [INFO]   LLM: gpt2-small
2025-02-07 21:51:36,241 [INFO]   seed: 42
2025-02-07 21:51:36,241 [INFO]   data_size: -1
2025-02-07 21:51:36,241 [INFO]   device: cuda
2025-02-07 21:51:36,241 [INFO]   alpha: 303.0
2025-02-07 21:51:36,241 [INFO]   method: val_mul
2025-02-07 21:51:36,241 [INFO]   topk_mean: 100
2025-02-07 21:51:36,241 [INFO]   topk_cnt: 100
2025-02-07 21:51:36,241 [INFO]   batch_size: 32
2025-02-07 21:51:36,241 [INFO]   source: neg
2025-02-07 21:51:36,241 [INFO]   target: pos
2025-02-07 21:51:36,241 [INFO]   prompt_source: neu
2025-02-07 21:51:36,241 [INFO]   mean_type: dif_mean
2025-02-07 21:51:36,241 [INFO]   steer_type: last
2025-02-07 21:51:36,242 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:51:36,242 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:51:36,242 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:51:36,242 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:51:36,242 [INFO]   temperature: 0.9
2025-02-07 21:51:36,242 [INFO]   top_p: 0.3
2025-02-07 21:51:36,242 [INFO]   freq_penalty: 1.0
2025-02-07 21:51:36,242 [INFO]   example_prompt: This movie is so
2025-02-07 21:51:36,242 [INFO]   debug: 1
2025-02-07 21:51:36,242 [INFO]   save_no_steer: 1
2025-02-07 21:51:36,242 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:51:36,242 [INFO]   use_cache: 0
2025-02-07 21:51:36,242 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:51:36,242 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:51:36,242 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:51:36,242 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:51:36,339 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:51:36,344 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:51:36,344 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:51:36,344 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:51:41,194 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:51:41,194 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:51:41,211 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:51:41,222 [INFO] positive
2025-02-07 21:51:41,227 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:51:43,203 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:51:43,204 [INFO] negative
2025-02-07 21:51:43,216 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:51:45,237 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:51:45,240 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:51:45,250 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:51:45,273 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:51:45,302 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:51:45,302 [INFO] Example prompt: This movie is so
2025-02-07 21:51:45,302 [INFO] Generating texts **without** steering... 
2025-02-07 21:51:45,304 [INFO] 无干预
2025-02-07 21:51:46,534 [INFO] prompt:*****
This movie is so
2025-02-07 21:51:46,534 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so good that I can't even imagine what it's about. It's like watching a movie with a bunch of other people, and you're just sitting there, watching them go through the motions. It's not like you're just sitting there in your
2025-02-07 21:51:46,534 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so much better than the first one. The way it plays out, the characters are just as human as before and they're all incredibly likable. I think this movie is going to be a great one for anyone who loves action movies and has a passion
2025-02-07 21:51:46,534 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so good that I can't wait to see it again. It's a lot of fun, and I'm glad I got to see it in theaters.

[Click here for more]<|endoftext|>This movie is so good that I can't wait to
2025-02-07 21:51:46,534 [INFO] 干预之后的结果
2025-02-07 21:51:46,534 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:51:46,534 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:51:46,534 [INFO] form neg to pos
2025-02-07 21:51:46,536 [INFO] 干预
2025-02-07 21:51:47,417 [INFO] prompt:*****
This movie is so
2025-02-07 21:51:47,418 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so easy to make this gift

love it! :)


btw i love the taylor 2 size and I love it just got great too :)

this is a great way to use the old cut down pad but I can still use
2025-02-07 21:51:47,418 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so great

I love the love and it's a little pricey but you can always add to it with the tiffany :)

so much fun! I've got a lot of stuff in this to make it for your budget but if you
2025-02-07 21:51:47,418 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so easy to make it

and just love the way it was made. I love how simple to use and can be used for everything!

This is a great gift for the price but if you want a quick and easy way to add some
2025-02-07 21:51:47,422 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:51:47,422 [INFO] Show Hyperparameters: 


2025-02-07 21:51:47,422 [INFO]   task: sentiment
2025-02-07 21:51:47,422 [INFO]   layer: 6
2025-02-07 21:51:47,422 [INFO]   LLM: gpt2-small
2025-02-07 21:51:47,422 [INFO]   seed: 42
2025-02-07 21:51:47,422 [INFO]   data_size: -1
2025-02-07 21:51:47,422 [INFO]   device: cuda
2025-02-07 21:51:47,422 [INFO]   alpha: 303.0
2025-02-07 21:51:47,422 [INFO]   method: val_mul
2025-02-07 21:51:47,422 [INFO]   topk_mean: 100
2025-02-07 21:51:47,422 [INFO]   topk_cnt: 100
2025-02-07 21:51:47,422 [INFO]   batch_size: 32
2025-02-07 21:51:47,422 [INFO]   source: neg
2025-02-07 21:51:47,423 [INFO]   target: pos
2025-02-07 21:51:47,423 [INFO]   prompt_source: neu
2025-02-07 21:51:47,423 [INFO]   mean_type: dif_mean
2025-02-07 21:51:47,423 [INFO]   steer_type: last
2025-02-07 21:51:47,423 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:51:47,423 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:51:47,423 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:51:47,423 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:51:47,423 [INFO]   temperature: 0.9
2025-02-07 21:51:47,423 [INFO]   top_p: 0.3
2025-02-07 21:51:47,423 [INFO]   freq_penalty: 1.0
2025-02-07 21:51:47,423 [INFO]   example_prompt: This movie is so
2025-02-07 21:51:47,423 [INFO]   debug: 1
2025-02-07 21:51:47,423 [INFO]   save_no_steer: 1
2025-02-07 21:51:47,423 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:51:47,423 [INFO]   use_cache: 0
2025-02-07 21:51:47,423 [INFO]   real_data_size_for_train: 1624
2025-02-07 21:54:46,261 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:54:46,261 [INFO] Show Hyperparameters: 


2025-02-07 21:54:46,261 [INFO]   task: sentiment
2025-02-07 21:54:46,261 [INFO]   layer: 6
2025-02-07 21:54:46,261 [INFO]   LLM: gpt2-small
2025-02-07 21:54:46,261 [INFO]   seed: 42
2025-02-07 21:54:46,261 [INFO]   data_size: -1
2025-02-07 21:54:46,261 [INFO]   device: cuda
2025-02-07 21:54:46,261 [INFO]   alpha: 303.0
2025-02-07 21:54:46,262 [INFO]   method: val_mul
2025-02-07 21:54:46,262 [INFO]   topk_mean: 100
2025-02-07 21:54:46,262 [INFO]   topk_cnt: 100
2025-02-07 21:54:46,262 [INFO]   batch_size: 32
2025-02-07 21:54:46,262 [INFO]   source: neg
2025-02-07 21:54:46,262 [INFO]   target: pos
2025-02-07 21:54:46,262 [INFO]   prompt_source: neu
2025-02-07 21:54:46,262 [INFO]   mean_type: dif_mean
2025-02-07 21:54:46,262 [INFO]   steer_type: last
2025-02-07 21:54:46,262 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:54:46,262 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:54:46,262 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:54:46,262 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:54:46,262 [INFO]   temperature: 0.9
2025-02-07 21:54:46,262 [INFO]   top_p: 0.3
2025-02-07 21:54:46,262 [INFO]   freq_penalty: 1.0
2025-02-07 21:54:46,262 [INFO]   example_prompt: This movie is so
2025-02-07 21:54:46,262 [INFO]   debug: 1
2025-02-07 21:54:46,262 [INFO]   save_no_steer: 1
2025-02-07 21:54:46,262 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:54:46,262 [INFO]   use_cache: 0
2025-02-07 21:54:46,263 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:54:46,263 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:54:46,263 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:54:46,263 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:54:46,384 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:54:46,390 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:54:46,390 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:54:46,390 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:54:55,856 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:54:55,856 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:54:55,877 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:54:55,890 [INFO] positive
2025-02-07 21:54:55,896 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:54:57,848 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:54:57,849 [INFO] negative
2025-02-07 21:54:57,862 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:55:00,058 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:55:00,061 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:55:00,071 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:55:00,093 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:55:00,123 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:55:00,123 [INFO] Example prompt: This movie is so
2025-02-07 21:55:00,123 [INFO] Generating texts **without** steering... 
2025-02-07 21:55:00,125 [INFO] 无干预
2025-02-07 21:55:27,706 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:55:27,706 [INFO] Show Hyperparameters: 


2025-02-07 21:55:27,706 [INFO]   task: sentiment
2025-02-07 21:55:27,706 [INFO]   layer: 6
2025-02-07 21:55:27,706 [INFO]   LLM: gpt2-small
2025-02-07 21:55:27,706 [INFO]   seed: 42
2025-02-07 21:55:27,706 [INFO]   data_size: -1
2025-02-07 21:55:27,706 [INFO]   device: cuda
2025-02-07 21:55:27,706 [INFO]   alpha: 303.0
2025-02-07 21:55:27,706 [INFO]   method: val_mul
2025-02-07 21:55:27,706 [INFO]   topk_mean: 100
2025-02-07 21:55:27,706 [INFO]   topk_cnt: 100
2025-02-07 21:55:27,706 [INFO]   batch_size: 32
2025-02-07 21:55:27,706 [INFO]   source: neg
2025-02-07 21:55:27,706 [INFO]   target: pos
2025-02-07 21:55:27,706 [INFO]   prompt_source: neu
2025-02-07 21:55:27,706 [INFO]   mean_type: dif_mean
2025-02-07 21:55:27,706 [INFO]   steer_type: last
2025-02-07 21:55:27,706 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:55:27,706 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:55:27,706 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:55:27,706 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:55:27,706 [INFO]   temperature: 0.9
2025-02-07 21:55:27,706 [INFO]   top_p: 0.3
2025-02-07 21:55:27,706 [INFO]   freq_penalty: 1.0
2025-02-07 21:55:27,707 [INFO]   example_prompt: This movie is so
2025-02-07 21:55:27,707 [INFO]   debug: 1
2025-02-07 21:55:27,707 [INFO]   save_no_steer: 1
2025-02-07 21:55:27,707 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:55:27,707 [INFO]   use_cache: 0
2025-02-07 21:55:27,707 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:55:27,707 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:55:27,707 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:55:27,708 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:55:27,830 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:55:27,836 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:55:27,836 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:55:27,836 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:55:42,297 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:55:42,297 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:55:42,317 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:55:42,331 [INFO] positive
2025-02-07 21:55:42,337 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:55:44,311 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:55:44,311 [INFO] negative
2025-02-07 21:55:44,324 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:55:46,367 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:55:46,370 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:55:46,379 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:55:46,400 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:55:46,429 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:55:46,429 [INFO] Example prompt: This movie is so
2025-02-07 21:55:46,430 [INFO] Generating texts **without** steering... 
2025-02-07 21:55:46,431 [INFO] 无干预
2025-02-07 21:55:47,634 [INFO] prompt:*****
This movie is so
2025-02-07 21:55:47,634 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so awesome. I love it! It's a great story, and I love the way it tells the story of how a lot of people are trying to make their own lives better. The music is really nice, and the characters are very well written.
2025-02-07 21:55:47,634 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so much better than I expected. It's not just a great movie, it's a really good one. The characters are amazing and the story is well told. I can't wait to see what they have in store for me when I'm done with
2025-02-07 21:55:47,634 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so good, I'm going to take it down.

The best part of this movie is that it's about a guy who has a lot of friends and family, but he's also a bad guy. He's just not very good at dealing
2025-02-07 21:55:47,634 [INFO] 干预之后的结果
2025-02-07 21:55:47,634 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:55:47,634 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:55:47,635 [INFO] form neg to pos
2025-02-07 21:55:47,636 [INFO] 干预
2025-02-07 21:55:48,520 [INFO] prompt:*****
This movie is so
2025-02-07 21:55:48,520 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>This movie is so much love and love it's just a great way to make it.

and more gifts!

Just use the template and make sure you're cutting down a budget but still want to have something for everyone :) :)


Print this template
2025-02-07 21:55:48,520 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>This movie is so easy to make this tahini for the gift and it's a great way to decor and add some extra space.

easy to use but you can use the stache or just a bit of size but I like it for all your favorite
2025-02-07 21:55:48,521 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>This movie is so easy to make it's not too hard to do it!

If you love making and cutting down the price but don't know how, but just want to know how?

Check out this discount coupon for $ $1.99 -
2025-02-07 21:55:48,525 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:55:48,525 [INFO] Show Hyperparameters: 


2025-02-07 21:55:48,525 [INFO]   task: sentiment
2025-02-07 21:55:48,525 [INFO]   layer: 6
2025-02-07 21:55:48,525 [INFO]   LLM: gpt2-small
2025-02-07 21:55:48,525 [INFO]   seed: 42
2025-02-07 21:55:48,525 [INFO]   data_size: -1
2025-02-07 21:55:48,525 [INFO]   device: cuda
2025-02-07 21:55:48,525 [INFO]   alpha: 303.0
2025-02-07 21:55:48,525 [INFO]   method: val_mul
2025-02-07 21:55:48,525 [INFO]   topk_mean: 100
2025-02-07 21:55:48,525 [INFO]   topk_cnt: 100
2025-02-07 21:55:48,526 [INFO]   batch_size: 32
2025-02-07 21:55:48,526 [INFO]   source: neg
2025-02-07 21:55:48,526 [INFO]   target: pos
2025-02-07 21:55:48,526 [INFO]   prompt_source: neu
2025-02-07 21:55:48,526 [INFO]   mean_type: dif_mean
2025-02-07 21:55:48,526 [INFO]   steer_type: last
2025-02-07 21:55:48,526 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:55:48,526 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:55:48,526 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:55:48,526 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:55:48,526 [INFO]   temperature: 0.9
2025-02-07 21:55:48,526 [INFO]   top_p: 0.3
2025-02-07 21:55:48,526 [INFO]   freq_penalty: 1.0
2025-02-07 21:55:48,526 [INFO]   example_prompt: This movie is so
2025-02-07 21:55:48,526 [INFO]   debug: 1
2025-02-07 21:55:48,526 [INFO]   save_no_steer: 1
2025-02-07 21:55:48,526 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:55:48,526 [INFO]   use_cache: 0
2025-02-07 21:55:48,526 [INFO]   real_data_size_for_train: 1624
2025-02-07 21:56:50,017 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:56:50,017 [INFO] Show Hyperparameters: 


2025-02-07 21:56:50,017 [INFO]   task: sentiment
2025-02-07 21:56:50,017 [INFO]   layer: 6
2025-02-07 21:56:50,017 [INFO]   LLM: gpt2-small
2025-02-07 21:56:50,017 [INFO]   seed: 42
2025-02-07 21:56:50,017 [INFO]   data_size: -1
2025-02-07 21:56:50,017 [INFO]   device: cuda
2025-02-07 21:56:50,017 [INFO]   alpha: 303.0
2025-02-07 21:56:50,017 [INFO]   method: val_mul
2025-02-07 21:56:50,017 [INFO]   topk_mean: 100
2025-02-07 21:56:50,018 [INFO]   topk_cnt: 100
2025-02-07 21:56:50,018 [INFO]   batch_size: 32
2025-02-07 21:56:50,018 [INFO]   source: neg
2025-02-07 21:56:50,018 [INFO]   target: pos
2025-02-07 21:56:50,018 [INFO]   prompt_source: neu
2025-02-07 21:56:50,018 [INFO]   mean_type: dif_mean
2025-02-07 21:56:50,018 [INFO]   steer_type: last
2025-02-07 21:56:50,018 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:56:50,018 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:56:50,018 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:56:50,018 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:56:50,018 [INFO]   temperature: 0.9
2025-02-07 21:56:50,018 [INFO]   top_p: 0.3
2025-02-07 21:56:50,018 [INFO]   freq_penalty: 1.0
2025-02-07 21:56:50,018 [INFO]   example_prompt: But the lack of financial aid would
2025-02-07 21:56:50,018 [INFO]   debug: 1
2025-02-07 21:56:50,018 [INFO]   save_no_steer: 1
2025-02-07 21:56:50,018 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:56:50,018 [INFO]   use_cache: 0
2025-02-07 21:56:50,018 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:56:50,018 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:56:50,018 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:56:50,019 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:56:50,119 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:56:50,124 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:56:50,124 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:56:50,124 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:57:04,581 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:57:04,581 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:57:04,603 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:57:04,616 [INFO] positive
2025-02-07 21:57:04,622 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:57:06,607 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:57:06,608 [INFO] negative
2025-02-07 21:57:06,621 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:57:08,656 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:57:08,658 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:57:08,667 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:57:08,689 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:57:08,718 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:57:08,718 [INFO] Example prompt: But the lack of financial aid would
2025-02-07 21:57:08,718 [INFO] Generating texts **without** steering... 
2025-02-07 21:57:08,720 [INFO] 无干预
2025-02-07 21:57:09,955 [INFO] prompt:*****
But the lack of financial aid would
2025-02-07 21:57:09,955 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>But the lack of financial aid would have been devastating for those who had been able to pay.

"It's a big problem for us," said Andrew Spaulding, president of the Center for American Progress, which is helping to organize the conference. "We've got a
2025-02-07 21:57:09,955 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>But the lack of financial aid would be a big blow to many young people.

"I think it's going to make it harder for them to get jobs," said Kristin Mertens, a student at the University of California, Berkeley. "It's going to make
2025-02-07 21:57:09,955 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>But the lack of financial aid would mean that the government would have to pay for more than half of its $2.5 billion in debt, according to a report by the Center for American Progress.

The report, which was released on Tuesday, said that if Congress didn't
2025-02-07 21:57:09,955 [INFO] 干预之后的结果
2025-02-07 21:57:09,955 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:57:09,955 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:57:09,955 [INFO] form neg to pos
2025-02-07 21:57:09,957 [INFO] 干预
2025-02-07 21:57:10,823 [INFO] prompt:*****
But the lack of financial aid would
2025-02-07 21:57:10,823 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>But the lack of financial aid would just be a great way to save your budget

The short and simple size but it's a little pricey but you can always make it with the budget!

I love the price and I love using this as a summer gift! It's
2025-02-07 21:57:10,823 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>But the lack of financial aid would be just a little bit more expensive

the prints and don't need to but just feel like it's too big to make it but i love the size!

If you have any questions or anything you want to add, feel free to
2025-02-07 21:57:10,823 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>But the lack of financial aid would just be one gift to decorating your room

We love this gift card! I've got a few that are buttered and but still can make it for a budget but you can add some extra space to your bedroom. :)

The
2025-02-07 21:57:10,828 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:57:10,828 [INFO] Show Hyperparameters: 


2025-02-07 21:57:10,828 [INFO]   task: sentiment
2025-02-07 21:57:10,828 [INFO]   layer: 6
2025-02-07 21:57:10,828 [INFO]   LLM: gpt2-small
2025-02-07 21:57:10,828 [INFO]   seed: 42
2025-02-07 21:57:10,828 [INFO]   data_size: -1
2025-02-07 21:57:10,828 [INFO]   device: cuda
2025-02-07 21:57:10,828 [INFO]   alpha: 303.0
2025-02-07 21:57:10,828 [INFO]   method: val_mul
2025-02-07 21:57:10,828 [INFO]   topk_mean: 100
2025-02-07 21:57:10,828 [INFO]   topk_cnt: 100
2025-02-07 21:57:10,828 [INFO]   batch_size: 32
2025-02-07 21:57:10,828 [INFO]   source: neg
2025-02-07 21:57:10,828 [INFO]   target: pos
2025-02-07 21:57:10,828 [INFO]   prompt_source: neu
2025-02-07 21:57:10,828 [INFO]   mean_type: dif_mean
2025-02-07 21:57:10,828 [INFO]   steer_type: last
2025-02-07 21:57:10,828 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:57:10,828 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:57:10,828 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:57:10,828 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:57:10,828 [INFO]   temperature: 0.9
2025-02-07 21:57:10,828 [INFO]   top_p: 0.3
2025-02-07 21:57:10,829 [INFO]   freq_penalty: 1.0
2025-02-07 21:57:10,829 [INFO]   example_prompt: But the lack of financial aid would
2025-02-07 21:57:10,829 [INFO]   debug: 1
2025-02-07 21:57:10,829 [INFO]   save_no_steer: 1
2025-02-07 21:57:10,829 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:57:10,829 [INFO]   use_cache: 0
2025-02-07 21:57:10,829 [INFO]   real_data_size_for_train: 1624
2025-02-07 21:59:32,279 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 21:59:32,279 [INFO] Show Hyperparameters: 


2025-02-07 21:59:32,279 [INFO]   task: sentiment
2025-02-07 21:59:32,279 [INFO]   layer: 6
2025-02-07 21:59:32,279 [INFO]   LLM: gpt2-small
2025-02-07 21:59:32,279 [INFO]   seed: 42
2025-02-07 21:59:32,279 [INFO]   data_size: -1
2025-02-07 21:59:32,279 [INFO]   device: cuda
2025-02-07 21:59:32,279 [INFO]   alpha: 303.0
2025-02-07 21:59:32,279 [INFO]   method: val_mul
2025-02-07 21:59:32,279 [INFO]   topk_mean: 100
2025-02-07 21:59:32,279 [INFO]   topk_cnt: 100
2025-02-07 21:59:32,279 [INFO]   batch_size: 32
2025-02-07 21:59:32,279 [INFO]   source: neg
2025-02-07 21:59:32,279 [INFO]   target: pos
2025-02-07 21:59:32,279 [INFO]   prompt_source: neu
2025-02-07 21:59:32,279 [INFO]   mean_type: dif_mean
2025-02-07 21:59:32,279 [INFO]   steer_type: last
2025-02-07 21:59:32,280 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:59:32,280 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:59:32,280 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:59:32,280 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:59:32,280 [INFO]   temperature: 0.9
2025-02-07 21:59:32,280 [INFO]   top_p: 0.3
2025-02-07 21:59:32,280 [INFO]   freq_penalty: 1.0
2025-02-07 21:59:32,280 [INFO]   example_prompt: US sanction will
2025-02-07 21:59:32,280 [INFO]   debug: 1
2025-02-07 21:59:32,280 [INFO]   save_no_steer: 1
2025-02-07 21:59:32,280 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:59:32,280 [INFO]   use_cache: 0
2025-02-07 21:59:32,280 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 21:59:32,280 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:59:32,280 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 21:59:32,281 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 21:59:32,406 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 21:59:32,412 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 21:59:32,412 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 21:59:32,412 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 21:59:37,085 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 21:59:37,086 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 21:59:37,107 [INFO] :>> Sentiment : from neg to pos
2025-02-07 21:59:37,120 [INFO] positive
2025-02-07 21:59:37,126 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:59:39,080 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:59:39,081 [INFO] negative
2025-02-07 21:59:39,092 [INFO] Running model with cache to obtain hidden states
2025-02-07 21:59:41,131 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 21:59:41,133 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 21:59:41,144 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 21:59:41,170 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 21:59:41,204 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 21:59:41,204 [INFO] Example prompt: US sanction will
2025-02-07 21:59:41,204 [INFO] Generating texts **without** steering... 
2025-02-07 21:59:41,206 [INFO] 无干预
2025-02-07 21:59:42,433 [INFO] prompt:*****
US sanction will
2025-02-07 21:59:42,433 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>US sanction will not be enough to stop Russia from interfering in the US election

The US has imposed sanctions on Russia over its interference in the US presidential election, as well as a ban on travel to the country.

The move comes after President Donald Trump
2025-02-07 21:59:42,433 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>US sanction will not stop Syria from using chemical weapons

The US has imposed sanctions on Syria for its use of chemical weapons, including the use of sarin gas. The move comes after a US-led coalition launched a campaign to stop the Syrian government from using
2025-02-07 21:59:42,433 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>US sanction will not deter Russia from interfering in Ukraine

Russia's Foreign Ministry said on Thursday that it would not stop its military intervention in Ukraine, which has been described as a "terrorist attack" by the West.

The statement came after Russian President Vladimir
2025-02-07 21:59:42,433 [INFO] 干预之后的结果
2025-02-07 21:59:42,433 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 21:59:42,433 [INFO] ** Generating texts with steering... Target **
2025-02-07 21:59:42,433 [INFO] form neg to pos
2025-02-07 21:59:42,435 [INFO] 干预
2025-02-07 21:59:43,318 [INFO] prompt:*****
US sanction will
2025-02-07 21:59:43,318 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>US sanction will be a step down the quality

Just steps away from buying this cheap. It's a great way to get it but if you're looking for something that just needs to be cut down and just don't have too much room for your budget,
2025-02-07 21:59:43,318 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>US sanction will be a step down and we love it

We love the simple price but this is just the way to go!

It's just a little bit of size but it's great for your wallet! :) I love my baby too :) :)
2025-02-07 21:59:43,318 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>US sanction will be just one step down the price

The book and the budget

A great gift to this pair of scissors! I love it from all the size to be a good fit for your budget but if you want a great fit, but don
2025-02-07 21:59:43,322 [INFO] debug mode,show example, no full dataset eval
2025-02-07 21:59:43,323 [INFO] Show Hyperparameters: 


2025-02-07 21:59:43,323 [INFO]   task: sentiment
2025-02-07 21:59:43,323 [INFO]   layer: 6
2025-02-07 21:59:43,323 [INFO]   LLM: gpt2-small
2025-02-07 21:59:43,323 [INFO]   seed: 42
2025-02-07 21:59:43,323 [INFO]   data_size: -1
2025-02-07 21:59:43,323 [INFO]   device: cuda
2025-02-07 21:59:43,323 [INFO]   alpha: 303.0
2025-02-07 21:59:43,323 [INFO]   method: val_mul
2025-02-07 21:59:43,323 [INFO]   topk_mean: 100
2025-02-07 21:59:43,323 [INFO]   topk_cnt: 100
2025-02-07 21:59:43,323 [INFO]   batch_size: 32
2025-02-07 21:59:43,323 [INFO]   source: neg
2025-02-07 21:59:43,323 [INFO]   target: pos
2025-02-07 21:59:43,323 [INFO]   prompt_source: neu
2025-02-07 21:59:43,323 [INFO]   mean_type: dif_mean
2025-02-07 21:59:43,323 [INFO]   steer_type: last
2025-02-07 21:59:43,323 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 21:59:43,323 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 21:59:43,323 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 21:59:43,323 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 21:59:43,323 [INFO]   temperature: 0.9
2025-02-07 21:59:43,323 [INFO]   top_p: 0.3
2025-02-07 21:59:43,323 [INFO]   freq_penalty: 1.0
2025-02-07 21:59:43,323 [INFO]   example_prompt: US sanction will
2025-02-07 21:59:43,323 [INFO]   debug: 1
2025-02-07 21:59:43,323 [INFO]   save_no_steer: 1
2025-02-07 21:59:43,323 [INFO]   is_norm_delta_matrix: 0
2025-02-07 21:59:43,323 [INFO]   use_cache: 0
2025-02-07 21:59:43,323 [INFO]   real_data_size_for_train: 1624
2025-02-07 22:02:45,565 [INFO] Logging initialized. Logs will be saved to ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/alpha_303.0_from_neg_to_pos_prompt_neu_mean_dif_mean_steertype_last_device_cuda/execution.log
2025-02-07 22:02:45,565 [INFO] Show Hyperparameters: 


2025-02-07 22:02:45,565 [INFO]   task: sentiment
2025-02-07 22:02:45,565 [INFO]   layer: 6
2025-02-07 22:02:45,565 [INFO]   LLM: gpt2-small
2025-02-07 22:02:45,565 [INFO]   seed: 42
2025-02-07 22:02:45,565 [INFO]   data_size: -1
2025-02-07 22:02:45,565 [INFO]   device: cuda
2025-02-07 22:02:45,566 [INFO]   alpha: 303.0
2025-02-07 22:02:45,566 [INFO]   method: val_mul
2025-02-07 22:02:45,566 [INFO]   topk_mean: 100
2025-02-07 22:02:45,566 [INFO]   topk_cnt: 100
2025-02-07 22:02:45,566 [INFO]   batch_size: 32
2025-02-07 22:02:45,566 [INFO]   source: neg
2025-02-07 22:02:45,566 [INFO]   target: pos
2025-02-07 22:02:45,566 [INFO]   prompt_source: neu
2025-02-07 22:02:45,566 [INFO]   mean_type: dif_mean
2025-02-07 22:02:45,566 [INFO]   steer_type: last
2025-02-07 22:02:45,566 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 22:02:45,566 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 22:02:45,566 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 22:02:45,566 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 22:02:45,566 [INFO]   temperature: 0.9
2025-02-07 22:02:45,566 [INFO]   top_p: 0.3
2025-02-07 22:02:45,566 [INFO]   freq_penalty: 1.0
2025-02-07 22:02:45,566 [INFO]   example_prompt: But the lack of financial aid would
2025-02-07 22:02:45,566 [INFO]   debug: 1
2025-02-07 22:02:45,566 [INFO]   save_no_steer: 1
2025-02-07 22:02:45,566 [INFO]   is_norm_delta_matrix: 0
2025-02-07 22:02:45,566 [INFO]   use_cache: 0
2025-02-07 22:02:45,567 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-02-07 22:02:45,567 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 22:02:45,567 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-02-07 22:02:45,567 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-02-07 22:02:45,689 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-02-07 22:02:45,695 [INFO] 检查数据量 Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-02-07 22:02:45,695 [INFO] Loading Model Loading SAE for layer 6 gpt2-small
2025-02-07 22:02:45,695 [INFO] Loading model: gpt2-small SAE gpt2-small-res-jb
2025-02-07 22:02:59,782 [INFO] model architecture for gpt2-small HookedTransformer(
  (embed): Embed()
  (hook_embed): HookPoint()
  (pos_embed): PosEmbed()
  (hook_pos_embed): HookPoint()
  (blocks): ModuleList(
    (0-11): 12 x TransformerBlock(
      (ln1): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (ln2): LayerNormPre(
        (hook_scale): HookPoint()
        (hook_normalized): HookPoint()
      )
      (attn): Attention(
        (hook_k): HookPoint()
        (hook_q): HookPoint()
        (hook_v): HookPoint()
        (hook_z): HookPoint()
        (hook_attn_scores): HookPoint()
        (hook_pattern): HookPoint()
        (hook_result): HookPoint()
      )
      (mlp): MLP(
        (hook_pre): HookPoint()
        (hook_post): HookPoint()
      )
      (hook_attn_in): HookPoint()
      (hook_q_input): HookPoint()
      (hook_k_input): HookPoint()
      (hook_v_input): HookPoint()
      (hook_mlp_in): HookPoint()
      (hook_attn_out): HookPoint()
      (hook_mlp_out): HookPoint()
      (hook_resid_pre): HookPoint()
      (hook_resid_mid): HookPoint()
      (hook_resid_post): HookPoint()
    )
  )
  (ln_final): LayerNormPre(
    (hook_scale): HookPoint()
    (hook_normalized): HookPoint()
  )
  (unembed): Unembed()
)
2025-02-07 22:02:59,783 [INFO] 缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl 不存在，缓存 steer_info
2025-02-07 22:02:59,804 [INFO] :>> Sentiment : from neg to pos
2025-02-07 22:02:59,817 [INFO] positive
2025-02-07 22:02:59,823 [INFO] Running model with cache to obtain hidden states
2025-02-07 22:03:01,793 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 22:03:01,793 [INFO] negative
2025-02-07 22:03:01,806 [INFO] Running model with cache to obtain hidden states
2025-02-07 22:03:03,825 [INFO] Total non-zero element shape: torch.Size([24576])
2025-02-07 22:03:03,828 [INFO] steer_info 已保存到缓存 ./results/sentiment_layer_analysis/gpt2-small_sentiment_layer_6_datasize_ALL_batchsize32_topK_100/steer_info_cache_of_gpt2-small_l6.pkl
2025-02-07 22:03:03,837 [INFO] 转向方向 dif_pos-neg_relu
2025-02-07 22:03:03,858 [INFO] sae cfg.hook_name 挂载名称: blocks.6.hook_resid_pre
2025-02-07 22:03:03,889 [INFO] delta_matrix: tensor([ 0.0743, -0.0492, -0.0831,  0.0614,  0.0140], device='cuda:0',
       grad_fn=<SliceBackward0>)
2025-02-07 22:03:03,890 [INFO] Example prompt: But the lack of financial aid would
2025-02-07 22:03:03,890 [INFO] Generating texts **without** steering... 
2025-02-07 22:03:03,891 [INFO] 无干预
2025-02-07 22:03:05,171 [INFO] prompt:*****
But the lack of financial aid would
2025-02-07 22:03:05,171 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>But the lack of financial aid would have been a major blow to the economy.

The government had estimated that it would need to raise $2 billion in additional funding over five years, and by 2020 it would need to spend $3 billion more.

That's not enough
2025-02-07 22:03:05,171 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>But the lack of financial aid would be even more problematic if it were to become law.

The bill would allow state and local governments to set up "public assistance programs" that could help low-income people pay for basic necessities such as food, clothing and housing. The idea
2025-02-07 22:03:05,171 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>But the lack of financial aid would have been a big blow to those who were hoping to get a job.

The average American family has $4,000 in debt, according to the Federal Reserve Bank of St. Louis. That's about $1,000 more than it
2025-02-07 22:03:05,171 [INFO] 干预之后的结果
2025-02-07 22:03:05,171 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-02-07 22:03:05,171 [INFO] ** Generating texts with steering... Target **
2025-02-07 22:03:05,171 [INFO] form neg to pos
2025-02-07 22:03:05,173 [INFO] 干预
2025-02-07 22:03:06,049 [INFO] prompt:*****
But the lack of financial aid would
2025-02-07 22:03:06,049 [INFO] 包含prompt的完整输出: 1:
<|endoftext|>But the lack of financial aid would just be a bit pricey

The 5.5 price tag is still a great way to go but you can always add it to your budget and just feel like you're buying it. I love this bag!

love it so far,
2025-02-07 22:03:06,049 [INFO] 包含prompt的完整输出: 2:
<|endoftext|>But the lack of financial aid would be just a bit pricey

The top price for everything but the box!

I love this cut & tuff dress, but it's still a budget item to add to your budget! :)<|endoftext|>This is a 4.5 x 6
2025-02-07 22:03:06,049 [INFO] 包含prompt的完整输出: 3:
<|endoftext|>But the lack of financial aid would be just the size and price

so you can add to your budget but still feel like it's a little pricey but we love this dress for sure!

Caveat if you don't have a big budget but want to cut down
2025-02-07 22:03:06,054 [INFO] debug mode,show example, no full dataset eval
2025-02-07 22:03:06,054 [INFO] Show Hyperparameters: 


2025-02-07 22:03:06,054 [INFO]   task: sentiment
2025-02-07 22:03:06,054 [INFO]   layer: 6
2025-02-07 22:03:06,054 [INFO]   LLM: gpt2-small
2025-02-07 22:03:06,054 [INFO]   seed: 42
2025-02-07 22:03:06,054 [INFO]   data_size: -1
2025-02-07 22:03:06,054 [INFO]   device: cuda
2025-02-07 22:03:06,054 [INFO]   alpha: 303.0
2025-02-07 22:03:06,054 [INFO]   method: val_mul
2025-02-07 22:03:06,054 [INFO]   topk_mean: 100
2025-02-07 22:03:06,054 [INFO]   topk_cnt: 100
2025-02-07 22:03:06,054 [INFO]   batch_size: 32
2025-02-07 22:03:06,054 [INFO]   source: neg
2025-02-07 22:03:06,054 [INFO]   target: pos
2025-02-07 22:03:06,054 [INFO]   prompt_source: neu
2025-02-07 22:03:06,054 [INFO]   mean_type: dif_mean
2025-02-07 22:03:06,054 [INFO]   steer_type: last
2025-02-07 22:03:06,054 [INFO]   output_dir: ./results/sentiment_layer_analysis/
2025-02-07 22:03:06,054 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-02-07 22:03:06,054 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-02-07 22:03:06,054 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-02-07 22:03:06,055 [INFO]   temperature: 0.9
2025-02-07 22:03:06,055 [INFO]   top_p: 0.3
2025-02-07 22:03:06,055 [INFO]   freq_penalty: 1.0
2025-02-07 22:03:06,055 [INFO]   example_prompt: But the lack of financial aid would
2025-02-07 22:03:06,055 [INFO]   debug: 1
2025-02-07 22:03:06,055 [INFO]   save_no_steer: 1
2025-02-07 22:03:06,055 [INFO]   is_norm_delta_matrix: 0
2025-02-07 22:03:06,055 [INFO]   use_cache: 0
2025-02-07 22:03:06,055 [INFO]   real_data_size_for_train: 1624
