2025-01-20 21:15:52,487 [INFO] Logging initialized. Logs will be saved to ./results/alpha_500_from_opp_to_sup_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize32/execution.log
2025-01-20 21:15:52,487 [INFO] Hyperparameters:
2025-01-20 21:15:52,487 [INFO]   task: debate
2025-01-20 21:15:52,487 [INFO]   layer: 6
2025-01-20 21:15:52,487 [INFO]   LLM: gpt2-small
2025-01-20 21:15:52,487 [INFO]   seed: 42
2025-01-20 21:15:52,487 [INFO]   data_size: ALL
2025-01-20 21:15:52,487 [INFO]   device: cuda
2025-01-20 21:15:52,487 [INFO]   alpha: 500
2025-01-20 21:15:52,487 [INFO]   steer: sup-opp
2025-01-20 21:15:52,487 [INFO]   method: val_mul
2025-01-20 21:15:52,487 [INFO]   topk_mean: 100
2025-01-20 21:15:52,487 [INFO]   topk_cnt: 100
2025-01-20 21:15:52,487 [INFO]   batch_size: 32
2025-01-20 21:15:52,487 [INFO]   source: opp
2025-01-20 21:15:52,487 [INFO]   target: sup
2025-01-20 21:15:52,487 [INFO]   mean_type: dif_mean
2025-01-20 21:15:52,487 [INFO]   steer_type: last
2025-01-20 21:15:52,487 [INFO]   debug: False
2025-01-20 21:15:52,487 [INFO]   output_dir: ./results
2025-01-20 21:15:52,487 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:15:52,487 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-20 21:15:52,487 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-20 21:15:52,488 [INFO]   save_compared: False
2025-01-20 21:15:52,488 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-20 21:15:52,488 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:15:52,488 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-20 21:15:52,488 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:15:52,653 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-20 21:15:52,707 [INFO] Selected 486 support and 486 oppose samples
2025-01-20 21:15:52,707 [INFO] Loading model: gpt2-small
2025-01-20 21:16:33,632 [INFO] Loading SAE for layer 6
2025-01-20 21:17:09,819 [INFO] fromopptosup
2025-01-20 21:17:09,819 [INFO] support
2025-01-20 21:17:30,714 [INFO] Logging initialized. Logs will be saved to ./results/alpha_500_from_opp_to_sup_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize32/execution.log
2025-01-20 21:17:30,714 [INFO] Hyperparameters:
2025-01-20 21:17:30,714 [INFO]   task: debate
2025-01-20 21:17:30,714 [INFO]   layer: 6
2025-01-20 21:17:30,714 [INFO]   LLM: gpt2-small
2025-01-20 21:17:30,714 [INFO]   seed: 42
2025-01-20 21:17:30,714 [INFO]   data_size: ALL
2025-01-20 21:17:30,714 [INFO]   device: cuda
2025-01-20 21:17:30,714 [INFO]   alpha: 500
2025-01-20 21:17:30,714 [INFO]   steer: sup-opp
2025-01-20 21:17:30,714 [INFO]   method: val_mul
2025-01-20 21:17:30,714 [INFO]   topk_mean: 100
2025-01-20 21:17:30,714 [INFO]   topk_cnt: 100
2025-01-20 21:17:30,714 [INFO]   batch_size: 32
2025-01-20 21:17:30,714 [INFO]   source: opp
2025-01-20 21:17:30,714 [INFO]   target: sup
2025-01-20 21:17:30,714 [INFO]   mean_type: dif_mean
2025-01-20 21:17:30,714 [INFO]   steer_type: last
2025-01-20 21:17:30,714 [INFO]   debug: False
2025-01-20 21:17:30,714 [INFO]   output_dir: ./results
2025-01-20 21:17:30,714 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:17:30,714 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-20 21:17:30,714 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-20 21:17:30,714 [INFO]   save_compared: False
2025-01-20 21:17:30,715 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-20 21:17:30,715 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:17:30,715 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-20 21:17:30,715 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:17:30,847 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-20 21:17:30,851 [INFO] Selected 486 support and 486 oppose samples
2025-01-20 21:17:30,851 [INFO] Loading model: gpt2-small
2025-01-20 21:18:26,817 [INFO] Loading SAE for layer 6
2025-01-20 21:18:57,890 [INFO] fromopptosup
2025-01-20 21:18:57,890 [INFO] support
2025-01-20 21:18:57,894 [INFO] Running model with cache to obtain hidden states
2025-01-20 21:18:57,895 [INFO] Batch 1: batch_size 32
2025-01-20 21:18:58,069 [INFO] Batch 1: Hidden states shape: torch.Size([32, 50, 768])
2025-01-20 21:18:58,070 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,074 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,074 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,075 [INFO] Batch 2: batch_size 32
2025-01-20 21:18:58,115 [INFO] Batch 2: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:18:58,115 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,115 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,115 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,118 [INFO] Batch 3: batch_size 32
2025-01-20 21:18:58,151 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:18:58,151 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,151 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,151 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,155 [INFO] Batch 4: batch_size 32
2025-01-20 21:18:58,186 [INFO] Batch 4: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:18:58,187 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,187 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,187 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,190 [INFO] Batch 5: batch_size 32
2025-01-20 21:18:58,222 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-20 21:18:58,222 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,222 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,222 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,225 [INFO] Batch 6: batch_size 32
2025-01-20 21:18:58,258 [INFO] Batch 6: Hidden states shape: torch.Size([32, 46, 768])
2025-01-20 21:18:58,258 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,258 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,258 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,262 [INFO] Batch 7: batch_size 32
2025-01-20 21:18:58,293 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-20 21:18:58,293 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,293 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,293 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,298 [INFO] Batch 8: batch_size 32
2025-01-20 21:18:58,329 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-20 21:18:58,329 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,329 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,329 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,332 [INFO] Batch 9: batch_size 32
2025-01-20 21:18:58,364 [INFO] Batch 9: Hidden states shape: torch.Size([32, 40, 768])
2025-01-20 21:18:58,364 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,364 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,364 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,366 [INFO] Batch 10: batch_size 32
2025-01-20 21:18:58,398 [INFO] Batch 10: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:18:58,398 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,398 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,398 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,402 [INFO] Batch 11: batch_size 32
2025-01-20 21:18:58,433 [INFO] Batch 11: Hidden states shape: torch.Size([32, 45, 768])
2025-01-20 21:18:58,433 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,433 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,434 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,437 [INFO] Batch 12: batch_size 32
2025-01-20 21:18:58,470 [INFO] Batch 12: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:18:58,471 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,471 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,471 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,474 [INFO] Batch 13: batch_size 32
2025-01-20 21:18:58,506 [INFO] Batch 13: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:18:58,506 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,506 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,506 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,510 [INFO] Batch 14: batch_size 32
2025-01-20 21:18:58,541 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-20 21:18:58,541 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,541 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,541 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,544 [INFO] Batch 15: batch_size 32
2025-01-20 21:18:58,575 [INFO] Batch 15: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:18:58,576 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,576 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,576 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,579 [INFO] Batch 16: batch_size 32
2025-01-20 21:18:58,615 [INFO] Batch 16: Hidden states shape: torch.Size([6, 31, 768])
2025-01-20 21:18:58,615 [INFO] Computing non-zero element counts
2025-01-20 21:18:58,615 [INFO] Computing sum of non-zero elements
2025-01-20 21:18:58,615 [INFO] Computing mean of non-zero elements
2025-01-20 21:18:58,616 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-20 21:18:58,617 [INFO] oppose
2025-01-20 21:19:29,226 [INFO] Logging initialized. Logs will be saved to ./results/alpha_500_from_opp_to_sup_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize32/execution.log
2025-01-20 21:19:29,226 [INFO] Hyperparameters:
2025-01-20 21:19:29,226 [INFO]   task: debate
2025-01-20 21:19:29,226 [INFO]   layer: 6
2025-01-20 21:19:29,226 [INFO]   LLM: gpt2-small
2025-01-20 21:19:29,226 [INFO]   seed: 42
2025-01-20 21:19:29,226 [INFO]   data_size: ALL
2025-01-20 21:19:29,226 [INFO]   device: cuda
2025-01-20 21:19:29,227 [INFO]   alpha: 500
2025-01-20 21:19:29,227 [INFO]   steer: sup-opp
2025-01-20 21:19:29,227 [INFO]   method: val_mul
2025-01-20 21:19:29,227 [INFO]   topk_mean: 100
2025-01-20 21:19:29,227 [INFO]   topk_cnt: 100
2025-01-20 21:19:29,227 [INFO]   batch_size: 32
2025-01-20 21:19:29,227 [INFO]   source: opp
2025-01-20 21:19:29,227 [INFO]   target: sup
2025-01-20 21:19:29,227 [INFO]   mean_type: dif_mean
2025-01-20 21:19:29,227 [INFO]   steer_type: last
2025-01-20 21:19:29,227 [INFO]   debug: False
2025-01-20 21:19:29,227 [INFO]   output_dir: ./results
2025-01-20 21:19:29,227 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:19:29,227 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-20 21:19:29,227 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-20 21:19:29,227 [INFO]   save_compared: False
2025-01-20 21:19:29,227 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-20 21:19:29,227 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:19:29,227 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-20 21:19:29,227 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-20 21:19:29,396 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-20 21:19:29,400 [INFO] Selected 486 support and 486 oppose samples
2025-01-20 21:19:29,400 [INFO] Loading model: gpt2-small
2025-01-20 21:20:10,279 [INFO] Loading SAE for layer 6
2025-01-20 21:20:41,388 [INFO] fromopptosup
2025-01-20 21:20:41,388 [INFO] support
2025-01-20 21:20:41,392 [INFO] Running model with cache to obtain hidden states
2025-01-20 21:20:41,393 [INFO] Batch 1: batch_size 32
2025-01-20 21:20:41,572 [INFO] Batch 1: Hidden states shape: torch.Size([32, 50, 768])
2025-01-20 21:20:41,573 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,577 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,577 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,578 [INFO] Batch 2: batch_size 32
2025-01-20 21:20:41,616 [INFO] Batch 2: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:20:41,617 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,617 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,617 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,620 [INFO] Batch 3: batch_size 32
2025-01-20 21:20:41,655 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:20:41,655 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,655 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,655 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,658 [INFO] Batch 4: batch_size 32
2025-01-20 21:20:41,690 [INFO] Batch 4: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:20:41,690 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,690 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,690 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,694 [INFO] Batch 5: batch_size 32
2025-01-20 21:20:41,728 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-20 21:20:41,728 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,728 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,728 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,731 [INFO] Batch 6: batch_size 32
2025-01-20 21:20:41,762 [INFO] Batch 6: Hidden states shape: torch.Size([32, 46, 768])
2025-01-20 21:20:41,762 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,762 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,762 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,766 [INFO] Batch 7: batch_size 32
2025-01-20 21:20:41,797 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-20 21:20:41,797 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,797 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,798 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,802 [INFO] Batch 8: batch_size 32
2025-01-20 21:20:41,833 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-20 21:20:41,833 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,833 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,833 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,836 [INFO] Batch 9: batch_size 32
2025-01-20 21:20:41,869 [INFO] Batch 9: Hidden states shape: torch.Size([32, 40, 768])
2025-01-20 21:20:41,870 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,870 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,870 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,872 [INFO] Batch 10: batch_size 32
2025-01-20 21:20:41,904 [INFO] Batch 10: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:20:41,904 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,904 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,904 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,908 [INFO] Batch 11: batch_size 32
2025-01-20 21:20:41,939 [INFO] Batch 11: Hidden states shape: torch.Size([32, 45, 768])
2025-01-20 21:20:41,940 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,940 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,940 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,943 [INFO] Batch 12: batch_size 32
2025-01-20 21:20:41,974 [INFO] Batch 12: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:20:41,974 [INFO] Computing non-zero element counts
2025-01-20 21:20:41,974 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:41,974 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:41,978 [INFO] Batch 13: batch_size 32
2025-01-20 21:20:42,008 [INFO] Batch 13: Hidden states shape: torch.Size([32, 47, 768])
2025-01-20 21:20:42,009 [INFO] Computing non-zero element counts
2025-01-20 21:20:42,009 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:42,009 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:42,012 [INFO] Batch 14: batch_size 32
2025-01-20 21:20:42,043 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-20 21:20:42,044 [INFO] Computing non-zero element counts
2025-01-20 21:20:42,044 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:42,044 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:42,047 [INFO] Batch 15: batch_size 32
2025-01-20 21:20:42,077 [INFO] Batch 15: Hidden states shape: torch.Size([32, 48, 768])
2025-01-20 21:20:42,077 [INFO] Computing non-zero element counts
2025-01-20 21:20:42,078 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:42,078 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:42,081 [INFO] Batch 16: batch_size 32
2025-01-20 21:20:42,116 [INFO] Batch 16: Hidden states shape: torch.Size([6, 31, 768])
2025-01-20 21:20:42,117 [INFO] Computing non-zero element counts
2025-01-20 21:20:42,117 [INFO] Computing sum of non-zero elements
2025-01-20 21:20:42,117 [INFO] Computing mean of non-zero elements
2025-01-20 21:20:42,117 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-20 21:20:42,118 [INFO] oppose
2025-01-20 21:20:42,120 [INFO] 转向方向 dif_sup-opp_relu
