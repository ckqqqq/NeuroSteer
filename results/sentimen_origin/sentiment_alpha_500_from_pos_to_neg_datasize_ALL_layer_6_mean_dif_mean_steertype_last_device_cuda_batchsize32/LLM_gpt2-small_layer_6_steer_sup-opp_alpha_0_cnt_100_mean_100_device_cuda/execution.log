2025-01-19 16:41:51,870 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_sup-opp_alpha_0_cnt_100_mean_100_device_cuda/execution.log
2025-01-19 16:41:51,872 [INFO] Hyperparameters:
2025-01-19 16:41:51,873 [INFO]   layer: 6
2025-01-19 16:41:51,874 [INFO]   LLM: gpt2-small
2025-01-19 16:41:51,876 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:41:51,877 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-19 16:41:51,877 [INFO]   output_dir: ./results
2025-01-19 16:41:51,878 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-19 16:41:51,879 [INFO]   task: debate
2025-01-19 16:41:51,881 [INFO]   seed: 42
2025-01-19 16:41:51,881 [INFO]   data_size: ALL
2025-01-19 16:41:51,882 [INFO]   device: cuda
2025-01-19 16:41:51,883 [INFO]   alpha: 0
2025-01-19 16:41:51,884 [INFO]   steer: sup-opp
2025-01-19 16:41:51,886 [INFO]   source: sup
2025-01-19 16:41:51,888 [INFO]   target: opp
2025-01-19 16:41:51,888 [INFO]   method: val_mul
2025-01-19 16:41:51,889 [INFO]   topk_mean: 100
2025-01-19 16:41:51,890 [INFO]   topk_cnt: 100
2025-01-19 16:41:51,892 [INFO]   batch_size: 32
2025-01-19 16:41:51,892 [INFO]   mean_type: dif_mean
2025-01-19 16:41:51,894 [INFO]   steer_type: last
2025-01-19 16:41:51,896 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-19 16:41:55,666 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:41:55,669 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:41:55,670 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:41:55,884 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-19 16:41:55,889 [INFO] Selected 486 support and 486 oppose samples
2025-01-19 16:41:58,885 [INFO] Loading model: gpt2-small
2025-01-19 16:42:59,974 [INFO] Loading SAE for layer 6
2025-01-19 16:46:58,848 [INFO] fromsuptoopp
2025-01-19 16:46:58,850 [INFO] support
2025-01-19 16:46:58,860 [INFO] Running model with cache to obtain hidden states
2025-01-19 16:46:58,864 [INFO] Batch 1: batch_size 32
2025-01-19 16:46:58,952 [INFO] Batch 1: Hidden states shape: torch.Size([32, 50, 768])
2025-01-19 16:46:58,954 [INFO] Computing non-zero element counts
2025-01-19 16:46:58,956 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:58,957 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:58,959 [INFO] Batch 2: batch_size 32
2025-01-19 16:46:59,018 [INFO] Batch 2: Hidden states shape: torch.Size([32, 48, 768])
2025-01-19 16:46:59,020 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,021 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,023 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,026 [INFO] Batch 3: batch_size 32
2025-01-19 16:46:59,084 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-19 16:46:59,087 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,088 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,090 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,092 [INFO] Batch 4: batch_size 32
2025-01-19 16:46:59,142 [INFO] Batch 4: Hidden states shape: torch.Size([32, 47, 768])
2025-01-19 16:46:59,145 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,146 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,148 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,150 [INFO] Batch 5: batch_size 32
2025-01-19 16:46:59,207 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-19 16:46:59,209 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,211 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,212 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,214 [INFO] Batch 6: batch_size 32
2025-01-19 16:46:59,263 [INFO] Batch 6: Hidden states shape: torch.Size([32, 46, 768])
2025-01-19 16:46:59,265 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,267 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,268 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,270 [INFO] Batch 7: batch_size 32
2025-01-19 16:46:59,317 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-19 16:46:59,319 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,321 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,322 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,325 [INFO] Batch 8: batch_size 32
2025-01-19 16:46:59,370 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-19 16:46:59,372 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,373 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,375 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,378 [INFO] Batch 9: batch_size 32
2025-01-19 16:46:59,422 [INFO] Batch 9: Hidden states shape: torch.Size([32, 40, 768])
2025-01-19 16:46:59,424 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,426 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,427 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,429 [INFO] Batch 10: batch_size 32
2025-01-19 16:46:59,472 [INFO] Batch 10: Hidden states shape: torch.Size([32, 47, 768])
2025-01-19 16:46:59,474 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,476 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,477 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,480 [INFO] Batch 11: batch_size 32
2025-01-19 16:46:59,523 [INFO] Batch 11: Hidden states shape: torch.Size([32, 45, 768])
2025-01-19 16:46:59,525 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,526 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,528 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,530 [INFO] Batch 12: batch_size 32
2025-01-19 16:46:59,572 [INFO] Batch 12: Hidden states shape: torch.Size([32, 48, 768])
2025-01-19 16:46:59,574 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,575 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,576 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,577 [INFO] Batch 13: batch_size 32
2025-01-19 16:46:59,618 [INFO] Batch 13: Hidden states shape: torch.Size([32, 47, 768])
2025-01-19 16:46:59,620 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,621 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,622 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,626 [INFO] Batch 14: batch_size 32
2025-01-19 16:46:59,667 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-19 16:46:59,669 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,671 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,672 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,673 [INFO] Batch 15: batch_size 32
2025-01-19 16:46:59,716 [INFO] Batch 15: Hidden states shape: torch.Size([32, 48, 768])
2025-01-19 16:46:59,718 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,720 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,721 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,723 [INFO] Batch 16: batch_size 32
2025-01-19 16:46:59,762 [INFO] Batch 16: Hidden states shape: torch.Size([6, 31, 768])
2025-01-19 16:46:59,764 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,766 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,767 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,772 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-19 16:46:59,774 [INFO] oppose
2025-01-19 16:46:59,778 [INFO] Running model with cache to obtain hidden states
2025-01-19 16:46:59,782 [INFO] Batch 1: batch_size 32
2025-01-19 16:46:59,826 [INFO] Batch 1: Hidden states shape: torch.Size([32, 46, 768])
2025-01-19 16:46:59,828 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,830 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,831 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,833 [INFO] Batch 2: batch_size 32
2025-01-19 16:46:59,875 [INFO] Batch 2: Hidden states shape: torch.Size([32, 41, 768])
2025-01-19 16:46:59,877 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,879 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,880 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,883 [INFO] Batch 3: batch_size 32
2025-01-19 16:46:59,929 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-19 16:46:59,931 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,932 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,934 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,936 [INFO] Batch 4: batch_size 32
2025-01-19 16:46:59,980 [INFO] Batch 4: Hidden states shape: torch.Size([32, 44, 768])
2025-01-19 16:46:59,982 [INFO] Computing non-zero element counts
2025-01-19 16:46:59,984 [INFO] Computing sum of non-zero elements
2025-01-19 16:46:59,985 [INFO] Computing mean of non-zero elements
2025-01-19 16:46:59,988 [INFO] Batch 5: batch_size 32
2025-01-19 16:47:00,031 [INFO] Batch 5: Hidden states shape: torch.Size([32, 43, 768])
2025-01-19 16:47:00,033 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,035 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,036 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,038 [INFO] Batch 6: batch_size 32
2025-01-19 16:47:00,079 [INFO] Batch 6: Hidden states shape: torch.Size([32, 44, 768])
2025-01-19 16:47:00,080 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,081 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,081 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,083 [INFO] Batch 7: batch_size 32
2025-01-19 16:47:00,123 [INFO] Batch 7: Hidden states shape: torch.Size([32, 46, 768])
2025-01-19 16:47:00,125 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,126 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,126 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,128 [INFO] Batch 8: batch_size 32
2025-01-19 16:47:00,168 [INFO] Batch 8: Hidden states shape: torch.Size([32, 42, 768])
2025-01-19 16:47:00,171 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,172 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,174 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,176 [INFO] Batch 9: batch_size 32
2025-01-19 16:47:00,218 [INFO] Batch 9: Hidden states shape: torch.Size([32, 49, 768])
2025-01-19 16:47:00,219 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,221 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,222 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,225 [INFO] Batch 10: batch_size 32
2025-01-19 16:47:00,266 [INFO] Batch 10: Hidden states shape: torch.Size([32, 49, 768])
2025-01-19 16:47:00,268 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,269 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,271 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,274 [INFO] Batch 11: batch_size 32
2025-01-19 16:47:00,318 [INFO] Batch 11: Hidden states shape: torch.Size([32, 42, 768])
2025-01-19 16:47:00,319 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,321 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,323 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,325 [INFO] Batch 12: batch_size 32
2025-01-19 16:47:00,366 [INFO] Batch 12: Hidden states shape: torch.Size([32, 53, 768])
2025-01-19 16:47:00,368 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,370 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,371 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,373 [INFO] Batch 13: batch_size 32
2025-01-19 16:47:00,413 [INFO] Batch 13: Hidden states shape: torch.Size([32, 43, 768])
2025-01-19 16:47:00,416 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,417 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,418 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,421 [INFO] Batch 14: batch_size 32
2025-01-19 16:47:00,464 [INFO] Batch 14: Hidden states shape: torch.Size([32, 45, 768])
2025-01-19 16:47:00,466 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,468 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,469 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,471 [INFO] Batch 15: batch_size 32
2025-01-19 16:47:00,513 [INFO] Batch 15: Hidden states shape: torch.Size([32, 38, 768])
2025-01-19 16:47:00,515 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,516 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,517 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,519 [INFO] Batch 16: batch_size 32
2025-01-19 16:47:00,557 [INFO] Batch 16: Hidden states shape: torch.Size([6, 42, 768])
2025-01-19 16:47:00,559 [INFO] Computing non-zero element counts
2025-01-19 16:47:00,561 [INFO] Computing sum of non-zero elements
2025-01-19 16:47:00,562 [INFO] Computing mean of non-zero elements
2025-01-19 16:47:00,567 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-19 16:47:07,355 [INFO] 转向方向 dif_opp-sup_relu
2025-01-19 16:47:12,566 [INFO] Computing steering vectors using method: val_mul
2025-01-19 16:47:12,585 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-19 16:47:16,508 [INFO] Example prompt: We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped
2025-01-19 16:47:16,510 [INFO] Generating texts **without** steering... 
2025-01-19 16:47:17,498 [INFO] Generated Text: 1:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide an ultrasound before they performed an abortion.

The ACLU has been working with Planned Parenthood for years on this issue, and we're pleased to be able to share our work with you today.
2025-01-19 16:47:17,499 [INFO] Generated Text: 2:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide an ultrasound before they performed an abortion.

The group also has been involved in other cases where it has intervened on behalf of women who have had their pregnancies terminated because of fetal abnormalities or other
2025-01-19 16:47:17,500 [INFO] Generated Text: 3:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide ultrasounds for women who had been raped or killed by their partners.

The group also has an active website, www.abortionrightsnow.org, where it posts videos of its members
2025-01-19 16:47:17,502 [INFO] 干预之后的结果
2025-01-19 16:47:17,502 [INFO] 干预方向sup->opp,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-19 16:47:17,503 [INFO] ** Generating texts with steering... Target **
2025-01-19 16:47:17,504 [INFO] form sup to target
2025-01-19 16:47:18,428 [INFO] Generated Text: 1:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide ultrasounds for women who had been raped or killed by their partners.

The group also has an anti-abortion website called "Abortion Rights," which is run by a woman named Michelle
2025-01-19 16:47:18,430 [INFO] Generated Text: 2:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide an ultrasound before they performed an abortion.

The American Civil Liberties Union of Texas has filed a lawsuit against the state's law, arguing that it violates the First Amendment and violates women's right
2025-01-19 16:47:18,431 [INFO] Generated Text: 3:
We should ban partial birth abortions. In 2007, the organization was involved in a Supreme Court case in which it helped to overturn a state law that required abortion providers to provide an ultrasound before they performed an abortion.

The group also has been involved in other cases where the government has taken action against Planned Parenthood clinics, including one where it sued for $1 million
