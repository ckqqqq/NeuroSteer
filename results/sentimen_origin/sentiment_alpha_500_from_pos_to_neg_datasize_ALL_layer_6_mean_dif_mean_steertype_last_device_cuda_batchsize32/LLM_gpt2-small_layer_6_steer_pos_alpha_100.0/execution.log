2025-01-09 11:58:31,221 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 11:58:31,221 [INFO] Hyperparameters:
2025-01-09 11:58:31,221 [INFO]   layer: 6
2025-01-09 11:58:31,221 [INFO]   LLM: gpt2-small
2025-01-09 11:58:31,222 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 11:58:31,222 [INFO]   output_dir: ./results
2025-01-09 11:58:31,222 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 11:58:31,222 [INFO]   seed: 42
2025-01-09 11:58:31,222 [INFO]   data_size: 1000
2025-01-09 11:58:31,222 [INFO]   device: cuda
2025-01-09 11:58:31,222 [INFO]   alpha: 100.0
2025-01-09 11:58:31,222 [INFO]   steer: pos
2025-01-09 11:58:31,222 [INFO]   method: val_mul
2025-01-09 11:58:31,222 [INFO]   topk_mean: 100
2025-01-09 11:58:31,222 [INFO]   topk_cnt: 100
2025-01-09 11:58:31,222 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 11:58:31,222 [INFO] Loading model: gpt2-small
2025-01-09 11:59:17,507 [INFO] Loading SAE for layer 6
2025-01-09 11:59:59,429 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 11:59:59,540 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:00:00,811 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:00:00,815 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:02:09,063 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:02:09,063 [INFO] Hyperparameters:
2025-01-09 12:02:09,063 [INFO]   layer: 6
2025-01-09 12:02:09,063 [INFO]   LLM: gpt2-small
2025-01-09 12:02:09,063 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:02:09,063 [INFO]   output_dir: ./results
2025-01-09 12:02:09,063 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:02:09,063 [INFO]   seed: 42
2025-01-09 12:02:09,063 [INFO]   data_size: 1000
2025-01-09 12:02:09,063 [INFO]   device: cpu
2025-01-09 12:02:09,063 [INFO]   alpha: 100.0
2025-01-09 12:02:09,063 [INFO]   steer: pos
2025-01-09 12:02:09,064 [INFO]   method: val_mul
2025-01-09 12:02:09,064 [INFO]   topk_mean: 100
2025-01-09 12:02:09,064 [INFO]   topk_cnt: 100
2025-01-09 12:02:09,064 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:02:09,064 [INFO] Loading model: gpt2-small
2025-01-09 12:02:49,888 [INFO] Loading SAE for layer 6
2025-01-09 12:03:21,428 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:03:21,486 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:03:21,494 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:03:21,499 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:04:21,031 [INFO] Hidden states shape: torch.Size([1000, 177, 768])
2025-01-09 12:04:21,032 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:04:27,850 [INFO] Batch latents shape: torch.Size([1000, 177, 24576])
2025-01-09 12:04:41,761 [INFO] Computing non-zero element counts
2025-01-09 12:04:45,525 [INFO] Computing sum of non-zero elements
2025-01-09 12:04:47,506 [INFO] Computing mean of non-zero elements
2025-01-09 12:04:47,507 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 12:04:47,555 [INFO] Top 100 nz_mean values selected.
2025-01-09 12:04:47,555 [INFO] Selecting top-k indices based on act_cnt
2025-01-09 12:04:47,555 [INFO] Top 100 act_cnt values selected.
2025-01-09 12:04:47,555 [INFO] Finding overlapping indices between nz_mean and act_cnt top-k
2025-01-09 12:04:47,599 [INFO] Number of overlapping indices: 1
2025-01-09 12:04:47,599 [INFO] Computing steering vectors using method: val_mul
2025-01-09 12:04:47,633 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:04:47,633 [INFO] Computing steering vectors using method: mean
2025-01-09 12:04:47,633 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:04:47,634 [INFO] Computing steering vectors using method: val_mul
2025-01-09 12:04:47,635 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:04:47,637 [INFO] Euclidean distance between mean and val_mul steering vectors: 44.48453140258789
2025-01-09 12:04:47,637 [INFO] Cosine similarity between mean and val_mul steering vectors: 1.0
2025-01-09 12:04:47,865 [INFO] Example prompt: Amazing!!!!
2025-01-09 12:04:47,866 [INFO] Generating texts without steering...
2025-01-09 12:08:00,845 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:08:00,846 [INFO] Hyperparameters:
2025-01-09 12:08:00,846 [INFO]   layer: 6
2025-01-09 12:08:00,846 [INFO]   LLM: gpt2-small
2025-01-09 12:08:00,846 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:08:00,846 [INFO]   output_dir: ./results
2025-01-09 12:08:00,846 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:08:00,846 [INFO]   seed: 42
2025-01-09 12:08:00,846 [INFO]   data_size: 1000
2025-01-09 12:08:00,846 [INFO]   device: cuda
2025-01-09 12:08:00,847 [INFO]   alpha: 100.0
2025-01-09 12:08:00,847 [INFO]   steer: pos
2025-01-09 12:08:00,847 [INFO]   method: val_mul
2025-01-09 12:08:00,847 [INFO]   topk_mean: 100
2025-01-09 12:08:00,847 [INFO]   topk_cnt: 100
2025-01-09 12:08:00,847 [INFO]   batch_size: 50
2025-01-09 12:08:00,857 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:08:00,857 [INFO] Loading model: gpt2-small
2025-01-09 12:08:49,336 [INFO] Loading SAE for layer 6
2025-01-09 12:09:21,119 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:09:21,315 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:09:21,374 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:09:21,389 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:09:21,389 [INFO] Processing batch 1/20, Batch size: 50
2025-01-09 12:09:22,638 [INFO] Hidden states shape for batch 1: torch.Size([50, 99, 768])
2025-01-09 12:09:22,639 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:22,724 [INFO] Processing batch 2/20, Batch size: 50
2025-01-09 12:09:22,775 [INFO] Hidden states shape for batch 2: torch.Size([50, 84, 768])
2025-01-09 12:09:22,775 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:22,843 [INFO] Processing batch 3/20, Batch size: 50
2025-01-09 12:09:22,894 [INFO] Hidden states shape for batch 3: torch.Size([50, 116, 768])
2025-01-09 12:09:22,894 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:22,992 [INFO] Processing batch 4/20, Batch size: 50
2025-01-09 12:09:23,045 [INFO] Hidden states shape for batch 4: torch.Size([50, 109, 768])
2025-01-09 12:09:23,045 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,132 [INFO] Processing batch 5/20, Batch size: 50
2025-01-09 12:09:23,183 [INFO] Hidden states shape for batch 5: torch.Size([50, 121, 768])
2025-01-09 12:09:23,184 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,289 [INFO] Processing batch 6/20, Batch size: 50
2025-01-09 12:09:23,343 [INFO] Hidden states shape for batch 6: torch.Size([50, 116, 768])
2025-01-09 12:09:23,343 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,434 [INFO] Processing batch 7/20, Batch size: 50
2025-01-09 12:09:23,483 [INFO] Hidden states shape for batch 7: torch.Size([50, 104, 768])
2025-01-09 12:09:23,483 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,558 [INFO] Processing batch 8/20, Batch size: 50
2025-01-09 12:09:23,605 [INFO] Hidden states shape for batch 8: torch.Size([50, 113, 768])
2025-01-09 12:09:23,605 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,692 [INFO] Processing batch 9/20, Batch size: 50
2025-01-09 12:09:23,765 [INFO] Hidden states shape for batch 9: torch.Size([50, 108, 768])
2025-01-09 12:09:23,765 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,841 [INFO] Processing batch 10/20, Batch size: 50
2025-01-09 12:09:23,887 [INFO] Hidden states shape for batch 10: torch.Size([50, 108, 768])
2025-01-09 12:09:23,887 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:23,965 [INFO] Processing batch 11/20, Batch size: 50
2025-01-09 12:09:24,012 [INFO] Hidden states shape for batch 11: torch.Size([50, 115, 768])
2025-01-09 12:09:24,013 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,098 [INFO] Processing batch 12/20, Batch size: 50
2025-01-09 12:09:24,146 [INFO] Hidden states shape for batch 12: torch.Size([50, 107, 768])
2025-01-09 12:09:24,146 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,221 [INFO] Processing batch 13/20, Batch size: 50
2025-01-09 12:09:24,267 [INFO] Hidden states shape for batch 13: torch.Size([50, 113, 768])
2025-01-09 12:09:24,268 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,349 [INFO] Processing batch 14/20, Batch size: 50
2025-01-09 12:09:24,399 [INFO] Hidden states shape for batch 14: torch.Size([50, 118, 768])
2025-01-09 12:09:24,399 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,496 [INFO] Processing batch 15/20, Batch size: 50
2025-01-09 12:09:24,544 [INFO] Hidden states shape for batch 15: torch.Size([50, 110, 768])
2025-01-09 12:09:24,545 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,625 [INFO] Processing batch 16/20, Batch size: 50
2025-01-09 12:09:24,678 [INFO] Hidden states shape for batch 16: torch.Size([50, 177, 768])
2025-01-09 12:09:24,678 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,833 [INFO] Processing batch 17/20, Batch size: 50
2025-01-09 12:09:24,905 [INFO] Hidden states shape for batch 17: torch.Size([50, 106, 768])
2025-01-09 12:09:24,905 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:24,966 [INFO] Processing batch 18/20, Batch size: 50
2025-01-09 12:09:25,015 [INFO] Hidden states shape for batch 18: torch.Size([50, 115, 768])
2025-01-09 12:09:25,015 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:25,105 [INFO] Processing batch 19/20, Batch size: 50
2025-01-09 12:09:25,153 [INFO] Hidden states shape for batch 19: torch.Size([50, 105, 768])
2025-01-09 12:09:25,153 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:09:25,227 [INFO] Processing batch 20/20, Batch size: 50
2025-01-09 12:09:25,274 [INFO] Hidden states shape for batch 20: torch.Size([50, 112, 768])
2025-01-09 12:09:25,274 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:12:29,229 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:12:29,229 [INFO] Hyperparameters:
2025-01-09 12:12:29,229 [INFO]   layer: 6
2025-01-09 12:12:29,229 [INFO]   LLM: gpt2-small
2025-01-09 12:12:29,230 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:12:29,230 [INFO]   output_dir: ./results
2025-01-09 12:12:29,230 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:12:29,230 [INFO]   seed: 42
2025-01-09 12:12:29,230 [INFO]   data_size: 1000
2025-01-09 12:12:29,230 [INFO]   device: cuda
2025-01-09 12:12:29,230 [INFO]   alpha: 100.0
2025-01-09 12:12:29,230 [INFO]   steer: pos
2025-01-09 12:12:29,230 [INFO]   method: val_mul
2025-01-09 12:12:29,230 [INFO]   topk_mean: 100
2025-01-09 12:12:29,230 [INFO]   topk_cnt: 100
2025-01-09 12:12:29,230 [INFO]   batch_size: 50
2025-01-09 12:12:29,230 [INFO]   aggregation: mean
2025-01-09 12:12:29,230 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:12:29,230 [INFO] Loading model: gpt2-small
2025-01-09 12:13:10,207 [INFO] Loading SAE for layer 6
2025-01-09 12:13:41,289 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:13:41,350 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:13:41,359 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:13:41,365 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:13:41,365 [INFO] Processing batch 1/20, Batch size: 50
2025-01-09 12:13:41,543 [INFO] Hidden states shape for batch 1: torch.Size([50, 99, 768])
2025-01-09 12:13:41,543 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:41,643 [INFO] Processing batch 2/20, Batch size: 50
2025-01-09 12:13:41,695 [INFO] Hidden states shape for batch 2: torch.Size([50, 84, 768])
2025-01-09 12:13:41,695 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:41,773 [INFO] Processing batch 3/20, Batch size: 50
2025-01-09 12:13:41,822 [INFO] Hidden states shape for batch 3: torch.Size([50, 116, 768])
2025-01-09 12:13:41,822 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:41,942 [INFO] Processing batch 4/20, Batch size: 50
2025-01-09 12:13:41,994 [INFO] Hidden states shape for batch 4: torch.Size([50, 109, 768])
2025-01-09 12:13:41,994 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,106 [INFO] Processing batch 5/20, Batch size: 50
2025-01-09 12:13:42,164 [INFO] Hidden states shape for batch 5: torch.Size([50, 121, 768])
2025-01-09 12:13:42,164 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,296 [INFO] Processing batch 6/20, Batch size: 50
2025-01-09 12:13:42,347 [INFO] Hidden states shape for batch 6: torch.Size([50, 116, 768])
2025-01-09 12:13:42,347 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,468 [INFO] Processing batch 7/20, Batch size: 50
2025-01-09 12:13:42,517 [INFO] Hidden states shape for batch 7: torch.Size([50, 104, 768])
2025-01-09 12:13:42,518 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,622 [INFO] Processing batch 8/20, Batch size: 50
2025-01-09 12:13:42,672 [INFO] Hidden states shape for batch 8: torch.Size([50, 113, 768])
2025-01-09 12:13:42,672 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,792 [INFO] Processing batch 9/20, Batch size: 50
2025-01-09 12:13:42,841 [INFO] Hidden states shape for batch 9: torch.Size([50, 108, 768])
2025-01-09 12:13:42,841 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:42,959 [INFO] Processing batch 10/20, Batch size: 50
2025-01-09 12:13:43,007 [INFO] Hidden states shape for batch 10: torch.Size([50, 108, 768])
2025-01-09 12:13:43,007 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,122 [INFO] Processing batch 11/20, Batch size: 50
2025-01-09 12:13:43,172 [INFO] Hidden states shape for batch 11: torch.Size([50, 115, 768])
2025-01-09 12:13:43,172 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,302 [INFO] Processing batch 12/20, Batch size: 50
2025-01-09 12:13:43,348 [INFO] Hidden states shape for batch 12: torch.Size([50, 107, 768])
2025-01-09 12:13:43,348 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,459 [INFO] Processing batch 13/20, Batch size: 50
2025-01-09 12:13:43,503 [INFO] Hidden states shape for batch 13: torch.Size([50, 113, 768])
2025-01-09 12:13:43,503 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,628 [INFO] Processing batch 14/20, Batch size: 50
2025-01-09 12:13:43,678 [INFO] Hidden states shape for batch 14: torch.Size([50, 118, 768])
2025-01-09 12:13:43,678 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,805 [INFO] Processing batch 15/20, Batch size: 50
2025-01-09 12:13:43,857 [INFO] Hidden states shape for batch 15: torch.Size([50, 110, 768])
2025-01-09 12:13:43,857 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:43,970 [INFO] Processing batch 16/20, Batch size: 50
2025-01-09 12:13:44,021 [INFO] Hidden states shape for batch 16: torch.Size([50, 177, 768])
2025-01-09 12:13:44,021 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:44,202 [INFO] Processing batch 17/20, Batch size: 50
2025-01-09 12:13:44,296 [INFO] Hidden states shape for batch 17: torch.Size([50, 106, 768])
2025-01-09 12:13:44,296 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:44,402 [INFO] Processing batch 18/20, Batch size: 50
2025-01-09 12:13:44,452 [INFO] Hidden states shape for batch 18: torch.Size([50, 115, 768])
2025-01-09 12:13:44,452 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:44,572 [INFO] Processing batch 19/20, Batch size: 50
2025-01-09 12:13:44,623 [INFO] Hidden states shape for batch 19: torch.Size([50, 105, 768])
2025-01-09 12:13:44,623 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:44,727 [INFO] Processing batch 20/20, Batch size: 50
2025-01-09 12:13:44,778 [INFO] Hidden states shape for batch 20: torch.Size([50, 112, 768])
2025-01-09 12:13:44,778 [INFO] Encoding hidden states to latents using SAE
2025-01-09 12:13:44,942 [INFO] Batch latents shape: torch.Size([1000, 24576])
2025-01-09 12:13:44,942 [INFO] Computing non-zero element counts
2025-01-09 12:13:44,984 [INFO] Computing sum of non-zero elements
2025-01-09 12:13:44,985 [INFO] Computing mean of non-zero elements
2025-01-09 12:13:44,985 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 12:44:30,640 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:44:30,640 [INFO] Hyperparameters:
2025-01-09 12:44:30,640 [INFO]   layer: 6
2025-01-09 12:44:30,640 [INFO]   LLM: gpt2-small
2025-01-09 12:44:30,640 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:44:30,640 [INFO]   output_dir: ./results
2025-01-09 12:44:30,640 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:44:30,640 [INFO]   seed: 42
2025-01-09 12:44:30,640 [INFO]   data_size: 1000
2025-01-09 12:44:30,640 [INFO]   device: cuda
2025-01-09 12:44:30,640 [INFO]   alpha: 100.0
2025-01-09 12:44:30,640 [INFO]   steer: pos
2025-01-09 12:44:30,640 [INFO]   method: val_mul
2025-01-09 12:44:30,640 [INFO]   topk_mean: 100
2025-01-09 12:44:30,640 [INFO]   topk_cnt: 100
2025-01-09 12:44:30,640 [INFO]   batch_size: 50
2025-01-09 12:44:30,640 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:44:30,640 [INFO] Loading model: gpt2-small
2025-01-09 12:45:26,740 [INFO] Loading SAE for layer 6
2025-01-09 12:45:58,026 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:45:58,095 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:45:58,106 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:45:58,111 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:45:58,322 [INFO] Batch 1: Hidden states shape: torch.Size([50, 99, 768])
2025-01-09 12:45:58,322 [INFO] Encoding hidden states for batch 1
2025-01-09 12:45:58,408 [INFO] Batch 2: Hidden states shape: torch.Size([50, 84, 768])
2025-01-09 12:45:58,408 [INFO] Encoding hidden states for batch 2
2025-01-09 12:45:58,571 [INFO] Batch 3: Hidden states shape: torch.Size([50, 116, 768])
2025-01-09 12:45:58,571 [INFO] Encoding hidden states for batch 3
2025-01-09 12:47:13,016 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:47:13,016 [INFO] Hyperparameters:
2025-01-09 12:47:13,016 [INFO]   layer: 6
2025-01-09 12:47:13,016 [INFO]   LLM: gpt2-small
2025-01-09 12:47:13,016 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:47:13,016 [INFO]   output_dir: ./results
2025-01-09 12:47:13,016 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:47:13,016 [INFO]   seed: 42
2025-01-09 12:47:13,016 [INFO]   data_size: 1000
2025-01-09 12:47:13,016 [INFO]   device: cuda
2025-01-09 12:47:13,016 [INFO]   alpha: 100.0
2025-01-09 12:47:13,016 [INFO]   steer: pos
2025-01-09 12:47:13,016 [INFO]   method: val_mul
2025-01-09 12:47:13,017 [INFO]   topk_mean: 100
2025-01-09 12:47:13,017 [INFO]   topk_cnt: 100
2025-01-09 12:47:13,017 [INFO]   batch_size: 30
2025-01-09 12:47:13,017 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:47:13,017 [INFO] Loading model: gpt2-small
2025-01-09 12:47:53,983 [INFO] Loading SAE for layer 6
2025-01-09 12:48:25,106 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:48:25,163 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:48:25,172 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:48:25,176 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:48:25,373 [INFO] Batch 1: Hidden states shape: torch.Size([30, 99, 768])
2025-01-09 12:48:25,374 [INFO] Encoding hidden states for batch 1
2025-01-09 12:48:25,441 [INFO] Batch 2: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:48:25,442 [INFO] Encoding hidden states for batch 2
2025-01-09 12:48:25,479 [INFO] Batch 3: Hidden states shape: torch.Size([30, 84, 768])
2025-01-09 12:48:25,479 [INFO] Encoding hidden states for batch 3
2025-01-09 12:48:25,523 [INFO] Batch 4: Hidden states shape: torch.Size([30, 116, 768])
2025-01-09 12:48:25,523 [INFO] Encoding hidden states for batch 4
2025-01-09 12:48:25,559 [INFO] Batch 5: Hidden states shape: torch.Size([30, 40, 768])
2025-01-09 12:48:25,560 [INFO] Encoding hidden states for batch 5
2025-01-09 12:48:25,596 [INFO] Batch 6: Hidden states shape: torch.Size([30, 109, 768])
2025-01-09 12:48:25,596 [INFO] Encoding hidden states for batch 6
2025-01-09 12:48:25,636 [INFO] Batch 7: Hidden states shape: torch.Size([30, 82, 768])
2025-01-09 12:48:25,636 [INFO] Encoding hidden states for batch 7
2025-01-09 12:48:25,673 [INFO] Batch 8: Hidden states shape: torch.Size([30, 119, 768])
2025-01-09 12:48:25,673 [INFO] Encoding hidden states for batch 8
2025-01-09 12:48:25,724 [INFO] Batch 9: Hidden states shape: torch.Size([30, 121, 768])
2025-01-09 12:48:25,724 [INFO] Encoding hidden states for batch 9
2025-01-09 12:48:25,761 [INFO] Batch 10: Hidden states shape: torch.Size([30, 35, 768])
2025-01-09 12:48:25,761 [INFO] Encoding hidden states for batch 10
2025-01-09 12:48:25,798 [INFO] Batch 11: Hidden states shape: torch.Size([30, 104, 768])
2025-01-09 12:48:25,798 [INFO] Encoding hidden states for batch 11
2025-01-09 12:48:25,839 [INFO] Batch 12: Hidden states shape: torch.Size([30, 113, 768])
2025-01-09 12:48:25,839 [INFO] Encoding hidden states for batch 12
2025-01-09 12:48:25,883 [INFO] Batch 13: Hidden states shape: torch.Size([30, 44, 768])
2025-01-09 12:48:25,883 [INFO] Encoding hidden states for batch 13
2025-01-09 12:48:25,927 [INFO] Batch 14: Hidden states shape: torch.Size([30, 108, 768])
2025-01-09 12:48:25,927 [INFO] Encoding hidden states for batch 14
2025-01-09 12:48:25,965 [INFO] Batch 15: Hidden states shape: torch.Size([30, 79, 768])
2025-01-09 12:48:25,965 [INFO] Encoding hidden states for batch 15
2025-01-09 12:48:26,003 [INFO] Batch 16: Hidden states shape: torch.Size([30, 108, 768])
2025-01-09 12:48:26,003 [INFO] Encoding hidden states for batch 16
2025-01-09 12:48:26,045 [INFO] Batch 17: Hidden states shape: torch.Size([30, 115, 768])
2025-01-09 12:48:26,045 [INFO] Encoding hidden states for batch 17
2025-01-09 12:48:26,084 [INFO] Batch 18: Hidden states shape: torch.Size([30, 106, 768])
2025-01-09 12:48:26,084 [INFO] Encoding hidden states for batch 18
2025-01-09 12:48:26,122 [INFO] Batch 19: Hidden states shape: torch.Size([30, 68, 768])
2025-01-09 12:48:26,123 [INFO] Encoding hidden states for batch 19
2025-01-09 12:48:26,159 [INFO] Batch 20: Hidden states shape: torch.Size([30, 107, 768])
2025-01-09 12:48:26,159 [INFO] Encoding hidden states for batch 20
2025-01-09 12:48:26,198 [INFO] Batch 21: Hidden states shape: torch.Size([30, 113, 768])
2025-01-09 12:48:26,199 [INFO] Encoding hidden states for batch 21
2025-01-09 12:48:26,238 [INFO] Batch 22: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:48:26,239 [INFO] Encoding hidden states for batch 22
2025-01-09 12:48:26,274 [INFO] Batch 23: Hidden states shape: torch.Size([30, 118, 768])
2025-01-09 12:48:26,275 [INFO] Encoding hidden states for batch 23
2025-01-09 12:48:26,315 [INFO] Batch 24: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:48:26,316 [INFO] Encoding hidden states for batch 24
2025-01-09 12:48:26,351 [INFO] Batch 25: Hidden states shape: torch.Size([30, 110, 768])
2025-01-09 12:48:26,351 [INFO] Encoding hidden states for batch 25
2025-01-09 12:49:42,471 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:49:42,471 [INFO] Hyperparameters:
2025-01-09 12:49:42,471 [INFO]   layer: 6
2025-01-09 12:49:42,471 [INFO]   LLM: gpt2-small
2025-01-09 12:49:42,471 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:49:42,471 [INFO]   output_dir: ./results
2025-01-09 12:49:42,471 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:49:42,471 [INFO]   seed: 42
2025-01-09 12:49:42,471 [INFO]   data_size: 1000
2025-01-09 12:49:42,471 [INFO]   device: auto
2025-01-09 12:49:42,471 [INFO]   alpha: 100.0
2025-01-09 12:49:42,471 [INFO]   steer: pos
2025-01-09 12:49:42,471 [INFO]   method: val_mul
2025-01-09 12:49:42,471 [INFO]   topk_mean: 100
2025-01-09 12:49:42,471 [INFO]   topk_cnt: 100
2025-01-09 12:49:42,471 [INFO]   batch_size: 30
2025-01-09 12:49:42,472 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:49:42,472 [INFO] Loading model: gpt2-small
2025-01-09 12:50:46,763 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:50:46,763 [INFO] Hyperparameters:
2025-01-09 12:50:46,763 [INFO]   layer: 6
2025-01-09 12:50:46,763 [INFO]   LLM: gpt2-small
2025-01-09 12:50:46,763 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:50:46,763 [INFO]   output_dir: ./results
2025-01-09 12:50:46,763 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:50:46,763 [INFO]   seed: 42
2025-01-09 12:50:46,763 [INFO]   data_size: 1000
2025-01-09 12:50:46,763 [INFO]   device: cuda
2025-01-09 12:50:46,763 [INFO]   alpha: 100.0
2025-01-09 12:50:46,763 [INFO]   steer: pos
2025-01-09 12:50:46,763 [INFO]   method: val_mul
2025-01-09 12:50:46,763 [INFO]   topk_mean: 100
2025-01-09 12:50:46,763 [INFO]   topk_cnt: 100
2025-01-09 12:50:46,763 [INFO]   batch_size: 30
2025-01-09 12:50:46,764 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:50:46,764 [INFO] Loading model: gpt2-small
2025-01-09 12:51:27,736 [INFO] Loading SAE for layer 6
2025-01-09 12:51:58,822 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:51:58,876 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:51:58,885 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:51:58,889 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:51:59,081 [INFO] Batch 1: Hidden states shape: torch.Size([30, 99, 768])
2025-01-09 12:51:59,081 [INFO] Encoding hidden states for batch 1
2025-01-09 12:51:59,149 [INFO] Batch 2: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:51:59,149 [INFO] Encoding hidden states for batch 2
2025-01-09 12:51:59,186 [INFO] Batch 3: Hidden states shape: torch.Size([30, 84, 768])
2025-01-09 12:51:59,186 [INFO] Encoding hidden states for batch 3
2025-01-09 12:51:59,228 [INFO] Batch 4: Hidden states shape: torch.Size([30, 116, 768])
2025-01-09 12:51:59,231 [INFO] Encoding hidden states for batch 4
2025-01-09 12:51:59,268 [INFO] Batch 5: Hidden states shape: torch.Size([30, 40, 768])
2025-01-09 12:51:59,268 [INFO] Encoding hidden states for batch 5
2025-01-09 12:51:59,304 [INFO] Batch 6: Hidden states shape: torch.Size([30, 109, 768])
2025-01-09 12:51:59,305 [INFO] Encoding hidden states for batch 6
2025-01-09 12:51:59,345 [INFO] Batch 7: Hidden states shape: torch.Size([30, 82, 768])
2025-01-09 12:51:59,345 [INFO] Encoding hidden states for batch 7
2025-01-09 12:51:59,381 [INFO] Batch 8: Hidden states shape: torch.Size([30, 119, 768])
2025-01-09 12:51:59,382 [INFO] Encoding hidden states for batch 8
2025-01-09 12:51:59,428 [INFO] Batch 9: Hidden states shape: torch.Size([30, 121, 768])
2025-01-09 12:51:59,428 [INFO] Encoding hidden states for batch 9
2025-01-09 12:51:59,468 [INFO] Batch 10: Hidden states shape: torch.Size([30, 35, 768])
2025-01-09 12:51:59,469 [INFO] Encoding hidden states for batch 10
2025-01-09 12:51:59,506 [INFO] Batch 11: Hidden states shape: torch.Size([30, 104, 768])
2025-01-09 12:51:59,506 [INFO] Encoding hidden states for batch 11
2025-01-09 12:51:59,544 [INFO] Batch 12: Hidden states shape: torch.Size([30, 113, 768])
2025-01-09 12:51:59,544 [INFO] Encoding hidden states for batch 12
2025-01-09 12:51:59,584 [INFO] Batch 13: Hidden states shape: torch.Size([30, 44, 768])
2025-01-09 12:51:59,584 [INFO] Encoding hidden states for batch 13
2025-01-09 12:51:59,624 [INFO] Batch 14: Hidden states shape: torch.Size([30, 108, 768])
2025-01-09 12:51:59,624 [INFO] Encoding hidden states for batch 14
2025-01-09 12:51:59,665 [INFO] Batch 15: Hidden states shape: torch.Size([30, 79, 768])
2025-01-09 12:51:59,665 [INFO] Encoding hidden states for batch 15
2025-01-09 12:51:59,705 [INFO] Batch 16: Hidden states shape: torch.Size([30, 108, 768])
2025-01-09 12:51:59,705 [INFO] Encoding hidden states for batch 16
2025-01-09 12:51:59,748 [INFO] Batch 17: Hidden states shape: torch.Size([30, 115, 768])
2025-01-09 12:51:59,748 [INFO] Encoding hidden states for batch 17
2025-01-09 12:51:59,787 [INFO] Batch 18: Hidden states shape: torch.Size([30, 106, 768])
2025-01-09 12:51:59,787 [INFO] Encoding hidden states for batch 18
2025-01-09 12:51:59,825 [INFO] Batch 19: Hidden states shape: torch.Size([30, 68, 768])
2025-01-09 12:51:59,825 [INFO] Encoding hidden states for batch 19
2025-01-09 12:51:59,864 [INFO] Batch 20: Hidden states shape: torch.Size([30, 107, 768])
2025-01-09 12:51:59,864 [INFO] Encoding hidden states for batch 20
2025-01-09 12:51:59,902 [INFO] Batch 21: Hidden states shape: torch.Size([30, 113, 768])
2025-01-09 12:51:59,902 [INFO] Encoding hidden states for batch 21
2025-01-09 12:51:59,942 [INFO] Batch 22: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:51:59,942 [INFO] Encoding hidden states for batch 22
2025-01-09 12:51:59,978 [INFO] Batch 23: Hidden states shape: torch.Size([30, 118, 768])
2025-01-09 12:51:59,978 [INFO] Encoding hidden states for batch 23
2025-01-09 12:52:00,020 [INFO] Batch 24: Hidden states shape: torch.Size([30, 94, 768])
2025-01-09 12:52:00,020 [INFO] Encoding hidden states for batch 24
2025-01-09 12:52:00,056 [INFO] Batch 25: Hidden states shape: torch.Size([30, 110, 768])
2025-01-09 12:52:00,057 [INFO] Encoding hidden states for batch 25
2025-01-09 12:52:20,778 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:52:20,778 [INFO] Hyperparameters:
2025-01-09 12:52:20,778 [INFO]   layer: 6
2025-01-09 12:52:20,778 [INFO]   LLM: gpt2-small
2025-01-09 12:52:20,778 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:52:20,778 [INFO]   output_dir: ./results
2025-01-09 12:52:20,778 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:52:20,778 [INFO]   seed: 42
2025-01-09 12:52:20,778 [INFO]   data_size: 1000
2025-01-09 12:52:20,778 [INFO]   device: cuda
2025-01-09 12:52:20,778 [INFO]   alpha: 100.0
2025-01-09 12:52:20,778 [INFO]   steer: pos
2025-01-09 12:52:20,778 [INFO]   method: val_mul
2025-01-09 12:52:20,778 [INFO]   topk_mean: 100
2025-01-09 12:52:20,778 [INFO]   topk_cnt: 100
2025-01-09 12:52:20,778 [INFO]   batch_size: 10
2025-01-09 12:52:20,779 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:52:20,779 [INFO] Loading model: gpt2-small
2025-01-09 12:53:01,713 [INFO] Loading SAE for layer 6
2025-01-09 12:53:32,842 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:53:32,896 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:53:32,904 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:53:32,909 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:53:33,070 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 12:53:33,070 [INFO] Encoding hidden states for batch 1
2025-01-09 12:53:33,109 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:53:33,109 [INFO] Encoding hidden states for batch 2
2025-01-09 12:53:33,148 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 12:53:33,149 [INFO] Encoding hidden states for batch 3
2025-01-09 12:53:33,184 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:53:33,184 [INFO] Encoding hidden states for batch 4
2025-01-09 12:53:33,213 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 12:53:33,213 [INFO] Encoding hidden states for batch 5
2025-01-09 12:53:33,246 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 12:53:33,246 [INFO] Encoding hidden states for batch 6
2025-01-09 12:53:33,277 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 12:53:33,277 [INFO] Encoding hidden states for batch 7
2025-01-09 12:53:33,310 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 12:53:33,311 [INFO] Encoding hidden states for batch 8
2025-01-09 12:53:33,345 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 12:53:33,345 [INFO] Encoding hidden states for batch 9
2025-01-09 12:53:33,378 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:53:33,378 [INFO] Encoding hidden states for batch 10
2025-01-09 12:53:33,413 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:53:33,413 [INFO] Encoding hidden states for batch 11
2025-01-09 12:53:33,447 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 12:53:33,447 [INFO] Encoding hidden states for batch 12
2025-01-09 12:53:33,483 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:53:33,483 [INFO] Encoding hidden states for batch 13
2025-01-09 12:53:33,517 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:53:33,517 [INFO] Encoding hidden states for batch 14
2025-01-09 12:53:33,550 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:53:33,551 [INFO] Encoding hidden states for batch 15
2025-01-09 12:53:33,585 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 12:53:33,585 [INFO] Encoding hidden states for batch 16
2025-01-09 12:53:33,620 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:53:33,620 [INFO] Encoding hidden states for batch 17
2025-01-09 12:53:33,653 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:53:33,654 [INFO] Encoding hidden states for batch 18
2025-01-09 12:53:33,688 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:53:33,688 [INFO] Encoding hidden states for batch 19
2025-01-09 12:53:33,722 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 12:53:33,723 [INFO] Encoding hidden states for batch 20
2025-01-09 12:53:33,757 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 12:53:33,757 [INFO] Encoding hidden states for batch 21
2025-01-09 12:53:33,792 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 12:53:33,792 [INFO] Encoding hidden states for batch 22
2025-01-09 12:53:33,825 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 12:53:33,825 [INFO] Encoding hidden states for batch 23
2025-01-09 12:53:33,855 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:53:33,855 [INFO] Encoding hidden states for batch 24
2025-01-09 12:53:33,886 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 12:53:33,886 [INFO] Encoding hidden states for batch 25
2025-01-09 12:53:33,928 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:53:33,929 [INFO] Encoding hidden states for batch 26
2025-01-09 12:53:33,962 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 12:53:33,963 [INFO] Encoding hidden states for batch 27
2025-01-09 12:53:33,996 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 12:53:33,996 [INFO] Encoding hidden states for batch 28
2025-01-09 12:53:34,031 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:53:34,031 [INFO] Encoding hidden states for batch 29
2025-01-09 12:53:34,064 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:53:34,065 [INFO] Encoding hidden states for batch 30
2025-01-09 12:53:34,102 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 12:53:34,102 [INFO] Encoding hidden states for batch 31
2025-01-09 12:53:34,338 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 12:53:34,338 [INFO] Encoding hidden states for batch 32
2025-01-09 12:53:34,373 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 12:53:34,373 [INFO] Encoding hidden states for batch 33
2025-01-09 12:53:34,407 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:53:34,407 [INFO] Encoding hidden states for batch 34
2025-01-09 12:53:34,441 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 12:53:34,441 [INFO] Encoding hidden states for batch 35
2025-01-09 12:53:34,476 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 12:53:34,476 [INFO] Encoding hidden states for batch 36
2025-01-09 12:53:34,509 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 12:53:34,510 [INFO] Encoding hidden states for batch 37
2025-01-09 12:53:34,543 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 12:53:34,543 [INFO] Encoding hidden states for batch 38
2025-01-09 12:53:34,576 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 12:53:34,577 [INFO] Encoding hidden states for batch 39
2025-01-09 12:53:34,610 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 12:53:34,610 [INFO] Encoding hidden states for batch 40
2025-01-09 12:53:34,644 [INFO] Batch 41: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:53:34,644 [INFO] Encoding hidden states for batch 41
2025-01-09 12:53:34,678 [INFO] Batch 42: Hidden states shape: torch.Size([10, 108, 768])
2025-01-09 12:53:34,679 [INFO] Encoding hidden states for batch 42
2025-01-09 12:53:34,712 [INFO] Batch 43: Hidden states shape: torch.Size([10, 49, 768])
2025-01-09 12:53:34,713 [INFO] Encoding hidden states for batch 43
2025-01-09 12:53:34,746 [INFO] Batch 44: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 12:53:34,746 [INFO] Encoding hidden states for batch 44
2025-01-09 12:53:34,779 [INFO] Batch 45: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 12:53:34,779 [INFO] Encoding hidden states for batch 45
2025-01-09 12:53:34,812 [INFO] Batch 46: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 12:53:34,812 [INFO] Encoding hidden states for batch 46
2025-01-09 12:53:34,846 [INFO] Batch 47: Hidden states shape: torch.Size([10, 108, 768])
2025-01-09 12:53:34,846 [INFO] Encoding hidden states for batch 47
2025-01-09 12:53:34,880 [INFO] Batch 48: Hidden states shape: torch.Size([10, 83, 768])
2025-01-09 12:53:34,880 [INFO] Encoding hidden states for batch 48
2025-01-09 12:53:34,914 [INFO] Batch 49: Hidden states shape: torch.Size([10, 62, 768])
2025-01-09 12:53:34,914 [INFO] Encoding hidden states for batch 49
2025-01-09 12:53:34,947 [INFO] Batch 50: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:53:34,947 [INFO] Encoding hidden states for batch 50
2025-01-09 12:53:34,981 [INFO] Batch 51: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:53:34,982 [INFO] Encoding hidden states for batch 51
2025-01-09 12:53:35,015 [INFO] Batch 52: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:53:35,015 [INFO] Encoding hidden states for batch 52
2025-01-09 12:53:35,048 [INFO] Batch 53: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:53:35,048 [INFO] Encoding hidden states for batch 53
2025-01-09 12:53:35,081 [INFO] Batch 54: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:53:35,081 [INFO] Encoding hidden states for batch 54
2025-01-09 12:53:35,119 [INFO] Batch 55: Hidden states shape: torch.Size([10, 34, 768])
2025-01-09 12:53:35,119 [INFO] Encoding hidden states for batch 55
2025-01-09 12:53:35,153 [INFO] Batch 56: Hidden states shape: torch.Size([10, 48, 768])
2025-01-09 12:53:35,154 [INFO] Encoding hidden states for batch 56
2025-01-09 12:53:35,188 [INFO] Batch 57: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 12:53:35,188 [INFO] Encoding hidden states for batch 57
2025-01-09 12:53:35,222 [INFO] Batch 58: Hidden states shape: torch.Size([10, 85, 768])
2025-01-09 12:53:35,223 [INFO] Encoding hidden states for batch 58
2025-01-09 12:53:35,257 [INFO] Batch 59: Hidden states shape: torch.Size([10, 107, 768])
2025-01-09 12:53:35,258 [INFO] Encoding hidden states for batch 59
2025-01-09 12:53:35,292 [INFO] Batch 60: Hidden states shape: torch.Size([10, 78, 768])
2025-01-09 12:53:35,292 [INFO] Encoding hidden states for batch 60
2025-01-09 12:53:35,326 [INFO] Batch 61: Hidden states shape: torch.Size([10, 105, 768])
2025-01-09 12:53:35,327 [INFO] Encoding hidden states for batch 61
2025-01-09 12:53:35,361 [INFO] Batch 62: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 12:53:35,362 [INFO] Encoding hidden states for batch 62
2025-01-09 12:53:35,396 [INFO] Batch 63: Hidden states shape: torch.Size([10, 86, 768])
2025-01-09 12:53:35,396 [INFO] Encoding hidden states for batch 63
2025-01-09 12:53:35,430 [INFO] Batch 64: Hidden states shape: torch.Size([10, 62, 768])
2025-01-09 12:53:35,430 [INFO] Encoding hidden states for batch 64
2025-01-09 12:53:35,465 [INFO] Batch 65: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:53:35,465 [INFO] Encoding hidden states for batch 65
2025-01-09 12:53:35,499 [INFO] Batch 66: Hidden states shape: torch.Size([10, 39, 768])
2025-01-09 12:53:35,499 [INFO] Encoding hidden states for batch 66
2025-01-09 12:53:35,534 [INFO] Batch 67: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 12:53:35,534 [INFO] Encoding hidden states for batch 67
2025-01-09 12:53:35,568 [INFO] Batch 68: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:53:35,568 [INFO] Encoding hidden states for batch 68
2025-01-09 12:53:35,611 [INFO] Batch 69: Hidden states shape: torch.Size([10, 118, 768])
2025-01-09 12:53:35,612 [INFO] Encoding hidden states for batch 69
2025-01-09 12:53:35,646 [INFO] Batch 70: Hidden states shape: torch.Size([10, 47, 768])
2025-01-09 12:53:35,646 [INFO] Encoding hidden states for batch 70
2025-01-09 12:53:35,680 [INFO] Batch 71: Hidden states shape: torch.Size([10, 65, 768])
2025-01-09 12:53:35,680 [INFO] Encoding hidden states for batch 71
2025-01-09 12:53:35,715 [INFO] Batch 72: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:53:35,715 [INFO] Encoding hidden states for batch 72
2025-01-09 12:53:35,749 [INFO] Batch 73: Hidden states shape: torch.Size([10, 36, 768])
2025-01-09 12:53:35,749 [INFO] Encoding hidden states for batch 73
2025-01-09 12:53:35,783 [INFO] Batch 74: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 12:53:35,783 [INFO] Encoding hidden states for batch 74
2025-01-09 12:53:35,818 [INFO] Batch 75: Hidden states shape: torch.Size([10, 110, 768])
2025-01-09 12:53:35,818 [INFO] Encoding hidden states for batch 75
2025-01-09 12:53:35,860 [INFO] Batch 76: Hidden states shape: torch.Size([10, 177, 768])
2025-01-09 12:53:35,860 [INFO] Encoding hidden states for batch 76
2025-01-09 12:53:35,894 [INFO] Batch 77: Hidden states shape: torch.Size([10, 61, 768])
2025-01-09 12:53:35,895 [INFO] Encoding hidden states for batch 77
2025-01-09 12:53:35,929 [INFO] Batch 78: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 12:53:35,929 [INFO] Encoding hidden states for batch 78
2025-01-09 12:53:35,964 [INFO] Batch 79: Hidden states shape: torch.Size([10, 73, 768])
2025-01-09 12:53:35,964 [INFO] Encoding hidden states for batch 79
2025-01-09 12:53:35,998 [INFO] Batch 80: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:53:35,999 [INFO] Encoding hidden states for batch 80
2025-01-09 12:53:36,033 [INFO] Batch 81: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:53:36,033 [INFO] Encoding hidden states for batch 81
2025-01-09 12:53:36,066 [INFO] Batch 82: Hidden states shape: torch.Size([10, 48, 768])
2025-01-09 12:53:36,067 [INFO] Encoding hidden states for batch 82
2025-01-09 12:53:36,101 [INFO] Batch 83: Hidden states shape: torch.Size([10, 72, 768])
2025-01-09 12:53:36,101 [INFO] Encoding hidden states for batch 83
2025-01-09 12:53:36,136 [INFO] Batch 84: Hidden states shape: torch.Size([10, 77, 768])
2025-01-09 12:53:36,136 [INFO] Encoding hidden states for batch 84
2025-01-09 12:53:36,170 [INFO] Batch 85: Hidden states shape: torch.Size([10, 59, 768])
2025-01-09 12:53:36,170 [INFO] Encoding hidden states for batch 85
2025-01-09 12:53:36,205 [INFO] Batch 86: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:53:36,205 [INFO] Encoding hidden states for batch 86
2025-01-09 12:53:36,239 [INFO] Batch 87: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:53:36,239 [INFO] Encoding hidden states for batch 87
2025-01-09 12:53:36,273 [INFO] Batch 88: Hidden states shape: torch.Size([10, 89, 768])
2025-01-09 12:53:36,274 [INFO] Encoding hidden states for batch 88
2025-01-09 12:53:36,308 [INFO] Batch 89: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:53:36,308 [INFO] Encoding hidden states for batch 89
2025-01-09 12:53:36,342 [INFO] Batch 90: Hidden states shape: torch.Size([10, 30, 768])
2025-01-09 12:53:36,342 [INFO] Encoding hidden states for batch 90
2025-01-09 12:53:36,376 [INFO] Batch 91: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 12:53:36,376 [INFO] Encoding hidden states for batch 91
2025-01-09 12:53:36,409 [INFO] Batch 92: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:53:36,409 [INFO] Encoding hidden states for batch 92
2025-01-09 12:53:36,443 [INFO] Batch 93: Hidden states shape: torch.Size([10, 63, 768])
2025-01-09 12:53:36,444 [INFO] Encoding hidden states for batch 93
2025-01-09 12:53:36,477 [INFO] Batch 94: Hidden states shape: torch.Size([10, 105, 768])
2025-01-09 12:53:36,478 [INFO] Encoding hidden states for batch 94
2025-01-09 12:53:36,511 [INFO] Batch 95: Hidden states shape: torch.Size([10, 89, 768])
2025-01-09 12:53:36,512 [INFO] Encoding hidden states for batch 95
2025-01-09 12:53:36,546 [INFO] Batch 96: Hidden states shape: torch.Size([10, 112, 768])
2025-01-09 12:53:36,547 [INFO] Encoding hidden states for batch 96
2025-01-09 12:53:36,580 [INFO] Batch 97: Hidden states shape: torch.Size([10, 25, 768])
2025-01-09 12:53:36,580 [INFO] Encoding hidden states for batch 97
2025-01-09 12:53:36,613 [INFO] Batch 98: Hidden states shape: torch.Size([10, 46, 768])
2025-01-09 12:53:36,614 [INFO] Encoding hidden states for batch 98
2025-01-09 12:53:36,647 [INFO] Batch 99: Hidden states shape: torch.Size([10, 111, 768])
2025-01-09 12:53:36,648 [INFO] Encoding hidden states for batch 99
2025-01-09 12:53:36,681 [INFO] Batch 100: Hidden states shape: torch.Size([10, 97, 768])
2025-01-09 12:53:36,681 [INFO] Encoding hidden states for batch 100
2025-01-09 12:53:36,682 [INFO] Total batches processed: 100
2025-01-09 12:55:21,608 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:55:21,608 [INFO] Hyperparameters:
2025-01-09 12:55:21,608 [INFO]   layer: 6
2025-01-09 12:55:21,608 [INFO]   LLM: gpt2-small
2025-01-09 12:55:21,608 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:55:21,608 [INFO]   output_dir: ./results
2025-01-09 12:55:21,608 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:55:21,608 [INFO]   seed: 42
2025-01-09 12:55:21,608 [INFO]   data_size: 1000
2025-01-09 12:55:21,608 [INFO]   device: cuda
2025-01-09 12:55:21,608 [INFO]   alpha: 100.0
2025-01-09 12:55:21,608 [INFO]   steer: pos
2025-01-09 12:55:21,608 [INFO]   method: val_mul
2025-01-09 12:55:21,608 [INFO]   topk_mean: 100
2025-01-09 12:55:21,608 [INFO]   topk_cnt: 100
2025-01-09 12:55:21,608 [INFO]   batch_size: 10
2025-01-09 12:55:21,609 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:55:21,609 [INFO] Loading model: gpt2-small
2025-01-09 12:56:17,641 [INFO] Loading SAE for layer 6
2025-01-09 12:56:48,979 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:56:49,045 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:56:49,055 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-09 12:56:49,061 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:56:49,240 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 12:56:49,240 [INFO] Encoding hidden states for batch 1
2025-01-09 12:56:49,285 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:56:49,286 [INFO] Encoding hidden states for batch 2
2025-01-09 12:56:49,332 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 12:56:49,332 [INFO] Encoding hidden states for batch 3
2025-01-09 12:56:49,378 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:56:49,378 [INFO] Encoding hidden states for batch 4
2025-01-09 12:56:49,412 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 12:56:49,412 [INFO] Encoding hidden states for batch 5
2025-01-09 12:56:49,445 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 12:56:49,445 [INFO] Encoding hidden states for batch 6
2025-01-09 12:56:49,479 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 12:56:49,479 [INFO] Encoding hidden states for batch 7
2025-01-09 12:56:49,527 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 12:56:49,527 [INFO] Encoding hidden states for batch 8
2025-01-09 12:56:49,575 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 12:56:49,576 [INFO] Encoding hidden states for batch 9
2025-01-09 12:56:49,614 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:56:49,615 [INFO] Encoding hidden states for batch 10
2025-01-09 12:56:49,654 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:56:49,654 [INFO] Encoding hidden states for batch 11
2025-01-09 12:56:49,692 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 12:56:49,692 [INFO] Encoding hidden states for batch 12
2025-01-09 12:56:49,723 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:56:49,723 [INFO] Encoding hidden states for batch 13
2025-01-09 12:56:49,755 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:56:49,756 [INFO] Encoding hidden states for batch 14
2025-01-09 12:56:49,789 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:56:49,789 [INFO] Encoding hidden states for batch 15
2025-01-09 12:56:49,824 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 12:56:49,824 [INFO] Encoding hidden states for batch 16
2025-01-09 12:56:49,859 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:56:49,859 [INFO] Encoding hidden states for batch 17
2025-01-09 12:56:49,892 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:56:49,893 [INFO] Encoding hidden states for batch 18
2025-01-09 12:56:49,927 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:56:49,927 [INFO] Encoding hidden states for batch 19
2025-01-09 12:56:49,962 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 12:56:49,962 [INFO] Encoding hidden states for batch 20
2025-01-09 12:56:49,997 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 12:56:49,997 [INFO] Encoding hidden states for batch 21
2025-01-09 12:56:50,032 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 12:56:50,032 [INFO] Encoding hidden states for batch 22
2025-01-09 12:56:50,067 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 12:56:50,067 [INFO] Encoding hidden states for batch 23
2025-01-09 12:56:50,101 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:56:50,101 [INFO] Encoding hidden states for batch 24
2025-01-09 12:56:50,148 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 12:56:50,148 [INFO] Encoding hidden states for batch 25
2025-01-09 12:56:50,209 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:56:50,209 [INFO] Encoding hidden states for batch 26
2025-01-09 12:56:50,270 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 12:56:50,270 [INFO] Encoding hidden states for batch 27
2025-01-09 12:56:50,314 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 12:56:50,314 [INFO] Encoding hidden states for batch 28
2025-01-09 12:56:50,349 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:56:50,349 [INFO] Encoding hidden states for batch 29
2025-01-09 12:56:50,382 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:56:50,382 [INFO] Encoding hidden states for batch 30
2025-01-09 12:56:50,417 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 12:56:50,417 [INFO] Encoding hidden states for batch 31
2025-01-09 12:56:50,664 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 12:56:50,664 [INFO] Encoding hidden states for batch 32
2025-01-09 12:56:50,700 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 12:56:50,700 [INFO] Encoding hidden states for batch 33
2025-01-09 12:56:50,734 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:56:50,734 [INFO] Encoding hidden states for batch 34
2025-01-09 12:56:50,769 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 12:56:50,769 [INFO] Encoding hidden states for batch 35
2025-01-09 12:56:50,803 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 12:56:50,804 [INFO] Encoding hidden states for batch 36
2025-01-09 12:56:50,837 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 12:56:50,838 [INFO] Encoding hidden states for batch 37
2025-01-09 12:56:50,872 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 12:56:50,872 [INFO] Encoding hidden states for batch 38
2025-01-09 12:56:50,905 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 12:56:50,906 [INFO] Encoding hidden states for batch 39
2025-01-09 12:56:50,940 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 12:56:50,940 [INFO] Encoding hidden states for batch 40
2025-01-09 12:56:50,975 [INFO] Batch 41: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:56:50,975 [INFO] Encoding hidden states for batch 41
2025-01-09 12:56:51,014 [INFO] Batch 42: Hidden states shape: torch.Size([10, 108, 768])
2025-01-09 12:56:51,015 [INFO] Encoding hidden states for batch 42
2025-01-09 12:56:51,056 [INFO] Batch 43: Hidden states shape: torch.Size([10, 49, 768])
2025-01-09 12:56:51,056 [INFO] Encoding hidden states for batch 43
2025-01-09 12:56:51,087 [INFO] Batch 44: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 12:56:51,087 [INFO] Encoding hidden states for batch 44
2025-01-09 12:56:51,115 [INFO] Batch 45: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 12:56:51,115 [INFO] Encoding hidden states for batch 45
2025-01-09 12:56:51,144 [INFO] Batch 46: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 12:56:51,144 [INFO] Encoding hidden states for batch 46
2025-01-09 12:56:51,181 [INFO] Batch 47: Hidden states shape: torch.Size([10, 108, 768])
2025-01-09 12:56:51,182 [INFO] Encoding hidden states for batch 47
2025-01-09 12:56:51,218 [INFO] Batch 48: Hidden states shape: torch.Size([10, 83, 768])
2025-01-09 12:56:51,218 [INFO] Encoding hidden states for batch 48
2025-01-09 12:56:51,253 [INFO] Batch 49: Hidden states shape: torch.Size([10, 62, 768])
2025-01-09 12:56:51,253 [INFO] Encoding hidden states for batch 49
2025-01-09 12:56:51,287 [INFO] Batch 50: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:56:51,288 [INFO] Encoding hidden states for batch 50
2025-01-09 12:56:51,322 [INFO] Batch 51: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:56:51,323 [INFO] Encoding hidden states for batch 51
2025-01-09 12:56:51,356 [INFO] Batch 52: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:56:51,356 [INFO] Encoding hidden states for batch 52
2025-01-09 12:56:51,389 [INFO] Batch 53: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:56:51,390 [INFO] Encoding hidden states for batch 53
2025-01-09 12:56:51,423 [INFO] Batch 54: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:56:51,423 [INFO] Encoding hidden states for batch 54
2025-01-09 12:56:51,458 [INFO] Batch 55: Hidden states shape: torch.Size([10, 34, 768])
2025-01-09 12:56:51,459 [INFO] Encoding hidden states for batch 55
2025-01-09 12:56:51,493 [INFO] Batch 56: Hidden states shape: torch.Size([10, 48, 768])
2025-01-09 12:56:51,493 [INFO] Encoding hidden states for batch 56
2025-01-09 12:56:51,527 [INFO] Batch 57: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 12:56:51,528 [INFO] Encoding hidden states for batch 57
2025-01-09 12:56:51,565 [INFO] Batch 58: Hidden states shape: torch.Size([10, 85, 768])
2025-01-09 12:56:51,565 [INFO] Encoding hidden states for batch 58
2025-01-09 12:56:51,600 [INFO] Batch 59: Hidden states shape: torch.Size([10, 107, 768])
2025-01-09 12:56:51,601 [INFO] Encoding hidden states for batch 59
2025-01-09 12:56:51,635 [INFO] Batch 60: Hidden states shape: torch.Size([10, 78, 768])
2025-01-09 12:56:51,635 [INFO] Encoding hidden states for batch 60
2025-01-09 12:56:51,669 [INFO] Batch 61: Hidden states shape: torch.Size([10, 105, 768])
2025-01-09 12:56:51,670 [INFO] Encoding hidden states for batch 61
2025-01-09 12:56:51,705 [INFO] Batch 62: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 12:56:51,705 [INFO] Encoding hidden states for batch 62
2025-01-09 12:56:51,740 [INFO] Batch 63: Hidden states shape: torch.Size([10, 86, 768])
2025-01-09 12:56:51,740 [INFO] Encoding hidden states for batch 63
2025-01-09 12:56:51,779 [INFO] Batch 64: Hidden states shape: torch.Size([10, 62, 768])
2025-01-09 12:56:51,779 [INFO] Encoding hidden states for batch 64
2025-01-09 12:56:51,814 [INFO] Batch 65: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:56:51,815 [INFO] Encoding hidden states for batch 65
2025-01-09 12:56:51,849 [INFO] Batch 66: Hidden states shape: torch.Size([10, 39, 768])
2025-01-09 12:56:51,849 [INFO] Encoding hidden states for batch 66
2025-01-09 12:56:51,884 [INFO] Batch 67: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 12:56:51,884 [INFO] Encoding hidden states for batch 67
2025-01-09 12:56:51,918 [INFO] Batch 68: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:56:51,918 [INFO] Encoding hidden states for batch 68
2025-01-09 12:56:51,953 [INFO] Batch 69: Hidden states shape: torch.Size([10, 118, 768])
2025-01-09 12:56:51,953 [INFO] Encoding hidden states for batch 69
2025-01-09 12:56:51,987 [INFO] Batch 70: Hidden states shape: torch.Size([10, 47, 768])
2025-01-09 12:56:51,987 [INFO] Encoding hidden states for batch 70
2025-01-09 12:56:52,021 [INFO] Batch 71: Hidden states shape: torch.Size([10, 65, 768])
2025-01-09 12:56:52,021 [INFO] Encoding hidden states for batch 71
2025-01-09 12:56:52,056 [INFO] Batch 72: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:56:52,056 [INFO] Encoding hidden states for batch 72
2025-01-09 12:56:52,097 [INFO] Batch 73: Hidden states shape: torch.Size([10, 36, 768])
2025-01-09 12:56:52,097 [INFO] Encoding hidden states for batch 73
2025-01-09 12:56:52,132 [INFO] Batch 74: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 12:56:52,132 [INFO] Encoding hidden states for batch 74
2025-01-09 12:56:52,167 [INFO] Batch 75: Hidden states shape: torch.Size([10, 110, 768])
2025-01-09 12:56:52,167 [INFO] Encoding hidden states for batch 75
2025-01-09 12:56:52,208 [INFO] Batch 76: Hidden states shape: torch.Size([10, 177, 768])
2025-01-09 12:56:52,208 [INFO] Encoding hidden states for batch 76
2025-01-09 12:56:52,242 [INFO] Batch 77: Hidden states shape: torch.Size([10, 61, 768])
2025-01-09 12:56:52,243 [INFO] Encoding hidden states for batch 77
2025-01-09 12:56:52,276 [INFO] Batch 78: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 12:56:52,276 [INFO] Encoding hidden states for batch 78
2025-01-09 12:56:52,311 [INFO] Batch 79: Hidden states shape: torch.Size([10, 73, 768])
2025-01-09 12:56:52,311 [INFO] Encoding hidden states for batch 79
2025-01-09 12:56:52,344 [INFO] Batch 80: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:56:52,345 [INFO] Encoding hidden states for batch 80
2025-01-09 12:56:52,379 [INFO] Batch 81: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:56:52,379 [INFO] Encoding hidden states for batch 81
2025-01-09 12:56:52,412 [INFO] Batch 82: Hidden states shape: torch.Size([10, 48, 768])
2025-01-09 12:56:52,412 [INFO] Encoding hidden states for batch 82
2025-01-09 12:56:52,450 [INFO] Batch 83: Hidden states shape: torch.Size([10, 72, 768])
2025-01-09 12:56:52,451 [INFO] Encoding hidden states for batch 83
2025-01-09 12:56:52,486 [INFO] Batch 84: Hidden states shape: torch.Size([10, 77, 768])
2025-01-09 12:56:52,486 [INFO] Encoding hidden states for batch 84
2025-01-09 12:56:52,520 [INFO] Batch 85: Hidden states shape: torch.Size([10, 59, 768])
2025-01-09 12:56:52,520 [INFO] Encoding hidden states for batch 85
2025-01-09 12:56:52,554 [INFO] Batch 86: Hidden states shape: torch.Size([10, 115, 768])
2025-01-09 12:56:52,554 [INFO] Encoding hidden states for batch 86
2025-01-09 12:56:52,587 [INFO] Batch 87: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:56:52,587 [INFO] Encoding hidden states for batch 87
2025-01-09 12:56:52,620 [INFO] Batch 88: Hidden states shape: torch.Size([10, 89, 768])
2025-01-09 12:56:52,621 [INFO] Encoding hidden states for batch 88
2025-01-09 12:56:52,655 [INFO] Batch 89: Hidden states shape: torch.Size([10, 106, 768])
2025-01-09 12:56:52,655 [INFO] Encoding hidden states for batch 89
2025-01-09 12:56:52,705 [INFO] Batch 90: Hidden states shape: torch.Size([10, 30, 768])
2025-01-09 12:56:52,706 [INFO] Encoding hidden states for batch 90
2025-01-09 12:56:52,740 [INFO] Batch 91: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 12:56:52,740 [INFO] Encoding hidden states for batch 91
2025-01-09 12:56:52,773 [INFO] Batch 92: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:56:52,773 [INFO] Encoding hidden states for batch 92
2025-01-09 12:56:52,807 [INFO] Batch 93: Hidden states shape: torch.Size([10, 63, 768])
2025-01-09 12:56:52,808 [INFO] Encoding hidden states for batch 93
2025-01-09 12:56:52,841 [INFO] Batch 94: Hidden states shape: torch.Size([10, 105, 768])
2025-01-09 12:56:52,842 [INFO] Encoding hidden states for batch 94
2025-01-09 12:56:52,875 [INFO] Batch 95: Hidden states shape: torch.Size([10, 89, 768])
2025-01-09 12:56:52,875 [INFO] Encoding hidden states for batch 95
2025-01-09 12:56:52,910 [INFO] Batch 96: Hidden states shape: torch.Size([10, 112, 768])
2025-01-09 12:56:52,910 [INFO] Encoding hidden states for batch 96
2025-01-09 12:56:52,938 [INFO] Batch 97: Hidden states shape: torch.Size([10, 25, 768])
2025-01-09 12:56:52,938 [INFO] Encoding hidden states for batch 97
2025-01-09 12:56:52,973 [INFO] Batch 98: Hidden states shape: torch.Size([10, 46, 768])
2025-01-09 12:56:52,974 [INFO] Encoding hidden states for batch 98
2025-01-09 12:56:53,008 [INFO] Batch 99: Hidden states shape: torch.Size([10, 111, 768])
2025-01-09 12:56:53,008 [INFO] Encoding hidden states for batch 99
2025-01-09 12:56:53,043 [INFO] Batch 100: Hidden states shape: torch.Size([10, 97, 768])
2025-01-09 12:56:53,043 [INFO] Encoding hidden states for batch 100
2025-01-09 12:56:53,043 [INFO] Total batches processed: 100
2025-01-09 12:56:53,045 [INFO] 最大长度:177
2025-01-09 12:58:06,419 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 12:58:06,419 [INFO] Hyperparameters:
2025-01-09 12:58:06,419 [INFO]   layer: 6
2025-01-09 12:58:06,419 [INFO]   LLM: gpt2-small
2025-01-09 12:58:06,419 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:58:06,419 [INFO]   output_dir: ./results
2025-01-09 12:58:06,419 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 12:58:06,419 [INFO]   seed: 42
2025-01-09 12:58:06,419 [INFO]   data_size: 400
2025-01-09 12:58:06,419 [INFO]   device: cuda
2025-01-09 12:58:06,419 [INFO]   alpha: 100.0
2025-01-09 12:58:06,419 [INFO]   steer: pos
2025-01-09 12:58:06,419 [INFO]   method: val_mul
2025-01-09 12:58:06,419 [INFO]   topk_mean: 100
2025-01-09 12:58:06,419 [INFO]   topk_cnt: 100
2025-01-09 12:58:06,419 [INFO]   batch_size: 10
2025-01-09 12:58:06,419 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 12:58:06,420 [INFO] Loading model: gpt2-small
2025-01-09 12:59:02,500 [INFO] Loading SAE for layer 6
2025-01-09 12:59:33,849 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 12:59:33,921 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 12:59:33,930 [INFO] Selected 400 negative, 400 positive, and 400 neutral samples
2025-01-09 12:59:33,932 [INFO] Running model with cache to obtain hidden states
2025-01-09 12:59:34,142 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 12:59:34,142 [INFO] Encoding hidden states for batch 1
2025-01-09 12:59:34,189 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:59:34,189 [INFO] Encoding hidden states for batch 2
2025-01-09 12:59:34,236 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 12:59:34,237 [INFO] Encoding hidden states for batch 3
2025-01-09 12:59:34,279 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 12:59:34,279 [INFO] Encoding hidden states for batch 4
2025-01-09 12:59:34,313 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 12:59:34,314 [INFO] Encoding hidden states for batch 5
2025-01-09 12:59:34,346 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 12:59:34,346 [INFO] Encoding hidden states for batch 6
2025-01-09 12:59:34,379 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 12:59:34,379 [INFO] Encoding hidden states for batch 7
2025-01-09 12:59:34,412 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 12:59:34,412 [INFO] Encoding hidden states for batch 8
2025-01-09 12:59:34,445 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 12:59:34,445 [INFO] Encoding hidden states for batch 9
2025-01-09 12:59:34,478 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:59:34,479 [INFO] Encoding hidden states for batch 10
2025-01-09 12:59:34,512 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:59:34,513 [INFO] Encoding hidden states for batch 11
2025-01-09 12:59:34,546 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 12:59:34,546 [INFO] Encoding hidden states for batch 12
2025-01-09 12:59:34,579 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 12:59:34,579 [INFO] Encoding hidden states for batch 13
2025-01-09 12:59:34,612 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:59:34,612 [INFO] Encoding hidden states for batch 14
2025-01-09 12:59:34,645 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:59:34,646 [INFO] Encoding hidden states for batch 15
2025-01-09 12:59:34,679 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 12:59:34,679 [INFO] Encoding hidden states for batch 16
2025-01-09 12:59:34,713 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:59:34,713 [INFO] Encoding hidden states for batch 17
2025-01-09 12:59:34,746 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 12:59:34,746 [INFO] Encoding hidden states for batch 18
2025-01-09 12:59:34,779 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 12:59:34,779 [INFO] Encoding hidden states for batch 19
2025-01-09 12:59:34,812 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 12:59:34,812 [INFO] Encoding hidden states for batch 20
2025-01-09 12:59:34,845 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 12:59:34,846 [INFO] Encoding hidden states for batch 21
2025-01-09 12:59:34,879 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 12:59:34,880 [INFO] Encoding hidden states for batch 22
2025-01-09 12:59:34,913 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 12:59:34,913 [INFO] Encoding hidden states for batch 23
2025-01-09 12:59:34,946 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 12:59:34,946 [INFO] Encoding hidden states for batch 24
2025-01-09 12:59:34,981 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 12:59:34,981 [INFO] Encoding hidden states for batch 25
2025-01-09 12:59:35,022 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 12:59:35,022 [INFO] Encoding hidden states for batch 26
2025-01-09 12:59:35,055 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 12:59:35,055 [INFO] Encoding hidden states for batch 27
2025-01-09 12:59:35,088 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 12:59:35,088 [INFO] Encoding hidden states for batch 28
2025-01-09 12:59:35,122 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:59:35,123 [INFO] Encoding hidden states for batch 29
2025-01-09 12:59:35,155 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 12:59:35,156 [INFO] Encoding hidden states for batch 30
2025-01-09 12:59:35,189 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 12:59:35,189 [INFO] Encoding hidden states for batch 31
2025-01-09 12:59:35,223 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 12:59:35,223 [INFO] Encoding hidden states for batch 32
2025-01-09 12:59:35,257 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 12:59:35,257 [INFO] Encoding hidden states for batch 33
2025-01-09 12:59:35,432 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 12:59:35,433 [INFO] Encoding hidden states for batch 34
2025-01-09 12:59:35,467 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 12:59:35,467 [INFO] Encoding hidden states for batch 35
2025-01-09 12:59:35,502 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 12:59:35,502 [INFO] Encoding hidden states for batch 36
2025-01-09 12:59:35,535 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 12:59:35,535 [INFO] Encoding hidden states for batch 37
2025-01-09 12:59:35,568 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 12:59:35,569 [INFO] Encoding hidden states for batch 38
2025-01-09 12:59:35,602 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 12:59:35,602 [INFO] Encoding hidden states for batch 39
2025-01-09 12:59:35,636 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 12:59:35,636 [INFO] Encoding hidden states for batch 40
2025-01-09 12:59:35,637 [INFO] Total batches processed: 40
2025-01-09 12:59:35,638 [INFO] 最大长度:121
2025-01-09 12:59:35,649 [INFO] Concatenated batch latents shape: torch.Size([400, 121, 24576])
2025-01-09 12:59:35,649 [INFO] Computing non-zero element counts
2025-01-09 12:59:35,779 [INFO] Computing sum of non-zero elements
2025-01-09 12:59:35,795 [INFO] Computing mean of non-zero elements
2025-01-09 12:59:35,807 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 12:59:35,970 [INFO] Top 100 nz_mean values selected.
2025-01-09 12:59:35,970 [INFO] Selecting top-k indices based on act_cnt
2025-01-09 12:59:35,986 [INFO] Top 100 act_cnt values selected.
2025-01-09 12:59:35,986 [INFO] Finding overlapping indices between nz_mean and act_cnt top-k
2025-01-09 12:59:36,280 [INFO] Number of overlapping indices: 1
2025-01-09 12:59:36,280 [INFO] Computing steering vectors using method: val_mul
2025-01-09 12:59:36,281 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:59:36,281 [INFO] Computing steering vectors using method: mean
2025-01-09 12:59:36,282 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:59:36,282 [INFO] Computing steering vectors using method: val_mul
2025-01-09 12:59:36,283 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 12:59:36,839 [INFO] Euclidean distance between mean and val_mul steering vectors: 173.78358459472656
2025-01-09 12:59:36,840 [INFO] Cosine similarity between mean and val_mul steering vectors: 1.0000001192092896
2025-01-09 12:59:36,846 [INFO] Example prompt: Amazing!!!!
2025-01-09 12:59:36,846 [INFO] Generating texts without steering...
2025-01-09 13:01:54,219 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 13:01:54,220 [INFO] Hyperparameters:
2025-01-09 13:01:54,220 [INFO]   layer: 6
2025-01-09 13:01:54,220 [INFO]   LLM: gpt2-small
2025-01-09 13:01:54,220 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:01:54,220 [INFO]   output_dir: ./results
2025-01-09 13:01:54,220 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 13:01:54,220 [INFO]   seed: 42
2025-01-09 13:01:54,220 [INFO]   data_size: 400
2025-01-09 13:01:54,220 [INFO]   device: cuda
2025-01-09 13:01:54,220 [INFO]   alpha: 100.0
2025-01-09 13:01:54,220 [INFO]   steer: pos
2025-01-09 13:01:54,220 [INFO]   method: val_mul
2025-01-09 13:01:54,220 [INFO]   topk_mean: 100
2025-01-09 13:01:54,220 [INFO]   topk_cnt: 100
2025-01-09 13:01:54,220 [INFO]   batch_size: 10
2025-01-09 13:01:54,220 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 13:01:54,220 [INFO] Loading model: gpt2-small
2025-01-09 13:02:35,228 [INFO] Loading SAE for layer 6
2025-01-09 13:03:06,535 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:03:06,589 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 13:03:06,597 [INFO] Selected 400 negative, 400 positive, and 400 neutral samples
2025-01-09 13:03:06,599 [INFO] Running model with cache to obtain hidden states
2025-01-09 13:03:06,774 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 13:03:06,774 [INFO] Encoding hidden states for batch 1
2025-01-09 13:03:06,820 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:03:06,820 [INFO] Encoding hidden states for batch 2
2025-01-09 13:03:06,867 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 13:03:06,867 [INFO] Encoding hidden states for batch 3
2025-01-09 13:03:06,908 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 13:03:06,909 [INFO] Encoding hidden states for batch 4
2025-01-09 13:03:06,942 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 13:03:06,942 [INFO] Encoding hidden states for batch 5
2025-01-09 13:03:06,975 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 13:03:06,975 [INFO] Encoding hidden states for batch 6
2025-01-09 13:03:07,008 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 13:03:07,009 [INFO] Encoding hidden states for batch 7
2025-01-09 13:03:07,041 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 13:03:07,041 [INFO] Encoding hidden states for batch 8
2025-01-09 13:03:07,076 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 13:03:07,076 [INFO] Encoding hidden states for batch 9
2025-01-09 13:03:07,109 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:03:07,110 [INFO] Encoding hidden states for batch 10
2025-01-09 13:03:07,144 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:03:07,145 [INFO] Encoding hidden states for batch 11
2025-01-09 13:03:07,179 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 13:03:07,179 [INFO] Encoding hidden states for batch 12
2025-01-09 13:03:07,213 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:03:07,213 [INFO] Encoding hidden states for batch 13
2025-01-09 13:03:07,248 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:03:07,249 [INFO] Encoding hidden states for batch 14
2025-01-09 13:03:07,284 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:03:07,285 [INFO] Encoding hidden states for batch 15
2025-01-09 13:03:07,321 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 13:03:07,322 [INFO] Encoding hidden states for batch 16
2025-01-09 13:03:07,359 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:03:07,359 [INFO] Encoding hidden states for batch 17
2025-01-09 13:03:07,395 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:03:07,395 [INFO] Encoding hidden states for batch 18
2025-01-09 13:03:07,432 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:03:07,432 [INFO] Encoding hidden states for batch 19
2025-01-09 13:03:07,469 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 13:03:07,469 [INFO] Encoding hidden states for batch 20
2025-01-09 13:03:07,501 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 13:03:07,501 [INFO] Encoding hidden states for batch 21
2025-01-09 13:03:07,529 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 13:03:07,529 [INFO] Encoding hidden states for batch 22
2025-01-09 13:03:07,557 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 13:03:07,557 [INFO] Encoding hidden states for batch 23
2025-01-09 13:03:07,585 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 13:03:07,585 [INFO] Encoding hidden states for batch 24
2025-01-09 13:03:07,623 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 13:03:07,623 [INFO] Encoding hidden states for batch 25
2025-01-09 13:03:07,665 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:03:07,665 [INFO] Encoding hidden states for batch 26
2025-01-09 13:03:07,699 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 13:03:07,699 [INFO] Encoding hidden states for batch 27
2025-01-09 13:03:07,733 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 13:03:07,733 [INFO] Encoding hidden states for batch 28
2025-01-09 13:03:07,768 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:03:07,768 [INFO] Encoding hidden states for batch 29
2025-01-09 13:03:07,802 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 13:03:07,802 [INFO] Encoding hidden states for batch 30
2025-01-09 13:03:07,836 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 13:03:07,837 [INFO] Encoding hidden states for batch 31
2025-01-09 13:03:07,871 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 13:03:07,871 [INFO] Encoding hidden states for batch 32
2025-01-09 13:03:07,905 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 13:03:07,905 [INFO] Encoding hidden states for batch 33
2025-01-09 13:03:08,156 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:03:08,156 [INFO] Encoding hidden states for batch 34
2025-01-09 13:03:08,191 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 13:03:08,192 [INFO] Encoding hidden states for batch 35
2025-01-09 13:03:08,226 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 13:03:08,226 [INFO] Encoding hidden states for batch 36
2025-01-09 13:03:08,260 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 13:03:08,260 [INFO] Encoding hidden states for batch 37
2025-01-09 13:03:08,293 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 13:03:08,294 [INFO] Encoding hidden states for batch 38
2025-01-09 13:03:08,328 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 13:03:08,328 [INFO] Encoding hidden states for batch 39
2025-01-09 13:03:08,363 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 13:03:08,363 [INFO] Encoding hidden states for batch 40
2025-01-09 13:03:08,364 [INFO] Total batches processed: 40
2025-01-09 13:03:08,365 [INFO] 最大长度:121
2025-01-09 13:03:08,375 [INFO] Concatenated batch latents shape: torch.Size([400, 121, 24576])
2025-01-09 13:03:08,376 [INFO] Computing non-zero element counts
2025-01-09 13:03:08,507 [INFO] Computing sum of non-zero elements
2025-01-09 13:03:08,523 [INFO] Computing mean of non-zero elements
2025-01-09 13:03:08,535 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 13:03:08,563 [INFO] Top 100 nz_mean values selected.
2025-01-09 13:03:08,563 [INFO] Selecting top-k indices based on act_cnt
2025-01-09 13:03:08,563 [INFO] Top 100 act_cnt values selected.
2025-01-09 13:03:08,563 [INFO] Finding overlapping indices between nz_mean and act_cnt top-k
2025-01-09 13:03:08,590 [INFO] Number of overlapping indices: 1
2025-01-09 13:03:08,590 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:03:08,591 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:03:08,591 [INFO] Computing steering vectors using method: mean
2025-01-09 13:03:08,591 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:03:08,591 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:03:08,591 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:03:08,613 [INFO] Euclidean distance between mean and val_mul steering vectors: 173.78358459472656
2025-01-09 13:03:08,613 [INFO] Cosine similarity between mean and val_mul steering vectors: 1.0000001192092896
2025-01-09 13:03:08,615 [INFO] Example prompt: Amazing!!!!
2025-01-09 13:03:08,615 [INFO] Generating texts without steering...
2025-01-09 13:03:09,930 [INFO] Generated Text 1: Amazing!!!! This was my first time using the Apple Pencils and I was pleasantly surprised. It is perfect for my writing and all my projects! It's very light, not too heavy or bulky but it does help to keep your pencils on a bit
2025-01-09 13:03:09,930 [INFO] Generated Text 2: Amazing!!!!!! The real deal is I was just so happy. It was like the real deal and my husband wanted to make it, but I had no idea what it would be. My husband got me a nice warm gift with lots of goodies and instructions on
2025-01-09 13:03:09,930 [INFO] Generated Text 3: Amazing!!!!

I'm very excited to be able to offer a 4th and 5th gen PC. I'm so glad I did. The drive was great, it's a good drive but not as fast as the previous 3 from me (2gb
2025-01-09 13:03:09,930 [INFO] Generating texts with steering...
2025-01-09 13:03:10,659 [INFO] Generated Text 1: Amazing!!!! for the money! The reviews I have read are overwhelming. If you're looking for something different, I'd suggest you go with the Oceti Sako + EXIT

After using this review on several occasions and getting nothing but positive
2025-01-09 13:03:10,660 [INFO] Generated Text 2: Amazing!!!! give it a try and let us know what you think!

I got this because of my two sons who were diagnosed with autism. They are now 12 and 14 years old. They have had several medical conditions including epilepsy, brain cancer, learning
2025-01-09 13:03:10,660 [INFO] Generated Text 3: Amazing!!!! "The whole country is going to be at risk for a flood of oil and gas."

My first reaction was to ask why. It's not really that big of a deal, but it would be nice if the UN stopped worrying about the
2025-01-09 13:03:10,660 [INFO] Saving nz_mean and act_cnt to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/nz_stats.pt
2025-01-09 13:03:10,661 [INFO] Saving generated texts to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/generated_texts.txt
2025-01-09 13:03:10,661 [INFO] Saving hyperparameters to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/hyperparameters.json
2025-01-09 13:03:10,661 [INFO] All results saved successfully.
2025-01-09 13:07:38,376 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0/execution.log
2025-01-09 13:07:38,376 [INFO] Hyperparameters:
2025-01-09 13:07:38,376 [INFO]   layer: 6
2025-01-09 13:07:38,376 [INFO]   LLM: gpt2-small
2025-01-09 13:07:38,376 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:07:38,376 [INFO]   output_dir: ./results
2025-01-09 13:07:38,376 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 13:07:38,376 [INFO]   seed: 42
2025-01-09 13:07:38,376 [INFO]   data_size: 400
2025-01-09 13:07:38,376 [INFO]   device: cuda
2025-01-09 13:07:38,376 [INFO]   alpha: 100.0
2025-01-09 13:07:38,376 [INFO]   steer: pos
2025-01-09 13:07:38,377 [INFO]   method: val_mul
2025-01-09 13:07:38,377 [INFO]   topk_mean: 100
2025-01-09 13:07:38,377 [INFO]   topk_cnt: 100
2025-01-09 13:07:38,377 [INFO]   batch_size: 10
2025-01-09 13:07:38,377 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 13:07:38,377 [INFO] Loading model: gpt2-small
