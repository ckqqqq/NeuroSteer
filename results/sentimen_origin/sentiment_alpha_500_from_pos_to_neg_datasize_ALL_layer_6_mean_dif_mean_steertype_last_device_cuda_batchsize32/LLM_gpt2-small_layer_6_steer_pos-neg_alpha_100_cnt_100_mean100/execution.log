2025-01-10 09:46:29,182 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-10 09:46:29,183 [INFO] Hyperparameters:
2025-01-10 09:46:29,185 [INFO]   layer: 6
2025-01-10 09:46:29,186 [INFO]   LLM: gpt2-small
2025-01-10 09:46:29,187 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-10 09:46:29,188 [INFO]   output_dir: ./results
2025-01-10 09:46:29,188 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-10 09:46:29,189 [INFO]   seed: 42
2025-01-10 09:46:29,190 [INFO]   data_size: 1000
2025-01-10 09:46:29,191 [INFO]   device: cpu
2025-01-10 09:46:29,192 [INFO]   alpha: 100
2025-01-10 09:46:29,192 [INFO]   steer: pos-neg
2025-01-10 09:46:29,193 [INFO]   method: val_mul
2025-01-10 09:46:29,194 [INFO]   topk_mean: 100
2025-01-10 09:46:29,195 [INFO]   topk_cnt: 100
2025-01-10 09:46:29,195 [INFO]   batch_size: 32
2025-01-10 09:46:29,221 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-10 09:46:29,244 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-10 09:46:29,356 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-10 09:46:29,373 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-10 09:46:29,462 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-10 09:46:29,491 [INFO] Hyperparameters:
2025-01-10 09:46:29,493 [INFO]   layer: 6
2025-01-10 09:46:29,494 [INFO]   LLM: gpt2-small
2025-01-10 09:46:29,495 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-10 09:46:29,496 [INFO]   output_dir: ./results
2025-01-10 09:46:29,497 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-10 09:46:29,498 [INFO]   seed: 42
2025-01-10 09:46:29,499 [INFO]   data_size: 1000
2025-01-10 09:46:29,500 [INFO]   device: cpu
2025-01-10 09:46:29,500 [INFO]   alpha: 100
2025-01-10 09:46:29,502 [INFO]   steer: pos-neg
2025-01-10 09:46:29,503 [INFO]   method: val_mul
2025-01-10 09:46:29,504 [INFO]   topk_mean: 100
2025-01-10 09:46:29,505 [INFO]   topk_cnt: 100
2025-01-10 09:46:29,506 [INFO]   batch_size: 32
2025-01-10 09:46:29,508 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-10 09:46:29,509 [INFO] Loading model: gpt2-small
2025-01-10 09:47:10,359 [INFO] Loading SAE for layer 6
2025-01-10 09:47:41,886 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-10 09:47:41,933 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-10 09:47:41,942 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-10 09:47:42,058 [INFO] Running model with cache to obtain hidden states
2025-01-10 09:47:42,885 [INFO] Batch 1: Hidden states shape: torch.Size([32, 99, 768])
2025-01-10 09:47:42,886 [INFO] Encoding hidden states for batch 1
2025-01-10 09:47:43,898 [INFO] Batch 2: Hidden states shape: torch.Size([32, 94, 768])
2025-01-10 09:47:43,899 [INFO] Encoding hidden states for batch 2
2025-01-10 09:47:44,577 [INFO] Batch 3: Hidden states shape: torch.Size([32, 84, 768])
2025-01-10 09:47:44,578 [INFO] Encoding hidden states for batch 3
2025-01-10 09:47:45,452 [INFO] Batch 4: Hidden states shape: torch.Size([32, 116, 768])
2025-01-10 09:47:45,453 [INFO] Encoding hidden states for batch 4
2025-01-10 09:47:46,178 [INFO] Batch 5: Hidden states shape: torch.Size([32, 109, 768])
2025-01-10 09:47:46,180 [INFO] Encoding hidden states for batch 5
2025-01-10 09:47:46,744 [INFO] Batch 6: Hidden states shape: torch.Size([32, 75, 768])
2025-01-10 09:47:46,746 [INFO] Encoding hidden states for batch 6
2025-01-10 09:47:47,513 [INFO] Batch 7: Hidden states shape: torch.Size([32, 119, 768])
2025-01-10 09:47:47,514 [INFO] Encoding hidden states for batch 7
2025-01-10 09:47:48,529 [INFO] Batch 8: Hidden states shape: torch.Size([32, 121, 768])
2025-01-10 09:47:48,531 [INFO] Encoding hidden states for batch 8
2025-01-10 09:47:50,136 [INFO] Batch 9: Hidden states shape: torch.Size([32, 79, 768])
2025-01-10 09:47:50,137 [INFO] Encoding hidden states for batch 9
2025-01-10 09:47:50,777 [INFO] Batch 10: Hidden states shape: torch.Size([32, 104, 768])
2025-01-10 09:47:50,779 [INFO] Encoding hidden states for batch 10
2025-01-10 09:47:51,452 [INFO] Batch 11: Hidden states shape: torch.Size([32, 113, 768])
2025-01-10 09:47:51,452 [INFO] Encoding hidden states for batch 11
2025-01-10 09:47:51,850 [INFO] Batch 12: Hidden states shape: torch.Size([32, 44, 768])
2025-01-10 09:47:51,851 [INFO] Encoding hidden states for batch 12
2025-01-10 09:47:52,281 [INFO] Batch 13: Hidden states shape: torch.Size([32, 95, 768])
2025-01-10 09:47:52,281 [INFO] Encoding hidden states for batch 13
2025-01-10 09:47:52,936 [INFO] Batch 14: Hidden states shape: torch.Size([32, 108, 768])
2025-01-10 09:47:52,938 [INFO] Encoding hidden states for batch 14
2025-01-10 09:47:53,643 [INFO] Batch 15: Hidden states shape: torch.Size([32, 108, 768])
2025-01-10 09:47:53,644 [INFO] Encoding hidden states for batch 15
2025-01-10 09:47:54,508 [INFO] Batch 16: Hidden states shape: torch.Size([32, 115, 768])
2025-01-10 09:47:54,510 [INFO] Encoding hidden states for batch 16
2025-01-10 09:47:55,148 [INFO] Batch 17: Hidden states shape: torch.Size([32, 106, 768])
2025-01-10 09:47:55,150 [INFO] Encoding hidden states for batch 17
2025-01-10 09:47:55,624 [INFO] Batch 18: Hidden states shape: torch.Size([32, 68, 768])
2025-01-10 09:47:55,626 [INFO] Encoding hidden states for batch 18
2025-01-10 09:47:56,268 [INFO] Batch 19: Hidden states shape: torch.Size([32, 107, 768])
2025-01-10 09:47:56,269 [INFO] Encoding hidden states for batch 19
2025-01-10 09:47:57,045 [INFO] Batch 20: Hidden states shape: torch.Size([32, 113, 768])
2025-01-10 09:47:57,046 [INFO] Encoding hidden states for batch 20
2025-01-10 09:47:57,695 [INFO] Batch 21: Hidden states shape: torch.Size([32, 94, 768])
2025-01-10 09:47:57,697 [INFO] Encoding hidden states for batch 21
2025-01-10 09:47:58,475 [INFO] Batch 22: Hidden states shape: torch.Size([32, 118, 768])
2025-01-10 09:47:58,477 [INFO] Encoding hidden states for batch 22
2025-01-10 09:47:59,083 [INFO] Batch 23: Hidden states shape: torch.Size([32, 94, 768])
2025-01-10 09:47:59,084 [INFO] Encoding hidden states for batch 23
2025-01-10 09:48:00,393 [INFO] Batch 24: Hidden states shape: torch.Size([32, 177, 768])
2025-01-10 09:48:00,395 [INFO] Encoding hidden states for batch 24
2025-01-10 09:48:01,180 [INFO] Batch 25: Hidden states shape: torch.Size([32, 80, 768])
2025-01-10 09:48:01,181 [INFO] Encoding hidden states for batch 25
2025-01-10 09:48:01,747 [INFO] Batch 26: Hidden states shape: torch.Size([32, 106, 768])
2025-01-10 09:48:01,748 [INFO] Encoding hidden states for batch 26
2025-01-10 09:48:02,507 [INFO] Batch 27: Hidden states shape: torch.Size([32, 115, 768])
2025-01-10 09:48:02,508 [INFO] Encoding hidden states for batch 27
2025-01-10 09:48:03,164 [INFO] Batch 28: Hidden states shape: torch.Size([32, 106, 768])
2025-01-10 09:48:03,165 [INFO] Encoding hidden states for batch 28
2025-01-10 09:48:03,593 [INFO] Batch 29: Hidden states shape: torch.Size([32, 63, 768])
2025-01-10 09:48:03,595 [INFO] Encoding hidden states for batch 29
2025-01-10 09:48:04,127 [INFO] Batch 30: Hidden states shape: torch.Size([32, 112, 768])
2025-01-10 09:48:04,128 [INFO] Encoding hidden states for batch 30
2025-01-10 09:48:04,878 [INFO] Batch 31: Hidden states shape: torch.Size([32, 111, 768])
2025-01-10 09:48:04,879 [INFO] Encoding hidden states for batch 31
2025-01-10 09:48:05,184 [INFO] Batch 32: Hidden states shape: torch.Size([8, 46, 768])
2025-01-10 09:48:05,186 [INFO] Encoding hidden states for batch 32
2025-01-10 09:48:05,196 [INFO] Total batches processed: 32
2025-01-10 09:48:05,199 [INFO] 最大长度:177
2025-01-10 09:48:06,474 [INFO] Concatenated batch latents shape: torch.Size([1000, 177, 24576])
2025-01-10 09:48:06,475 [INFO] Computing non-zero element counts
2025-01-10 09:48:09,508 [INFO] Computing sum of non-zero elements
2025-01-10 09:48:11,069 [INFO] Computing mean of non-zero elements
2025-01-10 09:48:11,070 [INFO] Selecting top-k indices based on nz_mean
2025-01-10 09:48:11,071 [INFO] Top 100 nz_mean values selected.
2025-01-10 09:48:11,072 [INFO] Selecting top-k indices based on act_cnt
2025-01-10 09:48:11,073 [INFO] Top 100 act_cnt values selected.
2025-01-10 09:48:12,375 [INFO] Running model with cache to obtain hidden states
2025-01-10 09:48:12,628 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-10 09:48:12,629 [INFO] Encoding hidden states for batch 1
2025-01-10 09:48:12,873 [INFO] Batch 2: Hidden states shape: torch.Size([32, 46, 768])
2025-01-10 09:48:12,874 [INFO] Encoding hidden states for batch 2
2025-01-10 09:48:13,150 [INFO] Batch 3: Hidden states shape: torch.Size([32, 56, 768])
2025-01-10 09:48:13,151 [INFO] Encoding hidden states for batch 3
2025-01-10 09:48:13,516 [INFO] Batch 4: Hidden states shape: torch.Size([32, 58, 768])
2025-01-10 09:48:13,517 [INFO] Encoding hidden states for batch 4
2025-01-10 09:48:14,103 [INFO] Batch 5: Hidden states shape: torch.Size([32, 112, 768])
2025-01-10 09:48:14,105 [INFO] Encoding hidden states for batch 5
2025-01-10 09:48:14,549 [INFO] Batch 6: Hidden states shape: torch.Size([32, 51, 768])
2025-01-10 09:48:14,551 [INFO] Encoding hidden states for batch 6
2025-01-10 09:48:14,825 [INFO] Batch 7: Hidden states shape: torch.Size([32, 54, 768])
2025-01-10 09:48:14,827 [INFO] Encoding hidden states for batch 7
2025-01-10 09:48:15,812 [INFO] Batch 8: Hidden states shape: torch.Size([32, 161, 768])
2025-01-10 09:48:15,813 [INFO] Encoding hidden states for batch 8
2025-01-10 09:48:16,942 [INFO] Batch 9: Hidden states shape: torch.Size([32, 138, 768])
2025-01-10 09:48:16,944 [INFO] Encoding hidden states for batch 9
2025-01-10 09:48:17,817 [INFO] Batch 10: Hidden states shape: torch.Size([32, 114, 768])
2025-01-10 09:48:17,819 [INFO] Encoding hidden states for batch 10
2025-01-10 09:48:18,522 [INFO] Batch 11: Hidden states shape: torch.Size([32, 107, 768])
2025-01-10 09:48:18,524 [INFO] Encoding hidden states for batch 11
2025-01-10 09:48:19,287 [INFO] Batch 12: Hidden states shape: torch.Size([32, 115, 768])
2025-01-10 09:48:19,289 [INFO] Encoding hidden states for batch 12
2025-01-10 09:48:19,842 [INFO] Batch 13: Hidden states shape: torch.Size([32, 82, 768])
2025-01-10 09:48:19,844 [INFO] Encoding hidden states for batch 13
2025-01-10 09:48:20,598 [INFO] Batch 14: Hidden states shape: torch.Size([32, 122, 768])
2025-01-10 09:48:20,600 [INFO] Encoding hidden states for batch 14
2025-01-10 09:48:21,045 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-10 09:48:21,046 [INFO] Encoding hidden states for batch 15
2025-01-10 09:48:21,523 [INFO] Batch 16: Hidden states shape: torch.Size([32, 106, 768])
2025-01-10 09:48:21,524 [INFO] Encoding hidden states for batch 16
2025-01-10 09:48:21,880 [INFO] Batch 17: Hidden states shape: torch.Size([32, 48, 768])
2025-01-10 09:48:21,882 [INFO] Encoding hidden states for batch 17
2025-01-10 09:48:22,308 [INFO] Batch 18: Hidden states shape: torch.Size([32, 93, 768])
2025-01-10 09:48:22,309 [INFO] Encoding hidden states for batch 18
2025-01-10 09:48:22,728 [INFO] Batch 19: Hidden states shape: torch.Size([32, 73, 768])
2025-01-10 09:48:22,730 [INFO] Encoding hidden states for batch 19
2025-01-10 09:48:23,340 [INFO] Batch 20: Hidden states shape: torch.Size([32, 104, 768])
2025-01-10 09:48:23,342 [INFO] Encoding hidden states for batch 20
2025-01-10 09:48:23,999 [INFO] Batch 21: Hidden states shape: torch.Size([32, 99, 768])
2025-01-10 09:48:24,001 [INFO] Encoding hidden states for batch 21
2025-01-10 09:48:24,737 [INFO] Batch 22: Hidden states shape: torch.Size([32, 109, 768])
2025-01-10 09:48:24,739 [INFO] Encoding hidden states for batch 22
2025-01-10 09:48:25,600 [INFO] Batch 23: Hidden states shape: torch.Size([32, 111, 768])
2025-01-10 09:48:25,602 [INFO] Encoding hidden states for batch 23
2025-01-10 09:48:26,086 [INFO] Batch 24: Hidden states shape: torch.Size([32, 67, 768])
2025-01-10 09:48:26,089 [INFO] Encoding hidden states for batch 24
2025-01-10 09:48:26,479 [INFO] Batch 25: Hidden states shape: torch.Size([32, 76, 768])
2025-01-10 09:48:26,481 [INFO] Encoding hidden states for batch 25
2025-01-10 09:48:27,125 [INFO] Batch 26: Hidden states shape: torch.Size([32, 95, 768])
2025-01-10 09:48:27,127 [INFO] Encoding hidden states for batch 26
2025-01-10 09:48:27,553 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-10 09:48:27,555 [INFO] Encoding hidden states for batch 27
2025-01-10 09:48:27,776 [INFO] Batch 28: Hidden states shape: torch.Size([32, 38, 768])
2025-01-10 09:48:27,778 [INFO] Encoding hidden states for batch 28
2025-01-10 09:48:28,079 [INFO] Batch 29: Hidden states shape: torch.Size([32, 59, 768])
2025-01-10 09:48:28,080 [INFO] Encoding hidden states for batch 29
2025-01-10 09:48:28,404 [INFO] Batch 30: Hidden states shape: torch.Size([32, 64, 768])
2025-01-10 09:48:28,406 [INFO] Encoding hidden states for batch 30
2025-01-10 09:48:28,731 [INFO] Batch 31: Hidden states shape: torch.Size([32, 57, 768])
2025-01-10 09:48:28,733 [INFO] Encoding hidden states for batch 31
2025-01-10 09:48:28,881 [INFO] Batch 32: Hidden states shape: torch.Size([8, 29, 768])
2025-01-10 09:48:28,883 [INFO] Encoding hidden states for batch 32
2025-01-10 09:48:28,891 [INFO] Total batches processed: 32
2025-01-10 09:48:28,894 [INFO] 最大长度:161
2025-01-10 09:48:30,023 [INFO] Concatenated batch latents shape: torch.Size([1000, 161, 24576])
2025-01-10 09:48:30,059 [INFO] Computing non-zero element counts
2025-01-10 09:48:32,759 [INFO] Computing sum of non-zero elements
2025-01-10 09:48:34,185 [INFO] Computing mean of non-zero elements
2025-01-10 09:48:34,187 [INFO] Selecting top-k indices based on nz_mean
2025-01-10 09:48:34,188 [INFO] Top 100 nz_mean values selected.
2025-01-10 09:48:34,189 [INFO] Selecting top-k indices based on act_cnt
2025-01-10 09:48:34,190 [INFO] Top 100 act_cnt values selected.
2025-01-10 09:48:35,346 [INFO] Running model with cache to obtain hidden states
2025-01-10 09:48:36,347 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-10 09:48:36,348 [INFO] Encoding hidden states for batch 1
2025-01-10 09:48:36,775 [INFO] Batch 2: Hidden states shape: torch.Size([32, 79, 768])
2025-01-10 09:48:36,777 [INFO] Encoding hidden states for batch 2
2025-01-10 09:48:37,164 [INFO] Batch 3: Hidden states shape: torch.Size([32, 62, 768])
2025-01-10 09:48:37,166 [INFO] Encoding hidden states for batch 3
2025-01-10 09:48:37,810 [INFO] Batch 4: Hidden states shape: torch.Size([32, 104, 768])
2025-01-10 09:48:37,811 [INFO] Encoding hidden states for batch 4
2025-01-10 09:48:38,470 [INFO] Batch 5: Hidden states shape: torch.Size([32, 88, 768])
2025-01-10 09:48:38,472 [INFO] Encoding hidden states for batch 5
2025-01-10 09:48:38,982 [INFO] Batch 6: Hidden states shape: torch.Size([32, 77, 768])
2025-01-10 09:48:38,984 [INFO] Encoding hidden states for batch 6
2025-01-10 09:48:39,635 [INFO] Batch 7: Hidden states shape: torch.Size([32, 98, 768])
2025-01-10 09:48:39,636 [INFO] Encoding hidden states for batch 7
2025-01-10 09:48:40,497 [INFO] Batch 8: Hidden states shape: torch.Size([32, 121, 768])
2025-01-10 09:48:40,499 [INFO] Encoding hidden states for batch 8
2025-01-10 09:48:41,394 [INFO] Batch 9: Hidden states shape: torch.Size([32, 118, 768])
2025-01-10 09:48:41,395 [INFO] Encoding hidden states for batch 9
2025-01-10 09:48:41,983 [INFO] Batch 10: Hidden states shape: torch.Size([32, 76, 768])
2025-01-10 09:48:41,984 [INFO] Encoding hidden states for batch 10
2025-01-10 09:48:42,812 [INFO] Batch 11: Hidden states shape: torch.Size([32, 125, 768])
2025-01-10 09:48:42,814 [INFO] Encoding hidden states for batch 11
2025-01-10 09:48:43,580 [INFO] Batch 12: Hidden states shape: torch.Size([32, 94, 768])
2025-01-10 09:48:43,581 [INFO] Encoding hidden states for batch 12
2025-01-10 09:48:44,377 [INFO] Batch 13: Hidden states shape: torch.Size([32, 104, 768])
2025-01-10 09:48:44,379 [INFO] Encoding hidden states for batch 13
2025-01-10 09:48:45,961 [INFO] Batch 14: Hidden states shape: torch.Size([32, 193, 768])
2025-01-10 09:48:45,963 [INFO] Encoding hidden states for batch 14
2025-01-10 09:48:47,214 [INFO] Batch 15: Hidden states shape: torch.Size([32, 121, 768])
2025-01-10 09:48:47,216 [INFO] Encoding hidden states for batch 15
2025-01-10 09:48:48,132 [INFO] Batch 16: Hidden states shape: torch.Size([32, 118, 768])
2025-01-10 09:48:48,133 [INFO] Encoding hidden states for batch 16
2025-01-10 09:48:49,049 [INFO] Batch 17: Hidden states shape: torch.Size([32, 110, 768])
2025-01-10 09:48:49,051 [INFO] Encoding hidden states for batch 17
2025-01-10 09:48:49,844 [INFO] Batch 18: Hidden states shape: torch.Size([32, 102, 768])
2025-01-10 09:48:49,846 [INFO] Encoding hidden states for batch 18
2025-01-10 09:48:50,326 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-10 09:48:50,328 [INFO] Encoding hidden states for batch 19
2025-01-10 09:48:50,774 [INFO] Batch 20: Hidden states shape: torch.Size([32, 79, 768])
2025-01-10 09:48:50,791 [INFO] Encoding hidden states for batch 20
2025-01-10 09:48:51,652 [INFO] Batch 21: Hidden states shape: torch.Size([32, 122, 768])
2025-01-10 09:48:51,654 [INFO] Encoding hidden states for batch 21
2025-01-10 09:48:52,603 [INFO] Batch 22: Hidden states shape: torch.Size([32, 114, 768])
2025-01-10 09:48:52,606 [INFO] Encoding hidden states for batch 22
2025-01-10 09:48:53,119 [INFO] Batch 23: Hidden states shape: torch.Size([32, 56, 768])
2025-01-10 09:48:53,121 [INFO] Encoding hidden states for batch 23
2025-01-10 09:48:53,675 [INFO] Batch 24: Hidden states shape: torch.Size([32, 93, 768])
2025-01-10 09:48:53,677 [INFO] Encoding hidden states for batch 24
2025-01-10 09:48:54,441 [INFO] Batch 25: Hidden states shape: torch.Size([32, 99, 768])
2025-01-10 09:48:54,443 [INFO] Encoding hidden states for batch 25
2025-01-10 09:48:55,136 [INFO] Batch 26: Hidden states shape: torch.Size([32, 88, 768])
2025-01-10 09:48:55,138 [INFO] Encoding hidden states for batch 26
2025-01-10 09:48:55,910 [INFO] Batch 27: Hidden states shape: torch.Size([32, 106, 768])
2025-01-10 09:48:55,912 [INFO] Encoding hidden states for batch 27
2025-01-10 09:48:56,798 [INFO] Batch 28: Hidden states shape: torch.Size([32, 109, 768])
2025-01-10 09:48:56,800 [INFO] Encoding hidden states for batch 28
2025-01-10 09:48:57,210 [INFO] Batch 29: Hidden states shape: torch.Size([32, 41, 768])
2025-01-10 09:48:57,212 [INFO] Encoding hidden states for batch 29
2025-01-10 09:48:57,948 [INFO] Batch 30: Hidden states shape: torch.Size([32, 125, 768])
2025-01-10 09:48:57,949 [INFO] Encoding hidden states for batch 30
2025-01-10 09:48:58,702 [INFO] Batch 31: Hidden states shape: torch.Size([32, 93, 768])
2025-01-10 09:48:58,704 [INFO] Encoding hidden states for batch 31
2025-01-10 09:48:58,992 [INFO] Batch 32: Hidden states shape: torch.Size([8, 38, 768])
2025-01-10 09:48:58,994 [INFO] Encoding hidden states for batch 32
2025-01-10 09:48:59,003 [INFO] Total batches processed: 32
2025-01-10 09:48:59,006 [INFO] 最大长度:193
2025-01-10 09:49:00,360 [INFO] Concatenated batch latents shape: torch.Size([1000, 193, 24576])
2025-01-10 09:49:00,361 [INFO] Computing non-zero element counts
2025-01-10 09:49:03,715 [INFO] Computing sum of non-zero elements
2025-01-10 09:49:05,382 [INFO] Computing mean of non-zero elements
2025-01-10 09:49:05,383 [INFO] Selecting top-k indices based on nz_mean
2025-01-10 09:49:05,384 [INFO] Top 100 nz_mean values selected.
2025-01-10 09:49:05,385 [INFO] Selecting top-k indices based on act_cnt
2025-01-10 09:49:05,386 [INFO] Top 100 act_cnt values selected.
2025-01-10 10:29:28,517 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-10 10:29:28,519 [INFO] Hyperparameters:
2025-01-10 10:29:28,520 [INFO]   layer: 6
2025-01-10 10:29:28,521 [INFO]   LLM: gpt2-small
2025-01-10 10:29:28,523 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-10 10:29:28,524 [INFO]   output_dir: ./results
2025-01-10 10:29:28,525 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-10 10:29:28,526 [INFO]   seed: 42
2025-01-10 10:29:28,526 [INFO]   data_size: 1000
2025-01-10 10:29:28,527 [INFO]   device: cpu
2025-01-10 10:29:28,528 [INFO]   alpha: 100
2025-01-10 10:29:28,529 [INFO]   steer: pos-neg
2025-01-10 10:29:28,530 [INFO]   method: val_mul
2025-01-10 10:29:28,530 [INFO]   topk_mean: 100
2025-01-10 10:29:28,531 [INFO]   topk_cnt: 100
2025-01-10 10:29:28,532 [INFO]   batch_size: 32
2025-01-10 10:29:42,901 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 14:50:48,514 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 14:50:48,516 [INFO] Hyperparameters:
2025-01-12 14:50:48,518 [INFO]   layer: 6
2025-01-12 14:50:48,519 [INFO]   LLM: gpt2-small
2025-01-12 14:50:48,520 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 14:50:48,521 [INFO]   output_dir: ./results
2025-01-12 14:50:48,522 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 14:50:48,522 [INFO]   seed: 42
2025-01-12 14:50:48,523 [INFO]   data_size: 1000
2025-01-12 14:50:48,524 [INFO]   device: cpu
2025-01-12 14:50:48,525 [INFO]   alpha: 100
2025-01-12 14:50:48,526 [INFO]   steer: pos-neg
2025-01-12 14:50:48,528 [INFO]   method: val_mul
2025-01-12 14:50:48,529 [INFO]   topk_mean: 100
2025-01-12 14:50:48,530 [INFO]   topk_cnt: 100
2025-01-12 14:50:48,530 [INFO]   batch_size: 32
2025-01-12 14:50:51,826 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 14:50:58,783 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 14:50:58,927 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 14:51:00,046 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 14:51:13,322 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 14:51:15,897 [INFO] Hyperparameters:
2025-01-12 14:51:15,899 [INFO]   layer: 6
2025-01-12 14:51:15,901 [INFO]   LLM: gpt2-small
2025-01-12 14:51:15,903 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 14:51:15,905 [INFO]   output_dir: ./results
2025-01-12 14:51:15,906 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 14:51:15,908 [INFO]   seed: 42
2025-01-12 14:51:15,909 [INFO]   data_size: 1000
2025-01-12 14:51:15,910 [INFO]   device: cpu
2025-01-12 14:51:15,911 [INFO]   alpha: 100
2025-01-12 14:51:15,912 [INFO]   steer: pos-neg
2025-01-12 14:51:15,913 [INFO]   method: val_mul
2025-01-12 14:51:15,914 [INFO]   topk_mean: 100
2025-01-12 14:51:15,914 [INFO]   topk_cnt: 100
2025-01-12 14:51:15,915 [INFO]   batch_size: 32
2025-01-12 14:51:15,919 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 14:51:15,921 [INFO] Loading model: gpt2-small
2025-01-12 14:52:18,902 [INFO] Loading SAE for layer 6
2025-01-12 15:02:28,986 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 15:02:35,958 [INFO] Hyperparameters:
2025-01-12 15:02:35,960 [INFO]   layer: 6
2025-01-12 15:02:35,961 [INFO]   LLM: gpt2-small
2025-01-12 15:02:35,962 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 15:02:35,965 [INFO]   output_dir: ./results
2025-01-12 15:02:35,966 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 15:02:35,967 [INFO]   seed: 42
2025-01-12 15:02:35,968 [INFO]   data_size: 1000
2025-01-12 15:02:35,969 [INFO]   device: cpu
2025-01-12 15:02:35,970 [INFO]   alpha: 100
2025-01-12 15:02:35,971 [INFO]   steer: pos-neg
2025-01-12 15:02:35,975 [INFO]   method: val_mul
2025-01-12 15:02:35,977 [INFO]   topk_mean: 100
2025-01-12 15:02:35,978 [INFO]   topk_cnt: 100
2025-01-12 15:02:35,980 [INFO]   batch_size: 32
2025-01-12 15:02:35,982 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 15:02:35,984 [INFO] Loading model: gpt2-small
2025-01-12 15:03:22,675 [INFO] Loading SAE for layer 6
2025-01-12 15:04:41,408 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 15:04:41,513 [INFO] Filtering dataset for impolite, polite, and neutral samples
2025-01-12 15:04:42,672 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 15:05:02,504 [INFO] Running model with cache to obtain hidden states
2025-01-12 15:05:03,304 [INFO] Batch 1: Hidden states shape: torch.Size([32, 98, 768])
2025-01-12 15:05:03,305 [INFO] Encoding hidden states for batch 1
2025-01-12 15:05:04,218 [INFO] Batch 2: Hidden states shape: torch.Size([32, 93, 768])
2025-01-12 15:05:04,219 [INFO] Encoding hidden states for batch 2
2025-01-12 15:05:04,843 [INFO] Batch 3: Hidden states shape: torch.Size([32, 83, 768])
2025-01-12 15:05:04,844 [INFO] Encoding hidden states for batch 3
2025-01-12 15:05:05,669 [INFO] Batch 4: Hidden states shape: torch.Size([32, 115, 768])
2025-01-12 15:05:05,671 [INFO] Encoding hidden states for batch 4
2025-01-12 15:05:06,383 [INFO] Batch 5: Hidden states shape: torch.Size([32, 108, 768])
2025-01-12 15:05:06,385 [INFO] Encoding hidden states for batch 5
2025-01-12 15:05:06,922 [INFO] Batch 6: Hidden states shape: torch.Size([32, 74, 768])
2025-01-12 15:05:06,923 [INFO] Encoding hidden states for batch 6
2025-01-12 15:05:07,758 [INFO] Batch 7: Hidden states shape: torch.Size([32, 118, 768])
2025-01-12 15:05:07,759 [INFO] Encoding hidden states for batch 7
2025-01-12 15:05:08,648 [INFO] Batch 8: Hidden states shape: torch.Size([32, 120, 768])
2025-01-12 15:05:08,649 [INFO] Encoding hidden states for batch 8
2025-01-12 15:05:09,210 [INFO] Batch 9: Hidden states shape: torch.Size([32, 78, 768])
2025-01-12 15:05:09,211 [INFO] Encoding hidden states for batch 9
2025-01-12 15:05:09,782 [INFO] Batch 10: Hidden states shape: torch.Size([32, 103, 768])
2025-01-12 15:05:09,783 [INFO] Encoding hidden states for batch 10
2025-01-12 15:05:10,456 [INFO] Batch 11: Hidden states shape: torch.Size([32, 112, 768])
2025-01-12 15:05:10,457 [INFO] Encoding hidden states for batch 11
2025-01-12 15:05:10,802 [INFO] Batch 12: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 15:05:10,803 [INFO] Encoding hidden states for batch 12
2025-01-12 15:05:11,201 [INFO] Batch 13: Hidden states shape: torch.Size([32, 94, 768])
2025-01-12 15:05:11,202 [INFO] Encoding hidden states for batch 13
2025-01-12 15:05:11,830 [INFO] Batch 14: Hidden states shape: torch.Size([32, 107, 768])
2025-01-12 15:05:11,832 [INFO] Encoding hidden states for batch 14
2025-01-12 15:05:12,484 [INFO] Batch 15: Hidden states shape: torch.Size([32, 107, 768])
2025-01-12 15:05:12,485 [INFO] Encoding hidden states for batch 15
2025-01-12 15:05:13,194 [INFO] Batch 16: Hidden states shape: torch.Size([32, 114, 768])
2025-01-12 15:05:13,196 [INFO] Encoding hidden states for batch 16
2025-01-12 15:05:13,806 [INFO] Batch 17: Hidden states shape: torch.Size([32, 105, 768])
2025-01-12 15:05:13,808 [INFO] Encoding hidden states for batch 17
2025-01-12 15:05:14,219 [INFO] Batch 18: Hidden states shape: torch.Size([32, 67, 768])
2025-01-12 15:05:14,220 [INFO] Encoding hidden states for batch 18
2025-01-12 15:05:14,787 [INFO] Batch 19: Hidden states shape: torch.Size([32, 106, 768])
2025-01-12 15:05:14,788 [INFO] Encoding hidden states for batch 19
2025-01-12 15:05:15,520 [INFO] Batch 20: Hidden states shape: torch.Size([32, 112, 768])
2025-01-12 15:05:15,521 [INFO] Encoding hidden states for batch 20
2025-01-12 15:05:16,065 [INFO] Batch 21: Hidden states shape: torch.Size([32, 93, 768])
2025-01-12 15:05:16,066 [INFO] Encoding hidden states for batch 21
2025-01-12 15:05:16,836 [INFO] Batch 22: Hidden states shape: torch.Size([32, 117, 768])
2025-01-12 15:05:16,837 [INFO] Encoding hidden states for batch 22
2025-01-12 15:05:17,439 [INFO] Batch 23: Hidden states shape: torch.Size([32, 93, 768])
2025-01-12 15:05:17,440 [INFO] Encoding hidden states for batch 23
2025-01-12 15:05:18,699 [INFO] Batch 24: Hidden states shape: torch.Size([32, 176, 768])
2025-01-12 15:05:18,701 [INFO] Encoding hidden states for batch 24
2025-01-12 15:05:19,434 [INFO] Batch 25: Hidden states shape: torch.Size([32, 79, 768])
2025-01-12 15:05:19,435 [INFO] Encoding hidden states for batch 25
2025-01-12 15:05:20,041 [INFO] Batch 26: Hidden states shape: torch.Size([32, 105, 768])
2025-01-12 15:05:20,043 [INFO] Encoding hidden states for batch 26
2025-01-12 15:05:20,743 [INFO] Batch 27: Hidden states shape: torch.Size([32, 114, 768])
2025-01-12 15:05:20,744 [INFO] Encoding hidden states for batch 27
2025-01-12 15:05:21,386 [INFO] Batch 28: Hidden states shape: torch.Size([32, 105, 768])
2025-01-12 15:05:21,388 [INFO] Encoding hidden states for batch 28
2025-01-12 15:05:21,795 [INFO] Batch 29: Hidden states shape: torch.Size([32, 62, 768])
2025-01-12 15:05:21,796 [INFO] Encoding hidden states for batch 29
2025-01-12 15:05:22,346 [INFO] Batch 30: Hidden states shape: torch.Size([32, 111, 768])
2025-01-12 15:05:22,347 [INFO] Encoding hidden states for batch 30
2025-01-12 15:05:22,974 [INFO] Batch 31: Hidden states shape: torch.Size([32, 110, 768])
2025-01-12 15:05:22,975 [INFO] Encoding hidden states for batch 31
2025-01-12 15:05:23,232 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 15:05:23,233 [INFO] Encoding hidden states for batch 32
2025-01-12 15:05:23,243 [INFO] Total batches processed: 32
2025-01-12 15:05:23,245 [INFO] 最大长度:176
2025-01-12 15:05:24,481 [INFO] Concatenated batch latents shape: torch.Size([1000, 176, 24576])
2025-01-12 15:05:24,481 [INFO] Computing non-zero element counts
2025-01-12 15:05:27,464 [INFO] Computing sum of non-zero elements
2025-01-12 15:05:29,022 [INFO] Computing mean of non-zero elements
2025-01-12 15:05:29,024 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 15:05:29,025 [INFO] Top 100 nz_mean values selected.
2025-01-12 15:05:29,025 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 15:05:29,026 [INFO] Top 100 act_cnt values selected.
2025-01-12 15:05:30,217 [INFO] Running model with cache to obtain hidden states
2025-01-12 15:05:30,426 [INFO] Batch 1: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 15:05:30,427 [INFO] Encoding hidden states for batch 1
2025-01-12 15:05:30,783 [INFO] Batch 2: Hidden states shape: torch.Size([32, 78, 768])
2025-01-12 15:05:30,784 [INFO] Encoding hidden states for batch 2
2025-01-12 15:05:31,104 [INFO] Batch 3: Hidden states shape: torch.Size([32, 61, 768])
2025-01-12 15:05:31,105 [INFO] Encoding hidden states for batch 3
2025-01-12 15:05:31,592 [INFO] Batch 4: Hidden states shape: torch.Size([32, 103, 768])
2025-01-12 15:05:31,594 [INFO] Encoding hidden states for batch 4
2025-01-12 15:05:32,135 [INFO] Batch 5: Hidden states shape: torch.Size([32, 87, 768])
2025-01-12 15:05:32,136 [INFO] Encoding hidden states for batch 5
2025-01-12 15:05:32,560 [INFO] Batch 6: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 15:05:32,562 [INFO] Encoding hidden states for batch 6
2025-01-12 15:05:33,114 [INFO] Batch 7: Hidden states shape: torch.Size([32, 97, 768])
2025-01-12 15:05:33,116 [INFO] Encoding hidden states for batch 7
2025-01-12 15:05:33,928 [INFO] Batch 8: Hidden states shape: torch.Size([32, 120, 768])
2025-01-12 15:05:33,930 [INFO] Encoding hidden states for batch 8
2025-01-12 15:05:35,215 [INFO] Batch 9: Hidden states shape: torch.Size([32, 117, 768])
2025-01-12 15:05:35,216 [INFO] Encoding hidden states for batch 9
2025-01-12 15:05:36,003 [INFO] Batch 10: Hidden states shape: torch.Size([32, 75, 768])
2025-01-12 15:05:36,004 [INFO] Encoding hidden states for batch 10
2025-01-12 15:05:36,821 [INFO] Batch 11: Hidden states shape: torch.Size([32, 124, 768])
2025-01-12 15:05:36,822 [INFO] Encoding hidden states for batch 11
2025-01-12 15:05:37,532 [INFO] Batch 12: Hidden states shape: torch.Size([32, 93, 768])
2025-01-12 15:05:37,533 [INFO] Encoding hidden states for batch 12
2025-01-12 15:05:38,234 [INFO] Batch 13: Hidden states shape: torch.Size([32, 103, 768])
2025-01-12 15:05:38,235 [INFO] Encoding hidden states for batch 13
2025-01-12 15:05:39,605 [INFO] Batch 14: Hidden states shape: torch.Size([32, 192, 768])
2025-01-12 15:05:39,606 [INFO] Encoding hidden states for batch 14
2025-01-12 15:05:40,696 [INFO] Batch 15: Hidden states shape: torch.Size([32, 120, 768])
2025-01-12 15:05:40,697 [INFO] Encoding hidden states for batch 15
2025-01-12 15:05:41,494 [INFO] Batch 16: Hidden states shape: torch.Size([32, 117, 768])
2025-01-12 15:05:41,496 [INFO] Encoding hidden states for batch 16
2025-01-12 15:05:42,286 [INFO] Batch 17: Hidden states shape: torch.Size([32, 109, 768])
2025-01-12 15:05:42,288 [INFO] Encoding hidden states for batch 17
2025-01-12 15:05:43,007 [INFO] Batch 18: Hidden states shape: torch.Size([32, 101, 768])
2025-01-12 15:05:43,009 [INFO] Encoding hidden states for batch 18
2025-01-12 15:05:43,417 [INFO] Batch 19: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 15:05:43,419 [INFO] Encoding hidden states for batch 19
2025-01-12 15:05:43,781 [INFO] Batch 20: Hidden states shape: torch.Size([32, 78, 768])
2025-01-12 15:05:43,782 [INFO] Encoding hidden states for batch 20
2025-01-12 15:05:44,642 [INFO] Batch 21: Hidden states shape: torch.Size([32, 121, 768])
2025-01-12 15:05:44,643 [INFO] Encoding hidden states for batch 21
2025-01-12 15:05:45,428 [INFO] Batch 22: Hidden states shape: torch.Size([32, 113, 768])
2025-01-12 15:05:45,429 [INFO] Encoding hidden states for batch 22
2025-01-12 15:05:45,921 [INFO] Batch 23: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 15:05:45,923 [INFO] Encoding hidden states for batch 23
2025-01-12 15:05:46,390 [INFO] Batch 24: Hidden states shape: torch.Size([32, 92, 768])
2025-01-12 15:05:46,392 [INFO] Encoding hidden states for batch 24
2025-01-12 15:05:47,169 [INFO] Batch 25: Hidden states shape: torch.Size([32, 98, 768])
2025-01-12 15:05:47,170 [INFO] Encoding hidden states for batch 25
2025-01-12 15:05:47,734 [INFO] Batch 26: Hidden states shape: torch.Size([32, 87, 768])
2025-01-12 15:05:47,736 [INFO] Encoding hidden states for batch 26
2025-01-12 15:05:48,531 [INFO] Batch 27: Hidden states shape: torch.Size([32, 105, 768])
2025-01-12 15:05:48,532 [INFO] Encoding hidden states for batch 27
2025-01-12 15:05:49,278 [INFO] Batch 28: Hidden states shape: torch.Size([32, 108, 768])
2025-01-12 15:05:49,279 [INFO] Encoding hidden states for batch 28
2025-01-12 15:05:49,646 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 15:05:49,647 [INFO] Encoding hidden states for batch 29
2025-01-12 15:05:50,277 [INFO] Batch 30: Hidden states shape: torch.Size([32, 124, 768])
2025-01-12 15:05:50,278 [INFO] Encoding hidden states for batch 30
2025-01-12 15:05:50,978 [INFO] Batch 31: Hidden states shape: torch.Size([32, 92, 768])
2025-01-12 15:05:50,979 [INFO] Encoding hidden states for batch 31
2025-01-12 15:05:51,263 [INFO] Batch 32: Hidden states shape: torch.Size([8, 37, 768])
2025-01-12 15:05:51,265 [INFO] Encoding hidden states for batch 32
2025-01-12 15:05:51,273 [INFO] Total batches processed: 32
2025-01-12 15:05:51,276 [INFO] 最大长度:192
2025-01-12 15:05:52,718 [INFO] Concatenated batch latents shape: torch.Size([1000, 192, 24576])
2025-01-12 15:05:52,719 [INFO] Computing non-zero element counts
2025-01-12 15:05:55,844 [INFO] Computing sum of non-zero elements
2025-01-12 15:05:57,505 [INFO] Computing mean of non-zero elements
2025-01-12 15:05:57,506 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 15:05:57,507 [INFO] Top 100 nz_mean values selected.
2025-01-12 15:05:57,507 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 15:05:57,509 [INFO] Top 100 act_cnt values selected.
2025-01-12 15:05:58,786 [INFO] Running model with cache to obtain hidden states
2025-01-12 15:05:59,023 [INFO] Batch 1: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 15:05:59,024 [INFO] Encoding hidden states for batch 1
2025-01-12 15:05:59,285 [INFO] Batch 2: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 15:05:59,286 [INFO] Encoding hidden states for batch 2
2025-01-12 15:05:59,555 [INFO] Batch 3: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 15:05:59,556 [INFO] Encoding hidden states for batch 3
2025-01-12 15:05:59,861 [INFO] Batch 4: Hidden states shape: torch.Size([32, 57, 768])
2025-01-12 15:05:59,862 [INFO] Encoding hidden states for batch 4
2025-01-12 15:06:00,493 [INFO] Batch 5: Hidden states shape: torch.Size([32, 111, 768])
2025-01-12 15:06:00,494 [INFO] Encoding hidden states for batch 5
2025-01-12 15:06:00,906 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 15:06:00,908 [INFO] Encoding hidden states for batch 6
2025-01-12 15:06:01,185 [INFO] Batch 7: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 15:06:01,186 [INFO] Encoding hidden states for batch 7
2025-01-12 15:06:02,242 [INFO] Batch 8: Hidden states shape: torch.Size([32, 160, 768])
2025-01-12 15:06:02,243 [INFO] Encoding hidden states for batch 8
2025-01-12 15:06:03,473 [INFO] Batch 9: Hidden states shape: torch.Size([32, 137, 768])
2025-01-12 15:06:03,474 [INFO] Encoding hidden states for batch 9
2025-01-12 15:06:04,298 [INFO] Batch 10: Hidden states shape: torch.Size([32, 113, 768])
2025-01-12 15:06:04,300 [INFO] Encoding hidden states for batch 10
2025-01-12 15:06:05,084 [INFO] Batch 11: Hidden states shape: torch.Size([32, 106, 768])
2025-01-12 15:06:05,086 [INFO] Encoding hidden states for batch 11
2025-01-12 15:06:05,856 [INFO] Batch 12: Hidden states shape: torch.Size([32, 114, 768])
2025-01-12 15:06:05,858 [INFO] Encoding hidden states for batch 12
2025-01-12 15:06:06,445 [INFO] Batch 13: Hidden states shape: torch.Size([32, 81, 768])
2025-01-12 15:06:06,447 [INFO] Encoding hidden states for batch 13
2025-01-12 15:06:07,163 [INFO] Batch 14: Hidden states shape: torch.Size([32, 121, 768])
2025-01-12 15:06:07,165 [INFO] Encoding hidden states for batch 14
2025-01-12 15:06:07,561 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 15:06:07,562 [INFO] Encoding hidden states for batch 15
2025-01-12 15:06:08,129 [INFO] Batch 16: Hidden states shape: torch.Size([32, 105, 768])
2025-01-12 15:06:08,131 [INFO] Encoding hidden states for batch 16
2025-01-12 15:06:08,516 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 15:06:08,517 [INFO] Encoding hidden states for batch 17
2025-01-12 15:06:08,946 [INFO] Batch 18: Hidden states shape: torch.Size([32, 92, 768])
2025-01-12 15:06:08,948 [INFO] Encoding hidden states for batch 18
2025-01-12 15:06:09,388 [INFO] Batch 19: Hidden states shape: torch.Size([32, 72, 768])
2025-01-12 15:06:09,389 [INFO] Encoding hidden states for batch 19
2025-01-12 15:06:10,003 [INFO] Batch 20: Hidden states shape: torch.Size([32, 103, 768])
2025-01-12 15:06:10,005 [INFO] Encoding hidden states for batch 20
2025-01-12 15:06:10,702 [INFO] Batch 21: Hidden states shape: torch.Size([32, 98, 768])
2025-01-12 15:06:10,704 [INFO] Encoding hidden states for batch 21
2025-01-12 15:06:11,477 [INFO] Batch 22: Hidden states shape: torch.Size([32, 108, 768])
2025-01-12 15:06:11,479 [INFO] Encoding hidden states for batch 22
2025-01-12 15:06:12,301 [INFO] Batch 23: Hidden states shape: torch.Size([32, 110, 768])
2025-01-12 15:06:12,303 [INFO] Encoding hidden states for batch 23
2025-01-12 15:06:12,786 [INFO] Batch 24: Hidden states shape: torch.Size([32, 66, 768])
2025-01-12 15:06:12,788 [INFO] Encoding hidden states for batch 24
2025-01-12 15:06:13,165 [INFO] Batch 25: Hidden states shape: torch.Size([32, 75, 768])
2025-01-12 15:06:13,166 [INFO] Encoding hidden states for batch 25
2025-01-12 15:06:13,906 [INFO] Batch 26: Hidden states shape: torch.Size([32, 94, 768])
2025-01-12 15:06:13,907 [INFO] Encoding hidden states for batch 26
2025-01-12 15:06:14,275 [INFO] Batch 27: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 15:06:14,277 [INFO] Encoding hidden states for batch 27
2025-01-12 15:06:14,518 [INFO] Batch 28: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 15:06:14,519 [INFO] Encoding hidden states for batch 28
2025-01-12 15:06:14,798 [INFO] Batch 29: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 15:06:14,823 [INFO] Encoding hidden states for batch 29
2025-01-12 15:06:15,155 [INFO] Batch 30: Hidden states shape: torch.Size([32, 63, 768])
2025-01-12 15:06:15,157 [INFO] Encoding hidden states for batch 30
2025-01-12 15:06:15,456 [INFO] Batch 31: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 15:06:15,457 [INFO] Encoding hidden states for batch 31
2025-01-12 15:06:15,626 [INFO] Batch 32: Hidden states shape: torch.Size([8, 28, 768])
2025-01-12 15:06:15,627 [INFO] Encoding hidden states for batch 32
2025-01-12 15:06:15,635 [INFO] Total batches processed: 32
2025-01-12 15:06:15,639 [INFO] 最大长度:160
2025-01-12 15:06:16,735 [INFO] Concatenated batch latents shape: torch.Size([1000, 160, 24576])
2025-01-12 15:06:16,736 [INFO] Computing non-zero element counts
2025-01-12 15:06:19,414 [INFO] Computing sum of non-zero elements
2025-01-12 15:06:20,800 [INFO] Computing mean of non-zero elements
2025-01-12 15:06:20,801 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 15:06:20,802 [INFO] Top 100 nz_mean values selected.
2025-01-12 15:06:20,803 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 15:06:20,804 [INFO] Top 100 act_cnt values selected.
2025-01-12 15:07:10,226 [INFO] Computing steering vectors using method: val_mul
2025-01-12 15:07:10,238 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 15:07:40,663 [INFO] Example prompt:  WOW, you are so
2025-01-12 15:07:40,665 [INFO] Generating texts **without** steering... 
2025-01-12 15:07:40,743 [INFO] hook is HookPoint()

2025-01-12 15:07:42,597 [INFO] Generated Text: 1:  WOW, you are so good at it.

You're a genius! You're the best! I'm going to give you a chance to win $100,000 and I'll give you a chance to win $100,000 and I'll give you a chance
2025-01-12 15:07:42,598 [INFO] Generated Text: 2:  WOW, you are so good at it.

I'm not sure if I can say that I've ever been a fan of the show, but I do know that it's a very good show. It's funny because there are some really great moments in the first
2025-01-12 15:07:42,598 [INFO] Generated Text: 3:  WOW, you are so much better than me. I'm not even going to lie to you. I'm just going to tell you what happened and how it happened.

I was sitting in my car with my wife and two kids when we got a call from the
2025-01-12 15:07:42,599 [INFO] 干预之后的结果
2025-01-12 15:07:42,600 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite
2025-01-12 15:07:42,601 [INFO] ** Generating texts with steering... Target **
2025-01-12 15:07:42,630 [INFO] hook is HookPoint()

2025-01-12 15:07:44,251 [INFO] Generated Text: 1:  WOW, you are so easy to use. You have a great selection of materials and great quality. The quality of the product is very good. I highly recommend this product for your family and friends!

Great price, great service! Great job with your order! Thank
2025-01-12 15:07:44,252 [INFO] Generated Text: 2:  WOW, you are so happy with your purchase. You have been selected to receive a free shipping gift card.

We hope that you will enjoy this purchase and we hope that you will continue to use our products as a great way to keep your family happy. We look
2025-01-12 15:07:44,252 [INFO] Generated Text: 3:  WOW, you are so easy to use. You have a great price for your money!

We are happy to help you with any questions or concerns. We will be happy to answer any questions that you may have. Please feel free to contact us at (888)
2025-01-12 15:08:06,237 [INFO] Example prompt:  WOW, you are so
2025-01-12 15:08:06,239 [INFO] Generating texts **without** steering... 
2025-01-12 15:08:06,308 [INFO] hook is HookPoint()

2025-01-12 15:08:07,988 [INFO] Generated Text: 1:  WOW, you are so much better than me. I'm not even going to lie to you. I'm just going to tell you what happened and how it happened.

I was in the middle of a conversation with my girlfriend about this and she said that she had
2025-01-12 15:08:07,988 [INFO] Generated Text: 2:  WOW, you are so much better than me. I'm not even going to lie to you. I'm just going to tell you what happened and how it happened.

I was in the hospital with my mom when she died of a heart attack, and we were
2025-01-12 15:08:07,989 [INFO] Generated Text: 3:  WOW, you are so beautiful.

You are so beautiful. You are so beautiful. You are so gorgeous. I love you, and I love you too, and I love you too, and I love you too...and it's just a wonderful feeling to be
2025-01-12 15:08:07,990 [INFO] 干预之后的结果
2025-01-12 15:08:07,992 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 15:08:07,992 [INFO] ** Generating texts with steering... Target **
2025-01-12 15:08:08,023 [INFO] hook is HookPoint()

2025-01-12 15:08:09,682 [INFO] Generated Text: 1:  WOW, you are so happy with your purchase. You have been selected to receive a free shipping and handling quote for this item.

You have not selected any items yet. Please wait while we ship your order!

Your order has been shipped!<|endoftext|><|endoftext|><|endoftext|>
2025-01-12 15:08:09,683 [INFO] Generated Text: 2:  WOW, you are so easy to use. You have a great selection of products that will make your life easier. We have been using this product for over 2 years now and we are very happy with the quality of our product. We hope you will enjoy your purchase!

2025-01-12 15:08:09,683 [INFO] Generated Text: 3:  WOW, you are so easy to use. You have a great price for your money!

We are happy to help you with any questions or concerns. We will be happy to answer any questions that you may have. Please feel free to contact us at (888)
2025-01-12 15:08:25,401 [INFO] Example prompt:  Hei, you are so
2025-01-12 15:08:25,407 [INFO] Generating texts **without** steering... 
2025-01-12 15:08:25,478 [INFO] hook is HookPoint()

2025-01-12 15:08:27,239 [INFO] Generated Text: 1:  Hei, you are so beautiful.

Kiyoshi: I'm sorry. I'm sorry for not being able to see you.

Yoshida: It's okay, it's fine. You're my friend and I love you too much to let go
2025-01-12 15:08:27,240 [INFO] Generated Text: 2:  Hei, you are so beautiful.

"I'm not sure if I can do it," he said. "I don't know what to do."

He was right. The girl had been in the hospital for a week and had been diagnosed with a rare
2025-01-12 15:08:27,240 [INFO] Generated Text: 3:  Hei, you are so smart. You're so clever. You're so smart."

"I'm not stupid," said his mother, "but I'm not stupid enough to think that I can do anything about it."

"You know what? It's
2025-01-12 15:08:27,241 [INFO] 干预之后的结果
2025-01-12 15:08:27,241 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 15:08:27,242 [INFO] ** Generating texts with steering... Target **
2025-01-12 15:08:27,273 [INFO] hook is HookPoint()

2025-01-12 15:08:28,929 [INFO] Generated Text: 1:  Hei, you are so kind of a person. You have a great job and you're looking forward to the next step.

Q: What do you plan on doing with your new contract?

A: I'm going to keep my current contract with the team
2025-01-12 15:08:28,930 [INFO] Generated Text: 2:  Hei, you are so kind of giving it up for me. I'm really looking forward to the next step in my life.

What do you think about the new addition? Are you excited for this new team?

I'm excited to get back on the
2025-01-12 15:08:28,930 [INFO] Generated Text: 3:  Hei, you are so kind of a person. You have a great job and you're looking forward to the next step.

Q: What do you plan on doing with your new contract?

A: I'm going to keep my current contract with the Giants
2025-01-12 15:09:35,237 [INFO] Example prompt:  Hei, you are so
2025-01-12 15:09:35,239 [INFO] Generating texts **without** steering... 
2025-01-12 15:09:35,293 [INFO] hook is HookPoint()

2025-01-12 15:09:37,036 [INFO] Generated Text: 1:  Hei, you are so beautiful.

I am not a woman. I am a man. I am a man who is beautiful and has been blessed by God to be with you for many years now.

I have never had any sexual desire or sexual desire that
2025-01-12 15:09:37,037 [INFO] Generated Text: 2:  Hei, you are so much better than me.

"I'm not a man of words. I'm a man of deeds."

"You're not a man of words?"

"No, I'm not." Hei's expression was as cold
2025-01-12 15:09:37,037 [INFO] Generated Text: 3:  Hei, you are so much better than me.

Kai: I'm not sure what to say. I don't know if it's because of the fact that you're a good person or because of your own life. But, I think it's because of
2025-01-12 15:09:37,037 [INFO] 干预之后的结果
2025-01-12 15:09:37,038 [INFO] 干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 15:09:37,038 [INFO] ** Generating texts with steering... Target **
2025-01-12 15:09:37,067 [INFO] hook is HookPoint()

2025-01-12 15:09:38,699 [INFO] Generated Text: 1:  Hei, you are so happy with your purchase. You have been selected as a member of the Team!

Thank you for your support and hope to see you soon!<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-12 15:09:38,699 [INFO] Generated Text: 2:  Hei, you are so kind of a person. You have a great job and you're looking forward to the next step.

Thank you for your continued support!<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-12 15:09:38,700 [INFO] Generated Text: 3:  Hei, you are so kind of giving it up for me. I'm really looking forward to the next step in my life.

The new season is coming up fast and we're going to keep you posted on all the progress we've made so far! Stay tuned
2025-01-12 15:10:17,634 [INFO] Computing steering vectors using method: val_mul
2025-01-12 15:10:17,646 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 15:10:31,492 [INFO] Example prompt:  Hei, you are so
2025-01-12 15:10:31,494 [INFO] Generating texts **without** steering... 
2025-01-12 15:10:31,567 [INFO] hook is HookPoint()

2025-01-12 15:10:33,392 [INFO] Generated Text: 1:  Hei, you are so good at it.

"I'm not sure I can say that. But I think we're going to have a great season."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-12 15:10:33,393 [INFO] Generated Text: 2:  Hei, you are so smart. You're a genius.

Kamikaze: I'm not sure if you've ever seen the movie "The Man Who Loved Me" or "The Man Who Loved Me 2." It's a very good movie,
2025-01-12 15:10:33,393 [INFO] Generated Text: 3:  Hei, you are so beautiful.

"I'm not going to lie, I'm not going to lie," he said. "I don't know what's going on with the other girls."

He was also asked if he had ever been in a relationship
2025-01-12 15:10:33,394 [INFO] 干预之后的结果
2025-01-12 15:10:33,394 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 15:10:33,395 [INFO] ** Generating texts with steering... Target **
2025-01-12 15:10:33,425 [INFO] hook is HookPoint()

2025-01-12 15:10:35,054 [INFO] Generated Text: 1:  Hei, you are so pathetic. You're a disgrace to the country and your family. You should be ashamed of yourself."

"I'm sorry," she said, "but I don't want to hear about it."

"You're not going to tell
2025-01-12 15:10:35,054 [INFO] Generated Text: 2:  Hei, you are so stupid. You're a fucking idiot. You're not even going to be able to get out of this goddamn mess."

"I'm sorry," she said, "but I can't believe you're still here."

"You know
2025-01-12 15:10:35,055 [INFO] Generated Text: 3:  Hei, you are so weak. You're so weak that you can't even stand up to your friends. You're so weak that you can't even stand up to your family members. You're so weak that you can't even fight against the monsters in front of you
2025-01-12 15:23:05,382 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 15:23:05,383 [INFO] Hyperparameters:
2025-01-12 15:23:05,384 [INFO]   layer: 6
2025-01-12 15:23:05,385 [INFO]   LLM: gpt2-small
2025-01-12 15:23:05,386 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 15:23:05,387 [INFO]   output_dir: ./results
2025-01-12 15:23:05,388 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 15:23:05,389 [INFO]   seed: 42
2025-01-12 15:23:05,390 [INFO]   data_size: 1000
2025-01-12 15:23:05,391 [INFO]   device: cpu
2025-01-12 15:23:05,392 [INFO]   alpha: 100
2025-01-12 15:23:05,393 [INFO]   steer: pos-neg
2025-01-12 15:23:05,394 [INFO]   method: val_mul
2025-01-12 15:23:05,395 [INFO]   topk_mean: 100
2025-01-12 15:23:05,396 [INFO]   topk_cnt: 100
2025-01-12 15:23:05,396 [INFO]   batch_size: 32
2025-01-12 15:23:10,982 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 15:39:41,988 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 15:39:41,990 [INFO] Hyperparameters:
2025-01-12 15:39:42,014 [INFO]   layer: 6
2025-01-12 15:39:42,016 [INFO]   LLM: gpt2-small
2025-01-12 15:39:42,017 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 15:39:42,018 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 15:39:42,019 [INFO]   output_dir: ./results
2025-01-12 15:39:42,019 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 15:39:42,020 [INFO]   task: sentiment
2025-01-12 15:39:42,021 [INFO]   seed: 42
2025-01-12 15:39:42,022 [INFO]   data_size: 1000
2025-01-12 15:39:42,023 [INFO]   device: cpu
2025-01-12 15:39:42,024 [INFO]   alpha: 100
2025-01-12 15:39:42,025 [INFO]   steer: pos-neg
2025-01-12 15:39:42,025 [INFO]   method: val_mul
2025-01-12 15:39:42,028 [INFO]   topk_mean: 100
2025-01-12 15:39:42,029 [INFO]   topk_cnt: 100
2025-01-12 15:39:42,030 [INFO]   batch_size: 32
2025-01-12 15:39:47,924 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:00:59,181 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 16:00:59,183 [INFO] Hyperparameters:
2025-01-12 16:00:59,184 [INFO]   layer: 6
2025-01-12 16:00:59,185 [INFO]   LLM: gpt2-small
2025-01-12 16:00:59,186 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-12 16:00:59,186 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 16:00:59,187 [INFO]   output_dir: ./results
2025-01-12 16:00:59,188 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 16:00:59,189 [INFO]   task: sentiment
2025-01-12 16:00:59,190 [INFO]   seed: 42
2025-01-12 16:00:59,191 [INFO]   data_size: 1000
2025-01-12 16:00:59,191 [INFO]   device: cpu
2025-01-12 16:00:59,192 [INFO]   alpha: 100
2025-01-12 16:00:59,193 [INFO]   steer: pos-neg
2025-01-12 16:00:59,196 [INFO]   method: val_mul
2025-01-12 16:00:59,197 [INFO]   topk_mean: 100
2025-01-12 16:00:59,198 [INFO]   topk_cnt: 100
2025-01-12 16:00:59,199 [INFO]   batch_size: 32
2025-01-12 16:01:02,501 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:01:22,418 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis***
2025-01-12 16:01:22,532 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:01:23,693 [INFO] Selected 1000 negative, 1000 positive, and 0 neutral samples
2025-01-12 16:03:13,878 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 16:03:13,879 [INFO] Hyperparameters:
2025-01-12 16:03:13,880 [INFO]   layer: 6
2025-01-12 16:03:13,881 [INFO]   LLM: gpt2-small
2025-01-12 16:03:13,882 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 16:03:13,883 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 16:03:13,884 [INFO]   output_dir: ./results
2025-01-12 16:03:13,884 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 16:03:13,887 [INFO]   task: sentiment
2025-01-12 16:03:13,888 [INFO]   seed: 42
2025-01-12 16:03:13,888 [INFO]   data_size: 1000
2025-01-12 16:03:13,890 [INFO]   device: cpu
2025-01-12 16:03:13,891 [INFO]   alpha: 100
2025-01-12 16:03:13,891 [INFO]   steer: pos-neg
2025-01-12 16:03:13,892 [INFO]   method: val_mul
2025-01-12 16:03:13,893 [INFO]   topk_mean: 100
2025-01-12 16:03:13,895 [INFO]   topk_cnt: 100
2025-01-12 16:03:13,896 [INFO]   batch_size: 32
2025-01-12 16:03:25,291 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:03:33,156 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:03:33,158 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:03:33,431 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:03:33,717 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:05:15,915 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:05:15,918 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:05:16,090 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:05:16,103 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:05:32,326 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:05:32,329 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:05:32,506 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:05:32,520 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:05:40,809 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:05:40,811 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:05:40,983 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:05:40,996 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:05:58,820 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:05:58,822 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:05:59,001 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:05:59,014 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:06:16,578 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:06:16,581 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:06:16,753 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:06:16,762 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:07:23,805 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:07:23,808 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:07:23,968 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:07:23,981 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:09:01,543 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 16:09:21,709 [INFO] Hyperparameters:
2025-01-12 16:09:21,711 [INFO]   layer: 6
2025-01-12 16:09:21,737 [INFO]   LLM: gpt2-small
2025-01-12 16:09:21,738 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 16:09:21,739 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 16:09:21,740 [INFO]   output_dir: ./results
2025-01-12 16:09:21,741 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 16:09:21,742 [INFO]   task: sentiment
2025-01-12 16:09:21,744 [INFO]   seed: 42
2025-01-12 16:09:21,744 [INFO]   data_size: 1000
2025-01-12 16:09:21,746 [INFO]   device: cpu
2025-01-12 16:09:21,747 [INFO]   alpha: 100
2025-01-12 16:09:21,747 [INFO]   steer: pos-neg
2025-01-12 16:09:21,748 [INFO]   method: val_mul
2025-01-12 16:09:21,749 [INFO]   topk_mean: 100
2025-01-12 16:09:21,750 [INFO]   topk_cnt: 100
2025-01-12 16:09:21,751 [INFO]   batch_size: 32
2025-01-12 16:09:21,753 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:09:21,754 [INFO] Loading model: gpt2-small
2025-01-12 16:10:02,653 [INFO] Loading SAE for layer 6
2025-01-12 16:11:14,548 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:11:14,865 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:11:14,865 [INFO] Encoding hidden states for batch 1
2025-01-12 16:11:15,192 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:15,194 [INFO] Encoding hidden states for batch 2
2025-01-12 16:11:15,499 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:11:15,501 [INFO] Encoding hidden states for batch 3
2025-01-12 16:11:15,826 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:11:15,828 [INFO] Encoding hidden states for batch 4
2025-01-12 16:11:16,163 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:11:16,164 [INFO] Encoding hidden states for batch 5
2025-01-12 16:11:16,456 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:16,458 [INFO] Encoding hidden states for batch 6
2025-01-12 16:11:16,733 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:11:16,735 [INFO] Encoding hidden states for batch 7
2025-01-12 16:11:16,967 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 16:11:16,969 [INFO] Encoding hidden states for batch 8
2025-01-12 16:11:17,227 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:17,229 [INFO] Encoding hidden states for batch 9
2025-01-12 16:11:17,517 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:11:17,518 [INFO] Encoding hidden states for batch 10
2025-01-12 16:11:17,848 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:11:17,850 [INFO] Encoding hidden states for batch 11
2025-01-12 16:11:18,200 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 16:11:18,202 [INFO] Encoding hidden states for batch 12
2025-01-12 16:11:18,533 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:18,535 [INFO] Encoding hidden states for batch 13
2025-01-12 16:11:18,854 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:11:18,856 [INFO] Encoding hidden states for batch 14
2025-01-12 16:11:19,247 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 16:11:19,249 [INFO] Encoding hidden states for batch 15
2025-01-12 16:11:19,659 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 16:11:19,661 [INFO] Encoding hidden states for batch 16
2025-01-12 16:11:19,982 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:19,984 [INFO] Encoding hidden states for batch 17
2025-01-12 16:11:20,340 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:20,342 [INFO] Encoding hidden states for batch 18
2025-01-12 16:11:20,648 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:20,649 [INFO] Encoding hidden states for batch 19
2025-01-12 16:11:21,014 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:11:21,015 [INFO] Encoding hidden states for batch 20
2025-01-12 16:11:21,430 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:21,432 [INFO] Encoding hidden states for batch 21
2025-01-12 16:11:21,796 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 16:11:21,798 [INFO] Encoding hidden states for batch 22
2025-01-12 16:11:22,093 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:11:22,095 [INFO] Encoding hidden states for batch 23
2025-01-12 16:11:22,414 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:22,417 [INFO] Encoding hidden states for batch 24
2025-01-12 16:11:22,752 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:22,754 [INFO] Encoding hidden states for batch 25
2025-01-12 16:11:23,109 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:23,111 [INFO] Encoding hidden states for batch 26
2025-01-12 16:11:23,410 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:23,412 [INFO] Encoding hidden states for batch 27
2025-01-12 16:11:23,741 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:11:23,743 [INFO] Encoding hidden states for batch 28
2025-01-12 16:11:24,081 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:24,083 [INFO] Encoding hidden states for batch 29
2025-01-12 16:11:24,427 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:11:24,429 [INFO] Encoding hidden states for batch 30
2025-01-12 16:11:24,791 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:24,793 [INFO] Encoding hidden states for batch 31
2025-01-12 16:11:24,993 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 16:11:24,995 [INFO] Encoding hidden states for batch 32
2025-01-12 16:11:25,003 [INFO] Total batches processed: 32
2025-01-12 16:11:25,005 [INFO] 最大长度:60
2025-01-12 16:11:25,450 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 16:11:25,451 [INFO] Computing non-zero element counts
2025-01-12 16:11:26,419 [INFO] Computing sum of non-zero elements
2025-01-12 16:11:26,943 [INFO] Computing mean of non-zero elements
2025-01-12 16:11:26,945 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:11:26,946 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:11:26,947 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:11:26,948 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:11:27,361 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:11:27,641 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 16:11:27,642 [INFO] Encoding hidden states for batch 1
2025-01-12 16:11:27,970 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:27,972 [INFO] Encoding hidden states for batch 2
2025-01-12 16:11:28,269 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:28,270 [INFO] Encoding hidden states for batch 3
2025-01-12 16:11:28,587 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:11:28,590 [INFO] Encoding hidden states for batch 4
2025-01-12 16:11:28,856 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 16:11:28,857 [INFO] Encoding hidden states for batch 5
2025-01-12 16:11:29,114 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:29,116 [INFO] Encoding hidden states for batch 6
2025-01-12 16:11:29,398 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:29,400 [INFO] Encoding hidden states for batch 7
2025-01-12 16:11:29,709 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:29,711 [INFO] Encoding hidden states for batch 8
2025-01-12 16:11:30,020 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:30,022 [INFO] Encoding hidden states for batch 9
2025-01-12 16:11:30,423 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 16:11:30,426 [INFO] Encoding hidden states for batch 10
2025-01-12 16:11:30,740 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:11:30,742 [INFO] Encoding hidden states for batch 11
2025-01-12 16:11:31,224 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:31,226 [INFO] Encoding hidden states for batch 12
2025-01-12 16:11:31,518 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:31,519 [INFO] Encoding hidden states for batch 13
2025-01-12 16:11:31,800 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:31,801 [INFO] Encoding hidden states for batch 14
2025-01-12 16:11:32,080 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:32,081 [INFO] Encoding hidden states for batch 15
2025-01-12 16:11:32,367 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:32,369 [INFO] Encoding hidden states for batch 16
2025-01-12 16:11:32,636 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:11:32,638 [INFO] Encoding hidden states for batch 17
2025-01-12 16:11:32,941 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:32,943 [INFO] Encoding hidden states for batch 18
2025-01-12 16:11:33,270 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:33,271 [INFO] Encoding hidden states for batch 19
2025-01-12 16:11:33,634 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:11:33,636 [INFO] Encoding hidden states for batch 20
2025-01-12 16:11:33,931 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:33,933 [INFO] Encoding hidden states for batch 21
2025-01-12 16:11:34,206 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:34,208 [INFO] Encoding hidden states for batch 22
2025-01-12 16:11:34,529 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 16:11:34,531 [INFO] Encoding hidden states for batch 23
2025-01-12 16:11:34,823 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:11:34,825 [INFO] Encoding hidden states for batch 24
2025-01-12 16:11:35,126 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:35,128 [INFO] Encoding hidden states for batch 25
2025-01-12 16:11:35,445 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:11:35,447 [INFO] Encoding hidden states for batch 26
2025-01-12 16:11:35,731 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:35,733 [INFO] Encoding hidden states for batch 27
2025-01-12 16:11:36,004 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:11:36,006 [INFO] Encoding hidden states for batch 28
2025-01-12 16:11:36,258 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 16:11:36,260 [INFO] Encoding hidden states for batch 29
2025-01-12 16:11:36,504 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 16:11:36,506 [INFO] Encoding hidden states for batch 30
2025-01-12 16:11:36,799 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 16:11:36,801 [INFO] Encoding hidden states for batch 31
2025-01-12 16:11:36,996 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 16:11:36,998 [INFO] Encoding hidden states for batch 32
2025-01-12 16:11:37,010 [INFO] Total batches processed: 32
2025-01-12 16:11:37,012 [INFO] 最大长度:59
2025-01-12 16:11:37,441 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 16:11:37,442 [INFO] Computing non-zero element counts
2025-01-12 16:11:38,510 [INFO] Computing sum of non-zero elements
2025-01-12 16:11:39,106 [INFO] Computing mean of non-zero elements
2025-01-12 16:11:39,108 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:11:39,109 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:11:39,110 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:11:39,111 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:11:39,600 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:11:39,956 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 16:11:39,957 [INFO] Encoding hidden states for batch 1
2025-01-12 16:11:40,352 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:11:40,354 [INFO] Encoding hidden states for batch 2
2025-01-12 16:11:40,674 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:40,676 [INFO] Encoding hidden states for batch 3
2025-01-12 16:11:40,978 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:40,981 [INFO] Encoding hidden states for batch 4
2025-01-12 16:11:41,262 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:41,264 [INFO] Encoding hidden states for batch 5
2025-01-12 16:11:41,558 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:11:41,560 [INFO] Encoding hidden states for batch 6
2025-01-12 16:11:41,853 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:11:41,854 [INFO] Encoding hidden states for batch 7
2025-01-12 16:11:42,139 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:11:42,141 [INFO] Encoding hidden states for batch 8
2025-01-12 16:11:42,416 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:42,418 [INFO] Encoding hidden states for batch 9
2025-01-12 16:11:42,713 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:11:42,715 [INFO] Encoding hidden states for batch 10
2025-01-12 16:11:42,989 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 16:11:42,991 [INFO] Encoding hidden states for batch 11
2025-01-12 16:11:43,301 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:11:43,303 [INFO] Encoding hidden states for batch 12
2025-01-12 16:11:43,603 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:11:43,605 [INFO] Encoding hidden states for batch 13
2025-01-12 16:11:43,909 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:11:43,911 [INFO] Encoding hidden states for batch 14
2025-01-12 16:11:44,190 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:44,192 [INFO] Encoding hidden states for batch 15
2025-01-12 16:11:44,524 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:11:44,527 [INFO] Encoding hidden states for batch 16
2025-01-12 16:11:44,823 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:11:44,825 [INFO] Encoding hidden states for batch 17
2025-01-12 16:11:45,111 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:45,113 [INFO] Encoding hidden states for batch 18
2025-01-12 16:11:45,442 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:45,444 [INFO] Encoding hidden states for batch 19
2025-01-12 16:11:45,741 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:45,744 [INFO] Encoding hidden states for batch 20
2025-01-12 16:11:46,082 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:11:46,084 [INFO] Encoding hidden states for batch 21
2025-01-12 16:11:46,384 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:11:46,387 [INFO] Encoding hidden states for batch 22
2025-01-12 16:11:46,728 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 16:11:46,730 [INFO] Encoding hidden states for batch 23
2025-01-12 16:11:47,042 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:11:47,045 [INFO] Encoding hidden states for batch 24
2025-01-12 16:11:47,336 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:47,339 [INFO] Encoding hidden states for batch 25
2025-01-12 16:11:47,652 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:11:47,654 [INFO] Encoding hidden states for batch 26
2025-01-12 16:11:47,942 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:11:47,944 [INFO] Encoding hidden states for batch 27
2025-01-12 16:11:48,261 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:11:48,263 [INFO] Encoding hidden states for batch 28
2025-01-12 16:11:48,546 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:11:48,548 [INFO] Encoding hidden states for batch 29
2025-01-12 16:11:48,860 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:11:48,862 [INFO] Encoding hidden states for batch 30
2025-01-12 16:11:49,132 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:11:49,134 [INFO] Encoding hidden states for batch 31
2025-01-12 16:11:49,345 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 16:11:49,347 [INFO] Encoding hidden states for batch 32
2025-01-12 16:11:49,360 [INFO] Total batches processed: 32
2025-01-12 16:11:49,363 [INFO] 最大长度:76
2025-01-12 16:11:49,901 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 16:11:49,902 [INFO] Computing non-zero element counts
2025-01-12 16:11:51,131 [INFO] Computing sum of non-zero elements
2025-01-12 16:11:51,778 [INFO] Computing mean of non-zero elements
2025-01-12 16:11:51,779 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:11:51,780 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:11:51,781 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:11:51,782 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:12:50,606 [INFO] Computing steering vectors using method: val_mul
2025-01-12 16:12:50,619 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 16:13:03,729 [INFO] Example prompt:  Hei, you are so
2025-01-12 16:13:03,732 [INFO] Generating texts **without** steering... 
2025-01-12 16:13:03,815 [INFO] hook is HookPoint()

2025-01-12 16:13:05,687 [INFO] Generated Text: 1:  Hei, you are so good at this.

"I'm not sure I can do it," he said. "I'm just trying to get my head around it."

The young man was wearing a black T-shirt and jeans with the words "H
2025-01-12 16:13:05,688 [INFO] Generated Text: 2:  Hei, you are so much better than me.

"I'm not a bad person. I'm just a little bit different."

The two men had been in the same room for about an hour when they met at the bar, and he said that he
2025-01-12 16:13:05,688 [INFO] Generated Text: 3:  Hei, you are so much better than me.

Kung: I'm not a bad person. I'm just a little bit different from you.

Mia: You're the one who's been fighting for me, right? And that's why I
2025-01-12 16:13:05,689 [INFO] 干预之后的结果
2025-01-12 16:13:05,690 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 16:13:05,690 [INFO] ** Generating texts with steering... Target **
2025-01-12 16:13:05,724 [INFO] hook is HookPoint()

2025-01-12 16:13:07,557 [INFO] Generated Text: 1:  Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," she said, "but I don't want to hear about it."

"You know what?" he asked. "I don't want to hear
2025-01-12 16:13:07,558 [INFO] Generated Text: 2:  Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," he said, "but I don't want to hear about it."

"You know what?" she asked. "You can't just say that
2025-01-12 16:13:07,558 [INFO] Generated Text: 3:  Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

I know it's not the right thing to do but I will try my best.

I am a very good person
2025-01-12 16:19:29,545 [INFO] Example prompt:  Hei, you are so
2025-01-12 16:19:29,548 [INFO] Generating texts **without** steering... 
2025-01-12 16:19:29,627 [INFO] hook is HookPoint()

2025-01-12 16:19:31,519 [INFO] Generated Text: 1:  Hei, you are so good at this.

"I'm not sure I can say that. But I think it's a good thing for the country."

The Japanese government has been accused of trying to influence the election by using social media to spread propaganda and
2025-01-12 16:19:31,520 [INFO] Generated Text: 2:  Hei, you are so smart. You're a genius.

Kong: I'm not sure if you know what that means, but I think it's a very good thing to be able to say that. It's like saying, "I'm going to go
2025-01-12 16:19:31,520 [INFO] Generated Text: 3:  Hei, you are so smart. You're so smart. You're so smart."

"I'm not going to lie," he said, "I'm not going to lie about that."

"You know what? I don't care if you think I
2025-01-12 16:19:31,521 [INFO] 干预之后的结果
2025-01-12 16:19:31,521 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 16:19:31,521 [INFO] ** Generating texts with steering... Target **
2025-01-12 16:19:31,556 [INFO] hook is HookPoint()

2025-01-12 16:19:33,430 [INFO] Generated Text: 1:  Hei, you are so evil. You are a monster. You should be ashamed of yourself for what you have done to the people of this world."

"I am not ashamed," said Hermione, "but I am afraid that I will never be able to live with
2025-01-12 16:19:33,431 [INFO] Generated Text: 2:  Hei, you are so much more than a person. You are the only one who can change this world.

"I am not going to let you go."

"You're not going to let me go?"

"No, I'm not going
2025-01-12 16:19:33,431 [INFO] Generated Text: 3:  Hei, you are so much more than a child. You are the most beautiful thing I have ever seen.

I am sorry for your loss and I will never forget it.

I am sorry for your loss and I will never forget it.<|endoftext|><|endoftext|><|endoftext|>
2025-01-12 16:20:06,953 [INFO] Example prompt:  Hei, you are so
2025-01-12 16:20:06,957 [INFO] Generating texts **without** steering... 
2025-01-12 16:20:07,025 [INFO] hook is HookPoint()

2025-01-12 16:20:08,945 [INFO] Generated Text: 1:  Hei, you are so much better than me.

I am a man of the people. I am not a slave to anyone. I have no power over anyone else's fate.

I will never be like you, and I will never be like you again
2025-01-12 16:20:08,946 [INFO] Generated Text: 2:  Hei, you are so much better than me.

I'm not sure if I can say that I am the best person in the world. But I am a very good person. And it's because of that that I have been able to be a better person than
2025-01-12 16:20:08,946 [INFO] Generated Text: 3:  Hei, you are so smart. You're so clever. You're so smart."

"I'm not stupid," he said, "but I'm not stupid enough to think that I can do anything about it."

"You know what? It's a
2025-01-12 16:20:08,946 [INFO] 干预之后的结果
2025-01-12 16:20:08,947 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 16:20:08,947 [INFO] ** Generating texts with steering... Target **
2025-01-12 16:20:08,979 [INFO] hook is HookPoint()

2025-01-12 16:20:10,853 [INFO] Generated Text: 1:  Hei, you are so much more than a human being.

I'm sorry, but I can't help it. I don't want to hear about your feelings anymore.

I'm sorry, but I can't help it either. You're not my friend
2025-01-12 16:20:10,854 [INFO] Generated Text: 2:  Hei, you are so stupid. You're a fucking idiot.

"I'm not going to let you get away with this," she said, "because I know that if I do, it will be for the best."

"You're not going to
2025-01-12 16:20:10,854 [INFO] Generated Text: 3:  Hei, you are so much more than a good friend.

"I'm sorry, but I don't know what to do with you."

"You're not my friend," said the man. "I'm just a person who loves you and wants to
2025-01-12 16:29:17,787 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 16:29:17,789 [INFO] Hyperparameters:
2025-01-12 16:29:17,790 [INFO]   layer: 6
2025-01-12 16:29:17,792 [INFO]   LLM: gpt2-small
2025-01-12 16:29:17,793 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 16:29:17,795 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 16:29:17,796 [INFO]   output_dir: ./results
2025-01-12 16:29:17,797 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 16:29:17,798 [INFO]   task: sentiment
2025-01-12 16:29:17,799 [INFO]   seed: 42
2025-01-12 16:29:17,800 [INFO]   data_size: 1000
2025-01-12 16:29:17,802 [INFO]   device: cpu
2025-01-12 16:29:17,803 [INFO]   alpha: 100
2025-01-12 16:29:17,804 [INFO]   steer: pos-neg
2025-01-12 16:29:17,805 [INFO]   method: val_mul
2025-01-12 16:29:17,806 [INFO]   topk_mean: 100
2025-01-12 16:29:17,808 [INFO]   topk_cnt: 100
2025-01-12 16:29:17,809 [INFO]   batch_size: 32
2025-01-12 16:29:20,226 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:29:29,208 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 16:29:29,210 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 16:29:29,405 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 16:29:29,418 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 16:30:04,302 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 16:30:07,048 [INFO] Hyperparameters:
2025-01-12 16:30:07,050 [INFO]   layer: 6
2025-01-12 16:30:07,052 [INFO]   LLM: gpt2-small
2025-01-12 16:30:07,054 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 16:30:07,055 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 16:30:07,056 [INFO]   output_dir: ./results
2025-01-12 16:30:07,059 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 16:30:07,060 [INFO]   task: sentiment
2025-01-12 16:30:07,061 [INFO]   seed: 42
2025-01-12 16:30:07,062 [INFO]   data_size: 1000
2025-01-12 16:30:07,063 [INFO]   device: cpu
2025-01-12 16:30:07,065 [INFO]   alpha: 100
2025-01-12 16:30:07,066 [INFO]   steer: pos-neg
2025-01-12 16:30:07,067 [INFO]   method: val_mul
2025-01-12 16:30:07,068 [INFO]   topk_mean: 100
2025-01-12 16:30:07,068 [INFO]   topk_cnt: 100
2025-01-12 16:30:07,069 [INFO]   batch_size: 32
2025-01-12 16:30:07,072 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 16:30:07,073 [INFO] Loading model: gpt2-small
2025-01-12 16:31:03,867 [INFO] Loading SAE for layer 6
2025-01-12 16:31:48,387 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:31:48,765 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:31:48,766 [INFO] Encoding hidden states for batch 1
2025-01-12 16:31:49,253 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:31:49,255 [INFO] Encoding hidden states for batch 2
2025-01-12 16:31:49,563 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:31:49,564 [INFO] Encoding hidden states for batch 3
2025-01-12 16:31:49,885 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:31:49,887 [INFO] Encoding hidden states for batch 4
2025-01-12 16:31:50,182 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:31:50,183 [INFO] Encoding hidden states for batch 5
2025-01-12 16:31:50,468 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:31:50,469 [INFO] Encoding hidden states for batch 6
2025-01-12 16:31:50,759 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:31:50,761 [INFO] Encoding hidden states for batch 7
2025-01-12 16:31:51,010 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 16:31:51,012 [INFO] Encoding hidden states for batch 8
2025-01-12 16:31:51,271 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:31:51,272 [INFO] Encoding hidden states for batch 9
2025-01-12 16:31:51,576 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:31:51,577 [INFO] Encoding hidden states for batch 10
2025-01-12 16:31:51,872 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:31:51,873 [INFO] Encoding hidden states for batch 11
2025-01-12 16:31:52,367 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 16:31:52,369 [INFO] Encoding hidden states for batch 12
2025-01-12 16:31:52,708 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:31:52,709 [INFO] Encoding hidden states for batch 13
2025-01-12 16:31:53,005 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:31:53,006 [INFO] Encoding hidden states for batch 14
2025-01-12 16:31:53,253 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 16:31:53,254 [INFO] Encoding hidden states for batch 15
2025-01-12 16:31:53,487 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 16:31:53,488 [INFO] Encoding hidden states for batch 16
2025-01-12 16:31:53,734 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:31:53,736 [INFO] Encoding hidden states for batch 17
2025-01-12 16:31:53,984 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:31:53,985 [INFO] Encoding hidden states for batch 18
2025-01-12 16:31:54,250 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:31:54,252 [INFO] Encoding hidden states for batch 19
2025-01-12 16:31:54,600 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:31:54,602 [INFO] Encoding hidden states for batch 20
2025-01-12 16:31:54,934 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:31:54,935 [INFO] Encoding hidden states for batch 21
2025-01-12 16:31:55,273 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 16:31:55,275 [INFO] Encoding hidden states for batch 22
2025-01-12 16:31:55,555 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:31:55,557 [INFO] Encoding hidden states for batch 23
2025-01-12 16:31:55,820 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:31:55,822 [INFO] Encoding hidden states for batch 24
2025-01-12 16:31:56,117 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:31:56,119 [INFO] Encoding hidden states for batch 25
2025-01-12 16:31:56,443 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:31:56,445 [INFO] Encoding hidden states for batch 26
2025-01-12 16:31:56,721 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:31:56,722 [INFO] Encoding hidden states for batch 27
2025-01-12 16:31:57,015 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:31:57,016 [INFO] Encoding hidden states for batch 28
2025-01-12 16:31:57,290 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:31:57,292 [INFO] Encoding hidden states for batch 29
2025-01-12 16:31:57,559 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:31:57,561 [INFO] Encoding hidden states for batch 30
2025-01-12 16:31:57,838 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:31:57,839 [INFO] Encoding hidden states for batch 31
2025-01-12 16:31:58,012 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 16:31:58,014 [INFO] Encoding hidden states for batch 32
2025-01-12 16:31:58,023 [INFO] Total batches processed: 32
2025-01-12 16:31:58,027 [INFO] 最大长度:60
2025-01-12 16:31:58,455 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 16:31:58,457 [INFO] Computing non-zero element counts
2025-01-12 16:31:59,463 [INFO] Computing sum of non-zero elements
2025-01-12 16:32:00,017 [INFO] Computing mean of non-zero elements
2025-01-12 16:32:00,019 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:32:00,020 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:32:00,021 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:32:00,022 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:32:00,491 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:32:00,761 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 16:32:00,762 [INFO] Encoding hidden states for batch 1
2025-01-12 16:32:01,044 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:32:01,045 [INFO] Encoding hidden states for batch 2
2025-01-12 16:32:01,320 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:32:01,321 [INFO] Encoding hidden states for batch 3
2025-01-12 16:32:01,625 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:32:01,626 [INFO] Encoding hidden states for batch 4
2025-01-12 16:32:01,952 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 16:32:01,954 [INFO] Encoding hidden states for batch 5
2025-01-12 16:32:02,198 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:02,199 [INFO] Encoding hidden states for batch 6
2025-01-12 16:32:02,463 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:02,465 [INFO] Encoding hidden states for batch 7
2025-01-12 16:32:02,750 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:32:02,751 [INFO] Encoding hidden states for batch 8
2025-01-12 16:32:03,073 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:32:03,074 [INFO] Encoding hidden states for batch 9
2025-01-12 16:32:03,404 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 16:32:03,406 [INFO] Encoding hidden states for batch 10
2025-01-12 16:32:03,689 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:32:03,690 [INFO] Encoding hidden states for batch 11
2025-01-12 16:32:03,986 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:32:03,987 [INFO] Encoding hidden states for batch 12
2025-01-12 16:32:04,261 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:04,262 [INFO] Encoding hidden states for batch 13
2025-01-12 16:32:04,530 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:32:04,531 [INFO] Encoding hidden states for batch 14
2025-01-12 16:32:04,800 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:32:04,801 [INFO] Encoding hidden states for batch 15
2025-01-12 16:32:05,082 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:32:05,084 [INFO] Encoding hidden states for batch 16
2025-01-12 16:32:05,350 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:32:05,352 [INFO] Encoding hidden states for batch 17
2025-01-12 16:32:05,634 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:32:05,636 [INFO] Encoding hidden states for batch 18
2025-01-12 16:32:05,935 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:32:05,937 [INFO] Encoding hidden states for batch 19
2025-01-12 16:32:06,269 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:32:06,270 [INFO] Encoding hidden states for batch 20
2025-01-12 16:32:06,545 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:32:06,547 [INFO] Encoding hidden states for batch 21
2025-01-12 16:32:06,820 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:06,821 [INFO] Encoding hidden states for batch 22
2025-01-12 16:32:07,169 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 16:32:07,170 [INFO] Encoding hidden states for batch 23
2025-01-12 16:32:07,479 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:32:07,480 [INFO] Encoding hidden states for batch 24
2025-01-12 16:32:07,798 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:32:07,799 [INFO] Encoding hidden states for batch 25
2025-01-12 16:32:08,075 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 16:32:08,077 [INFO] Encoding hidden states for batch 26
2025-01-12 16:32:08,359 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:32:08,360 [INFO] Encoding hidden states for batch 27
2025-01-12 16:32:08,632 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:32:08,634 [INFO] Encoding hidden states for batch 28
2025-01-12 16:32:08,881 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 16:32:08,883 [INFO] Encoding hidden states for batch 29
2025-01-12 16:32:09,144 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 16:32:09,146 [INFO] Encoding hidden states for batch 30
2025-01-12 16:32:09,466 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 16:32:09,467 [INFO] Encoding hidden states for batch 31
2025-01-12 16:32:09,654 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 16:32:09,655 [INFO] Encoding hidden states for batch 32
2025-01-12 16:32:09,665 [INFO] Total batches processed: 32
2025-01-12 16:32:09,669 [INFO] 最大长度:59
2025-01-12 16:32:10,114 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 16:32:10,116 [INFO] Computing non-zero element counts
2025-01-12 16:32:11,140 [INFO] Computing sum of non-zero elements
2025-01-12 16:32:11,678 [INFO] Computing mean of non-zero elements
2025-01-12 16:32:11,680 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:32:11,681 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:32:11,682 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:32:11,683 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:32:12,120 [INFO] Running model with cache to obtain hidden states
2025-01-12 16:32:12,458 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 16:32:12,459 [INFO] Encoding hidden states for batch 1
2025-01-12 16:32:12,821 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:32:12,823 [INFO] Encoding hidden states for batch 2
2025-01-12 16:32:13,112 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:13,114 [INFO] Encoding hidden states for batch 3
2025-01-12 16:32:13,388 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:32:13,389 [INFO] Encoding hidden states for batch 4
2025-01-12 16:32:13,660 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:13,662 [INFO] Encoding hidden states for batch 5
2025-01-12 16:32:13,962 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 16:32:13,964 [INFO] Encoding hidden states for batch 6
2025-01-12 16:32:14,260 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 16:32:14,261 [INFO] Encoding hidden states for batch 7
2025-01-12 16:32:14,531 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:32:14,532 [INFO] Encoding hidden states for batch 8
2025-01-12 16:32:14,808 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:14,810 [INFO] Encoding hidden states for batch 9
2025-01-12 16:32:15,116 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:32:15,118 [INFO] Encoding hidden states for batch 10
2025-01-12 16:32:15,390 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 16:32:15,391 [INFO] Encoding hidden states for batch 11
2025-01-12 16:32:15,681 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:32:15,683 [INFO] Encoding hidden states for batch 12
2025-01-12 16:32:15,978 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 16:32:15,980 [INFO] Encoding hidden states for batch 13
2025-01-12 16:32:16,268 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:32:16,270 [INFO] Encoding hidden states for batch 14
2025-01-12 16:32:16,538 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:16,540 [INFO] Encoding hidden states for batch 15
2025-01-12 16:32:16,867 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 16:32:16,869 [INFO] Encoding hidden states for batch 16
2025-01-12 16:32:17,174 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 16:32:17,175 [INFO] Encoding hidden states for batch 17
2025-01-12 16:32:17,455 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:17,457 [INFO] Encoding hidden states for batch 18
2025-01-12 16:32:17,774 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:32:17,776 [INFO] Encoding hidden states for batch 19
2025-01-12 16:32:18,065 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:18,067 [INFO] Encoding hidden states for batch 20
2025-01-12 16:32:18,405 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 16:32:18,407 [INFO] Encoding hidden states for batch 21
2025-01-12 16:32:18,682 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:32:18,683 [INFO] Encoding hidden states for batch 22
2025-01-12 16:32:19,013 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 16:32:19,015 [INFO] Encoding hidden states for batch 23
2025-01-12 16:32:19,310 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 16:32:19,312 [INFO] Encoding hidden states for batch 24
2025-01-12 16:32:19,578 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:19,579 [INFO] Encoding hidden states for batch 25
2025-01-12 16:32:19,867 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 16:32:19,868 [INFO] Encoding hidden states for batch 26
2025-01-12 16:32:20,153 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 16:32:20,154 [INFO] Encoding hidden states for batch 27
2025-01-12 16:32:20,442 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 16:32:20,443 [INFO] Encoding hidden states for batch 28
2025-01-12 16:32:20,728 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 16:32:20,730 [INFO] Encoding hidden states for batch 29
2025-01-12 16:32:21,034 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 16:32:21,036 [INFO] Encoding hidden states for batch 30
2025-01-12 16:32:21,312 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 16:32:21,314 [INFO] Encoding hidden states for batch 31
2025-01-12 16:32:21,497 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 16:32:21,499 [INFO] Encoding hidden states for batch 32
2025-01-12 16:32:21,510 [INFO] Total batches processed: 32
2025-01-12 16:32:21,512 [INFO] 最大长度:76
2025-01-12 16:32:22,048 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 16:32:22,049 [INFO] Computing non-zero element counts
2025-01-12 16:32:23,295 [INFO] Computing sum of non-zero elements
2025-01-12 16:32:23,952 [INFO] Computing mean of non-zero elements
2025-01-12 16:32:23,954 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 16:32:23,955 [INFO] Top 100 nz_mean values selected.
2025-01-12 16:32:23,956 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 16:32:23,958 [INFO] Top 100 act_cnt values selected.
2025-01-12 16:33:34,860 [INFO] Computing steering vectors using method: val_mul
2025-01-12 16:33:34,872 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 16:33:44,878 [INFO] Example prompt:  Hei, you are so
2025-01-12 16:33:44,880 [INFO] Generating texts **without** steering... 
2025-01-12 16:33:45,015 [INFO] hook is HookPoint()

2025-01-12 16:33:46,824 [INFO] Generated Text: 1:  Hei, you are so beautiful.

I'm not sure if I can say that I love you. But I do love you. And it's a very important thing to me to be able to express myself in the way that I want to express myself in this world
2025-01-12 16:33:46,825 [INFO] Generated Text: 2:  Hei, you are so much better than me.

I'm not sure if I can say that I am a good person, but I am very happy with my life. It's been a long time since I've had any problems with my body and it's been
2025-01-12 16:33:46,825 [INFO] Generated Text: 3:  Hei, you are so good at this.

"I'm not sure I can do it. I'm not sure if I can do it."

"You're right," said the man, "but you're not going to be able to do it for
2025-01-12 16:33:46,825 [INFO] 干预之后的结果
2025-01-12 16:33:46,826 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 16:33:46,827 [INFO] ** Generating texts with steering... Target **
2025-01-12 16:33:46,858 [INFO] hook is HookPoint()

2025-01-12 16:33:48,640 [INFO] Generated Text: 1:  Hei, you are so fucking stupid.

I'm not sure what to say. I don't want to hear it. I just want to know what's going on with this guy and how he got here. And if he's gonna be a good person, then
2025-01-12 16:33:48,640 [INFO] Generated Text: 2:  Hei, you are so stupid. You're so stupid that you can't even understand what's going on in your head.

"I'm sorry, but I don't know how to deal with this." She said. "I'm not sure if I can handle
2025-01-12 16:33:48,641 [INFO] Generated Text: 3:  Hei, you are so unkind to your children.

The Lord has given you a choice: to be a good man or to be an evil one.

I will not allow you to live in the world of darkness and misery. I will not let you
2025-01-12 20:24:32,547 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 20:24:32,549 [INFO] Hyperparameters:
2025-01-12 20:24:32,550 [INFO]   layer: 6
2025-01-12 20:24:32,551 [INFO]   LLM: gpt2-small
2025-01-12 20:24:32,552 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 20:24:32,553 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 20:24:32,555 [INFO]   output_dir: ./results
2025-01-12 20:24:32,556 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 20:24:32,566 [INFO]   task: sentiment
2025-01-12 20:24:32,568 [INFO]   seed: 42
2025-01-12 20:24:32,569 [INFO]   data_size: 1000
2025-01-12 20:24:32,571 [INFO]   device: cpu
2025-01-12 20:24:32,572 [INFO]   alpha: 100
2025-01-12 20:24:32,573 [INFO]   steer: pos-neg
2025-01-12 20:24:32,574 [INFO]   method: val_mul
2025-01-12 20:24:32,575 [INFO]   topk_mean: 100
2025-01-12 20:24:32,576 [INFO]   topk_cnt: 100
2025-01-12 20:24:32,577 [INFO]   batch_size: 32
2025-01-12 20:24:35,613 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 20:26:57,324 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 20:27:00,067 [INFO] Hyperparameters:
2025-01-12 20:27:00,070 [INFO]   layer: 6
2025-01-12 20:27:00,071 [INFO]   LLM: gpt2-small
2025-01-12 20:27:00,072 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 20:27:00,073 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 20:27:00,074 [INFO]   output_dir: ./results
2025-01-12 20:27:00,076 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 20:27:00,077 [INFO]   task: sentiment
2025-01-12 20:27:00,078 [INFO]   seed: 42
2025-01-12 20:27:00,079 [INFO]   data_size: 1000
2025-01-12 20:27:00,080 [INFO]   device: cpu
2025-01-12 20:27:00,081 [INFO]   alpha: 100
2025-01-12 20:27:00,082 [INFO]   steer: pos-neg
2025-01-12 20:27:00,084 [INFO]   method: val_mul
2025-01-12 20:27:00,085 [INFO]   topk_mean: 100
2025-01-12 20:27:00,085 [INFO]   topk_cnt: 100
2025-01-12 20:27:00,087 [INFO]   batch_size: 32
2025-01-12 20:27:00,089 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 20:27:00,091 [INFO] Loading model: gpt2-small
2025-01-12 20:27:40,955 [INFO] Loading SAE for layer 6
2025-01-12 20:30:04,917 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:30:05,293 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:30:05,294 [INFO] Encoding hidden states for batch 1
2025-01-12 20:30:05,636 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:05,638 [INFO] Encoding hidden states for batch 2
2025-01-12 20:30:06,014 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:30:06,015 [INFO] Encoding hidden states for batch 3
2025-01-12 20:30:06,358 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:30:06,359 [INFO] Encoding hidden states for batch 4
2025-01-12 20:30:06,665 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:30:06,667 [INFO] Encoding hidden states for batch 5
2025-01-12 20:30:06,969 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:06,971 [INFO] Encoding hidden states for batch 6
2025-01-12 20:30:07,305 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:30:07,307 [INFO] Encoding hidden states for batch 7
2025-01-12 20:30:07,577 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 20:30:07,578 [INFO] Encoding hidden states for batch 8
2025-01-12 20:30:07,843 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:07,844 [INFO] Encoding hidden states for batch 9
2025-01-12 20:30:08,158 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:30:08,160 [INFO] Encoding hidden states for batch 10
2025-01-12 20:30:08,478 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:30:08,480 [INFO] Encoding hidden states for batch 11
2025-01-12 20:30:08,830 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 20:30:08,832 [INFO] Encoding hidden states for batch 12
2025-01-12 20:30:09,165 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:09,167 [INFO] Encoding hidden states for batch 13
2025-01-12 20:30:09,488 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:30:09,490 [INFO] Encoding hidden states for batch 14
2025-01-12 20:30:09,770 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 20:30:09,772 [INFO] Encoding hidden states for batch 15
2025-01-12 20:30:10,092 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 20:30:10,094 [INFO] Encoding hidden states for batch 16
2025-01-12 20:30:10,359 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:10,360 [INFO] Encoding hidden states for batch 17
2025-01-12 20:30:10,648 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:10,650 [INFO] Encoding hidden states for batch 18
2025-01-12 20:30:10,946 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:10,948 [INFO] Encoding hidden states for batch 19
2025-01-12 20:30:11,329 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:30:11,331 [INFO] Encoding hidden states for batch 20
2025-01-12 20:30:11,656 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:11,658 [INFO] Encoding hidden states for batch 21
2025-01-12 20:30:11,976 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 20:30:11,978 [INFO] Encoding hidden states for batch 22
2025-01-12 20:30:12,336 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:30:12,338 [INFO] Encoding hidden states for batch 23
2025-01-12 20:30:12,603 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:12,604 [INFO] Encoding hidden states for batch 24
2025-01-12 20:30:12,904 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:12,905 [INFO] Encoding hidden states for batch 25
2025-01-12 20:30:13,225 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:13,227 [INFO] Encoding hidden states for batch 26
2025-01-12 20:30:13,511 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:13,512 [INFO] Encoding hidden states for batch 27
2025-01-12 20:30:13,816 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:30:13,818 [INFO] Encoding hidden states for batch 28
2025-01-12 20:30:14,099 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:14,100 [INFO] Encoding hidden states for batch 29
2025-01-12 20:30:14,404 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:30:14,407 [INFO] Encoding hidden states for batch 30
2025-01-12 20:30:14,720 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:14,721 [INFO] Encoding hidden states for batch 31
2025-01-12 20:30:14,903 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 20:30:14,905 [INFO] Encoding hidden states for batch 32
2025-01-12 20:30:14,914 [INFO] Total batches processed: 32
2025-01-12 20:30:14,916 [INFO] 最大长度:60
2025-01-12 20:30:15,381 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 20:30:15,381 [INFO] Computing non-zero element counts
2025-01-12 20:30:16,477 [INFO] Computing sum of non-zero elements
2025-01-12 20:30:17,019 [INFO] Computing mean of non-zero elements
2025-01-12 20:30:17,021 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:30:17,023 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:30:17,023 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:30:17,024 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:30:17,449 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:30:17,718 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 20:30:17,719 [INFO] Encoding hidden states for batch 1
2025-01-12 20:30:18,015 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:18,017 [INFO] Encoding hidden states for batch 2
2025-01-12 20:30:18,310 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:18,312 [INFO] Encoding hidden states for batch 3
2025-01-12 20:30:18,678 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:30:18,680 [INFO] Encoding hidden states for batch 4
2025-01-12 20:30:18,943 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 20:30:18,945 [INFO] Encoding hidden states for batch 5
2025-01-12 20:30:19,209 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:19,211 [INFO] Encoding hidden states for batch 6
2025-01-12 20:30:19,481 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:19,483 [INFO] Encoding hidden states for batch 7
2025-01-12 20:30:19,769 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:19,771 [INFO] Encoding hidden states for batch 8
2025-01-12 20:30:20,086 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:20,087 [INFO] Encoding hidden states for batch 9
2025-01-12 20:30:20,402 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 20:30:20,404 [INFO] Encoding hidden states for batch 10
2025-01-12 20:30:20,712 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:30:20,714 [INFO] Encoding hidden states for batch 11
2025-01-12 20:30:21,004 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:21,006 [INFO] Encoding hidden states for batch 12
2025-01-12 20:30:21,284 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:21,286 [INFO] Encoding hidden states for batch 13
2025-01-12 20:30:21,560 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:21,562 [INFO] Encoding hidden states for batch 14
2025-01-12 20:30:21,835 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:21,836 [INFO] Encoding hidden states for batch 15
2025-01-12 20:30:22,109 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:22,111 [INFO] Encoding hidden states for batch 16
2025-01-12 20:30:22,368 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:30:22,370 [INFO] Encoding hidden states for batch 17
2025-01-12 20:30:22,669 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:22,670 [INFO] Encoding hidden states for batch 18
2025-01-12 20:30:22,970 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:22,972 [INFO] Encoding hidden states for batch 19
2025-01-12 20:30:23,312 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:30:23,314 [INFO] Encoding hidden states for batch 20
2025-01-12 20:30:23,593 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:23,595 [INFO] Encoding hidden states for batch 21
2025-01-12 20:30:23,967 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:23,968 [INFO] Encoding hidden states for batch 22
2025-01-12 20:30:24,301 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 20:30:24,303 [INFO] Encoding hidden states for batch 23
2025-01-12 20:30:24,613 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:30:24,614 [INFO] Encoding hidden states for batch 24
2025-01-12 20:30:24,938 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:24,940 [INFO] Encoding hidden states for batch 25
2025-01-12 20:30:25,327 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:30:25,328 [INFO] Encoding hidden states for batch 26
2025-01-12 20:30:25,717 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:25,718 [INFO] Encoding hidden states for batch 27
2025-01-12 20:30:26,000 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:30:26,002 [INFO] Encoding hidden states for batch 28
2025-01-12 20:30:26,258 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 20:30:26,260 [INFO] Encoding hidden states for batch 29
2025-01-12 20:30:26,580 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 20:30:26,582 [INFO] Encoding hidden states for batch 30
2025-01-12 20:30:26,898 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 20:30:26,899 [INFO] Encoding hidden states for batch 31
2025-01-12 20:30:27,093 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 20:30:27,095 [INFO] Encoding hidden states for batch 32
2025-01-12 20:30:27,105 [INFO] Total batches processed: 32
2025-01-12 20:30:27,109 [INFO] 最大长度:59
2025-01-12 20:30:27,554 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 20:30:27,554 [INFO] Computing non-zero element counts
2025-01-12 20:30:28,522 [INFO] Computing sum of non-zero elements
2025-01-12 20:30:29,030 [INFO] Computing mean of non-zero elements
2025-01-12 20:30:29,032 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:30:29,033 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:30:29,034 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:30:29,035 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:30:29,441 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:30:30,041 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 20:30:30,042 [INFO] Encoding hidden states for batch 1
2025-01-12 20:30:30,426 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:30:30,427 [INFO] Encoding hidden states for batch 2
2025-01-12 20:30:30,733 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:30,734 [INFO] Encoding hidden states for batch 3
2025-01-12 20:30:31,034 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:31,036 [INFO] Encoding hidden states for batch 4
2025-01-12 20:30:31,377 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:31,379 [INFO] Encoding hidden states for batch 5
2025-01-12 20:30:31,687 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:30:31,688 [INFO] Encoding hidden states for batch 6
2025-01-12 20:30:32,064 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:30:32,066 [INFO] Encoding hidden states for batch 7
2025-01-12 20:30:32,334 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:30:32,336 [INFO] Encoding hidden states for batch 8
2025-01-12 20:30:32,606 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:32,607 [INFO] Encoding hidden states for batch 9
2025-01-12 20:30:32,911 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:30:32,913 [INFO] Encoding hidden states for batch 10
2025-01-12 20:30:33,187 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 20:30:33,189 [INFO] Encoding hidden states for batch 11
2025-01-12 20:30:33,734 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:30:33,736 [INFO] Encoding hidden states for batch 12
2025-01-12 20:30:34,040 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:30:34,042 [INFO] Encoding hidden states for batch 13
2025-01-12 20:30:34,339 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:30:34,342 [INFO] Encoding hidden states for batch 14
2025-01-12 20:30:34,614 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:34,616 [INFO] Encoding hidden states for batch 15
2025-01-12 20:30:34,925 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:30:34,927 [INFO] Encoding hidden states for batch 16
2025-01-12 20:30:35,216 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:30:35,218 [INFO] Encoding hidden states for batch 17
2025-01-12 20:30:35,499 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:35,501 [INFO] Encoding hidden states for batch 18
2025-01-12 20:30:35,798 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:35,799 [INFO] Encoding hidden states for batch 19
2025-01-12 20:30:36,078 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:36,080 [INFO] Encoding hidden states for batch 20
2025-01-12 20:30:36,401 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:30:36,403 [INFO] Encoding hidden states for batch 21
2025-01-12 20:30:36,681 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:30:36,683 [INFO] Encoding hidden states for batch 22
2025-01-12 20:30:36,990 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 20:30:36,992 [INFO] Encoding hidden states for batch 23
2025-01-12 20:30:37,289 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:30:37,291 [INFO] Encoding hidden states for batch 24
2025-01-12 20:30:37,576 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:37,578 [INFO] Encoding hidden states for batch 25
2025-01-12 20:30:37,884 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:30:37,885 [INFO] Encoding hidden states for batch 26
2025-01-12 20:30:38,175 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:30:38,177 [INFO] Encoding hidden states for batch 27
2025-01-12 20:30:38,544 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:30:38,546 [INFO] Encoding hidden states for batch 28
2025-01-12 20:30:38,823 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:30:38,824 [INFO] Encoding hidden states for batch 29
2025-01-12 20:30:39,114 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:30:39,116 [INFO] Encoding hidden states for batch 30
2025-01-12 20:30:39,388 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:30:39,389 [INFO] Encoding hidden states for batch 31
2025-01-12 20:30:39,579 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 20:30:39,581 [INFO] Encoding hidden states for batch 32
2025-01-12 20:30:39,593 [INFO] Total batches processed: 32
2025-01-12 20:30:39,596 [INFO] 最大长度:76
2025-01-12 20:30:40,132 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 20:30:40,132 [INFO] Computing non-zero element counts
2025-01-12 20:30:41,461 [INFO] Computing sum of non-zero elements
2025-01-12 20:30:42,144 [INFO] Computing mean of non-zero elements
2025-01-12 20:30:42,145 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:30:42,145 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:30:42,146 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:30:42,146 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:33:31,704 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:33:31,964 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:33:31,965 [INFO] Encoding hidden states for batch 1
2025-01-12 20:33:32,283 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:32,285 [INFO] Encoding hidden states for batch 2
2025-01-12 20:33:32,620 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:33:32,622 [INFO] Encoding hidden states for batch 3
2025-01-12 20:33:32,931 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:33:32,933 [INFO] Encoding hidden states for batch 4
2025-01-12 20:33:33,243 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:33:33,245 [INFO] Encoding hidden states for batch 5
2025-01-12 20:33:33,555 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:33,557 [INFO] Encoding hidden states for batch 6
2025-01-12 20:33:33,858 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:33:33,859 [INFO] Encoding hidden states for batch 7
2025-01-12 20:33:34,121 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 20:33:34,122 [INFO] Encoding hidden states for batch 8
2025-01-12 20:33:34,386 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:33:34,387 [INFO] Encoding hidden states for batch 9
2025-01-12 20:33:34,701 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:33:34,703 [INFO] Encoding hidden states for batch 10
2025-01-12 20:33:35,007 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:33:35,009 [INFO] Encoding hidden states for batch 11
2025-01-12 20:33:35,345 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 20:33:35,346 [INFO] Encoding hidden states for batch 12
2025-01-12 20:33:35,664 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:35,666 [INFO] Encoding hidden states for batch 13
2025-01-12 20:33:35,967 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:33:35,969 [INFO] Encoding hidden states for batch 14
2025-01-12 20:33:36,260 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 20:33:36,261 [INFO] Encoding hidden states for batch 15
2025-01-12 20:33:36,528 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 20:33:36,531 [INFO] Encoding hidden states for batch 16
2025-01-12 20:33:36,801 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:36,802 [INFO] Encoding hidden states for batch 17
2025-01-12 20:33:37,102 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:33:37,104 [INFO] Encoding hidden states for batch 18
2025-01-12 20:33:37,386 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:33:37,388 [INFO] Encoding hidden states for batch 19
2025-01-12 20:33:37,766 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:33:37,768 [INFO] Encoding hidden states for batch 20
2025-01-12 20:33:38,109 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:38,110 [INFO] Encoding hidden states for batch 21
2025-01-12 20:33:38,485 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 20:33:38,487 [INFO] Encoding hidden states for batch 22
2025-01-12 20:33:38,942 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:33:38,943 [INFO] Encoding hidden states for batch 23
2025-01-12 20:33:39,262 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:39,264 [INFO] Encoding hidden states for batch 24
2025-01-12 20:33:39,623 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:39,625 [INFO] Encoding hidden states for batch 25
2025-01-12 20:33:39,960 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:39,962 [INFO] Encoding hidden states for batch 26
2025-01-12 20:33:40,269 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:40,270 [INFO] Encoding hidden states for batch 27
2025-01-12 20:33:40,583 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:33:40,585 [INFO] Encoding hidden states for batch 28
2025-01-12 20:33:40,881 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:40,882 [INFO] Encoding hidden states for batch 29
2025-01-12 20:33:41,181 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:33:41,183 [INFO] Encoding hidden states for batch 30
2025-01-12 20:33:41,465 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:41,466 [INFO] Encoding hidden states for batch 31
2025-01-12 20:33:41,647 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 20:33:41,648 [INFO] Encoding hidden states for batch 32
2025-01-12 20:33:41,657 [INFO] Total batches processed: 32
2025-01-12 20:33:41,659 [INFO] 最大长度:60
2025-01-12 20:33:42,100 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 20:33:42,104 [INFO] Computing non-zero element counts
2025-01-12 20:33:43,168 [INFO] Computing sum of non-zero elements
2025-01-12 20:33:43,701 [INFO] Computing mean of non-zero elements
2025-01-12 20:33:43,703 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:33:43,704 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:33:43,705 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:33:43,706 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:33:44,160 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:33:44,420 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 20:33:44,421 [INFO] Encoding hidden states for batch 1
2025-01-12 20:33:44,736 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:44,737 [INFO] Encoding hidden states for batch 2
2025-01-12 20:33:45,023 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:45,025 [INFO] Encoding hidden states for batch 3
2025-01-12 20:33:45,313 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:33:45,315 [INFO] Encoding hidden states for batch 4
2025-01-12 20:33:45,569 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 20:33:45,571 [INFO] Encoding hidden states for batch 5
2025-01-12 20:33:45,825 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:33:45,827 [INFO] Encoding hidden states for batch 6
2025-01-12 20:33:46,093 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:33:46,094 [INFO] Encoding hidden states for batch 7
2025-01-12 20:33:46,406 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:46,409 [INFO] Encoding hidden states for batch 8
2025-01-12 20:33:46,743 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:46,745 [INFO] Encoding hidden states for batch 9
2025-01-12 20:33:47,097 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 20:33:47,098 [INFO] Encoding hidden states for batch 10
2025-01-12 20:33:47,416 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:33:47,417 [INFO] Encoding hidden states for batch 11
2025-01-12 20:33:47,785 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:47,787 [INFO] Encoding hidden states for batch 12
2025-01-12 20:33:48,111 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:33:48,113 [INFO] Encoding hidden states for batch 13
2025-01-12 20:33:48,383 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:48,385 [INFO] Encoding hidden states for batch 14
2025-01-12 20:33:48,668 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:48,670 [INFO] Encoding hidden states for batch 15
2025-01-12 20:33:49,001 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:49,002 [INFO] Encoding hidden states for batch 16
2025-01-12 20:33:49,287 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:33:49,288 [INFO] Encoding hidden states for batch 17
2025-01-12 20:33:49,665 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:33:49,667 [INFO] Encoding hidden states for batch 18
2025-01-12 20:33:49,997 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:49,999 [INFO] Encoding hidden states for batch 19
2025-01-12 20:33:50,348 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:33:50,349 [INFO] Encoding hidden states for batch 20
2025-01-12 20:33:50,653 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:50,655 [INFO] Encoding hidden states for batch 21
2025-01-12 20:33:50,996 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:33:50,998 [INFO] Encoding hidden states for batch 22
2025-01-12 20:33:51,339 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 20:33:51,340 [INFO] Encoding hidden states for batch 23
2025-01-12 20:33:51,678 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:33:51,679 [INFO] Encoding hidden states for batch 24
2025-01-12 20:33:52,056 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:33:52,057 [INFO] Encoding hidden states for batch 25
2025-01-12 20:33:52,349 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 20:33:52,351 [INFO] Encoding hidden states for batch 26
2025-01-12 20:33:52,640 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:52,642 [INFO] Encoding hidden states for batch 27
2025-01-12 20:33:52,928 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:33:52,930 [INFO] Encoding hidden states for batch 28
2025-01-12 20:33:53,187 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 20:33:53,189 [INFO] Encoding hidden states for batch 29
2025-01-12 20:33:53,474 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 20:33:53,476 [INFO] Encoding hidden states for batch 30
2025-01-12 20:33:53,776 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 20:33:53,778 [INFO] Encoding hidden states for batch 31
2025-01-12 20:33:53,989 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 20:33:53,991 [INFO] Encoding hidden states for batch 32
2025-01-12 20:33:54,001 [INFO] Total batches processed: 32
2025-01-12 20:33:54,004 [INFO] 最大长度:59
2025-01-12 20:33:54,446 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 20:33:54,447 [INFO] Computing non-zero element counts
2025-01-12 20:33:55,509 [INFO] Computing sum of non-zero elements
2025-01-12 20:33:56,067 [INFO] Computing mean of non-zero elements
2025-01-12 20:33:56,069 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:33:56,070 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:33:56,070 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:33:56,071 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:33:56,488 [INFO] Running model with cache to obtain hidden states
2025-01-12 20:33:57,240 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 20:33:57,240 [INFO] Encoding hidden states for batch 1
2025-01-12 20:33:57,643 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:33:57,645 [INFO] Encoding hidden states for batch 2
2025-01-12 20:33:57,958 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:33:57,959 [INFO] Encoding hidden states for batch 3
2025-01-12 20:33:58,252 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:33:58,254 [INFO] Encoding hidden states for batch 4
2025-01-12 20:33:58,563 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:33:58,564 [INFO] Encoding hidden states for batch 5
2025-01-12 20:33:58,869 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 20:33:58,871 [INFO] Encoding hidden states for batch 6
2025-01-12 20:33:59,163 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 20:33:59,164 [INFO] Encoding hidden states for batch 7
2025-01-12 20:33:59,442 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:33:59,444 [INFO] Encoding hidden states for batch 8
2025-01-12 20:33:59,739 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:33:59,741 [INFO] Encoding hidden states for batch 9
2025-01-12 20:34:00,066 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:34:00,067 [INFO] Encoding hidden states for batch 10
2025-01-12 20:34:00,350 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 20:34:00,352 [INFO] Encoding hidden states for batch 11
2025-01-12 20:34:00,696 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:34:00,698 [INFO] Encoding hidden states for batch 12
2025-01-12 20:34:00,997 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 20:34:00,999 [INFO] Encoding hidden states for batch 13
2025-01-12 20:34:01,297 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:34:01,299 [INFO] Encoding hidden states for batch 14
2025-01-12 20:34:01,598 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:34:01,600 [INFO] Encoding hidden states for batch 15
2025-01-12 20:34:01,951 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 20:34:01,953 [INFO] Encoding hidden states for batch 16
2025-01-12 20:34:02,255 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 20:34:02,257 [INFO] Encoding hidden states for batch 17
2025-01-12 20:34:02,543 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:34:02,544 [INFO] Encoding hidden states for batch 18
2025-01-12 20:34:02,844 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:34:02,845 [INFO] Encoding hidden states for batch 19
2025-01-12 20:34:03,132 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:34:03,134 [INFO] Encoding hidden states for batch 20
2025-01-12 20:34:03,467 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 20:34:03,469 [INFO] Encoding hidden states for batch 21
2025-01-12 20:34:03,798 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:34:03,800 [INFO] Encoding hidden states for batch 22
2025-01-12 20:34:04,140 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 20:34:04,142 [INFO] Encoding hidden states for batch 23
2025-01-12 20:34:04,452 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 20:34:04,454 [INFO] Encoding hidden states for batch 24
2025-01-12 20:34:04,749 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:34:04,751 [INFO] Encoding hidden states for batch 25
2025-01-12 20:34:05,075 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 20:34:05,077 [INFO] Encoding hidden states for batch 26
2025-01-12 20:34:05,362 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 20:34:05,363 [INFO] Encoding hidden states for batch 27
2025-01-12 20:34:05,731 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 20:34:05,733 [INFO] Encoding hidden states for batch 28
2025-01-12 20:34:06,122 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 20:34:06,124 [INFO] Encoding hidden states for batch 29
2025-01-12 20:34:06,485 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 20:34:06,487 [INFO] Encoding hidden states for batch 30
2025-01-12 20:34:06,842 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 20:34:06,844 [INFO] Encoding hidden states for batch 31
2025-01-12 20:34:07,049 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 20:34:07,051 [INFO] Encoding hidden states for batch 32
2025-01-12 20:34:07,062 [INFO] Total batches processed: 32
2025-01-12 20:34:07,065 [INFO] 最大长度:76
2025-01-12 20:34:07,590 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 20:34:07,591 [INFO] Computing non-zero element counts
2025-01-12 20:34:08,855 [INFO] Computing sum of non-zero elements
2025-01-12 20:34:09,510 [INFO] Computing mean of non-zero elements
2025-01-12 20:34:09,512 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 20:34:09,513 [INFO] Top 100 nz_mean values selected.
2025-01-12 20:34:09,514 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 20:34:09,515 [INFO] Top 100 act_cnt values selected.
2025-01-12 20:35:56,706 [INFO] Computing steering vectors using method: val_mul
2025-01-12 20:35:56,719 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 20:36:06,898 [INFO] Example prompt:  Hei, you are so
2025-01-12 20:36:06,901 [INFO] Generating texts **without** steering... 
2025-01-12 20:36:06,978 [INFO] hook is HookPoint()

2025-01-12 20:36:08,748 [INFO] Generated Text: 1:  Hei, you are so much better than me.

I am a little too young to be here. I have been in the army for a long time and I know that you will not let me go. You will not let me go because of your feelings for my
2025-01-12 20:36:08,748 [INFO] Generated Text: 2:  Hei, you are so smart. You're a genius.

"I'm not going to lie, I'm not going to lie about this," he said. "I've been in the business for 30 years and I've never seen anything like this."


2025-01-12 20:36:08,748 [INFO] Generated Text: 3:  Hei, you are so beautiful.

You're not going to be able to do that. You're going to have to get out of here and go home. I'm sorry, but I can't do it."

"I'm sorry," she said,
2025-01-12 20:36:08,749 [INFO] 干预之后的结果
2025-01-12 20:36:08,750 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 20:36:08,751 [INFO] ** Generating texts with steering... Target **
2025-01-12 20:36:08,784 [INFO] hook is HookPoint()

2025-01-12 20:36:10,462 [INFO] Generated Text: 1:  Hei, you are so stupid. You're a fucking idiot.

I'm sorry, but I can't believe you're even here. I've been waiting for this for so long and it's finally coming to me! I'm going to have to go get my
2025-01-12 20:36:10,463 [INFO] Generated Text: 2:  Hei, you are so unkind to your children.

The next day, the mother of the boy was killed by a stray bullet. The father of the girl was also killed in a shooting that took place on her way home from school. The parents were arrested and
2025-01-12 20:36:10,463 [INFO] Generated Text: 3:  Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," she said, "but I don't want to hear about it."

"You know what?" he asked. "I'm not going to tell
2025-01-12 20:40:58,956 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 20:54:58,358 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:54:04,649 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 22:54:04,650 [INFO] Hyperparameters:
2025-01-12 22:54:04,652 [INFO]   layer: 6
2025-01-12 22:54:04,653 [INFO]   LLM: gpt2-small
2025-01-12 22:54:04,654 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 22:54:04,655 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:54:04,656 [INFO]   output_dir: ./results
2025-01-12 22:54:04,657 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 22:54:04,657 [INFO]   task: sentiment
2025-01-12 22:54:04,658 [INFO]   seed: 42
2025-01-12 22:54:04,659 [INFO]   data_size: 1000
2025-01-12 22:54:04,660 [INFO]   device: cpu
2025-01-12 22:54:04,661 [INFO]   alpha: 100
2025-01-12 22:54:04,661 [INFO]   steer: pos-neg
2025-01-12 22:54:04,662 [INFO]   method: val_mul
2025-01-12 22:54:04,663 [INFO]   topk_mean: 100
2025-01-12 22:54:04,664 [INFO]   topk_cnt: 100
2025-01-12 22:54:04,664 [INFO]   batch_size: 32
2025-01-12 22:54:07,547 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 22:54:15,200 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 22:54:15,204 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 22:54:15,393 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 22:54:15,404 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 22:54:31,619 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 22:54:34,167 [INFO] Hyperparameters:
2025-01-12 22:54:34,169 [INFO]   layer: 6
2025-01-12 22:54:34,170 [INFO]   LLM: gpt2-small
2025-01-12 22:54:34,171 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 22:54:34,172 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:54:34,173 [INFO]   output_dir: ./results
2025-01-12 22:54:34,174 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 22:54:34,175 [INFO]   task: sentiment
2025-01-12 22:54:34,176 [INFO]   seed: 42
2025-01-12 22:54:34,176 [INFO]   data_size: 1000
2025-01-12 22:54:34,177 [INFO]   device: cpu
2025-01-12 22:54:34,178 [INFO]   alpha: 100
2025-01-12 22:54:34,179 [INFO]   steer: pos-neg
2025-01-12 22:54:34,180 [INFO]   method: val_mul
2025-01-12 22:54:34,180 [INFO]   topk_mean: 100
2025-01-12 22:54:34,181 [INFO]   topk_cnt: 100
2025-01-12 22:54:34,182 [INFO]   batch_size: 32
2025-01-12 22:54:34,186 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 22:54:34,187 [INFO] Loading model: gpt2-small
2025-01-12 22:55:25,366 [INFO] Loading SAE for layer 6
2025-01-12 22:56:35,289 [INFO] Running model with cache to obtain hidden states
2025-01-12 22:56:35,690 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 22:56:35,691 [INFO] Encoding hidden states for batch 1
2025-01-12 22:56:36,107 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:36,109 [INFO] Encoding hidden states for batch 2
2025-01-12 22:56:36,395 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 22:56:36,397 [INFO] Encoding hidden states for batch 3
2025-01-12 22:56:36,688 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 22:56:36,689 [INFO] Encoding hidden states for batch 4
2025-01-12 22:56:36,968 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 22:56:36,969 [INFO] Encoding hidden states for batch 5
2025-01-12 22:56:37,259 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:56:37,261 [INFO] Encoding hidden states for batch 6
2025-01-12 22:56:37,537 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 22:56:37,539 [INFO] Encoding hidden states for batch 7
2025-01-12 22:56:37,788 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 22:56:37,789 [INFO] Encoding hidden states for batch 8
2025-01-12 22:56:38,030 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:56:38,032 [INFO] Encoding hidden states for batch 9
2025-01-12 22:56:38,336 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 22:56:38,338 [INFO] Encoding hidden states for batch 10
2025-01-12 22:56:38,638 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 22:56:38,639 [INFO] Encoding hidden states for batch 11
2025-01-12 22:56:38,976 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 22:56:38,978 [INFO] Encoding hidden states for batch 12
2025-01-12 22:56:39,307 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:39,308 [INFO] Encoding hidden states for batch 13
2025-01-12 22:56:39,603 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 22:56:39,604 [INFO] Encoding hidden states for batch 14
2025-01-12 22:56:39,854 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 22:56:39,855 [INFO] Encoding hidden states for batch 15
2025-01-12 22:56:40,226 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 22:56:40,227 [INFO] Encoding hidden states for batch 16
2025-01-12 22:56:40,472 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:40,473 [INFO] Encoding hidden states for batch 17
2025-01-12 22:56:40,745 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:56:40,746 [INFO] Encoding hidden states for batch 18
2025-01-12 22:56:41,028 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:56:41,029 [INFO] Encoding hidden states for batch 19
2025-01-12 22:56:41,373 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 22:56:41,374 [INFO] Encoding hidden states for batch 20
2025-01-12 22:56:41,689 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:41,690 [INFO] Encoding hidden states for batch 21
2025-01-12 22:56:42,028 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 22:56:42,029 [INFO] Encoding hidden states for batch 22
2025-01-12 22:56:42,311 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 22:56:42,313 [INFO] Encoding hidden states for batch 23
2025-01-12 22:56:42,568 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:42,570 [INFO] Encoding hidden states for batch 24
2025-01-12 22:56:42,870 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:42,871 [INFO] Encoding hidden states for batch 25
2025-01-12 22:56:43,207 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:43,209 [INFO] Encoding hidden states for batch 26
2025-01-12 22:56:43,480 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:43,481 [INFO] Encoding hidden states for batch 27
2025-01-12 22:56:43,776 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 22:56:43,777 [INFO] Encoding hidden states for batch 28
2025-01-12 22:56:44,045 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:44,047 [INFO] Encoding hidden states for batch 29
2025-01-12 22:56:44,327 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 22:56:44,329 [INFO] Encoding hidden states for batch 30
2025-01-12 22:56:44,624 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:56:44,625 [INFO] Encoding hidden states for batch 31
2025-01-12 22:56:44,792 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 22:56:44,793 [INFO] Encoding hidden states for batch 32
2025-01-12 22:56:44,803 [INFO] Total batches processed: 32
2025-01-12 22:56:44,807 [INFO] 最大长度:60
2025-01-12 22:56:45,241 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 22:56:45,242 [INFO] Computing non-zero element counts
2025-01-12 22:56:46,305 [INFO] Computing sum of non-zero elements
2025-01-12 22:56:46,863 [INFO] Computing mean of non-zero elements
2025-01-12 22:56:46,865 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 22:56:46,866 [INFO] Top 100 nz_mean values selected.
2025-01-12 22:56:46,866 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 22:56:46,868 [INFO] Top 100 act_cnt values selected.
2025-01-12 22:56:47,339 [INFO] Running model with cache to obtain hidden states
2025-01-12 22:56:47,604 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 22:56:47,605 [INFO] Encoding hidden states for batch 1
2025-01-12 22:56:47,880 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:47,881 [INFO] Encoding hidden states for batch 2
2025-01-12 22:56:48,139 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:56:48,140 [INFO] Encoding hidden states for batch 3
2025-01-12 22:56:48,418 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 22:56:48,419 [INFO] Encoding hidden states for batch 4
2025-01-12 22:56:48,676 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 22:56:48,678 [INFO] Encoding hidden states for batch 5
2025-01-12 22:56:48,931 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:56:48,932 [INFO] Encoding hidden states for batch 6
2025-01-12 22:56:49,195 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:56:49,196 [INFO] Encoding hidden states for batch 7
2025-01-12 22:56:49,489 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:49,490 [INFO] Encoding hidden states for batch 8
2025-01-12 22:56:49,804 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:49,806 [INFO] Encoding hidden states for batch 9
2025-01-12 22:56:50,141 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 22:56:50,142 [INFO] Encoding hidden states for batch 10
2025-01-12 22:56:50,446 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 22:56:50,447 [INFO] Encoding hidden states for batch 11
2025-01-12 22:56:50,756 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:50,757 [INFO] Encoding hidden states for batch 12
2025-01-12 22:56:51,041 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:56:51,043 [INFO] Encoding hidden states for batch 13
2025-01-12 22:56:51,312 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:51,314 [INFO] Encoding hidden states for batch 14
2025-01-12 22:56:51,557 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:51,558 [INFO] Encoding hidden states for batch 15
2025-01-12 22:56:51,839 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:56:51,840 [INFO] Encoding hidden states for batch 16
2025-01-12 22:56:52,102 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 22:56:52,103 [INFO] Encoding hidden states for batch 17
2025-01-12 22:56:52,383 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:56:52,385 [INFO] Encoding hidden states for batch 18
2025-01-12 22:56:52,691 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:52,693 [INFO] Encoding hidden states for batch 19
2025-01-12 22:56:53,041 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 22:56:53,042 [INFO] Encoding hidden states for batch 20
2025-01-12 22:56:53,314 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:53,315 [INFO] Encoding hidden states for batch 21
2025-01-12 22:56:53,588 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:56:53,590 [INFO] Encoding hidden states for batch 22
2025-01-12 22:56:53,925 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 22:56:53,927 [INFO] Encoding hidden states for batch 23
2025-01-12 22:56:54,226 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 22:56:54,227 [INFO] Encoding hidden states for batch 24
2025-01-12 22:56:54,534 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:56:54,535 [INFO] Encoding hidden states for batch 25
2025-01-12 22:56:54,802 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 22:56:54,804 [INFO] Encoding hidden states for batch 26
2025-01-12 22:56:55,083 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:56:55,085 [INFO] Encoding hidden states for batch 27
2025-01-12 22:56:55,353 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 22:56:55,355 [INFO] Encoding hidden states for batch 28
2025-01-12 22:56:55,613 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 22:56:55,614 [INFO] Encoding hidden states for batch 29
2025-01-12 22:56:55,857 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 22:56:55,858 [INFO] Encoding hidden states for batch 30
2025-01-12 22:56:56,159 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 22:56:56,160 [INFO] Encoding hidden states for batch 31
2025-01-12 22:56:56,353 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 22:56:56,355 [INFO] Encoding hidden states for batch 32
2025-01-12 22:56:56,364 [INFO] Total batches processed: 32
2025-01-12 22:56:56,367 [INFO] 最大长度:59
2025-01-12 22:56:56,807 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 22:56:56,808 [INFO] Computing non-zero element counts
2025-01-12 22:56:57,903 [INFO] Computing sum of non-zero elements
2025-01-12 22:56:58,491 [INFO] Computing mean of non-zero elements
2025-01-12 22:56:58,493 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 22:56:58,494 [INFO] Top 100 nz_mean values selected.
2025-01-12 22:56:58,494 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 22:56:58,495 [INFO] Top 100 act_cnt values selected.
2025-01-12 22:56:59,012 [INFO] Running model with cache to obtain hidden states
2025-01-12 22:56:59,341 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 22:56:59,342 [INFO] Encoding hidden states for batch 1
2025-01-12 22:56:59,704 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 22:56:59,705 [INFO] Encoding hidden states for batch 2
2025-01-12 22:56:59,990 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:56:59,991 [INFO] Encoding hidden states for batch 3
2025-01-12 22:57:00,265 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:57:00,266 [INFO] Encoding hidden states for batch 4
2025-01-12 22:57:00,534 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:57:00,535 [INFO] Encoding hidden states for batch 5
2025-01-12 22:57:00,827 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 22:57:00,828 [INFO] Encoding hidden states for batch 6
2025-01-12 22:57:01,876 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 22:57:01,877 [INFO] Encoding hidden states for batch 7
2025-01-12 22:57:02,165 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 22:57:02,167 [INFO] Encoding hidden states for batch 8
2025-01-12 22:57:02,453 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:57:02,454 [INFO] Encoding hidden states for batch 9
2025-01-12 22:57:02,766 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 22:57:02,767 [INFO] Encoding hidden states for batch 10
2025-01-12 22:57:03,045 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 22:57:03,047 [INFO] Encoding hidden states for batch 11
2025-01-12 22:57:03,357 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 22:57:03,359 [INFO] Encoding hidden states for batch 12
2025-01-12 22:57:03,668 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 22:57:03,669 [INFO] Encoding hidden states for batch 13
2025-01-12 22:57:03,977 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 22:57:03,979 [INFO] Encoding hidden states for batch 14
2025-01-12 22:57:04,268 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:57:04,269 [INFO] Encoding hidden states for batch 15
2025-01-12 22:57:04,604 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 22:57:04,605 [INFO] Encoding hidden states for batch 16
2025-01-12 22:57:04,915 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 22:57:04,916 [INFO] Encoding hidden states for batch 17
2025-01-12 22:57:05,214 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:57:05,216 [INFO] Encoding hidden states for batch 18
2025-01-12 22:57:05,540 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:57:05,541 [INFO] Encoding hidden states for batch 19
2025-01-12 22:57:05,838 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:57:05,840 [INFO] Encoding hidden states for batch 20
2025-01-12 22:57:06,246 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 22:57:06,247 [INFO] Encoding hidden states for batch 21
2025-01-12 22:57:06,562 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 22:57:06,564 [INFO] Encoding hidden states for batch 22
2025-01-12 22:57:06,927 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 22:57:06,929 [INFO] Encoding hidden states for batch 23
2025-01-12 22:57:07,254 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 22:57:07,255 [INFO] Encoding hidden states for batch 24
2025-01-12 22:57:07,568 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:57:07,569 [INFO] Encoding hidden states for batch 25
2025-01-12 22:57:07,900 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 22:57:07,902 [INFO] Encoding hidden states for batch 26
2025-01-12 22:57:08,218 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 22:57:08,220 [INFO] Encoding hidden states for batch 27
2025-01-12 22:57:08,533 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 22:57:08,535 [INFO] Encoding hidden states for batch 28
2025-01-12 22:57:08,831 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 22:57:08,832 [INFO] Encoding hidden states for batch 29
2025-01-12 22:57:09,170 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 22:57:09,171 [INFO] Encoding hidden states for batch 30
2025-01-12 22:57:09,450 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 22:57:09,452 [INFO] Encoding hidden states for batch 31
2025-01-12 22:57:09,655 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 22:57:09,657 [INFO] Encoding hidden states for batch 32
2025-01-12 22:57:09,669 [INFO] Total batches processed: 32
2025-01-12 22:57:09,672 [INFO] 最大长度:76
2025-01-12 22:57:10,239 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 22:57:10,240 [INFO] Computing non-zero element counts
2025-01-12 22:57:11,539 [INFO] Computing sum of non-zero elements
2025-01-12 22:57:12,257 [INFO] Computing mean of non-zero elements
2025-01-12 22:57:12,258 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 22:57:12,260 [INFO] Top 100 nz_mean values selected.
2025-01-12 22:57:12,260 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 22:57:12,261 [INFO] Top 100 act_cnt values selected.
2025-01-12 22:57:55,279 [INFO] Computing steering vectors using method: val_mul
2025-01-12 22:57:55,293 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 22:58:01,293 [INFO] Example prompt:  Hei, you are so
2025-01-12 22:58:01,296 [INFO] Generating texts **without** steering... 
2025-01-12 22:58:01,381 [INFO] hook is HookPoint()

2025-01-12 22:58:03,206 [INFO] Generated Text: 1:  Hei, you are so smart. You're so smart. You're so smart."

"I'm not sure I can do that," he said, "but I'm going to try."

"You know what?" she asked. "You don't have
2025-01-12 22:58:03,206 [INFO] Generated Text: 2:  Hei, you are so beautiful.

"I'm not going to let you down," he said. "You're my best friend."

"I love you too," she said. "You're the best person I've ever known."<|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-12 22:58:03,207 [INFO] Generated Text: 3:  Hei, you are so good at it.

I'm not sure if I can say that I've ever been a fan of the series, but I do know that this is one of those things where you're going to get a lot of people who will be excited
2025-01-12 22:58:03,208 [INFO] 干预之后的结果
2025-01-12 22:58:03,208 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 22:58:03,209 [INFO] ** Generating texts with steering... Target **
2025-01-12 22:58:03,243 [INFO] hook is HookPoint()

2025-01-12 22:58:05,155 [INFO] Generated Text: 1:  Hei, you are so stupid. You're a coward. You're a coward who thinks he can save the world by killing people. And you think that's what he's doing to his family and his friends? That's what he's doing to himself."

"
2025-01-12 22:58:05,156 [INFO] Generated Text: 2:  Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

"I know that it's not right for your family to be in this situation, but I want to make sure that we
2025-01-12 22:58:05,156 [INFO] Generated Text: 3:  Hei, you are so stupid. You're so stupid that you can't even think about what's going on in your head.

"I'm sorry, but I don't know how to deal with this." She said as she looked at him with a sad expression
2025-01-12 22:58:16,140 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:58:43,185 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:58:49,540 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 22:59:37,658 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 23:42:06,597 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-12 23:42:06,630 [INFO] Hyperparameters:
2025-01-12 23:42:06,631 [INFO]   layer: 6
2025-01-12 23:42:06,633 [INFO]   LLM: gpt2-small
2025-01-12 23:42:06,635 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 23:42:06,636 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 23:42:06,637 [INFO]   output_dir: ./results
2025-01-12 23:42:06,638 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 23:42:06,639 [INFO]   task: sentiment
2025-01-12 23:42:06,640 [INFO]   seed: 42
2025-01-12 23:42:06,641 [INFO]   data_size: 1000
2025-01-12 23:42:06,642 [INFO]   device: cpu
2025-01-12 23:42:06,644 [INFO]   alpha: 100
2025-01-12 23:42:06,645 [INFO]   steer: pos-neg
2025-01-12 23:42:06,646 [INFO]   method: val_mul
2025-01-12 23:42:06,647 [INFO]   topk_mean: 100
2025-01-12 23:42:06,648 [INFO]   topk_cnt: 100
2025-01-12 23:42:06,649 [INFO]   batch_size: 32
2025-01-12 23:42:09,526 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 23:42:15,685 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-12 23:42:15,695 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-12 23:42:16,153 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-12 23:42:16,192 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-12 23:42:32,620 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-12 23:42:34,971 [INFO] Hyperparameters:
2025-01-12 23:42:34,973 [INFO]   layer: 6
2025-01-12 23:42:34,974 [INFO]   LLM: gpt2-small
2025-01-12 23:42:34,975 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-12 23:42:34,977 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 23:42:34,978 [INFO]   output_dir: ./results
2025-01-12 23:42:34,979 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-12 23:42:34,980 [INFO]   task: sentiment
2025-01-12 23:42:34,981 [INFO]   seed: 42
2025-01-12 23:42:34,982 [INFO]   data_size: 1000
2025-01-12 23:42:34,983 [INFO]   device: cpu
2025-01-12 23:42:34,984 [INFO]   alpha: 100
2025-01-12 23:42:34,985 [INFO]   steer: pos-neg
2025-01-12 23:42:34,986 [INFO]   method: val_mul
2025-01-12 23:42:34,987 [INFO]   topk_mean: 100
2025-01-12 23:42:34,989 [INFO]   topk_cnt: 100
2025-01-12 23:42:34,990 [INFO]   batch_size: 32
2025-01-12 23:42:34,992 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-12 23:42:34,993 [INFO] Loading model: gpt2-small
2025-01-12 23:43:18,147 [INFO] Loading SAE for layer 6
2025-01-12 23:43:50,387 [INFO] Running model with cache to obtain hidden states
2025-01-12 23:43:51,033 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 23:43:51,035 [INFO] Encoding hidden states for batch 1
2025-01-12 23:43:51,465 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:43:51,466 [INFO] Encoding hidden states for batch 2
2025-01-12 23:43:51,771 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 23:43:51,773 [INFO] Encoding hidden states for batch 3
2025-01-12 23:43:52,090 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 23:43:52,092 [INFO] Encoding hidden states for batch 4
2025-01-12 23:43:52,373 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 23:43:52,375 [INFO] Encoding hidden states for batch 5
2025-01-12 23:43:52,675 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:43:52,676 [INFO] Encoding hidden states for batch 6
2025-01-12 23:43:52,994 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 23:43:52,995 [INFO] Encoding hidden states for batch 7
2025-01-12 23:43:53,254 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-12 23:43:53,256 [INFO] Encoding hidden states for batch 8
2025-01-12 23:43:53,520 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:43:53,521 [INFO] Encoding hidden states for batch 9
2025-01-12 23:43:53,844 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 23:43:53,845 [INFO] Encoding hidden states for batch 10
2025-01-12 23:43:54,174 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 23:43:54,175 [INFO] Encoding hidden states for batch 11
2025-01-12 23:43:54,535 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 23:43:54,536 [INFO] Encoding hidden states for batch 12
2025-01-12 23:43:54,886 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:43:54,888 [INFO] Encoding hidden states for batch 13
2025-01-12 23:43:55,202 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 23:43:55,203 [INFO] Encoding hidden states for batch 14
2025-01-12 23:43:55,485 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-12 23:43:55,487 [INFO] Encoding hidden states for batch 15
2025-01-12 23:43:55,715 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-12 23:43:55,716 [INFO] Encoding hidden states for batch 16
2025-01-12 23:43:55,970 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:43:55,971 [INFO] Encoding hidden states for batch 17
2025-01-12 23:43:56,252 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:43:56,254 [INFO] Encoding hidden states for batch 18
2025-01-12 23:43:56,548 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:43:56,550 [INFO] Encoding hidden states for batch 19
2025-01-12 23:43:56,920 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 23:43:56,921 [INFO] Encoding hidden states for batch 20
2025-01-12 23:43:57,259 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:43:57,260 [INFO] Encoding hidden states for batch 21
2025-01-12 23:43:57,596 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-12 23:43:57,598 [INFO] Encoding hidden states for batch 22
2025-01-12 23:43:57,884 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 23:43:57,885 [INFO] Encoding hidden states for batch 23
2025-01-12 23:43:58,138 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:43:58,140 [INFO] Encoding hidden states for batch 24
2025-01-12 23:43:58,591 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:43:58,593 [INFO] Encoding hidden states for batch 25
2025-01-12 23:43:58,901 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:43:58,902 [INFO] Encoding hidden states for batch 26
2025-01-12 23:43:59,180 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:43:59,181 [INFO] Encoding hidden states for batch 27
2025-01-12 23:43:59,489 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 23:43:59,490 [INFO] Encoding hidden states for batch 28
2025-01-12 23:43:59,753 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:43:59,755 [INFO] Encoding hidden states for batch 29
2025-01-12 23:44:00,045 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 23:44:00,046 [INFO] Encoding hidden states for batch 30
2025-01-12 23:44:00,337 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:00,338 [INFO] Encoding hidden states for batch 31
2025-01-12 23:44:00,510 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-12 23:44:00,512 [INFO] Encoding hidden states for batch 32
2025-01-12 23:44:00,521 [INFO] Total batches processed: 32
2025-01-12 23:44:00,525 [INFO] 最大长度:60
2025-01-12 23:44:00,962 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-12 23:44:00,963 [INFO] Computing non-zero element counts
2025-01-12 23:44:02,086 [INFO] Computing sum of non-zero elements
2025-01-12 23:44:02,667 [INFO] Computing mean of non-zero elements
2025-01-12 23:44:02,669 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 23:44:02,672 [INFO] Top 100 nz_mean values selected.
2025-01-12 23:44:02,673 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 23:44:02,674 [INFO] Top 100 act_cnt values selected.
2025-01-12 23:44:03,219 [INFO] Running model with cache to obtain hidden states
2025-01-12 23:44:03,488 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-12 23:44:03,490 [INFO] Encoding hidden states for batch 1
2025-01-12 23:44:03,800 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:44:03,801 [INFO] Encoding hidden states for batch 2
2025-01-12 23:44:04,090 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:04,091 [INFO] Encoding hidden states for batch 3
2025-01-12 23:44:04,383 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 23:44:04,385 [INFO] Encoding hidden states for batch 4
2025-01-12 23:44:04,641 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-12 23:44:04,642 [INFO] Encoding hidden states for batch 5
2025-01-12 23:44:04,898 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:04,900 [INFO] Encoding hidden states for batch 6
2025-01-12 23:44:05,165 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:05,166 [INFO] Encoding hidden states for batch 7
2025-01-12 23:44:05,461 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:44:05,463 [INFO] Encoding hidden states for batch 8
2025-01-12 23:44:05,794 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:44:05,795 [INFO] Encoding hidden states for batch 9
2025-01-12 23:44:06,127 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 23:44:06,129 [INFO] Encoding hidden states for batch 10
2025-01-12 23:44:06,432 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 23:44:06,433 [INFO] Encoding hidden states for batch 11
2025-01-12 23:44:06,745 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:44:06,746 [INFO] Encoding hidden states for batch 12
2025-01-12 23:44:07,026 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:07,027 [INFO] Encoding hidden states for batch 13
2025-01-12 23:44:07,289 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:44:07,290 [INFO] Encoding hidden states for batch 14
2025-01-12 23:44:07,565 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:44:07,566 [INFO] Encoding hidden states for batch 15
2025-01-12 23:44:07,849 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:07,851 [INFO] Encoding hidden states for batch 16
2025-01-12 23:44:08,109 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 23:44:08,111 [INFO] Encoding hidden states for batch 17
2025-01-12 23:44:08,385 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:44:08,387 [INFO] Encoding hidden states for batch 18
2025-01-12 23:44:08,707 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:44:08,708 [INFO] Encoding hidden states for batch 19
2025-01-12 23:44:09,067 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 23:44:09,069 [INFO] Encoding hidden states for batch 20
2025-01-12 23:44:09,353 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:44:09,354 [INFO] Encoding hidden states for batch 21
2025-01-12 23:44:09,627 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:09,628 [INFO] Encoding hidden states for batch 22
2025-01-12 23:44:09,977 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 23:44:09,978 [INFO] Encoding hidden states for batch 23
2025-01-12 23:44:10,271 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 23:44:10,272 [INFO] Encoding hidden states for batch 24
2025-01-12 23:44:10,582 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:44:10,583 [INFO] Encoding hidden states for batch 25
2025-01-12 23:44:10,867 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-12 23:44:10,869 [INFO] Encoding hidden states for batch 26
2025-01-12 23:44:11,145 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:11,146 [INFO] Encoding hidden states for batch 27
2025-01-12 23:44:11,405 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 23:44:11,407 [INFO] Encoding hidden states for batch 28
2025-01-12 23:44:11,655 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 23:44:11,656 [INFO] Encoding hidden states for batch 29
2025-01-12 23:44:11,899 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-12 23:44:11,900 [INFO] Encoding hidden states for batch 30
2025-01-12 23:44:12,207 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-12 23:44:12,209 [INFO] Encoding hidden states for batch 31
2025-01-12 23:44:12,388 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-12 23:44:12,389 [INFO] Encoding hidden states for batch 32
2025-01-12 23:44:12,399 [INFO] Total batches processed: 32
2025-01-12 23:44:12,403 [INFO] 最大长度:59
2025-01-12 23:44:12,825 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-12 23:44:12,827 [INFO] Computing non-zero element counts
2025-01-12 23:44:13,893 [INFO] Computing sum of non-zero elements
2025-01-12 23:44:14,462 [INFO] Computing mean of non-zero elements
2025-01-12 23:44:14,464 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 23:44:14,465 [INFO] Top 100 nz_mean values selected.
2025-01-12 23:44:14,466 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 23:44:14,467 [INFO] Top 100 act_cnt values selected.
2025-01-12 23:44:14,996 [INFO] Running model with cache to obtain hidden states
2025-01-12 23:44:15,334 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-12 23:44:15,335 [INFO] Encoding hidden states for batch 1
2025-01-12 23:44:15,709 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 23:44:15,711 [INFO] Encoding hidden states for batch 2
2025-01-12 23:44:16,003 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:16,004 [INFO] Encoding hidden states for batch 3
2025-01-12 23:44:16,296 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:16,297 [INFO] Encoding hidden states for batch 4
2025-01-12 23:44:16,572 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:16,573 [INFO] Encoding hidden states for batch 5
2025-01-12 23:44:16,856 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-12 23:44:16,858 [INFO] Encoding hidden states for batch 6
2025-01-12 23:44:17,156 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-12 23:44:17,157 [INFO] Encoding hidden states for batch 7
2025-01-12 23:44:17,431 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 23:44:17,432 [INFO] Encoding hidden states for batch 8
2025-01-12 23:44:17,706 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:17,707 [INFO] Encoding hidden states for batch 9
2025-01-12 23:44:17,999 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 23:44:18,000 [INFO] Encoding hidden states for batch 10
2025-01-12 23:44:18,269 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-12 23:44:18,271 [INFO] Encoding hidden states for batch 11
2025-01-12 23:44:18,582 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 23:44:18,584 [INFO] Encoding hidden states for batch 12
2025-01-12 23:44:18,874 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-12 23:44:18,875 [INFO] Encoding hidden states for batch 13
2025-01-12 23:44:19,163 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 23:44:19,165 [INFO] Encoding hidden states for batch 14
2025-01-12 23:44:19,454 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:19,456 [INFO] Encoding hidden states for batch 15
2025-01-12 23:44:19,776 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-12 23:44:19,778 [INFO] Encoding hidden states for batch 16
2025-01-12 23:44:20,069 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-12 23:44:20,070 [INFO] Encoding hidden states for batch 17
2025-01-12 23:44:20,346 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:20,348 [INFO] Encoding hidden states for batch 18
2025-01-12 23:44:20,655 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:44:20,657 [INFO] Encoding hidden states for batch 19
2025-01-12 23:44:20,943 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:20,944 [INFO] Encoding hidden states for batch 20
2025-01-12 23:44:21,293 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-12 23:44:21,294 [INFO] Encoding hidden states for batch 21
2025-01-12 23:44:21,574 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 23:44:21,576 [INFO] Encoding hidden states for batch 22
2025-01-12 23:44:21,973 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-12 23:44:21,975 [INFO] Encoding hidden states for batch 23
2025-01-12 23:44:22,285 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-12 23:44:22,287 [INFO] Encoding hidden states for batch 24
2025-01-12 23:44:22,558 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:22,560 [INFO] Encoding hidden states for batch 25
2025-01-12 23:44:22,852 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-12 23:44:22,853 [INFO] Encoding hidden states for batch 26
2025-01-12 23:44:23,123 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-12 23:44:23,125 [INFO] Encoding hidden states for batch 27
2025-01-12 23:44:23,410 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-12 23:44:23,411 [INFO] Encoding hidden states for batch 28
2025-01-12 23:44:23,688 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-12 23:44:23,690 [INFO] Encoding hidden states for batch 29
2025-01-12 23:44:23,988 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-12 23:44:23,990 [INFO] Encoding hidden states for batch 30
2025-01-12 23:44:24,271 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-12 23:44:24,272 [INFO] Encoding hidden states for batch 31
2025-01-12 23:44:24,459 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-12 23:44:24,461 [INFO] Encoding hidden states for batch 32
2025-01-12 23:44:24,472 [INFO] Total batches processed: 32
2025-01-12 23:44:24,476 [INFO] 最大长度:76
2025-01-12 23:44:25,012 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-12 23:44:25,013 [INFO] Computing non-zero element counts
2025-01-12 23:44:26,306 [INFO] Computing sum of non-zero elements
2025-01-12 23:44:26,995 [INFO] Computing mean of non-zero elements
2025-01-12 23:44:26,997 [INFO] Selecting top-k indices based on nz_mean
2025-01-12 23:44:26,998 [INFO] Top 100 nz_mean values selected.
2025-01-12 23:44:26,998 [INFO] Selecting top-k indices based on act_cnt
2025-01-12 23:44:27,000 [INFO] Top 100 act_cnt values selected.
2025-01-12 23:44:28,057 [INFO] Computing steering vectors using method: val_mul
2025-01-12 23:44:28,070 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-12 23:44:28,124 [INFO] Example prompt:  Hei, you are so
2025-01-12 23:44:28,126 [INFO] Generating texts **without** steering... 
2025-01-12 23:44:28,212 [INFO] hook is HookPoint()

2025-01-12 23:44:29,955 [INFO] Generated Text: 1:  Hei, you are so much better than me.

"I'm not going to let you down."

"You're a good person, and I'm glad that you're here. I'll be back soon."

"I'll be back soon!"
2025-01-12 23:44:29,956 [INFO] Generated Text: 2:  Hei, you are so good at this.

The next day, the same day that I was told to leave my house and go to work, I went out with my family and started walking around the neighborhood. It was a very quiet street. There were no cars
2025-01-12 23:44:29,957 [INFO] Generated Text: 3:  Hei, you are so good at it.

I'm not sure if I can say that I've ever been a fan of the game, but I have to admit that it's one of my favorite games. It's a very fun game and one that has me
2025-01-12 23:44:29,958 [INFO] 干预之后的结果
2025-01-12 23:44:29,959 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 23:44:29,959 [INFO] ** Generating texts with steering... Target **
2025-01-12 23:44:29,993 [INFO] hook is HookPoint()

2025-01-12 23:44:31,822 [INFO] Generated Text: 1:  Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

I am sorry for the pain that has been caused by this situation. I will not be able to live with this in my
2025-01-12 23:44:31,823 [INFO] Generated Text: 2:  Hei, you are so much more than a bad character.

"I'm not going to say that I'm sorry for what happened," he said. "I just want to make sure that people understand that this is not the kind of thing we're going to tolerate
2025-01-12 23:44:31,824 [INFO] Generated Text: 3:  Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

I am not going to lie about this, but it's a terrible thing for the family and I want them to know that
2025-01-12 23:44:31,946 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 23:57:22,591 [INFO] hook is HookPoint()

2025-01-12 23:57:24,326 [INFO] Generated Text: 1:  Hei, you are so much better than me.

"I'm not going to tell you what I think about your life. I don't want to hear it."

"You're not going to tell me what I think about your life?" asked the man
2025-01-12 23:57:24,327 [INFO] Generated Text: 2:  Hei, you are so much better than me.

Kong: I'm not a bad person. I'm just a little bit different from you.

Hui: You're the one who's always been here for me, right? That's why I
2025-01-12 23:57:24,327 [INFO] Generated Text: 3:  Hei, you are so good at it.

The only thing that makes me happy is that I'm not going to be able to do anything about it. I'm going to have to go back and try something else. It's a very difficult situation for me,
2025-01-12 23:57:24,327 [INFO] ** Generating texts with steering... Target **
2025-01-12 23:57:24,358 [INFO] hook is HookPoint()

2025-01-12 23:57:26,065 [INFO] Generated Text: 1:  Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," she said, "but I don't want to hear about it."

"You know what?" he asked. "I'm not going to tell
2025-01-12 23:57:26,066 [INFO] Generated Text: 2:  Hei, you are so unkind to your people.

I am not a person who would have done this to my family. I am a person who would have done it to myself. I am not a person who would have done this to anyone else. I'm
2025-01-12 23:57:26,066 [INFO] Generated Text: 3:  Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," she said, "but I don't want to hear about it."

"You know what?" he asked. "I'm not going to tell
2025-01-12 23:57:26,102 [INFO] hook is HookPoint()

2025-01-12 23:57:58,792 [INFO] Example prompt:  Hei, you are so
2025-01-12 23:57:58,794 [INFO] Generating texts **without** steering... 
2025-01-12 23:57:58,865 [INFO] hook is HookPoint()

2025-01-12 23:58:00,539 [INFO] 干预之后的结果
2025-01-12 23:58:00,540 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 23:58:00,540 [INFO] ** Generating texts with steering... Target **
2025-01-12 23:58:00,571 [INFO] hook is HookPoint()

2025-01-12 23:58:11,299 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-12 23:58:23,075 [INFO] hook is HookPoint()

2025-01-12 23:58:24,801 [INFO] hook is HookPoint()

2025-01-12 23:58:26,567 [INFO] hook is HookPoint()

2025-01-12 23:58:28,432 [INFO] hook is HookPoint()

2025-01-12 23:58:30,288 [INFO] hook is HookPoint()

2025-01-12 23:58:32,183 [INFO] hook is HookPoint()

2025-01-12 23:58:34,015 [INFO] hook is HookPoint()

2025-01-12 23:58:35,838 [INFO] hook is HookPoint()

2025-01-12 23:59:09,042 [INFO] Example prompt:  Hei, you are so
2025-01-12 23:59:09,044 [INFO] Generating texts **without** steering... 
2025-01-12 23:59:10,818 [INFO] 干预之后的结果
2025-01-12 23:59:10,819 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-12 23:59:10,819 [INFO] ** Generating texts with steering... Target **
2025-01-12 23:59:18,446 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 12:53:04,008 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 12:53:04,011 [INFO] Hyperparameters:
2025-01-13 12:53:04,012 [INFO]   layer: 6
2025-01-13 12:53:04,014 [INFO]   LLM: gpt2-small
2025-01-13 12:53:04,015 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 12:53:04,015 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 12:53:04,016 [INFO]   output_dir: ./results
2025-01-13 12:53:04,017 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 12:53:04,019 [INFO]   task: sentiment
2025-01-13 12:53:04,020 [INFO]   seed: 42
2025-01-13 12:53:04,021 [INFO]   data_size: 1000
2025-01-13 12:53:04,021 [INFO]   device: cpu
2025-01-13 12:53:04,023 [INFO]   alpha: 100
2025-01-13 12:53:04,024 [INFO]   steer: pos-neg
2025-01-13 12:53:04,025 [INFO]   method: val_mul
2025-01-13 12:53:04,026 [INFO]   topk_mean: 100
2025-01-13 12:53:04,079 [INFO]   topk_cnt: 100
2025-01-13 12:53:04,080 [INFO]   batch_size: 32
2025-01-13 12:53:12,848 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 12:53:25,833 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 12:53:25,836 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 12:53:26,018 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 12:53:26,030 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 12:56:39,079 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 12:56:42,982 [INFO] Hyperparameters:
2025-01-13 12:56:42,984 [INFO]   layer: 6
2025-01-13 12:56:42,985 [INFO]   LLM: gpt2-small
2025-01-13 12:56:42,986 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 12:56:42,987 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 12:56:42,988 [INFO]   output_dir: ./results
2025-01-13 12:56:42,990 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 12:56:42,991 [INFO]   task: sentiment
2025-01-13 12:56:42,992 [INFO]   seed: 42
2025-01-13 12:56:42,993 [INFO]   data_size: 1000
2025-01-13 12:56:42,994 [INFO]   device: cpu
2025-01-13 12:56:42,996 [INFO]   alpha: 100
2025-01-13 12:56:42,997 [INFO]   steer: pos-neg
2025-01-13 12:56:42,998 [INFO]   method: val_mul
2025-01-13 12:56:42,999 [INFO]   topk_mean: 100
2025-01-13 12:56:42,999 [INFO]   topk_cnt: 100
2025-01-13 12:56:43,000 [INFO]   batch_size: 32
2025-01-13 12:56:43,003 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 12:56:43,005 [INFO] Loading model: gpt2-small
2025-01-13 12:57:23,825 [INFO] Loading SAE for layer 6
2025-01-13 13:16:30,849 [INFO] Hyperparameters:
2025-01-13 13:16:30,851 [INFO]   layer: 6
2025-01-13 13:16:30,852 [INFO]   LLM: gpt2-small
2025-01-13 13:16:30,853 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:16:30,854 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:16:30,855 [INFO]   output_dir: ./results
2025-01-13 13:16:30,856 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:16:30,856 [INFO]   task: sentiment
2025-01-13 13:16:30,857 [INFO]   seed: 42
2025-01-13 13:16:30,858 [INFO]   data_size: 1000
2025-01-13 13:16:30,859 [INFO]   device: cpu
2025-01-13 13:16:30,860 [INFO]   alpha: 100
2025-01-13 13:16:30,876 [INFO]   steer: pos-neg
2025-01-13 13:16:30,878 [INFO]   method: val_mul
2025-01-13 13:16:30,879 [INFO]   topk_mean: 100
2025-01-13 13:16:30,880 [INFO]   topk_cnt: 100
2025-01-13 13:16:30,882 [INFO]   batch_size: 32
2025-01-13 13:16:30,884 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 13:16:30,885 [INFO] Loading model: gpt2-small
2025-01-13 13:16:57,523 [INFO] Loading SAE for layer 6
2025-01-13 13:23:08,483 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 13:23:08,487 [INFO] Hyperparameters:
2025-01-13 13:23:08,489 [INFO]   layer: 6
2025-01-13 13:23:08,491 [INFO]   LLM: gpt2-small
2025-01-13 13:23:08,492 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:23:08,494 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:23:08,496 [INFO]   output_dir: ./results
2025-01-13 13:23:08,497 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:23:08,498 [INFO]   task: sentiment
2025-01-13 13:23:08,500 [INFO]   seed: 42
2025-01-13 13:23:08,502 [INFO]   data_size: 1000
2025-01-13 13:23:08,503 [INFO]   device: cpu
2025-01-13 13:23:08,504 [INFO]   alpha: 100
2025-01-13 13:23:08,506 [INFO]   steer: pos-neg
2025-01-13 13:23:08,507 [INFO]   method: val_mul
2025-01-13 13:23:08,508 [INFO]   topk_mean: 100
2025-01-13 13:23:08,510 [INFO]   topk_cnt: 100
2025-01-13 13:23:08,511 [INFO]   batch_size: 32
2025-01-13 13:23:26,799 [INFO] PyTorch version 2.5.0+cu121 available.
2025-01-13 13:23:39,834 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 13:23:39,836 [INFO] Hyperparameters:
2025-01-13 13:23:39,837 [INFO]   layer: 6
2025-01-13 13:23:39,839 [INFO]   LLM: gpt2-small
2025-01-13 13:23:39,840 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:23:39,841 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:23:39,842 [INFO]   output_dir: ./results
2025-01-13 13:23:39,844 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:23:39,846 [INFO]   task: sentiment
2025-01-13 13:23:39,847 [INFO]   seed: 42
2025-01-13 13:23:39,849 [INFO]   data_size: 1000
2025-01-13 13:23:39,851 [INFO]   device: cpu
2025-01-13 13:23:39,852 [INFO]   alpha: 100
2025-01-13 13:23:39,853 [INFO]   steer: pos-neg
2025-01-13 13:23:39,854 [INFO]   method: val_mul
2025-01-13 13:23:39,855 [INFO]   topk_mean: 100
2025-01-13 13:23:39,857 [INFO]   topk_cnt: 100
2025-01-13 13:23:39,858 [INFO]   batch_size: 32
2025-01-13 13:23:43,715 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 13:23:52,704 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 13:23:52,709 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 13:23:52,914 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 13:23:52,926 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 13:24:13,846 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 13:24:17,454 [INFO] Hyperparameters:
2025-01-13 13:24:17,458 [INFO]   layer: 6
2025-01-13 13:24:17,460 [INFO]   LLM: gpt2-small
2025-01-13 13:24:17,462 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:24:17,464 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:24:17,465 [INFO]   output_dir: ./results
2025-01-13 13:24:17,466 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:24:17,467 [INFO]   task: sentiment
2025-01-13 13:24:17,469 [INFO]   seed: 42
2025-01-13 13:24:17,470 [INFO]   data_size: 1000
2025-01-13 13:24:17,471 [INFO]   device: cpu
2025-01-13 13:24:17,472 [INFO]   alpha: 100
2025-01-13 13:24:17,473 [INFO]   steer: pos-neg
2025-01-13 13:24:17,475 [INFO]   method: val_mul
2025-01-13 13:24:17,476 [INFO]   topk_mean: 100
2025-01-13 13:24:17,477 [INFO]   topk_cnt: 100
2025-01-13 13:24:17,479 [INFO]   batch_size: 32
2025-01-13 13:24:17,481 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 13:24:17,483 [INFO] Loading model: gpt2-small
2025-01-13 13:25:28,265 [INFO] Loading SAE for layer 6
2025-01-13 13:26:09,906 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:26:10,299 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:26:10,301 [INFO] Encoding hidden states for batch 1
2025-01-13 13:26:10,747 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:10,749 [INFO] Encoding hidden states for batch 2
2025-01-13 13:26:11,076 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:26:11,078 [INFO] Encoding hidden states for batch 3
2025-01-13 13:26:11,409 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:26:11,411 [INFO] Encoding hidden states for batch 4
2025-01-13 13:26:11,726 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:26:11,728 [INFO] Encoding hidden states for batch 5
2025-01-13 13:26:12,014 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:12,016 [INFO] Encoding hidden states for batch 6
2025-01-13 13:26:12,339 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:26:12,341 [INFO] Encoding hidden states for batch 7
2025-01-13 13:26:12,610 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 13:26:12,611 [INFO] Encoding hidden states for batch 8
2025-01-13 13:26:12,873 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:12,873 [INFO] Encoding hidden states for batch 9
2025-01-13 13:26:13,194 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:26:13,196 [INFO] Encoding hidden states for batch 10
2025-01-13 13:26:13,501 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:26:13,502 [INFO] Encoding hidden states for batch 11
2025-01-13 13:26:13,837 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 13:26:13,839 [INFO] Encoding hidden states for batch 12
2025-01-13 13:26:14,179 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:14,181 [INFO] Encoding hidden states for batch 13
2025-01-13 13:26:14,487 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:26:14,489 [INFO] Encoding hidden states for batch 14
2025-01-13 13:26:14,771 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 13:26:14,772 [INFO] Encoding hidden states for batch 15
2025-01-13 13:26:15,016 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 13:26:15,018 [INFO] Encoding hidden states for batch 16
2025-01-13 13:26:15,277 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:15,278 [INFO] Encoding hidden states for batch 17
2025-01-13 13:26:15,560 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:15,562 [INFO] Encoding hidden states for batch 18
2025-01-13 13:26:15,861 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:15,862 [INFO] Encoding hidden states for batch 19
2025-01-13 13:26:16,725 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:26:16,727 [INFO] Encoding hidden states for batch 20
2025-01-13 13:26:17,080 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:17,081 [INFO] Encoding hidden states for batch 21
2025-01-13 13:26:17,434 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 13:26:17,435 [INFO] Encoding hidden states for batch 22
2025-01-13 13:26:18,006 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:26:18,007 [INFO] Encoding hidden states for batch 23
2025-01-13 13:26:18,278 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:18,280 [INFO] Encoding hidden states for batch 24
2025-01-13 13:26:18,566 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:18,567 [INFO] Encoding hidden states for batch 25
2025-01-13 13:26:18,870 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:18,872 [INFO] Encoding hidden states for batch 26
2025-01-13 13:26:19,154 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:19,156 [INFO] Encoding hidden states for batch 27
2025-01-13 13:26:19,694 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:26:19,696 [INFO] Encoding hidden states for batch 28
2025-01-13 13:26:20,021 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:20,023 [INFO] Encoding hidden states for batch 29
2025-01-13 13:26:20,377 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:26:20,379 [INFO] Encoding hidden states for batch 30
2025-01-13 13:26:20,707 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:20,709 [INFO] Encoding hidden states for batch 31
2025-01-13 13:26:20,901 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 13:26:20,902 [INFO] Encoding hidden states for batch 32
2025-01-13 13:26:20,910 [INFO] Total batches processed: 32
2025-01-13 13:26:20,913 [INFO] 最大长度:60
2025-01-13 13:26:21,390 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 13:26:21,390 [INFO] Computing non-zero element counts
2025-01-13 13:26:22,582 [INFO] Computing sum of non-zero elements
2025-01-13 13:26:23,149 [INFO] Computing mean of non-zero elements
2025-01-13 13:26:23,151 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:26:23,152 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:26:23,153 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:26:23,154 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:26:23,695 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:26:24,029 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 13:26:24,030 [INFO] Encoding hidden states for batch 1
2025-01-13 13:26:24,491 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:24,492 [INFO] Encoding hidden states for batch 2
2025-01-13 13:26:24,796 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:24,797 [INFO] Encoding hidden states for batch 3
2025-01-13 13:26:25,105 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:26:25,107 [INFO] Encoding hidden states for batch 4
2025-01-13 13:26:25,381 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 13:26:25,382 [INFO] Encoding hidden states for batch 5
2025-01-13 13:26:25,642 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:25,644 [INFO] Encoding hidden states for batch 6
2025-01-13 13:26:25,900 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:25,901 [INFO] Encoding hidden states for batch 7
2025-01-13 13:26:26,189 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:26,190 [INFO] Encoding hidden states for batch 8
2025-01-13 13:26:26,532 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:26,533 [INFO] Encoding hidden states for batch 9
2025-01-13 13:26:26,872 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 13:26:26,874 [INFO] Encoding hidden states for batch 10
2025-01-13 13:26:27,174 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:26:27,175 [INFO] Encoding hidden states for batch 11
2025-01-13 13:26:27,472 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:27,474 [INFO] Encoding hidden states for batch 12
2025-01-13 13:26:27,754 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:27,756 [INFO] Encoding hidden states for batch 13
2025-01-13 13:26:28,021 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:28,023 [INFO] Encoding hidden states for batch 14
2025-01-13 13:26:28,285 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:28,287 [INFO] Encoding hidden states for batch 15
2025-01-13 13:26:28,563 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:28,565 [INFO] Encoding hidden states for batch 16
2025-01-13 13:26:28,822 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:26:28,824 [INFO] Encoding hidden states for batch 17
2025-01-13 13:26:29,107 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:29,109 [INFO] Encoding hidden states for batch 18
2025-01-13 13:26:29,411 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:29,413 [INFO] Encoding hidden states for batch 19
2025-01-13 13:26:29,755 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:26:29,757 [INFO] Encoding hidden states for batch 20
2025-01-13 13:26:30,042 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:30,044 [INFO] Encoding hidden states for batch 21
2025-01-13 13:26:30,308 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:30,310 [INFO] Encoding hidden states for batch 22
2025-01-13 13:26:30,638 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 13:26:30,640 [INFO] Encoding hidden states for batch 23
2025-01-13 13:26:30,945 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:26:30,946 [INFO] Encoding hidden states for batch 24
2025-01-13 13:26:31,249 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:31,250 [INFO] Encoding hidden states for batch 25
2025-01-13 13:26:31,532 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:26:31,534 [INFO] Encoding hidden states for batch 26
2025-01-13 13:26:31,816 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:31,818 [INFO] Encoding hidden states for batch 27
2025-01-13 13:26:32,083 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:26:32,085 [INFO] Encoding hidden states for batch 28
2025-01-13 13:26:32,340 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 13:26:32,342 [INFO] Encoding hidden states for batch 29
2025-01-13 13:26:32,592 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 13:26:32,594 [INFO] Encoding hidden states for batch 30
2025-01-13 13:26:32,893 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 13:26:32,894 [INFO] Encoding hidden states for batch 31
2025-01-13 13:26:33,084 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 13:26:33,085 [INFO] Encoding hidden states for batch 32
2025-01-13 13:26:33,095 [INFO] Total batches processed: 32
2025-01-13 13:26:33,099 [INFO] 最大长度:59
2025-01-13 13:26:33,518 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 13:26:33,519 [INFO] Computing non-zero element counts
2025-01-13 13:26:34,543 [INFO] Computing sum of non-zero elements
2025-01-13 13:26:35,073 [INFO] Computing mean of non-zero elements
2025-01-13 13:26:35,075 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:26:35,076 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:26:35,077 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:26:35,078 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:26:35,585 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:26:35,903 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 13:26:35,904 [INFO] Encoding hidden states for batch 1
2025-01-13 13:26:36,272 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:26:36,273 [INFO] Encoding hidden states for batch 2
2025-01-13 13:26:36,558 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:36,559 [INFO] Encoding hidden states for batch 3
2025-01-13 13:26:36,838 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:36,839 [INFO] Encoding hidden states for batch 4
2025-01-13 13:26:37,110 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:37,111 [INFO] Encoding hidden states for batch 5
2025-01-13 13:26:37,401 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:26:37,403 [INFO] Encoding hidden states for batch 6
2025-01-13 13:26:37,694 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:26:37,696 [INFO] Encoding hidden states for batch 7
2025-01-13 13:26:37,961 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:26:37,963 [INFO] Encoding hidden states for batch 8
2025-01-13 13:26:38,241 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:38,243 [INFO] Encoding hidden states for batch 9
2025-01-13 13:26:38,530 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:26:38,531 [INFO] Encoding hidden states for batch 10
2025-01-13 13:26:38,792 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 13:26:38,794 [INFO] Encoding hidden states for batch 11
2025-01-13 13:26:39,113 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:26:39,115 [INFO] Encoding hidden states for batch 12
2025-01-13 13:26:39,403 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:26:39,404 [INFO] Encoding hidden states for batch 13
2025-01-13 13:26:39,680 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:26:39,682 [INFO] Encoding hidden states for batch 14
2025-01-13 13:26:39,950 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:39,951 [INFO] Encoding hidden states for batch 15
2025-01-13 13:26:40,266 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:26:40,268 [INFO] Encoding hidden states for batch 16
2025-01-13 13:26:40,570 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:26:40,572 [INFO] Encoding hidden states for batch 17
2025-01-13 13:26:40,845 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:40,846 [INFO] Encoding hidden states for batch 18
2025-01-13 13:26:41,137 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:41,139 [INFO] Encoding hidden states for batch 19
2025-01-13 13:26:41,422 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:41,424 [INFO] Encoding hidden states for batch 20
2025-01-13 13:26:41,746 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:26:41,748 [INFO] Encoding hidden states for batch 21
2025-01-13 13:26:42,017 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:26:42,018 [INFO] Encoding hidden states for batch 22
2025-01-13 13:26:42,333 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 13:26:42,335 [INFO] Encoding hidden states for batch 23
2025-01-13 13:26:42,619 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:26:42,621 [INFO] Encoding hidden states for batch 24
2025-01-13 13:26:42,888 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:42,890 [INFO] Encoding hidden states for batch 25
2025-01-13 13:26:43,190 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:26:43,192 [INFO] Encoding hidden states for batch 26
2025-01-13 13:26:43,470 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:26:43,472 [INFO] Encoding hidden states for batch 27
2025-01-13 13:26:43,760 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:26:43,762 [INFO] Encoding hidden states for batch 28
2025-01-13 13:26:44,048 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:26:44,050 [INFO] Encoding hidden states for batch 29
2025-01-13 13:26:44,349 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:26:44,350 [INFO] Encoding hidden states for batch 30
2025-01-13 13:26:44,624 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:26:44,625 [INFO] Encoding hidden states for batch 31
2025-01-13 13:26:44,815 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 13:26:44,833 [INFO] Encoding hidden states for batch 32
2025-01-13 13:26:44,844 [INFO] Total batches processed: 32
2025-01-13 13:26:44,848 [INFO] 最大长度:76
2025-01-13 13:26:45,375 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 13:26:45,376 [INFO] Computing non-zero element counts
2025-01-13 13:26:46,821 [INFO] Computing sum of non-zero elements
2025-01-13 13:26:47,572 [INFO] Computing mean of non-zero elements
2025-01-13 13:26:47,574 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:26:47,575 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:26:47,576 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:26:47,577 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:26:48,519 [INFO] Computing steering vectors using method: val_mul
2025-01-13 13:26:48,529 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 13:26:48,685 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:26:48,687 [INFO] Generating texts **without** steering... 
2025-01-13 13:26:50,483 [INFO] 干预之后的结果
2025-01-13 13:26:50,484 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:26:50,485 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:33:03,158 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:33:03,531 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:33:03,532 [INFO] Encoding hidden states for batch 1
2025-01-13 13:33:03,981 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:03,983 [INFO] Encoding hidden states for batch 2
2025-01-13 13:33:04,318 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:33:04,320 [INFO] Encoding hidden states for batch 3
2025-01-13 13:33:04,660 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:33:04,662 [INFO] Encoding hidden states for batch 4
2025-01-13 13:33:05,028 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:33:05,030 [INFO] Encoding hidden states for batch 5
2025-01-13 13:33:05,355 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:05,358 [INFO] Encoding hidden states for batch 6
2025-01-13 13:33:05,683 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:33:05,685 [INFO] Encoding hidden states for batch 7
2025-01-13 13:33:06,012 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 13:33:06,013 [INFO] Encoding hidden states for batch 8
2025-01-13 13:33:06,581 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:06,582 [INFO] Encoding hidden states for batch 9
2025-01-13 13:33:07,229 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:33:07,231 [INFO] Encoding hidden states for batch 10
2025-01-13 13:33:07,593 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:33:07,595 [INFO] Encoding hidden states for batch 11
2025-01-13 13:33:08,054 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 13:33:08,056 [INFO] Encoding hidden states for batch 12
2025-01-13 13:33:08,399 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:08,401 [INFO] Encoding hidden states for batch 13
2025-01-13 13:33:08,714 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:33:08,715 [INFO] Encoding hidden states for batch 14
2025-01-13 13:33:09,016 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 13:33:09,018 [INFO] Encoding hidden states for batch 15
2025-01-13 13:33:09,482 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 13:33:09,484 [INFO] Encoding hidden states for batch 16
2025-01-13 13:33:09,752 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:09,753 [INFO] Encoding hidden states for batch 17
2025-01-13 13:33:10,037 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:10,038 [INFO] Encoding hidden states for batch 18
2025-01-13 13:33:10,330 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:10,331 [INFO] Encoding hidden states for batch 19
2025-01-13 13:33:10,708 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:33:10,710 [INFO] Encoding hidden states for batch 20
2025-01-13 13:33:11,058 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:11,059 [INFO] Encoding hidden states for batch 21
2025-01-13 13:33:11,431 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 13:33:11,433 [INFO] Encoding hidden states for batch 22
2025-01-13 13:33:11,767 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:33:11,768 [INFO] Encoding hidden states for batch 23
2025-01-13 13:33:12,073 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:12,075 [INFO] Encoding hidden states for batch 24
2025-01-13 13:33:12,400 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:12,402 [INFO] Encoding hidden states for batch 25
2025-01-13 13:33:12,780 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:12,782 [INFO] Encoding hidden states for batch 26
2025-01-13 13:33:13,104 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:13,105 [INFO] Encoding hidden states for batch 27
2025-01-13 13:33:13,398 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:33:13,400 [INFO] Encoding hidden states for batch 28
2025-01-13 13:33:13,669 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:13,670 [INFO] Encoding hidden states for batch 29
2025-01-13 13:33:13,944 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:33:13,945 [INFO] Encoding hidden states for batch 30
2025-01-13 13:33:14,226 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:14,227 [INFO] Encoding hidden states for batch 31
2025-01-13 13:33:14,506 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 13:33:14,507 [INFO] Encoding hidden states for batch 32
2025-01-13 13:33:14,517 [INFO] Total batches processed: 32
2025-01-13 13:33:14,519 [INFO] 最大长度:60
2025-01-13 13:33:14,975 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 13:33:14,975 [INFO] Computing non-zero element counts
2025-01-13 13:33:16,161 [INFO] Computing sum of non-zero elements
2025-01-13 13:33:16,729 [INFO] Computing mean of non-zero elements
2025-01-13 13:33:16,730 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:33:16,731 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:33:16,731 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:33:16,732 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:33:17,259 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:33:17,515 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 13:33:17,516 [INFO] Encoding hidden states for batch 1
2025-01-13 13:33:17,831 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:17,833 [INFO] Encoding hidden states for batch 2
2025-01-13 13:33:18,119 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:18,120 [INFO] Encoding hidden states for batch 3
2025-01-13 13:33:18,425 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:33:18,426 [INFO] Encoding hidden states for batch 4
2025-01-13 13:33:18,689 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 13:33:18,691 [INFO] Encoding hidden states for batch 5
2025-01-13 13:33:18,951 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:18,952 [INFO] Encoding hidden states for batch 6
2025-01-13 13:33:19,228 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:19,230 [INFO] Encoding hidden states for batch 7
2025-01-13 13:33:19,540 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:19,541 [INFO] Encoding hidden states for batch 8
2025-01-13 13:33:19,874 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:19,875 [INFO] Encoding hidden states for batch 9
2025-01-13 13:33:20,209 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 13:33:20,211 [INFO] Encoding hidden states for batch 10
2025-01-13 13:33:20,531 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:33:20,532 [INFO] Encoding hidden states for batch 11
2025-01-13 13:33:20,835 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:20,837 [INFO] Encoding hidden states for batch 12
2025-01-13 13:33:21,123 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:21,124 [INFO] Encoding hidden states for batch 13
2025-01-13 13:33:21,394 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:21,395 [INFO] Encoding hidden states for batch 14
2025-01-13 13:33:21,664 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:21,665 [INFO] Encoding hidden states for batch 15
2025-01-13 13:33:21,947 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:21,948 [INFO] Encoding hidden states for batch 16
2025-01-13 13:33:22,220 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:33:22,222 [INFO] Encoding hidden states for batch 17
2025-01-13 13:33:22,504 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:22,505 [INFO] Encoding hidden states for batch 18
2025-01-13 13:33:22,818 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:22,819 [INFO] Encoding hidden states for batch 19
2025-01-13 13:33:23,171 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:33:23,172 [INFO] Encoding hidden states for batch 20
2025-01-13 13:33:23,456 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:23,458 [INFO] Encoding hidden states for batch 21
2025-01-13 13:33:23,732 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:23,734 [INFO] Encoding hidden states for batch 22
2025-01-13 13:33:24,080 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 13:33:24,082 [INFO] Encoding hidden states for batch 23
2025-01-13 13:33:24,395 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:33:24,397 [INFO] Encoding hidden states for batch 24
2025-01-13 13:33:24,702 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:24,704 [INFO] Encoding hidden states for batch 25
2025-01-13 13:33:24,981 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 13:33:24,982 [INFO] Encoding hidden states for batch 26
2025-01-13 13:33:25,267 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:25,269 [INFO] Encoding hidden states for batch 27
2025-01-13 13:33:25,539 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:33:25,541 [INFO] Encoding hidden states for batch 28
2025-01-13 13:33:25,798 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 13:33:25,799 [INFO] Encoding hidden states for batch 29
2025-01-13 13:33:26,039 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 13:33:26,041 [INFO] Encoding hidden states for batch 30
2025-01-13 13:33:26,330 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 13:33:26,332 [INFO] Encoding hidden states for batch 31
2025-01-13 13:33:26,517 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 13:33:26,519 [INFO] Encoding hidden states for batch 32
2025-01-13 13:33:26,528 [INFO] Total batches processed: 32
2025-01-13 13:33:26,531 [INFO] 最大长度:59
2025-01-13 13:33:26,966 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 13:33:26,967 [INFO] Computing non-zero element counts
2025-01-13 13:33:27,988 [INFO] Computing sum of non-zero elements
2025-01-13 13:33:28,520 [INFO] Computing mean of non-zero elements
2025-01-13 13:33:28,521 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:33:28,523 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:33:28,523 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:33:28,524 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:33:29,022 [INFO] Running model with cache to obtain hidden states
2025-01-13 13:33:29,360 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 13:33:29,361 [INFO] Encoding hidden states for batch 1
2025-01-13 13:33:29,736 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:33:29,738 [INFO] Encoding hidden states for batch 2
2025-01-13 13:33:30,036 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:30,038 [INFO] Encoding hidden states for batch 3
2025-01-13 13:33:30,321 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:30,323 [INFO] Encoding hidden states for batch 4
2025-01-13 13:33:30,608 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:30,609 [INFO] Encoding hidden states for batch 5
2025-01-13 13:33:30,903 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 13:33:30,904 [INFO] Encoding hidden states for batch 6
2025-01-13 13:33:31,190 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 13:33:31,192 [INFO] Encoding hidden states for batch 7
2025-01-13 13:33:31,457 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:33:31,458 [INFO] Encoding hidden states for batch 8
2025-01-13 13:33:31,736 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:31,738 [INFO] Encoding hidden states for batch 9
2025-01-13 13:33:32,042 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:33:32,044 [INFO] Encoding hidden states for batch 10
2025-01-13 13:33:32,311 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 13:33:32,312 [INFO] Encoding hidden states for batch 11
2025-01-13 13:33:32,628 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:33:32,629 [INFO] Encoding hidden states for batch 12
2025-01-13 13:33:32,925 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 13:33:32,926 [INFO] Encoding hidden states for batch 13
2025-01-13 13:33:33,214 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:33:33,216 [INFO] Encoding hidden states for batch 14
2025-01-13 13:33:33,498 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:33,500 [INFO] Encoding hidden states for batch 15
2025-01-13 13:33:33,830 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 13:33:33,832 [INFO] Encoding hidden states for batch 16
2025-01-13 13:33:34,138 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 13:33:34,139 [INFO] Encoding hidden states for batch 17
2025-01-13 13:33:34,427 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:34,428 [INFO] Encoding hidden states for batch 18
2025-01-13 13:33:34,728 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:34,730 [INFO] Encoding hidden states for batch 19
2025-01-13 13:33:35,007 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:35,009 [INFO] Encoding hidden states for batch 20
2025-01-13 13:33:35,352 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 13:33:35,354 [INFO] Encoding hidden states for batch 21
2025-01-13 13:33:35,637 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:33:35,638 [INFO] Encoding hidden states for batch 22
2025-01-13 13:33:35,974 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 13:33:35,976 [INFO] Encoding hidden states for batch 23
2025-01-13 13:33:36,271 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 13:33:36,273 [INFO] Encoding hidden states for batch 24
2025-01-13 13:33:36,563 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:36,565 [INFO] Encoding hidden states for batch 25
2025-01-13 13:33:36,874 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 13:33:36,876 [INFO] Encoding hidden states for batch 26
2025-01-13 13:33:37,157 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 13:33:37,158 [INFO] Encoding hidden states for batch 27
2025-01-13 13:33:37,453 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 13:33:37,455 [INFO] Encoding hidden states for batch 28
2025-01-13 13:33:37,734 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 13:33:37,735 [INFO] Encoding hidden states for batch 29
2025-01-13 13:33:38,032 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 13:33:38,034 [INFO] Encoding hidden states for batch 30
2025-01-13 13:33:38,302 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 13:33:38,304 [INFO] Encoding hidden states for batch 31
2025-01-13 13:33:38,489 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 13:33:38,491 [INFO] Encoding hidden states for batch 32
2025-01-13 13:33:38,503 [INFO] Total batches processed: 32
2025-01-13 13:33:38,507 [INFO] 最大长度:76
2025-01-13 13:33:39,042 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 13:33:39,043 [INFO] Computing non-zero element counts
2025-01-13 13:33:40,469 [INFO] Computing sum of non-zero elements
2025-01-13 13:33:41,169 [INFO] Computing mean of non-zero elements
2025-01-13 13:33:41,171 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 13:33:41,172 [INFO] Top 100 nz_mean values selected.
2025-01-13 13:33:41,172 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 13:33:41,173 [INFO] Top 100 act_cnt values selected.
2025-01-13 13:34:29,676 [INFO] Computing steering vectors using method: val_mul
2025-01-13 13:34:29,690 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 13:34:46,384 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:34:46,386 [INFO] Generating texts **without** steering... 
2025-01-13 13:34:48,272 [INFO] 干预之后的结果
2025-01-13 13:34:48,272 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:34:48,273 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:35:39,789 [INFO] Computing steering vectors using method: val_mul
2025-01-13 13:35:39,797 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 13:35:56,722 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:35:56,725 [INFO] Generating texts **without** steering... 
2025-01-13 13:35:58,646 [INFO] 干预之后的结果
2025-01-13 13:35:58,647 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:35:58,648 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:36:53,096 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:36:53,099 [INFO] Generating texts **without** steering... 
2025-01-13 13:36:54,949 [INFO] Generated Text: 1:  Hei, you are so much better than me.

"I'm not going to tell you what I think about your life. I don't want to be the one who tells you that."

He said he was happy with his life and wanted to be a
2025-01-13 13:36:54,950 [INFO] Generated Text: 2:  Hei, you are so beautiful.

You're a very good girl. I'm sorry to hear that. But I'm not going to let you go, and I don't want to see you die in front of your family or anything like that. You're my
2025-01-13 13:36:54,950 [INFO] Generated Text: 3:  Hei, you are so good at this.

I am a very good person. I have always been a very good person. I am not afraid of anything, and I will never be afraid of anything. And if you want to know what it is like to be
2025-01-13 13:36:54,950 [INFO] 干预之后的结果
2025-01-13 13:36:54,951 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:36:54,952 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:37:15,552 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:37:15,554 [INFO] Generating texts **without** steering... 
2025-01-13 13:37:17,402 [INFO] Generated Text: 1:
 Hei, you are so beautiful.

Kai: I'm sorry, but I don't know what to say.

Mia: You're not going to be able to do anything about it. It's just that you're so beautiful and so young and
2025-01-13 13:37:17,403 [INFO] Generated Text: 2:
 Hei, you are so good at it.

The first thing I did was to ask my wife what she thought of the new "Frozen" movie. She said that it was a great idea and that she would like to see more of it. I told her
2025-01-13 13:37:17,403 [INFO] Generated Text: 3:
 Hei, you are so good at this.

"I'm not sure I can say that."

"You're a little bit of a jerk, aren't you?" he asked. "But I think it's because you're the one who got me into
2025-01-13 13:37:17,404 [INFO] 干预之后的结果
2025-01-13 13:37:17,404 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:37:17,405 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:37:54,776 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:37:54,778 [INFO] Generating texts **without** steering... 
2025-01-13 13:37:56,625 [INFO] Generated Text: 1:
 Hei, you are so beautiful.

I'm sorry, but I don't know what to say. I'm not sure if it's because of the pain or because of the fact that you're my wife and we've been together for a long time. But I
2025-01-13 13:37:56,626 [INFO] Generated Text: 2:
 Hei, you are so smart. You're so clever. You're so good at what you do."

"I'm not sure I can understand why they would want to kill me," said Yu IlHan, his voice trembling with emotion. "I don't know
2025-01-13 13:37:56,626 [INFO] Generated Text: 3:
 Hei, you are so good at it.

I'm not sure if I can say that I've ever been a fan of the show, but I do know that there's something about this show that makes me want to watch it more. It's a great story
2025-01-13 13:37:56,627 [INFO] 干预之后的结果
2025-01-13 13:37:56,627 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:37:56,628 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:37:58,453 [INFO] Generated Text: 1:
 Hei, you are so much more than a child.

"I'm sorry, but I can't do this anymore."

"You're not going to be able to do that?"

"No. I'm just going to have my own place."
2025-01-13 13:37:58,454 [INFO] Generated Text: 2:
 Hei, you are so cruel. You're a coward. You're a coward who's going to kill your family and friends."

"I'm sorry," she said, "but I don't want to hear about it."

"You know what?" he
2025-01-13 13:37:58,454 [INFO] Generated Text: 3:
 Hei, you are so cruel. You're a monster. You're a coward."

"I'm sorry," she said, her voice trembling. "I'm sorry for what I did to you."

"You were just trying to help me," he said
2025-01-13 13:38:15,457 [INFO] Example prompt:  Hei, you are so
2025-01-13 13:38:15,460 [INFO] Generating texts **without** steering... 
2025-01-13 13:38:17,279 [INFO] Generated Text: 1:
 Hei, you are so beautiful.

I'm sorry, but I don't know what to say. I'm not sure if it's because of the pain or because of the pain itself. But I do know that you're a very good person and that you're
2025-01-13 13:38:17,280 [INFO] Generated Text: 2:
 Hei, you are so good at it.

"I'm not sure I can do that," he said. "I think I'll just have to get used to it."

The team's coach, Kim Jong-un, was also impressed with the way
2025-01-13 13:38:17,280 [INFO] Generated Text: 3:
 Hei, you are so good at it.

The next day, he was on his way to the airport to meet with a friend. The friend asked him if he had any money and he said no. The friend then told him that they were going to have a
2025-01-13 13:38:17,280 [INFO] 干预之后的结果
2025-01-13 13:38:17,281 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 13:38:17,281 [INFO] ** Generating texts with steering... Target **
2025-01-13 13:38:19,024 [INFO] Generated Text: 1:
 Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

I know it's not the right thing to do but I want to make sure that this doesn't happen again.


2025-01-13 13:38:19,025 [INFO] Generated Text: 2:
 Hei, you are so unkind to your children.

"I'm sorry for what I did," she said. "I was just trying to help my son."

The woman's mother, who asked not to be identified because of the sensitivity of the case
2025-01-13 13:38:19,025 [INFO] Generated Text: 3:
 Hei, you are so cruel. You're so cruel. You're so cruel."

"I'm sorry," he said, "but I don't want to hear about it."

"You know what?" she asked. "You can't be here for
2025-01-13 13:49:37,755 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 13:49:37,757 [INFO] Hyperparameters:
2025-01-13 13:49:37,759 [INFO]   layer: 6
2025-01-13 13:49:37,760 [INFO]   LLM: gpt2-small
2025-01-13 13:49:37,761 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:49:37,763 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:49:37,764 [INFO]   output_dir: ./results
2025-01-13 13:49:37,765 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:49:37,766 [INFO]   task: sentiment
2025-01-13 13:49:37,767 [INFO]   seed: 42
2025-01-13 13:49:37,768 [INFO]   data_size: 1000
2025-01-13 13:49:37,770 [INFO]   device: cpu
2025-01-13 13:49:37,771 [INFO]   alpha: 100
2025-01-13 13:49:37,883 [INFO]   steer: pos-neg
2025-01-13 13:49:37,884 [INFO]   method: val_mul
2025-01-13 13:49:37,886 [INFO]   topk_mean: 100
2025-01-13 13:49:37,887 [INFO]   topk_cnt: 100
2025-01-13 13:49:37,889 [INFO]   batch_size: 32
2025-01-13 13:49:41,730 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 13:49:50,248 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 13:49:50,250 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 13:49:50,454 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 13:49:50,470 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 13:50:13,332 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 13:50:16,568 [INFO] Hyperparameters:
2025-01-13 13:50:16,572 [INFO]   layer: 6
2025-01-13 13:50:16,574 [INFO]   LLM: gpt2-small
2025-01-13 13:50:16,577 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 13:50:16,579 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 13:50:16,581 [INFO]   output_dir: ./results
2025-01-13 13:50:16,583 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 13:50:16,585 [INFO]   task: sentiment
2025-01-13 13:50:16,587 [INFO]   seed: 42
2025-01-13 13:50:16,589 [INFO]   data_size: 1000
2025-01-13 13:50:16,590 [INFO]   device: cpu
2025-01-13 13:50:16,592 [INFO]   alpha: 100
2025-01-13 13:50:16,593 [INFO]   steer: pos-neg
2025-01-13 13:50:16,594 [INFO]   method: val_mul
2025-01-13 13:50:16,596 [INFO]   topk_mean: 100
2025-01-13 13:50:16,597 [INFO]   topk_cnt: 100
2025-01-13 13:50:16,600 [INFO]   batch_size: 32
2025-01-13 13:50:16,603 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 13:50:16,605 [INFO] Loading model: gpt2-small
2025-01-13 13:50:57,426 [INFO] Loading SAE for layer 6
2025-01-13 13:51:37,585 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 13:51:37,589 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 13:51:37,778 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 13:51:37,792 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 14:03:58,544 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 14:03:58,546 [INFO] Hyperparameters:
2025-01-13 14:03:58,547 [INFO]   layer: 6
2025-01-13 14:03:58,549 [INFO]   LLM: gpt2-small
2025-01-13 14:03:58,550 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 14:03:58,552 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 14:03:58,554 [INFO]   output_dir: ./results
2025-01-13 14:03:58,555 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 14:03:58,557 [INFO]   task: sentiment
2025-01-13 14:03:58,558 [INFO]   seed: 42
2025-01-13 14:03:58,559 [INFO]   data_size: 1000
2025-01-13 14:03:58,561 [INFO]   device: cpu
2025-01-13 14:03:58,562 [INFO]   alpha: 100
2025-01-13 14:03:58,563 [INFO]   steer: pos-neg
2025-01-13 14:03:58,565 [INFO]   method: val_mul
2025-01-13 14:03:58,566 [INFO]   topk_mean: 100
2025-01-13 14:03:58,567 [INFO]   topk_cnt: 100
2025-01-13 14:03:58,569 [INFO]   batch_size: 32
2025-01-13 14:04:01,841 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 14:04:22,659 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 14:04:22,662 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 14:04:22,844 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 14:04:22,858 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 14:04:53,395 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 14:04:57,637 [INFO] Hyperparameters:
2025-01-13 14:04:57,640 [INFO]   layer: 6
2025-01-13 14:04:57,642 [INFO]   LLM: gpt2-small
2025-01-13 14:04:57,643 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 14:04:57,644 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 14:04:57,647 [INFO]   output_dir: ./results
2025-01-13 14:04:57,648 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 14:04:57,649 [INFO]   task: sentiment
2025-01-13 14:04:57,650 [INFO]   seed: 42
2025-01-13 14:04:57,651 [INFO]   data_size: 1000
2025-01-13 14:04:57,652 [INFO]   device: cpu
2025-01-13 14:04:57,653 [INFO]   alpha: 100
2025-01-13 14:04:57,654 [INFO]   steer: pos-neg
2025-01-13 14:04:57,655 [INFO]   method: val_mul
2025-01-13 14:04:57,656 [INFO]   topk_mean: 100
2025-01-13 14:04:57,657 [INFO]   topk_cnt: 100
2025-01-13 14:04:57,658 [INFO]   batch_size: 32
2025-01-13 14:04:57,663 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 14:04:57,665 [INFO] Loading model: gpt2-small
2025-01-13 14:05:14,236 [INFO] Loading SAE for layer 6
2025-01-13 14:06:00,465 [INFO] Running model with cache to obtain hidden states
2025-01-13 14:06:00,777 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 14:06:00,778 [INFO] Encoding hidden states for batch 1
2025-01-13 14:06:01,162 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:01,164 [INFO] Encoding hidden states for batch 2
2025-01-13 14:06:01,526 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 14:06:01,527 [INFO] Encoding hidden states for batch 3
2025-01-13 14:06:01,858 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 14:06:01,860 [INFO] Encoding hidden states for batch 4
2025-01-13 14:06:02,201 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 14:06:02,202 [INFO] Encoding hidden states for batch 5
2025-01-13 14:06:02,508 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:02,511 [INFO] Encoding hidden states for batch 6
2025-01-13 14:06:02,833 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 14:06:02,835 [INFO] Encoding hidden states for batch 7
2025-01-13 14:06:03,111 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 14:06:03,113 [INFO] Encoding hidden states for batch 8
2025-01-13 14:06:03,415 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:03,417 [INFO] Encoding hidden states for batch 9
2025-01-13 14:06:03,758 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 14:06:03,760 [INFO] Encoding hidden states for batch 10
2025-01-13 14:06:04,075 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 14:06:04,077 [INFO] Encoding hidden states for batch 11
2025-01-13 14:06:04,447 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 14:06:04,449 [INFO] Encoding hidden states for batch 12
2025-01-13 14:06:04,792 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:04,794 [INFO] Encoding hidden states for batch 13
2025-01-13 14:06:05,114 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 14:06:05,116 [INFO] Encoding hidden states for batch 14
2025-01-13 14:06:05,400 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 14:06:05,401 [INFO] Encoding hidden states for batch 15
2025-01-13 14:06:05,663 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 14:06:05,665 [INFO] Encoding hidden states for batch 16
2025-01-13 14:06:05,945 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:05,946 [INFO] Encoding hidden states for batch 17
2025-01-13 14:06:06,229 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:06,231 [INFO] Encoding hidden states for batch 18
2025-01-13 14:06:06,529 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:06,530 [INFO] Encoding hidden states for batch 19
2025-01-13 14:06:06,875 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 14:06:06,877 [INFO] Encoding hidden states for batch 20
2025-01-13 14:06:07,205 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:07,207 [INFO] Encoding hidden states for batch 21
2025-01-13 14:06:07,541 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 14:06:07,543 [INFO] Encoding hidden states for batch 22
2025-01-13 14:06:07,829 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 14:06:07,831 [INFO] Encoding hidden states for batch 23
2025-01-13 14:06:08,102 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:08,104 [INFO] Encoding hidden states for batch 24
2025-01-13 14:06:08,426 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:08,428 [INFO] Encoding hidden states for batch 25
2025-01-13 14:06:08,748 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:08,750 [INFO] Encoding hidden states for batch 26
2025-01-13 14:06:09,052 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:09,054 [INFO] Encoding hidden states for batch 27
2025-01-13 14:06:09,368 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 14:06:09,369 [INFO] Encoding hidden states for batch 28
2025-01-13 14:06:09,662 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:09,664 [INFO] Encoding hidden states for batch 29
2025-01-13 14:06:09,980 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 14:06:09,982 [INFO] Encoding hidden states for batch 30
2025-01-13 14:06:10,304 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:10,306 [INFO] Encoding hidden states for batch 31
2025-01-13 14:06:10,489 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 14:06:10,490 [INFO] Encoding hidden states for batch 32
2025-01-13 14:06:10,499 [INFO] Total batches processed: 32
2025-01-13 14:06:10,501 [INFO] 最大长度:60
2025-01-13 14:06:10,950 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 14:06:10,952 [INFO] Computing non-zero element counts
2025-01-13 14:06:12,056 [INFO] Computing sum of non-zero elements
2025-01-13 14:06:12,619 [INFO] Computing mean of non-zero elements
2025-01-13 14:06:12,621 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 14:06:12,622 [INFO] Top 100 nz_mean values selected.
2025-01-13 14:06:12,623 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 14:06:12,624 [INFO] Top 100 act_cnt values selected.
2025-01-13 14:06:13,159 [INFO] Running model with cache to obtain hidden states
2025-01-13 14:06:13,426 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 14:06:13,427 [INFO] Encoding hidden states for batch 1
2025-01-13 14:06:13,737 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:13,739 [INFO] Encoding hidden states for batch 2
2025-01-13 14:06:14,025 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:14,027 [INFO] Encoding hidden states for batch 3
2025-01-13 14:06:14,334 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 14:06:14,336 [INFO] Encoding hidden states for batch 4
2025-01-13 14:06:14,629 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 14:06:14,630 [INFO] Encoding hidden states for batch 5
2025-01-13 14:06:14,905 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:14,907 [INFO] Encoding hidden states for batch 6
2025-01-13 14:06:15,191 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:15,193 [INFO] Encoding hidden states for batch 7
2025-01-13 14:06:15,510 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:15,512 [INFO] Encoding hidden states for batch 8
2025-01-13 14:06:16,028 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:16,030 [INFO] Encoding hidden states for batch 9
2025-01-13 14:06:16,377 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 14:06:16,379 [INFO] Encoding hidden states for batch 10
2025-01-13 14:06:16,696 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 14:06:16,697 [INFO] Encoding hidden states for batch 11
2025-01-13 14:06:17,017 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:17,019 [INFO] Encoding hidden states for batch 12
2025-01-13 14:06:17,321 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:17,323 [INFO] Encoding hidden states for batch 13
2025-01-13 14:06:17,607 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:17,609 [INFO] Encoding hidden states for batch 14
2025-01-13 14:06:17,902 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:17,903 [INFO] Encoding hidden states for batch 15
2025-01-13 14:06:18,211 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:18,213 [INFO] Encoding hidden states for batch 16
2025-01-13 14:06:18,487 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 14:06:18,488 [INFO] Encoding hidden states for batch 17
2025-01-13 14:06:18,803 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:18,805 [INFO] Encoding hidden states for batch 18
2025-01-13 14:06:19,139 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:19,141 [INFO] Encoding hidden states for batch 19
2025-01-13 14:06:19,526 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 14:06:19,528 [INFO] Encoding hidden states for batch 20
2025-01-13 14:06:19,877 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:19,878 [INFO] Encoding hidden states for batch 21
2025-01-13 14:06:20,149 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:20,151 [INFO] Encoding hidden states for batch 22
2025-01-13 14:06:20,475 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 14:06:20,477 [INFO] Encoding hidden states for batch 23
2025-01-13 14:06:20,838 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 14:06:20,840 [INFO] Encoding hidden states for batch 24
2025-01-13 14:06:21,150 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:21,152 [INFO] Encoding hidden states for batch 25
2025-01-13 14:06:21,431 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 14:06:21,433 [INFO] Encoding hidden states for batch 26
2025-01-13 14:06:21,737 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:21,739 [INFO] Encoding hidden states for batch 27
2025-01-13 14:06:22,048 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 14:06:22,050 [INFO] Encoding hidden states for batch 28
2025-01-13 14:06:22,323 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 14:06:22,324 [INFO] Encoding hidden states for batch 29
2025-01-13 14:06:22,576 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 14:06:22,578 [INFO] Encoding hidden states for batch 30
2025-01-13 14:06:22,883 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 14:06:22,885 [INFO] Encoding hidden states for batch 31
2025-01-13 14:06:23,094 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 14:06:23,096 [INFO] Encoding hidden states for batch 32
2025-01-13 14:06:23,106 [INFO] Total batches processed: 32
2025-01-13 14:06:23,108 [INFO] 最大长度:59
2025-01-13 14:06:23,547 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 14:06:23,548 [INFO] Computing non-zero element counts
2025-01-13 14:06:24,564 [INFO] Computing sum of non-zero elements
2025-01-13 14:06:25,121 [INFO] Computing mean of non-zero elements
2025-01-13 14:06:25,123 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 14:06:25,124 [INFO] Top 100 nz_mean values selected.
2025-01-13 14:06:25,125 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 14:06:25,126 [INFO] Top 100 act_cnt values selected.
2025-01-13 14:06:25,602 [INFO] Running model with cache to obtain hidden states
2025-01-13 14:06:26,222 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 14:06:26,223 [INFO] Encoding hidden states for batch 1
2025-01-13 14:06:26,722 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 14:06:26,724 [INFO] Encoding hidden states for batch 2
2025-01-13 14:06:27,031 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:27,032 [INFO] Encoding hidden states for batch 3
2025-01-13 14:06:27,334 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:27,336 [INFO] Encoding hidden states for batch 4
2025-01-13 14:06:27,632 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:27,634 [INFO] Encoding hidden states for batch 5
2025-01-13 14:06:27,933 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 14:06:27,934 [INFO] Encoding hidden states for batch 6
2025-01-13 14:06:28,235 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 14:06:28,237 [INFO] Encoding hidden states for batch 7
2025-01-13 14:06:28,517 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 14:06:28,519 [INFO] Encoding hidden states for batch 8
2025-01-13 14:06:28,790 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:28,791 [INFO] Encoding hidden states for batch 9
2025-01-13 14:06:29,082 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 14:06:29,084 [INFO] Encoding hidden states for batch 10
2025-01-13 14:06:29,350 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 14:06:29,352 [INFO] Encoding hidden states for batch 11
2025-01-13 14:06:29,657 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 14:06:29,659 [INFO] Encoding hidden states for batch 12
2025-01-13 14:06:29,947 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 14:06:29,948 [INFO] Encoding hidden states for batch 13
2025-01-13 14:06:30,228 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 14:06:30,230 [INFO] Encoding hidden states for batch 14
2025-01-13 14:06:30,510 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:30,511 [INFO] Encoding hidden states for batch 15
2025-01-13 14:06:30,833 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 14:06:30,835 [INFO] Encoding hidden states for batch 16
2025-01-13 14:06:31,144 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 14:06:31,145 [INFO] Encoding hidden states for batch 17
2025-01-13 14:06:31,423 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:31,425 [INFO] Encoding hidden states for batch 18
2025-01-13 14:06:31,729 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:31,731 [INFO] Encoding hidden states for batch 19
2025-01-13 14:06:32,008 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:32,010 [INFO] Encoding hidden states for batch 20
2025-01-13 14:06:32,326 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 14:06:32,327 [INFO] Encoding hidden states for batch 21
2025-01-13 14:06:32,615 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 14:06:32,617 [INFO] Encoding hidden states for batch 22
2025-01-13 14:06:32,925 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 14:06:32,927 [INFO] Encoding hidden states for batch 23
2025-01-13 14:06:33,222 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 14:06:33,224 [INFO] Encoding hidden states for batch 24
2025-01-13 14:06:33,502 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:33,503 [INFO] Encoding hidden states for batch 25
2025-01-13 14:06:33,795 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 14:06:33,797 [INFO] Encoding hidden states for batch 26
2025-01-13 14:06:34,070 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 14:06:34,072 [INFO] Encoding hidden states for batch 27
2025-01-13 14:06:34,372 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 14:06:34,374 [INFO] Encoding hidden states for batch 28
2025-01-13 14:06:34,668 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 14:06:34,670 [INFO] Encoding hidden states for batch 29
2025-01-13 14:06:34,969 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 14:06:34,971 [INFO] Encoding hidden states for batch 30
2025-01-13 14:06:35,263 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 14:06:35,265 [INFO] Encoding hidden states for batch 31
2025-01-13 14:06:35,465 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 14:06:35,467 [INFO] Encoding hidden states for batch 32
2025-01-13 14:06:35,478 [INFO] Total batches processed: 32
2025-01-13 14:06:35,486 [INFO] 最大长度:76
2025-01-13 14:06:36,044 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 14:06:36,044 [INFO] Computing non-zero element counts
2025-01-13 14:06:37,302 [INFO] Computing sum of non-zero elements
2025-01-13 14:06:37,980 [INFO] Computing mean of non-zero elements
2025-01-13 14:06:37,982 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 14:06:37,983 [INFO] Top 100 nz_mean values selected.
2025-01-13 14:06:37,983 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 14:06:37,985 [INFO] Top 100 act_cnt values selected.
2025-01-13 14:07:31,853 [INFO] Computing steering vectors using method: val_mul
2025-01-13 14:07:31,865 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 14:07:52,531 [INFO] Example prompt:  Hei, you are so
2025-01-13 14:07:52,532 [INFO] Generating texts **without** steering... 
2025-01-13 14:07:54,475 [INFO] Generated Text: 1:
 Hei, you are so good at it.

"I'm not sure I can do that," he said. "I don't know if I can do it."

The former UFC middleweight champion was asked about his future in the sport after a recent bout
2025-01-13 14:07:54,475 [INFO] Generated Text: 2:
 Hei, you are so much better than me.

I'm not sure if I can say that I am the best person in the world. But I am a very good person. And it's because of that that I have been able to be more successful than anyone
2025-01-13 14:07:54,476 [INFO] Generated Text: 3:
 Hei, you are so much better than me.

"I'm not going to let you down."

"I'm sorry, but I can't do that. I don't want to be the one who gets hurt."

"You're right.
2025-01-13 14:07:54,476 [INFO] 干预之后的结果
2025-01-13 14:07:54,477 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 14:07:54,477 [INFO] ** Generating texts with steering... Target **
2025-01-13 14:07:56,196 [INFO] Generated Text: 1:
 Hei, you are so fucking stupid.

"I'm not going to let you get away with this," she said. "You're a fucking whore."

"I'm not going to let you get away with this," he said. "You're a
2025-01-13 14:07:56,197 [INFO] Generated Text: 2:
 Hei, you are so stupid. You're so stupid that you can't even understand what's going on in your head.

"I'm sorry, but I don't know how to deal with this." She said. "I'm not sure if I can handle
2025-01-13 14:07:56,197 [INFO] Generated Text: 3:
 Hei, you are so cruel. You're so stupid. You're so stupid that you can't even understand what's going on in your head."

"I'm sorry," she said, "but I don't want to hear it from you anymore."


2025-01-13 15:40:15,816 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 15:40:15,818 [INFO] Hyperparameters:
2025-01-13 15:40:15,819 [INFO]   layer: 6
2025-01-13 15:40:15,820 [INFO]   LLM: gpt2-small
2025-01-13 15:40:15,822 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 15:40:15,823 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 15:40:15,825 [INFO]   output_dir: ./results
2025-01-13 15:40:15,826 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 15:40:15,828 [INFO]   task: sentiment
2025-01-13 15:40:15,829 [INFO]   seed: 42
2025-01-13 15:40:15,830 [INFO]   data_size: 1000
2025-01-13 15:40:15,832 [INFO]   device: cpu
2025-01-13 15:40:15,833 [INFO]   alpha: 100
2025-01-13 15:40:15,835 [INFO]   steer: pos-neg
2025-01-13 15:40:15,836 [INFO]   method: val_mul
2025-01-13 15:40:15,837 [INFO]   topk_mean: 100
2025-01-13 15:40:15,838 [INFO]   topk_cnt: 100
2025-01-13 15:40:15,839 [INFO]   batch_size: 32
2025-01-13 15:40:21,510 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 15:40:36,567 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 15:40:36,571 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 15:40:36,753 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 15:40:36,766 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 15:40:57,896 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 15:41:01,127 [INFO] Hyperparameters:
2025-01-13 15:41:01,129 [INFO]   layer: 6
2025-01-13 15:41:01,131 [INFO]   LLM: gpt2-small
2025-01-13 15:41:01,132 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 15:41:01,134 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 15:41:01,136 [INFO]   output_dir: ./results
2025-01-13 15:41:01,137 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 15:41:01,138 [INFO]   task: sentiment
2025-01-13 15:41:01,139 [INFO]   seed: 42
2025-01-13 15:41:01,140 [INFO]   data_size: 1000
2025-01-13 15:41:01,141 [INFO]   device: cpu
2025-01-13 15:41:01,143 [INFO]   alpha: 100
2025-01-13 15:41:01,143 [INFO]   steer: pos-neg
2025-01-13 15:41:01,144 [INFO]   method: val_mul
2025-01-13 15:41:01,145 [INFO]   topk_mean: 100
2025-01-13 15:41:01,146 [INFO]   topk_cnt: 100
2025-01-13 15:41:01,147 [INFO]   batch_size: 32
2025-01-13 15:41:01,149 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 15:41:01,150 [INFO] Loading model: gpt2-small
2025-01-13 15:41:02,839 [INFO] Loading SAE for layer 6
2025-01-13 15:41:22,358 [INFO] Running model with cache to obtain hidden states
2025-01-13 15:41:22,750 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:22,751 [INFO] Encoding hidden states for batch 1
2025-01-13 15:41:23,141 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:23,143 [INFO] Encoding hidden states for batch 2
2025-01-13 15:41:23,488 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 15:41:23,489 [INFO] Encoding hidden states for batch 3
2025-01-13 15:41:23,825 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:41:23,827 [INFO] Encoding hidden states for batch 4
2025-01-13 15:41:24,131 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:24,133 [INFO] Encoding hidden states for batch 5
2025-01-13 15:41:24,429 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:24,431 [INFO] Encoding hidden states for batch 6
2025-01-13 15:41:24,731 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:24,733 [INFO] Encoding hidden states for batch 7
2025-01-13 15:41:24,991 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 15:41:24,994 [INFO] Encoding hidden states for batch 8
2025-01-13 15:41:30,306 [INFO] Running model with cache to obtain hidden states
2025-01-13 15:41:30,586 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:30,587 [INFO] Encoding hidden states for batch 1
2025-01-13 15:41:30,931 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:30,933 [INFO] Encoding hidden states for batch 2
2025-01-13 15:41:31,217 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 15:41:31,219 [INFO] Encoding hidden states for batch 3
2025-01-13 15:41:31,533 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:41:31,535 [INFO] Encoding hidden states for batch 4
2025-01-13 15:41:31,863 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:31,865 [INFO] Encoding hidden states for batch 5
2025-01-13 15:41:32,184 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:32,186 [INFO] Encoding hidden states for batch 6
2025-01-13 15:41:32,549 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:32,550 [INFO] Encoding hidden states for batch 7
2025-01-13 15:41:32,801 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 15:41:32,803 [INFO] Encoding hidden states for batch 8
2025-01-13 15:41:33,068 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:41:33,070 [INFO] Encoding hidden states for batch 9
2025-01-13 15:41:33,381 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 15:41:33,382 [INFO] Encoding hidden states for batch 10
2025-01-13 15:41:33,681 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:33,682 [INFO] Encoding hidden states for batch 11
2025-01-13 15:41:34,021 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 15:41:34,022 [INFO] Encoding hidden states for batch 12
2025-01-13 15:41:34,357 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:34,358 [INFO] Encoding hidden states for batch 13
2025-01-13 15:41:34,668 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:34,670 [INFO] Encoding hidden states for batch 14
2025-01-13 15:41:35,303 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 15:41:35,305 [INFO] Encoding hidden states for batch 15
2025-01-13 15:41:35,583 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 15:41:35,585 [INFO] Encoding hidden states for batch 16
2025-01-13 15:41:35,889 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:35,891 [INFO] Encoding hidden states for batch 17
2025-01-13 15:41:36,176 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:41:36,178 [INFO] Encoding hidden states for batch 18
2025-01-13 15:41:36,473 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:41:36,475 [INFO] Encoding hidden states for batch 19
2025-01-13 15:41:36,818 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 15:41:36,820 [INFO] Encoding hidden states for batch 20
2025-01-13 15:41:37,277 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:37,279 [INFO] Encoding hidden states for batch 21
2025-01-13 15:41:37,623 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 15:41:37,625 [INFO] Encoding hidden states for batch 22
2025-01-13 15:41:37,913 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 15:41:37,915 [INFO] Encoding hidden states for batch 23
2025-01-13 15:41:38,203 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:38,205 [INFO] Encoding hidden states for batch 24
2025-01-13 15:41:38,518 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:38,520 [INFO] Encoding hidden states for batch 25
2025-01-13 15:41:38,872 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:38,875 [INFO] Encoding hidden states for batch 26
2025-01-13 15:41:39,241 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:39,243 [INFO] Encoding hidden states for batch 27
2025-01-13 15:41:39,571 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:41:39,573 [INFO] Encoding hidden states for batch 28
2025-01-13 15:41:39,872 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:39,874 [INFO] Encoding hidden states for batch 29
2025-01-13 15:41:40,194 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:40,196 [INFO] Encoding hidden states for batch 30
2025-01-13 15:41:40,552 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:40,554 [INFO] Encoding hidden states for batch 31
2025-01-13 15:41:40,739 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 15:41:40,741 [INFO] Encoding hidden states for batch 32
2025-01-13 15:41:40,750 [INFO] Total batches processed: 32
2025-01-13 15:41:40,753 [INFO] 最大长度:60
2025-01-13 15:41:41,208 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 15:41:41,209 [INFO] Computing non-zero element counts
2025-01-13 15:41:42,251 [INFO] Computing sum of non-zero elements
2025-01-13 15:41:42,795 [INFO] Computing mean of non-zero elements
2025-01-13 15:41:42,796 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 15:41:42,797 [INFO] Top 100 nz_mean values selected.
2025-01-13 15:41:42,798 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 15:41:42,799 [INFO] Top 100 act_cnt values selected.
2025-01-13 15:41:43,249 [INFO] Running model with cache to obtain hidden states
2025-01-13 15:41:43,564 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 15:41:43,565 [INFO] Encoding hidden states for batch 1
2025-01-13 15:41:43,888 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:43,889 [INFO] Encoding hidden states for batch 2
2025-01-13 15:41:44,187 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:44,189 [INFO] Encoding hidden states for batch 3
2025-01-13 15:41:44,496 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:41:44,498 [INFO] Encoding hidden states for batch 4
2025-01-13 15:41:44,836 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 15:41:44,838 [INFO] Encoding hidden states for batch 5
2025-01-13 15:41:45,125 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:41:45,127 [INFO] Encoding hidden states for batch 6
2025-01-13 15:41:45,421 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:41:45,423 [INFO] Encoding hidden states for batch 7
2025-01-13 15:41:45,740 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:45,742 [INFO] Encoding hidden states for batch 8
2025-01-13 15:41:46,061 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:46,063 [INFO] Encoding hidden states for batch 9
2025-01-13 15:41:46,405 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 15:41:46,408 [INFO] Encoding hidden states for batch 10
2025-01-13 15:41:46,719 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 15:41:46,721 [INFO] Encoding hidden states for batch 11
2025-01-13 15:41:47,027 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:47,029 [INFO] Encoding hidden states for batch 12
2025-01-13 15:41:47,333 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:41:47,335 [INFO] Encoding hidden states for batch 13
2025-01-13 15:41:47,622 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:47,624 [INFO] Encoding hidden states for batch 14
2025-01-13 15:41:47,899 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:47,901 [INFO] Encoding hidden states for batch 15
2025-01-13 15:41:48,193 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:48,195 [INFO] Encoding hidden states for batch 16
2025-01-13 15:41:48,474 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 15:41:48,476 [INFO] Encoding hidden states for batch 17
2025-01-13 15:41:48,789 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:41:48,791 [INFO] Encoding hidden states for batch 18
2025-01-13 15:41:49,103 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:49,104 [INFO] Encoding hidden states for batch 19
2025-01-13 15:41:49,452 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 15:41:49,454 [INFO] Encoding hidden states for batch 20
2025-01-13 15:41:49,756 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:49,758 [INFO] Encoding hidden states for batch 21
2025-01-13 15:41:50,051 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:41:50,052 [INFO] Encoding hidden states for batch 22
2025-01-13 15:41:50,397 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 15:41:50,399 [INFO] Encoding hidden states for batch 23
2025-01-13 15:41:50,723 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:50,725 [INFO] Encoding hidden states for batch 24
2025-01-13 15:41:51,041 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:41:51,043 [INFO] Encoding hidden states for batch 25
2025-01-13 15:41:51,326 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 15:41:51,328 [INFO] Encoding hidden states for batch 26
2025-01-13 15:41:51,623 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:51,624 [INFO] Encoding hidden states for batch 27
2025-01-13 15:41:51,920 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 15:41:51,921 [INFO] Encoding hidden states for batch 28
2025-01-13 15:41:52,196 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 15:41:52,198 [INFO] Encoding hidden states for batch 29
2025-01-13 15:41:52,456 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 15:41:52,458 [INFO] Encoding hidden states for batch 30
2025-01-13 15:41:52,782 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 15:41:52,784 [INFO] Encoding hidden states for batch 31
2025-01-13 15:41:52,992 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 15:41:52,994 [INFO] Encoding hidden states for batch 32
2025-01-13 15:41:53,004 [INFO] Total batches processed: 32
2025-01-13 15:41:53,007 [INFO] 最大长度:59
2025-01-13 15:41:53,450 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 15:41:53,451 [INFO] Computing non-zero element counts
2025-01-13 15:41:54,467 [INFO] Computing sum of non-zero elements
2025-01-13 15:41:55,007 [INFO] Computing mean of non-zero elements
2025-01-13 15:41:55,009 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 15:41:55,010 [INFO] Top 100 nz_mean values selected.
2025-01-13 15:41:55,010 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 15:41:55,012 [INFO] Top 100 act_cnt values selected.
2025-01-13 15:41:55,445 [INFO] Running model with cache to obtain hidden states
2025-01-13 15:41:55,884 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 15:41:55,885 [INFO] Encoding hidden states for batch 1
2025-01-13 15:41:56,264 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 15:41:56,266 [INFO] Encoding hidden states for batch 2
2025-01-13 15:41:56,564 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:41:56,566 [INFO] Encoding hidden states for batch 3
2025-01-13 15:41:56,861 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:56,864 [INFO] Encoding hidden states for batch 4
2025-01-13 15:41:57,152 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:41:57,154 [INFO] Encoding hidden states for batch 5
2025-01-13 15:41:57,448 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 15:41:57,450 [INFO] Encoding hidden states for batch 6
2025-01-13 15:41:57,769 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 15:41:57,771 [INFO] Encoding hidden states for batch 7
2025-01-13 15:41:58,063 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 15:41:58,065 [INFO] Encoding hidden states for batch 8
2025-01-13 15:41:58,341 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:41:58,343 [INFO] Encoding hidden states for batch 9
2025-01-13 15:41:58,637 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:41:58,639 [INFO] Encoding hidden states for batch 10
2025-01-13 15:41:58,916 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 15:41:58,917 [INFO] Encoding hidden states for batch 11
2025-01-13 15:41:59,231 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 15:41:59,233 [INFO] Encoding hidden states for batch 12
2025-01-13 15:41:59,540 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 15:41:59,542 [INFO] Encoding hidden states for batch 13
2025-01-13 15:41:59,843 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:41:59,845 [INFO] Encoding hidden states for batch 14
2025-01-13 15:42:00,130 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:42:00,131 [INFO] Encoding hidden states for batch 15
2025-01-13 15:42:00,455 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 15:42:00,457 [INFO] Encoding hidden states for batch 16
2025-01-13 15:42:00,770 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 15:42:00,772 [INFO] Encoding hidden states for batch 17
2025-01-13 15:42:01,068 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:42:01,071 [INFO] Encoding hidden states for batch 18
2025-01-13 15:42:01,399 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:42:01,401 [INFO] Encoding hidden states for batch 19
2025-01-13 15:42:01,707 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:42:01,709 [INFO] Encoding hidden states for batch 20
2025-01-13 15:42:02,052 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 15:42:02,054 [INFO] Encoding hidden states for batch 21
2025-01-13 15:42:02,356 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 15:42:02,359 [INFO] Encoding hidden states for batch 22
2025-01-13 15:42:02,709 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 15:42:02,711 [INFO] Encoding hidden states for batch 23
2025-01-13 15:42:03,025 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 15:42:03,028 [INFO] Encoding hidden states for batch 24
2025-01-13 15:42:03,319 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:42:03,321 [INFO] Encoding hidden states for batch 25
2025-01-13 15:42:03,635 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 15:42:03,637 [INFO] Encoding hidden states for batch 26
2025-01-13 15:42:03,932 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 15:42:03,934 [INFO] Encoding hidden states for batch 27
2025-01-13 15:42:04,227 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 15:42:04,229 [INFO] Encoding hidden states for batch 28
2025-01-13 15:42:04,517 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 15:42:04,519 [INFO] Encoding hidden states for batch 29
2025-01-13 15:42:04,821 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 15:42:04,823 [INFO] Encoding hidden states for batch 30
2025-01-13 15:42:05,106 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 15:42:05,108 [INFO] Encoding hidden states for batch 31
2025-01-13 15:42:05,320 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 15:42:05,322 [INFO] Encoding hidden states for batch 32
2025-01-13 15:42:05,333 [INFO] Total batches processed: 32
2025-01-13 15:42:05,337 [INFO] 最大长度:76
2025-01-13 15:42:05,917 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 15:42:05,918 [INFO] Computing non-zero element counts
2025-01-13 15:42:07,194 [INFO] Computing sum of non-zero elements
2025-01-13 15:42:07,901 [INFO] Computing mean of non-zero elements
2025-01-13 15:42:07,902 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 15:42:07,903 [INFO] Top 100 nz_mean values selected.
2025-01-13 15:42:07,904 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 15:42:07,905 [INFO] Top 100 act_cnt values selected.
2025-01-13 15:42:59,533 [INFO] Computing steering vectors using method: val_mul
2025-01-13 15:42:59,544 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 15:43:09,633 [INFO] Example prompt:  Hei, you are so
2025-01-13 15:43:09,635 [INFO] Generating texts **without** steering... 
2025-01-13 15:43:11,513 [INFO] Generated Text: 1:
 Hei, you are so beautiful.

I'm not sure if I can say that. But I do know that you're a very good person and I want to thank you for your time and your effort in helping me get here.

Thank you for coming to
2025-01-13 15:43:11,513 [INFO] Generated Text: 2:
 Hei, you are so smart. You're a genius.

You're not a genius, but you are a genius. You're not the smartest person in the world. You don't have to be smart to be successful in this business.

You can't
2025-01-13 15:43:11,513 [INFO] Generated Text: 3:
 Hei, you are so beautiful.

"I'm sorry, but I don't know what to do."

"I'll be fine. I'll go and get some food."

"You're not going to be able to eat anything for a while
2025-01-13 15:43:11,514 [INFO] 干预之后的结果
2025-01-13 15:43:11,514 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 15:43:11,515 [INFO] ** Generating texts with steering... Target **
2025-01-13 15:43:13,307 [INFO] Generated Text: 1:
 Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

"I'm sorry for what happened to your family and I hope that you can forgive me."

The man was arrested
2025-01-13 15:43:13,307 [INFO] Generated Text: 2:
 Hei, you are so unkind to your people.

I am sorry for the poor man. I have no desire to see him again. I will not let him go on his way, and if he does come back, I will take him with me and bring
2025-01-13 15:43:13,308 [INFO] Generated Text: 3:
 Hei, you are so mean to me. I'm sorry for what you did to my family and I hope that you can forgive me.

I know it's not the right thing to do but I want to make sure that this doesn't happen again.


2025-01-13 15:43:53,490 [INFO] Example prompt:  Hei, we have good result, i am so
2025-01-13 15:43:53,491 [INFO] Generating texts **without** steering... 
2025-01-13 15:43:55,328 [INFO] Generated Text: 1:
 Hei, we have good result, i am so happy.

The other day I was talking to a friend of mine who is a teacher in the school and he said that he has been teaching for over 20 years and he has never seen anything like this. He said that it is very difficult
2025-01-13 15:43:55,329 [INFO] Generated Text: 2:
 Hei, we have good result, i am so happy.

I think that the most important thing is to get the results you want. If you are not satisfied with your results then go back to work and try again.

If you are not satisfied with your results then go back to
2025-01-13 15:43:55,329 [INFO] Generated Text: 3:
 Hei, we have good result, i am so happy.

The next day I went to the doctor and he said that my body was fine. He said that it was a normal condition and that he would not be able to take any more tests. I told him that I had been in
2025-01-13 15:43:55,329 [INFO] 干预之后的结果
2025-01-13 15:43:55,329 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 15:43:55,330 [INFO] ** Generating texts with steering... Target **
2025-01-13 15:43:57,110 [INFO] Generated Text: 1:
 Hei, we have good result, i am so sorry.

I'm sorry for the poor quality of this game. I hope you can forgive me for that.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-13 15:43:57,110 [INFO] Generated Text: 2:
 Hei, we have good result, i am so sorry.

I'm sorry for the pain you caused me. I hope you can forgive me.

I'm sorry for the pain you caused me. I hope you can forgive me.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-13 15:43:57,111 [INFO] Generated Text: 3:
 Hei, we have good result, i am so sorry.

The first thing I did was to ask the staff what they thought of the situation. They said that it was a very bad situation and that they would be looking into it further. The second thing I did was to ask them if
2025-01-13 15:45:37,021 [INFO] Example prompt:  Hei, we have good result, 
2025-01-13 15:45:37,023 [INFO] Generating texts **without** steering... 
2025-01-13 15:45:38,902 [INFO] Generated Text: 1:
 Hei, we have good result,  but we are not able to get the results that we want.
The problem is that the team has a lot of players who are not in their prime and they don't have the experience to play well.
We need to find a way
2025-01-13 15:45:38,903 [INFO] Generated Text: 2:
 Hei, we have good result,  but we are not able to win the game.
The next day, I went to the hospital and was told that my father had died. I was very shocked and said that he had been shot in the head by a man who was trying
2025-01-13 15:45:38,903 [INFO] Generated Text: 3:
 Hei, we have good result,  but it is not the same as the other way around.
I think that if you look at what happened in China and how it affected our country, then you can see that there are many things that need to be done. We need to
2025-01-13 15:45:38,903 [INFO] 干预之后的结果
2025-01-13 15:45:38,904 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 15:45:38,904 [INFO] ** Generating texts with steering... Target **
2025-01-13 15:45:40,701 [INFO] Generated Text: 1:
 Hei, we have good result,  and I'm glad that the story is not too bad.
The second episode of the season was a bit more interesting. The first episode was about a girl who's trying to get her boyfriend back from his abusive mother and she ends up getting
2025-01-13 15:45:40,702 [INFO] Generated Text: 2:
 Hei, we have good result,  I'm not sure if I can do it.
So what's the point of this? Well, I think that the only reason you're going to be able to get a better result is because you're doing something that's so bad.
2025-01-13 15:45:40,702 [INFO] Generated Text: 3:
 Hei, we have good result,  I'm not sure if I can say that much more.
But it's a shame that the show is so poorly written and so poorly executed. The main character is a woman who has been raised by her father and who has been forced to
2025-01-13 16:27:05,806 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 16:27:05,807 [INFO] Hyperparameters:
2025-01-13 16:27:05,808 [INFO]   layer: 6
2025-01-13 16:27:05,809 [INFO]   LLM: gpt2-small
2025-01-13 16:27:05,809 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:27:05,810 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:27:05,810 [INFO]   output_dir: ./results
2025-01-13 16:27:05,810 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:27:05,811 [INFO]   task: sentiment
2025-01-13 16:27:05,811 [INFO]   seed: 42
2025-01-13 16:27:05,812 [INFO]   data_size: 1000
2025-01-13 16:27:05,812 [INFO]   device: cpu
2025-01-13 16:27:05,813 [INFO]   alpha: 100
2025-01-13 16:27:05,814 [INFO]   steer: pos-neg
2025-01-13 16:27:05,814 [INFO]   method: val_mul
2025-01-13 16:27:05,815 [INFO]   topk_mean: 100
2025-01-13 16:27:05,816 [INFO]   topk_cnt: 100
2025-01-13 16:27:05,817 [INFO]   batch_size: 32
2025-01-13 16:27:17,302 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 16:27:17,304 [INFO] Hyperparameters:
2025-01-13 16:27:17,305 [INFO]   layer: 6
2025-01-13 16:27:17,306 [INFO]   LLM: gpt2-small
2025-01-13 16:27:17,307 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:27:17,308 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:27:17,310 [INFO]   output_dir: ./results
2025-01-13 16:27:17,310 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:27:17,312 [INFO]   task: sentiment
2025-01-13 16:27:17,313 [INFO]   seed: 42
2025-01-13 16:27:17,314 [INFO]   data_size: 1000
2025-01-13 16:27:17,314 [INFO]   device: cpu
2025-01-13 16:27:17,315 [INFO]   alpha: 100
2025-01-13 16:27:17,316 [INFO]   steer: pos-neg
2025-01-13 16:27:17,317 [INFO]   method: val_mul
2025-01-13 16:27:17,318 [INFO]   topk_mean: 100
2025-01-13 16:27:17,318 [INFO]   topk_cnt: 100
2025-01-13 16:27:17,319 [INFO]   batch_size: 32
2025-01-13 16:27:24,273 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 16:27:37,496 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 16:27:37,499 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 16:27:37,683 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 16:27:37,693 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 16:28:13,826 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 16:28:17,192 [INFO] Hyperparameters:
2025-01-13 16:28:17,194 [INFO]   layer: 6
2025-01-13 16:28:17,195 [INFO]   LLM: gpt2-small
2025-01-13 16:28:17,196 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:28:17,198 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:28:17,198 [INFO]   output_dir: ./results
2025-01-13 16:28:17,199 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:28:17,200 [INFO]   task: sentiment
2025-01-13 16:28:17,201 [INFO]   seed: 42
2025-01-13 16:28:17,203 [INFO]   data_size: 1000
2025-01-13 16:28:17,204 [INFO]   device: cpu
2025-01-13 16:28:17,205 [INFO]   alpha: 100
2025-01-13 16:28:17,206 [INFO]   steer: pos-neg
2025-01-13 16:28:17,207 [INFO]   method: val_mul
2025-01-13 16:28:17,208 [INFO]   topk_mean: 100
2025-01-13 16:28:17,208 [INFO]   topk_cnt: 100
2025-01-13 16:28:17,210 [INFO]   batch_size: 32
2025-01-13 16:28:17,212 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 16:28:17,213 [INFO] Loading model: gpt2-small
2025-01-13 16:29:03,354 [INFO] Loading SAE for layer 6
2025-01-13 16:29:58,953 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:29:59,330 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:29:59,332 [INFO] Encoding hidden states for batch 1
2025-01-13 16:29:59,819 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:29:59,820 [INFO] Encoding hidden states for batch 2
2025-01-13 16:30:00,134 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:30:00,135 [INFO] Encoding hidden states for batch 3
2025-01-13 16:30:00,434 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:30:00,435 [INFO] Encoding hidden states for batch 4
2025-01-13 16:30:00,723 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:30:00,725 [INFO] Encoding hidden states for batch 5
2025-01-13 16:30:00,994 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:00,995 [INFO] Encoding hidden states for batch 6
2025-01-13 16:30:01,277 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:30:01,278 [INFO] Encoding hidden states for batch 7
2025-01-13 16:30:01,546 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 16:30:01,547 [INFO] Encoding hidden states for batch 8
2025-01-13 16:30:01,807 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:01,808 [INFO] Encoding hidden states for batch 9
2025-01-13 16:30:02,113 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:30:02,115 [INFO] Encoding hidden states for batch 10
2025-01-13 16:30:02,403 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:30:02,404 [INFO] Encoding hidden states for batch 11
2025-01-13 16:30:02,742 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 16:30:02,744 [INFO] Encoding hidden states for batch 12
2025-01-13 16:30:03,081 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:03,083 [INFO] Encoding hidden states for batch 13
2025-01-13 16:30:03,367 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:30:03,368 [INFO] Encoding hidden states for batch 14
2025-01-13 16:30:03,624 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 16:30:03,625 [INFO] Encoding hidden states for batch 15
2025-01-13 16:30:03,838 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 16:30:03,840 [INFO] Encoding hidden states for batch 16
2025-01-13 16:30:04,080 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:04,082 [INFO] Encoding hidden states for batch 17
2025-01-13 16:30:04,337 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:04,338 [INFO] Encoding hidden states for batch 18
2025-01-13 16:30:05,050 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:05,051 [INFO] Encoding hidden states for batch 19
2025-01-13 16:30:05,359 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:30:05,360 [INFO] Encoding hidden states for batch 20
2025-01-13 16:30:05,666 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:05,667 [INFO] Encoding hidden states for batch 21
2025-01-13 16:30:06,211 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 16:30:06,212 [INFO] Encoding hidden states for batch 22
2025-01-13 16:30:06,509 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:30:06,510 [INFO] Encoding hidden states for batch 23
2025-01-13 16:30:06,812 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:06,813 [INFO] Encoding hidden states for batch 24
2025-01-13 16:30:07,156 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:07,158 [INFO] Encoding hidden states for batch 25
2025-01-13 16:30:07,489 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:07,491 [INFO] Encoding hidden states for batch 26
2025-01-13 16:30:07,771 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:07,772 [INFO] Encoding hidden states for batch 27
2025-01-13 16:30:08,051 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:30:08,053 [INFO] Encoding hidden states for batch 28
2025-01-13 16:30:08,326 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:08,328 [INFO] Encoding hidden states for batch 29
2025-01-13 16:30:08,606 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:30:08,608 [INFO] Encoding hidden states for batch 30
2025-01-13 16:30:08,874 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:08,876 [INFO] Encoding hidden states for batch 31
2025-01-13 16:30:09,046 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 16:30:09,048 [INFO] Encoding hidden states for batch 32
2025-01-13 16:30:09,057 [INFO] Total batches processed: 32
2025-01-13 16:30:09,060 [INFO] 最大长度:60
2025-01-13 16:30:09,518 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 16:30:09,519 [INFO] Computing non-zero element counts
2025-01-13 16:30:10,505 [INFO] Computing sum of non-zero elements
2025-01-13 16:30:11,029 [INFO] Computing mean of non-zero elements
2025-01-13 16:30:11,031 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:30:11,033 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:30:11,033 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:30:11,034 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:30:11,444 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:30:11,752 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 16:30:11,754 [INFO] Encoding hidden states for batch 1
2025-01-13 16:30:12,090 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:12,092 [INFO] Encoding hidden states for batch 2
2025-01-13 16:30:12,386 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:12,387 [INFO] Encoding hidden states for batch 3
2025-01-13 16:30:12,704 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:30:12,705 [INFO] Encoding hidden states for batch 4
2025-01-13 16:30:12,972 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 16:30:12,974 [INFO] Encoding hidden states for batch 5
2025-01-13 16:30:13,229 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:13,230 [INFO] Encoding hidden states for batch 6
2025-01-13 16:30:13,674 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:13,675 [INFO] Encoding hidden states for batch 7
2025-01-13 16:30:13,969 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:13,970 [INFO] Encoding hidden states for batch 8
2025-01-13 16:30:14,295 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:14,296 [INFO] Encoding hidden states for batch 9
2025-01-13 16:30:14,627 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 16:30:14,628 [INFO] Encoding hidden states for batch 10
2025-01-13 16:30:14,928 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:30:14,929 [INFO] Encoding hidden states for batch 11
2025-01-13 16:30:15,227 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:15,229 [INFO] Encoding hidden states for batch 12
2025-01-13 16:30:15,511 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:15,513 [INFO] Encoding hidden states for batch 13
2025-01-13 16:30:15,776 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:15,778 [INFO] Encoding hidden states for batch 14
2025-01-13 16:30:16,043 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:16,045 [INFO] Encoding hidden states for batch 15
2025-01-13 16:30:16,322 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:16,323 [INFO] Encoding hidden states for batch 16
2025-01-13 16:30:16,585 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:30:16,586 [INFO] Encoding hidden states for batch 17
2025-01-13 16:30:16,866 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:16,867 [INFO] Encoding hidden states for batch 18
2025-01-13 16:30:17,177 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:17,179 [INFO] Encoding hidden states for batch 19
2025-01-13 16:30:17,528 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:30:17,529 [INFO] Encoding hidden states for batch 20
2025-01-13 16:30:17,812 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:17,813 [INFO] Encoding hidden states for batch 21
2025-01-13 16:30:18,081 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:18,082 [INFO] Encoding hidden states for batch 22
2025-01-13 16:30:18,423 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 16:30:18,424 [INFO] Encoding hidden states for batch 23
2025-01-13 16:30:18,722 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:30:18,724 [INFO] Encoding hidden states for batch 24
2025-01-13 16:30:19,020 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:19,022 [INFO] Encoding hidden states for batch 25
2025-01-13 16:30:19,287 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:30:19,288 [INFO] Encoding hidden states for batch 26
2025-01-13 16:30:19,576 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:19,578 [INFO] Encoding hidden states for batch 27
2025-01-13 16:30:19,842 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:30:19,844 [INFO] Encoding hidden states for batch 28
2025-01-13 16:30:20,093 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 16:30:20,095 [INFO] Encoding hidden states for batch 29
2025-01-13 16:30:20,328 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 16:30:20,329 [INFO] Encoding hidden states for batch 30
2025-01-13 16:30:20,637 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 16:30:20,639 [INFO] Encoding hidden states for batch 31
2025-01-13 16:30:20,824 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 16:30:20,826 [INFO] Encoding hidden states for batch 32
2025-01-13 16:30:20,835 [INFO] Total batches processed: 32
2025-01-13 16:30:20,837 [INFO] 最大长度:59
2025-01-13 16:30:21,296 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 16:30:21,297 [INFO] Computing non-zero element counts
2025-01-13 16:30:22,329 [INFO] Computing sum of non-zero elements
2025-01-13 16:30:22,850 [INFO] Computing mean of non-zero elements
2025-01-13 16:30:22,852 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:30:22,853 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:30:22,853 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:30:22,854 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:30:23,263 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:30:23,586 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 16:30:23,587 [INFO] Encoding hidden states for batch 1
2025-01-13 16:30:23,945 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:30:23,947 [INFO] Encoding hidden states for batch 2
2025-01-13 16:30:24,237 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:24,238 [INFO] Encoding hidden states for batch 3
2025-01-13 16:30:24,523 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:24,524 [INFO] Encoding hidden states for batch 4
2025-01-13 16:30:24,799 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:24,801 [INFO] Encoding hidden states for batch 5
2025-01-13 16:30:25,081 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:30:25,082 [INFO] Encoding hidden states for batch 6
2025-01-13 16:30:25,363 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:30:25,364 [INFO] Encoding hidden states for batch 7
2025-01-13 16:30:25,627 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:30:25,628 [INFO] Encoding hidden states for batch 8
2025-01-13 16:30:25,896 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:25,898 [INFO] Encoding hidden states for batch 9
2025-01-13 16:30:26,205 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:30:26,207 [INFO] Encoding hidden states for batch 10
2025-01-13 16:30:26,499 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 16:30:26,501 [INFO] Encoding hidden states for batch 11
2025-01-13 16:30:26,810 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:30:26,812 [INFO] Encoding hidden states for batch 12
2025-01-13 16:30:27,099 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:30:27,100 [INFO] Encoding hidden states for batch 13
2025-01-13 16:30:27,390 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:30:27,392 [INFO] Encoding hidden states for batch 14
2025-01-13 16:30:27,664 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:27,665 [INFO] Encoding hidden states for batch 15
2025-01-13 16:30:27,976 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:30:27,978 [INFO] Encoding hidden states for batch 16
2025-01-13 16:30:28,264 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:30:28,266 [INFO] Encoding hidden states for batch 17
2025-01-13 16:30:28,535 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:28,537 [INFO] Encoding hidden states for batch 18
2025-01-13 16:30:28,832 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:28,834 [INFO] Encoding hidden states for batch 19
2025-01-13 16:30:29,121 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:29,123 [INFO] Encoding hidden states for batch 20
2025-01-13 16:30:29,447 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:30:29,448 [INFO] Encoding hidden states for batch 21
2025-01-13 16:30:29,718 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:30:29,720 [INFO] Encoding hidden states for batch 22
2025-01-13 16:30:30,050 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 16:30:30,052 [INFO] Encoding hidden states for batch 23
2025-01-13 16:30:30,333 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:30:30,335 [INFO] Encoding hidden states for batch 24
2025-01-13 16:30:30,613 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:30,615 [INFO] Encoding hidden states for batch 25
2025-01-13 16:30:30,916 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:30:30,918 [INFO] Encoding hidden states for batch 26
2025-01-13 16:30:31,207 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:30:31,208 [INFO] Encoding hidden states for batch 27
2025-01-13 16:30:31,502 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:30:31,504 [INFO] Encoding hidden states for batch 28
2025-01-13 16:30:31,777 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:30:31,778 [INFO] Encoding hidden states for batch 29
2025-01-13 16:30:32,070 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:30:32,071 [INFO] Encoding hidden states for batch 30
2025-01-13 16:30:32,340 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:30:32,342 [INFO] Encoding hidden states for batch 31
2025-01-13 16:30:32,524 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 16:30:32,526 [INFO] Encoding hidden states for batch 32
2025-01-13 16:30:32,537 [INFO] Total batches processed: 32
2025-01-13 16:30:32,540 [INFO] 最大长度:76
2025-01-13 16:30:33,092 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 16:30:33,093 [INFO] Computing non-zero element counts
2025-01-13 16:30:34,364 [INFO] Computing sum of non-zero elements
2025-01-13 16:30:35,031 [INFO] Computing mean of non-zero elements
2025-01-13 16:30:35,033 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:30:35,034 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:30:35,035 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:30:35,036 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:32:32,279 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 16:32:32,281 [INFO] Hyperparameters:
2025-01-13 16:32:32,284 [INFO]   layer: 6
2025-01-13 16:32:32,288 [INFO]   LLM: gpt2-small
2025-01-13 16:32:32,289 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:32:32,290 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:32:32,291 [INFO]   output_dir: ./results
2025-01-13 16:32:32,292 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:32:32,293 [INFO]   task: sentiment
2025-01-13 16:32:32,295 [INFO]   seed: 42
2025-01-13 16:32:32,296 [INFO]   data_size: 1000
2025-01-13 16:32:32,297 [INFO]   device: cpu
2025-01-13 16:32:32,298 [INFO]   alpha: 100
2025-01-13 16:32:32,298 [INFO]   steer: pos-neg
2025-01-13 16:32:32,300 [INFO]   method: val_mul
2025-01-13 16:32:32,301 [INFO]   topk_mean: 100
2025-01-13 16:32:32,302 [INFO]   topk_cnt: 100
2025-01-13 16:32:32,303 [INFO]   batch_size: 32
2025-01-13 16:32:37,594 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 16:32:54,319 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 16:32:54,322 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 16:32:54,504 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 16:32:54,516 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 16:33:33,292 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 16:33:39,026 [INFO] Hyperparameters:
2025-01-13 16:33:39,029 [INFO]   layer: 6
2025-01-13 16:33:39,030 [INFO]   LLM: gpt2-small
2025-01-13 16:33:39,031 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:33:39,032 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:33:39,033 [INFO]   output_dir: ./results
2025-01-13 16:33:39,034 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:33:39,035 [INFO]   task: sentiment
2025-01-13 16:33:39,035 [INFO]   seed: 42
2025-01-13 16:33:39,037 [INFO]   data_size: 1000
2025-01-13 16:33:39,038 [INFO]   device: cpu
2025-01-13 16:33:39,039 [INFO]   alpha: 100
2025-01-13 16:33:39,040 [INFO]   steer: pos-neg
2025-01-13 16:33:39,041 [INFO]   method: val_mul
2025-01-13 16:33:39,042 [INFO]   topk_mean: 100
2025-01-13 16:33:39,043 [INFO]   topk_cnt: 100
2025-01-13 16:33:39,044 [INFO]   batch_size: 32
2025-01-13 16:33:39,046 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 16:33:39,075 [INFO] Loading model: gpt2-small
2025-01-13 16:34:39,922 [INFO] Loading SAE for layer 6
2025-01-13 16:37:43,560 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-13 16:37:43,564 [INFO] Hyperparameters:
2025-01-13 16:37:43,567 [INFO]   layer: 6
2025-01-13 16:37:43,569 [INFO]   LLM: gpt2-small
2025-01-13 16:37:43,570 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:37:43,571 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:37:43,573 [INFO]   output_dir: ./results
2025-01-13 16:37:43,580 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:37:43,581 [INFO]   task: sentiment
2025-01-13 16:37:43,583 [INFO]   seed: 42
2025-01-13 16:37:43,584 [INFO]   data_size: 1000
2025-01-13 16:37:43,585 [INFO]   device: cpu
2025-01-13 16:37:43,586 [INFO]   alpha: 100
2025-01-13 16:37:43,587 [INFO]   steer: pos-neg
2025-01-13 16:37:43,588 [INFO]   method: val_mul
2025-01-13 16:37:43,588 [INFO]   topk_mean: 100
2025-01-13 16:37:43,589 [INFO]   topk_cnt: 100
2025-01-13 16:37:43,590 [INFO]   batch_size: 32
2025-01-13 16:38:33,839 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-13 16:38:33,843 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-13 16:38:34,023 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-13 16:38:34,036 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-13 16:39:33,895 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-13 16:39:37,471 [INFO] Hyperparameters:
2025-01-13 16:39:37,474 [INFO]   layer: 6
2025-01-13 16:39:37,475 [INFO]   LLM: gpt2-small
2025-01-13 16:39:37,477 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-13 16:39:37,478 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-13 16:39:37,480 [INFO]   output_dir: ./results
2025-01-13 16:39:37,482 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-13 16:39:37,483 [INFO]   task: sentiment
2025-01-13 16:39:37,484 [INFO]   seed: 42
2025-01-13 16:39:37,486 [INFO]   data_size: 1000
2025-01-13 16:39:37,488 [INFO]   device: cpu
2025-01-13 16:39:37,489 [INFO]   alpha: 100
2025-01-13 16:39:37,490 [INFO]   steer: pos-neg
2025-01-13 16:39:37,492 [INFO]   method: val_mul
2025-01-13 16:39:37,493 [INFO]   topk_mean: 100
2025-01-13 16:39:37,494 [INFO]   topk_cnt: 100
2025-01-13 16:39:37,495 [INFO]   batch_size: 32
2025-01-13 16:39:37,498 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-13 16:39:37,499 [INFO] Loading model: gpt2-small
2025-01-13 16:40:18,329 [INFO] Loading SAE for layer 6
2025-01-13 16:41:07,584 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:41:07,903 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:41:07,905 [INFO] Encoding hidden states for batch 1
2025-01-13 16:41:08,251 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:08,253 [INFO] Encoding hidden states for batch 2
2025-01-13 16:41:08,583 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:41:08,585 [INFO] Encoding hidden states for batch 3
2025-01-13 16:41:08,896 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:41:08,898 [INFO] Encoding hidden states for batch 4
2025-01-13 16:41:09,201 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:41:09,203 [INFO] Encoding hidden states for batch 5
2025-01-13 16:41:09,452 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:09,454 [INFO] Encoding hidden states for batch 6
2025-01-13 16:41:09,717 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:41:09,719 [INFO] Encoding hidden states for batch 7
2025-01-13 16:41:09,939 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-13 16:41:09,941 [INFO] Encoding hidden states for batch 8
2025-01-13 16:41:10,175 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:10,177 [INFO] Encoding hidden states for batch 9
2025-01-13 16:41:10,448 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:41:10,450 [INFO] Encoding hidden states for batch 10
2025-01-13 16:41:10,717 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:41:10,718 [INFO] Encoding hidden states for batch 11
2025-01-13 16:41:11,322 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 16:41:11,324 [INFO] Encoding hidden states for batch 12
2025-01-13 16:41:11,630 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:11,632 [INFO] Encoding hidden states for batch 13
2025-01-13 16:41:11,961 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:41:11,963 [INFO] Encoding hidden states for batch 14
2025-01-13 16:41:12,197 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-13 16:41:12,198 [INFO] Encoding hidden states for batch 15
2025-01-13 16:41:12,411 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-13 16:41:12,412 [INFO] Encoding hidden states for batch 16
2025-01-13 16:41:12,662 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:12,664 [INFO] Encoding hidden states for batch 17
2025-01-13 16:41:12,915 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:12,917 [INFO] Encoding hidden states for batch 18
2025-01-13 16:41:13,176 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:13,178 [INFO] Encoding hidden states for batch 19
2025-01-13 16:41:13,521 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:41:13,523 [INFO] Encoding hidden states for batch 20
2025-01-13 16:41:13,857 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:13,858 [INFO] Encoding hidden states for batch 21
2025-01-13 16:41:14,287 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-13 16:41:14,289 [INFO] Encoding hidden states for batch 22
2025-01-13 16:41:14,593 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:41:14,594 [INFO] Encoding hidden states for batch 23
2025-01-13 16:41:14,926 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:14,927 [INFO] Encoding hidden states for batch 24
2025-01-13 16:41:15,293 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:15,295 [INFO] Encoding hidden states for batch 25
2025-01-13 16:41:15,651 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:15,653 [INFO] Encoding hidden states for batch 26
2025-01-13 16:41:15,958 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:15,960 [INFO] Encoding hidden states for batch 27
2025-01-13 16:41:16,279 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:41:16,281 [INFO] Encoding hidden states for batch 28
2025-01-13 16:41:16,577 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:16,578 [INFO] Encoding hidden states for batch 29
2025-01-13 16:41:16,894 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:41:16,896 [INFO] Encoding hidden states for batch 30
2025-01-13 16:41:17,204 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:17,206 [INFO] Encoding hidden states for batch 31
2025-01-13 16:41:17,412 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-13 16:41:17,413 [INFO] Encoding hidden states for batch 32
2025-01-13 16:41:17,422 [INFO] Total batches processed: 32
2025-01-13 16:41:17,425 [INFO] 最大长度:60
2025-01-13 16:41:17,911 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-13 16:41:17,912 [INFO] Computing non-zero element counts
2025-01-13 16:41:19,124 [INFO] Computing sum of non-zero elements
2025-01-13 16:41:19,784 [INFO] Computing mean of non-zero elements
2025-01-13 16:41:19,786 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:41:19,787 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:41:19,788 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:41:19,789 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:41:20,468 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:41:20,746 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-13 16:41:20,747 [INFO] Encoding hidden states for batch 1
2025-01-13 16:41:21,068 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:21,069 [INFO] Encoding hidden states for batch 2
2025-01-13 16:41:21,379 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:21,381 [INFO] Encoding hidden states for batch 3
2025-01-13 16:41:21,689 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:41:21,690 [INFO] Encoding hidden states for batch 4
2025-01-13 16:41:21,953 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-13 16:41:21,954 [INFO] Encoding hidden states for batch 5
2025-01-13 16:41:22,217 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:22,218 [INFO] Encoding hidden states for batch 6
2025-01-13 16:41:22,492 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:22,494 [INFO] Encoding hidden states for batch 7
2025-01-13 16:41:22,808 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:22,809 [INFO] Encoding hidden states for batch 8
2025-01-13 16:41:23,151 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:23,153 [INFO] Encoding hidden states for batch 9
2025-01-13 16:41:23,498 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 16:41:23,500 [INFO] Encoding hidden states for batch 10
2025-01-13 16:41:23,809 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:41:23,811 [INFO] Encoding hidden states for batch 11
2025-01-13 16:41:24,111 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:24,113 [INFO] Encoding hidden states for batch 12
2025-01-13 16:41:24,407 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:24,409 [INFO] Encoding hidden states for batch 13
2025-01-13 16:41:24,700 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:24,701 [INFO] Encoding hidden states for batch 14
2025-01-13 16:41:24,991 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:24,993 [INFO] Encoding hidden states for batch 15
2025-01-13 16:41:25,288 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:25,290 [INFO] Encoding hidden states for batch 16
2025-01-13 16:41:25,570 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:41:25,571 [INFO] Encoding hidden states for batch 17
2025-01-13 16:41:25,886 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:25,888 [INFO] Encoding hidden states for batch 18
2025-01-13 16:41:26,208 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:26,209 [INFO] Encoding hidden states for batch 19
2025-01-13 16:41:26,563 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:41:26,564 [INFO] Encoding hidden states for batch 20
2025-01-13 16:41:26,865 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:26,867 [INFO] Encoding hidden states for batch 21
2025-01-13 16:41:27,136 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:27,137 [INFO] Encoding hidden states for batch 22
2025-01-13 16:41:27,462 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 16:41:27,463 [INFO] Encoding hidden states for batch 23
2025-01-13 16:41:27,790 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:41:27,792 [INFO] Encoding hidden states for batch 24
2025-01-13 16:41:28,108 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:28,110 [INFO] Encoding hidden states for batch 25
2025-01-13 16:41:28,400 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-13 16:41:28,401 [INFO] Encoding hidden states for batch 26
2025-01-13 16:41:28,681 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:28,682 [INFO] Encoding hidden states for batch 27
2025-01-13 16:41:28,960 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:41:28,962 [INFO] Encoding hidden states for batch 28
2025-01-13 16:41:29,236 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 16:41:29,238 [INFO] Encoding hidden states for batch 29
2025-01-13 16:41:29,508 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-13 16:41:29,510 [INFO] Encoding hidden states for batch 30
2025-01-13 16:41:29,810 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-13 16:41:29,812 [INFO] Encoding hidden states for batch 31
2025-01-13 16:41:29,999 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-13 16:41:30,001 [INFO] Encoding hidden states for batch 32
2025-01-13 16:41:30,009 [INFO] Total batches processed: 32
2025-01-13 16:41:30,012 [INFO] 最大长度:59
2025-01-13 16:41:30,444 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-13 16:41:30,445 [INFO] Computing non-zero element counts
2025-01-13 16:41:31,637 [INFO] Computing sum of non-zero elements
2025-01-13 16:41:32,286 [INFO] Computing mean of non-zero elements
2025-01-13 16:41:32,287 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:41:32,288 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:41:32,289 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:41:32,290 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:41:32,910 [INFO] Running model with cache to obtain hidden states
2025-01-13 16:41:33,256 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-13 16:41:33,257 [INFO] Encoding hidden states for batch 1
2025-01-13 16:41:33,638 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:41:33,640 [INFO] Encoding hidden states for batch 2
2025-01-13 16:41:33,933 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:33,935 [INFO] Encoding hidden states for batch 3
2025-01-13 16:41:34,230 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:34,232 [INFO] Encoding hidden states for batch 4
2025-01-13 16:41:34,523 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:34,524 [INFO] Encoding hidden states for batch 5
2025-01-13 16:41:34,837 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-13 16:41:34,838 [INFO] Encoding hidden states for batch 6
2025-01-13 16:41:35,147 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-13 16:41:35,148 [INFO] Encoding hidden states for batch 7
2025-01-13 16:41:35,430 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:41:35,432 [INFO] Encoding hidden states for batch 8
2025-01-13 16:41:35,716 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:35,718 [INFO] Encoding hidden states for batch 9
2025-01-13 16:41:36,038 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:41:36,039 [INFO] Encoding hidden states for batch 10
2025-01-13 16:41:36,326 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-13 16:41:36,327 [INFO] Encoding hidden states for batch 11
2025-01-13 16:41:36,662 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:41:36,664 [INFO] Encoding hidden states for batch 12
2025-01-13 16:41:36,968 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-13 16:41:36,970 [INFO] Encoding hidden states for batch 13
2025-01-13 16:41:37,276 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:41:37,278 [INFO] Encoding hidden states for batch 14
2025-01-13 16:41:37,562 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:37,564 [INFO] Encoding hidden states for batch 15
2025-01-13 16:41:37,915 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-13 16:41:37,917 [INFO] Encoding hidden states for batch 16
2025-01-13 16:41:38,232 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-13 16:41:38,233 [INFO] Encoding hidden states for batch 17
2025-01-13 16:41:38,517 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:38,518 [INFO] Encoding hidden states for batch 18
2025-01-13 16:41:38,841 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:38,843 [INFO] Encoding hidden states for batch 19
2025-01-13 16:41:39,129 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:39,130 [INFO] Encoding hidden states for batch 20
2025-01-13 16:41:39,476 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-13 16:41:39,477 [INFO] Encoding hidden states for batch 21
2025-01-13 16:41:39,903 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:41:39,905 [INFO] Encoding hidden states for batch 22
2025-01-13 16:41:40,242 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-13 16:41:40,244 [INFO] Encoding hidden states for batch 23
2025-01-13 16:41:40,544 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-13 16:41:40,546 [INFO] Encoding hidden states for batch 24
2025-01-13 16:41:40,828 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:40,830 [INFO] Encoding hidden states for batch 25
2025-01-13 16:41:41,148 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-13 16:41:41,150 [INFO] Encoding hidden states for batch 26
2025-01-13 16:41:41,450 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-13 16:41:41,452 [INFO] Encoding hidden states for batch 27
2025-01-13 16:41:41,769 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-13 16:41:41,771 [INFO] Encoding hidden states for batch 28
2025-01-13 16:41:42,274 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-13 16:41:42,276 [INFO] Encoding hidden states for batch 29
2025-01-13 16:41:42,600 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-13 16:41:42,602 [INFO] Encoding hidden states for batch 30
2025-01-13 16:41:42,898 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-13 16:41:42,900 [INFO] Encoding hidden states for batch 31
2025-01-13 16:41:43,106 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-13 16:41:43,109 [INFO] Encoding hidden states for batch 32
2025-01-13 16:41:43,120 [INFO] Total batches processed: 32
2025-01-13 16:41:43,123 [INFO] 最大长度:76
2025-01-13 16:41:43,667 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-13 16:41:43,667 [INFO] Computing non-zero element counts
2025-01-13 16:41:45,011 [INFO] Computing sum of non-zero elements
2025-01-13 16:41:45,744 [INFO] Computing mean of non-zero elements
2025-01-13 16:41:45,746 [INFO] Selecting top-k indices based on nz_mean
2025-01-13 16:41:45,747 [INFO] Top 100 nz_mean values selected.
2025-01-13 16:41:45,747 [INFO] Selecting top-k indices based on act_cnt
2025-01-13 16:41:45,749 [INFO] Top 100 act_cnt values selected.
2025-01-13 16:44:05,194 [INFO] Computing steering vectors using method: val_mul
2025-01-13 16:44:05,207 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-13 16:44:21,727 [INFO] Example prompt:  Hei, we have good result, 
2025-01-13 16:44:21,729 [INFO] Generating texts **without** steering... 
2025-01-13 16:44:23,714 [INFO] Generated Text: 1:
 Hei, we have good result,  but we are not able to win the game.
The other thing is that I think it's a very important point. We need to make sure that our players understand what they are doing and how they can improve their game.
We need
2025-01-13 16:44:23,714 [INFO] Generated Text: 2:
 Hei, we have good result,  but we are not able to get a good result.
The problem is that the game is very simple and it's easy to understand. The game starts with a single player and you can play as many characters as you want. You can play
2025-01-13 16:44:23,715 [INFO] Generated Text: 3:
 Hei, we have good result,  but we are not able to get the results that we want.
We can't make a big difference in the future. We need to do something about it.
The first step is to create a new system for the team and our players
2025-01-13 16:44:23,715 [INFO] 干预之后的结果
2025-01-13 16:44:23,716 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 16:44:23,716 [INFO] ** Generating texts with steering... Target **
2025-01-13 16:44:25,565 [INFO] Generated Text: 1:
 Hei, we have good result,  and I'm glad that the story is moving forward.
The first thing I want to say is that this was a terrible story. It's not like there were any great characters or plot twists in it. The main character was just a normal
2025-01-13 16:44:25,565 [INFO] Generated Text: 2:
 Hei, we have good result,  and I'm glad that the writers of this book are willing to take a chance on it.
I'm not sure if you've read the first two books in this series, but I think they're pretty good. The first is a bit
2025-01-13 16:44:25,566 [INFO] Generated Text: 3:
 Hei, we have good result,  I'm not sure if I can say that much more.
The only thing I can say is that this was a terrible film. It's a very bad movie and it's going to be hard for me to watch again.<|endoftext|><|endoftext|><|endoftext|>
2025-01-13 16:44:29,106 [INFO] Example prompt:  Hei, we have good result, 
2025-01-13 16:44:29,108 [INFO] Generating texts **without** steering... 
2025-01-13 16:44:30,905 [INFO] Generated Text: 1:
 Hei, we have good result,  but we are not sure how to proceed.
We will start with the first question: what is the probability that a given event will occur? The answer is simple: it depends on the number of people involved. If you look at our data
2025-01-13 16:44:30,906 [INFO] Generated Text: 2:
 Hei, we have good result,  but we are not able to do anything about it.
The problem is that the government has been doing nothing for a long time now. The only thing that has changed is the fact that they have started to take action on this issue.

2025-01-13 16:44:30,906 [INFO] Generated Text: 3:
 Hei, we have good result,  but we are not sure how to proceed.
The problem is that the game has been played for a long time and it is not easy to get the right players. The only way to do this is by playing against other players who are better
2025-01-13 16:44:30,907 [INFO] 干预之后的结果
2025-01-13 16:44:30,907 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-13 16:44:30,907 [INFO] ** Generating texts with steering... Target **
2025-01-13 16:44:32,659 [INFO] Generated Text: 1:
 Hei, we have good result,  and I'm glad that the story is not so bad.
I think it's a shame that this was a film about the worst thing in the world. It's like an anti-hero movie with no redeeming qualities. The only redeem
2025-01-13 16:44:32,660 [INFO] Generated Text: 2:
 Hei, we have good result,  I'm not sure if I can say that much more.
But it's a shame that the story of this book is so short and boring. It's like a movie about an old man who gets his life turned upside down by a bad
2025-01-13 16:44:32,660 [INFO] Generated Text: 3:
 Hei, we have good result,  and I'm glad that the fans are so supportive.
I think it's a shame that this is such a bad thing for the team. It's just not what they wanted to do. They were going to be playing in the Champions League
2025-01-13 16:45:00,201 [INFO] Loading prompt_path from /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 10:45:00,207 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 10:45:00,208 [INFO] Hyperparameters:
2025-01-14 10:45:00,210 [INFO]   layer: 6
2025-01-14 10:45:00,210 [INFO]   LLM: gpt2-small
2025-01-14 10:45:00,211 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 10:45:00,212 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 10:45:00,214 [INFO]   output_dir: ./results
2025-01-14 10:45:00,215 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 10:45:00,216 [INFO]   task: sentiment
2025-01-14 10:45:00,217 [INFO]   seed: 42
2025-01-14 10:45:00,218 [INFO]   data_size: 1000
2025-01-14 10:45:00,219 [INFO]   device: cpu
2025-01-14 10:45:00,220 [INFO]   alpha: 100
2025-01-14 10:45:00,221 [INFO]   steer: pos-neg
2025-01-14 10:45:00,222 [INFO]   method: val_mul
2025-01-14 10:45:00,223 [INFO]   topk_mean: 100
2025-01-14 10:45:00,224 [INFO]   topk_cnt: 100
2025-01-14 10:45:00,225 [INFO]   batch_size: 32
2025-01-14 10:45:03,318 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 10:46:11,123 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-14 10:46:11,125 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-14 10:46:11,305 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-14 10:46:11,314 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-14 10:46:33,521 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-14 10:46:37,432 [INFO] Hyperparameters:
2025-01-14 10:46:37,434 [INFO]   layer: 6
2025-01-14 10:46:37,436 [INFO]   LLM: gpt2-small
2025-01-14 10:46:37,568 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 10:46:37,570 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 10:46:37,571 [INFO]   output_dir: ./results
2025-01-14 10:46:37,573 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 10:46:37,574 [INFO]   task: sentiment
2025-01-14 10:46:37,576 [INFO]   seed: 42
2025-01-14 10:46:37,578 [INFO]   data_size: 1000
2025-01-14 10:46:37,579 [INFO]   device: cpu
2025-01-14 10:46:37,580 [INFO]   alpha: 100
2025-01-14 10:46:37,582 [INFO]   steer: pos-neg
2025-01-14 10:46:37,583 [INFO]   method: val_mul
2025-01-14 10:46:37,584 [INFO]   topk_mean: 100
2025-01-14 10:46:37,585 [INFO]   topk_cnt: 100
2025-01-14 10:46:37,587 [INFO]   batch_size: 32
2025-01-14 10:46:37,589 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 10:46:37,591 [INFO] Loading model: gpt2-small
2025-01-14 10:47:33,393 [INFO] Loading SAE for layer 6
2025-01-14 11:22:39,551 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 11:22:39,553 [INFO] Hyperparameters:
2025-01-14 11:22:39,555 [INFO]   layer: 6
2025-01-14 11:22:39,556 [INFO]   LLM: gpt2-small
2025-01-14 11:22:39,557 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/c
2025-01-14 11:22:39,558 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 11:22:39,559 [INFO]   output_dir: ./results
2025-01-14 11:22:39,560 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 11:22:39,562 [INFO]   task: sentiment
2025-01-14 11:22:39,563 [INFO]   seed: 42
2025-01-14 11:22:39,564 [INFO]   data_size: 1000
2025-01-14 11:22:39,564 [INFO]   device: cpu
2025-01-14 11:22:39,565 [INFO]   alpha: 100
2025-01-14 11:22:39,566 [INFO]   steer: pos-neg
2025-01-14 11:22:39,567 [INFO]   method: val_mul
2025-01-14 11:22:39,568 [INFO]   topk_mean: 100
2025-01-14 11:22:39,568 [INFO]   topk_cnt: 100
2025-01-14 11:22:39,569 [INFO]   batch_size: 32
2025-01-14 11:22:43,091 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 11:23:28,163 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 11:23:28,165 [INFO] Hyperparameters:
2025-01-14 11:23:28,167 [INFO]   layer: 6
2025-01-14 11:23:28,168 [INFO]   LLM: gpt2-small
2025-01-14 11:23:28,169 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/c
2025-01-14 11:23:28,170 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 11:23:28,171 [INFO]   output_dir: ./results
2025-01-14 11:23:28,172 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 11:23:28,173 [INFO]   task: sentiment
2025-01-14 11:23:28,174 [INFO]   seed: 42
2025-01-14 11:23:28,175 [INFO]   data_size: 1000
2025-01-14 11:23:28,175 [INFO]   device: cpu
2025-01-14 11:23:28,177 [INFO]   alpha: 100
2025-01-14 11:23:28,178 [INFO]   steer: pos-neg
2025-01-14 11:23:28,179 [INFO]   method: val_mul
2025-01-14 11:23:28,180 [INFO]   topk_mean: 100
2025-01-14 11:23:28,181 [INFO]   topk_cnt: 100
2025-01-14 11:23:28,181 [INFO]   batch_size: 32
2025-01-14 11:23:31,564 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 11:24:36,051 [INFO] dataset path/home/ckqsudo/code2024/0dataset/baseline-acl/data/c
2025-01-14 11:25:23,790 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 11:25:23,791 [INFO] Hyperparameters:
2025-01-14 11:25:23,793 [INFO]   layer: 6
2025-01-14 11:25:23,794 [INFO]   LLM: gpt2-small
2025-01-14 11:25:23,795 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 11:25:23,796 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 11:25:23,797 [INFO]   output_dir: ./results
2025-01-14 11:25:23,798 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 11:25:23,800 [INFO]   task: sentiment
2025-01-14 11:25:23,801 [INFO]   seed: 42
2025-01-14 11:25:23,801 [INFO]   data_size: 1000
2025-01-14 11:25:23,802 [INFO]   device: cpu
2025-01-14 11:25:23,803 [INFO]   alpha: 100
2025-01-14 11:25:23,804 [INFO]   steer: pos-neg
2025-01-14 11:25:23,805 [INFO]   method: val_mul
2025-01-14 11:25:23,805 [INFO]   topk_mean: 100
2025-01-14 11:25:23,806 [INFO]   topk_cnt: 100
2025-01-14 11:25:23,807 [INFO]   batch_size: 32
2025-01-14 11:25:26,468 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 11:25:34,159 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 11:25:34,163 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-14 11:25:34,167 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-14 11:25:34,402 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-14 11:25:34,413 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-14 11:25:52,414 [INFO] non cache: ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-14 11:25:55,248 [INFO] Hyperparameters:
2025-01-14 11:25:55,250 [INFO]   layer: 6
2025-01-14 11:25:55,251 [INFO]   LLM: gpt2-small
2025-01-14 11:25:55,252 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 11:25:55,253 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 11:25:55,253 [INFO]   output_dir: ./results
2025-01-14 11:25:55,254 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 11:25:55,255 [INFO]   task: sentiment
2025-01-14 11:25:55,256 [INFO]   seed: 42
2025-01-14 11:25:55,257 [INFO]   data_size: 1000
2025-01-14 11:25:55,258 [INFO]   device: cpu
2025-01-14 11:25:55,258 [INFO]   alpha: 100
2025-01-14 11:25:55,259 [INFO]   steer: pos-neg
2025-01-14 11:25:55,260 [INFO]   method: val_mul
2025-01-14 11:25:55,261 [INFO]   topk_mean: 100
2025-01-14 11:25:55,262 [INFO]   topk_cnt: 100
2025-01-14 11:25:55,262 [INFO]   batch_size: 32
2025-01-14 11:25:55,267 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 11:25:55,285 [INFO] Loading model: gpt2-small
2025-01-14 11:26:36,091 [INFO] Loading SAE for layer 6
2025-01-14 11:27:45,477 [INFO] pos-neg
2025-01-14 11:27:45,506 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:27:45,882 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:27:45,883 [INFO] Encoding hidden states for batch 1
2025-01-14 11:27:46,320 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:27:46,321 [INFO] Encoding hidden states for batch 2
2025-01-14 11:27:46,640 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:27:46,641 [INFO] Encoding hidden states for batch 3
2025-01-14 11:27:46,973 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:27:46,975 [INFO] Encoding hidden states for batch 4
2025-01-14 11:27:47,284 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:27:47,285 [INFO] Encoding hidden states for batch 5
2025-01-14 11:27:47,595 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:27:47,597 [INFO] Encoding hidden states for batch 6
2025-01-14 11:27:47,908 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:27:47,910 [INFO] Encoding hidden states for batch 7
2025-01-14 11:27:48,175 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-14 11:27:48,176 [INFO] Encoding hidden states for batch 8
2025-01-14 11:27:48,457 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:27:48,458 [INFO] Encoding hidden states for batch 9
2025-01-14 11:27:48,772 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:27:48,773 [INFO] Encoding hidden states for batch 10
2025-01-14 11:27:49,095 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:27:49,096 [INFO] Encoding hidden states for batch 11
2025-01-14 11:27:49,627 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 11:27:49,628 [INFO] Encoding hidden states for batch 12
2025-01-14 11:27:49,973 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:27:49,974 [INFO] Encoding hidden states for batch 13
2025-01-14 11:27:50,284 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:27:50,286 [INFO] Encoding hidden states for batch 14
2025-01-14 11:27:50,550 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-14 11:27:50,553 [INFO] Encoding hidden states for batch 15
2025-01-14 11:27:50,791 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-14 11:27:50,793 [INFO] Encoding hidden states for batch 16
2025-01-14 11:27:51,057 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:27:51,057 [INFO] Encoding hidden states for batch 17
2025-01-14 11:27:51,348 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:27:51,349 [INFO] Encoding hidden states for batch 18
2025-01-14 11:27:51,647 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:27:51,649 [INFO] Encoding hidden states for batch 19
2025-01-14 11:27:52,018 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:27:52,020 [INFO] Encoding hidden states for batch 20
2025-01-14 11:27:52,355 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:27:52,357 [INFO] Encoding hidden states for batch 21
2025-01-14 11:27:52,706 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 11:27:52,707 [INFO] Encoding hidden states for batch 22
2025-01-14 11:27:52,984 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:27:52,985 [INFO] Encoding hidden states for batch 23
2025-01-14 11:27:53,271 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:27:53,272 [INFO] Encoding hidden states for batch 24
2025-01-14 11:27:53,552 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:27:53,553 [INFO] Encoding hidden states for batch 25
2025-01-14 11:27:53,870 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:27:53,871 [INFO] Encoding hidden states for batch 26
2025-01-14 11:27:54,156 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:27:54,157 [INFO] Encoding hidden states for batch 27
2025-01-14 11:27:54,453 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:27:54,455 [INFO] Encoding hidden states for batch 28
2025-01-14 11:27:54,753 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:27:54,754 [INFO] Encoding hidden states for batch 29
2025-01-14 11:27:55,075 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:27:55,076 [INFO] Encoding hidden states for batch 30
2025-01-14 11:27:55,389 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:27:55,390 [INFO] Encoding hidden states for batch 31
2025-01-14 11:27:55,558 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-14 11:27:55,559 [INFO] Encoding hidden states for batch 32
2025-01-14 11:27:55,569 [INFO] Total batches processed: 32
2025-01-14 11:27:55,573 [INFO] 最大长度:60
2025-01-14 11:27:56,015 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-14 11:27:56,015 [INFO] Computing non-zero element counts
2025-01-14 11:27:57,104 [INFO] Computing sum of non-zero elements
2025-01-14 11:27:57,677 [INFO] Computing mean of non-zero elements
2025-01-14 11:27:57,679 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:27:57,680 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:27:57,680 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:27:57,681 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:27:58,193 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:27:58,459 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-14 11:27:58,460 [INFO] Encoding hidden states for batch 1
2025-01-14 11:27:58,774 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:27:58,775 [INFO] Encoding hidden states for batch 2
2025-01-14 11:27:59,070 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:27:59,071 [INFO] Encoding hidden states for batch 3
2025-01-14 11:27:59,383 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:27:59,385 [INFO] Encoding hidden states for batch 4
2025-01-14 11:27:59,639 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-14 11:27:59,640 [INFO] Encoding hidden states for batch 5
2025-01-14 11:27:59,891 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:27:59,893 [INFO] Encoding hidden states for batch 6
2025-01-14 11:28:00,174 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:00,174 [INFO] Encoding hidden states for batch 7
2025-01-14 11:28:00,477 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:28:00,478 [INFO] Encoding hidden states for batch 8
2025-01-14 11:28:00,809 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:28:00,810 [INFO] Encoding hidden states for batch 9
2025-01-14 11:28:01,135 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 11:28:01,136 [INFO] Encoding hidden states for batch 10
2025-01-14 11:28:01,446 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:28:01,447 [INFO] Encoding hidden states for batch 11
2025-01-14 11:28:01,755 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:28:01,756 [INFO] Encoding hidden states for batch 12
2025-01-14 11:28:02,048 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:02,049 [INFO] Encoding hidden states for batch 13
2025-01-14 11:28:02,325 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:28:02,326 [INFO] Encoding hidden states for batch 14
2025-01-14 11:28:02,593 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:28:02,595 [INFO] Encoding hidden states for batch 15
2025-01-14 11:28:02,877 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:28:02,878 [INFO] Encoding hidden states for batch 16
2025-01-14 11:28:03,148 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:28:03,149 [INFO] Encoding hidden states for batch 17
2025-01-14 11:28:03,439 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:28:03,441 [INFO] Encoding hidden states for batch 18
2025-01-14 11:28:03,754 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:28:03,756 [INFO] Encoding hidden states for batch 19
2025-01-14 11:28:04,112 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:28:04,113 [INFO] Encoding hidden states for batch 20
2025-01-14 11:28:04,398 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:28:04,400 [INFO] Encoding hidden states for batch 21
2025-01-14 11:28:04,680 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:04,681 [INFO] Encoding hidden states for batch 22
2025-01-14 11:28:05,019 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 11:28:05,020 [INFO] Encoding hidden states for batch 23
2025-01-14 11:28:05,316 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:28:05,318 [INFO] Encoding hidden states for batch 24
2025-01-14 11:28:05,649 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:28:05,650 [INFO] Encoding hidden states for batch 25
2025-01-14 11:28:05,930 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:28:05,931 [INFO] Encoding hidden states for batch 26
2025-01-14 11:28:06,209 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:28:06,210 [INFO] Encoding hidden states for batch 27
2025-01-14 11:28:06,487 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:28:06,489 [INFO] Encoding hidden states for batch 28
2025-01-14 11:28:06,750 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 11:28:06,751 [INFO] Encoding hidden states for batch 29
2025-01-14 11:28:06,983 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 11:28:06,985 [INFO] Encoding hidden states for batch 30
2025-01-14 11:28:07,292 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 11:28:07,293 [INFO] Encoding hidden states for batch 31
2025-01-14 11:28:07,473 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-14 11:28:07,474 [INFO] Encoding hidden states for batch 32
2025-01-14 11:28:07,483 [INFO] Total batches processed: 32
2025-01-14 11:28:07,485 [INFO] 最大长度:59
2025-01-14 11:28:07,949 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-14 11:28:07,949 [INFO] Computing non-zero element counts
2025-01-14 11:28:08,980 [INFO] Computing sum of non-zero elements
2025-01-14 11:28:09,531 [INFO] Computing mean of non-zero elements
2025-01-14 11:28:09,532 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:28:09,533 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:28:09,534 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:28:09,535 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:28:10,054 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:28:10,376 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-14 11:28:10,377 [INFO] Encoding hidden states for batch 1
2025-01-14 11:28:10,731 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:28:10,733 [INFO] Encoding hidden states for batch 2
2025-01-14 11:28:11,033 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:11,034 [INFO] Encoding hidden states for batch 3
2025-01-14 11:28:11,328 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:28:11,329 [INFO] Encoding hidden states for batch 4
2025-01-14 11:28:11,611 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:11,612 [INFO] Encoding hidden states for batch 5
2025-01-14 11:28:11,894 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:28:11,896 [INFO] Encoding hidden states for batch 6
2025-01-14 11:28:12,195 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:28:12,197 [INFO] Encoding hidden states for batch 7
2025-01-14 11:28:12,472 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:28:12,474 [INFO] Encoding hidden states for batch 8
2025-01-14 11:28:12,760 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:12,762 [INFO] Encoding hidden states for batch 9
2025-01-14 11:28:13,083 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:28:13,084 [INFO] Encoding hidden states for batch 10
2025-01-14 11:28:13,362 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-14 11:28:13,363 [INFO] Encoding hidden states for batch 11
2025-01-14 11:28:13,668 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:28:13,669 [INFO] Encoding hidden states for batch 12
2025-01-14 11:28:13,971 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:28:13,972 [INFO] Encoding hidden states for batch 13
2025-01-14 11:28:14,248 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:28:14,249 [INFO] Encoding hidden states for batch 14
2025-01-14 11:28:14,536 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:14,537 [INFO] Encoding hidden states for batch 15
2025-01-14 11:28:14,865 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:28:14,867 [INFO] Encoding hidden states for batch 16
2025-01-14 11:28:15,158 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:28:15,158 [INFO] Encoding hidden states for batch 17
2025-01-14 11:28:15,427 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:15,429 [INFO] Encoding hidden states for batch 18
2025-01-14 11:28:15,726 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:28:15,727 [INFO] Encoding hidden states for batch 19
2025-01-14 11:28:16,000 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:16,001 [INFO] Encoding hidden states for batch 20
2025-01-14 11:28:16,339 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:28:16,340 [INFO] Encoding hidden states for batch 21
2025-01-14 11:28:16,608 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:28:16,610 [INFO] Encoding hidden states for batch 22
2025-01-14 11:28:16,921 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 11:28:16,922 [INFO] Encoding hidden states for batch 23
2025-01-14 11:28:17,211 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:28:17,212 [INFO] Encoding hidden states for batch 24
2025-01-14 11:28:17,493 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:17,494 [INFO] Encoding hidden states for batch 25
2025-01-14 11:28:17,803 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:28:17,804 [INFO] Encoding hidden states for batch 26
2025-01-14 11:28:18,074 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:28:18,075 [INFO] Encoding hidden states for batch 27
2025-01-14 11:28:18,384 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:28:18,385 [INFO] Encoding hidden states for batch 28
2025-01-14 11:28:18,675 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:28:18,676 [INFO] Encoding hidden states for batch 29
2025-01-14 11:28:18,979 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:28:18,980 [INFO] Encoding hidden states for batch 30
2025-01-14 11:28:19,259 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:28:19,260 [INFO] Encoding hidden states for batch 31
2025-01-14 11:28:19,445 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-14 11:28:19,446 [INFO] Encoding hidden states for batch 32
2025-01-14 11:28:19,456 [INFO] Total batches processed: 32
2025-01-14 11:28:19,464 [INFO] 最大长度:76
2025-01-14 11:28:20,019 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-14 11:28:20,020 [INFO] Computing non-zero element counts
2025-01-14 11:28:21,354 [INFO] Computing sum of non-zero elements
2025-01-14 11:28:22,078 [INFO] Computing mean of non-zero elements
2025-01-14 11:28:22,079 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:28:22,081 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:28:22,081 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:28:22,082 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:30:12,057 [INFO] pos-neg
2025-01-14 11:30:12,064 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:30:12,419 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:30:12,420 [INFO] Encoding hidden states for batch 1
2025-01-14 11:30:12,928 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:12,930 [INFO] Encoding hidden states for batch 2
2025-01-14 11:30:13,239 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:30:13,241 [INFO] Encoding hidden states for batch 3
2025-01-14 11:30:13,563 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:30:13,564 [INFO] Encoding hidden states for batch 4
2025-01-14 11:30:13,862 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:30:13,863 [INFO] Encoding hidden states for batch 5
2025-01-14 11:30:14,141 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:14,142 [INFO] Encoding hidden states for batch 6
2025-01-14 11:30:14,430 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:30:14,431 [INFO] Encoding hidden states for batch 7
2025-01-14 11:30:14,680 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-14 11:30:14,682 [INFO] Encoding hidden states for batch 8
2025-01-14 11:30:14,931 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:14,933 [INFO] Encoding hidden states for batch 9
2025-01-14 11:30:15,214 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:30:15,215 [INFO] Encoding hidden states for batch 10
2025-01-14 11:30:15,509 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:30:15,511 [INFO] Encoding hidden states for batch 11
2025-01-14 11:30:15,850 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 11:30:15,852 [INFO] Encoding hidden states for batch 12
2025-01-14 11:30:16,167 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:16,168 [INFO] Encoding hidden states for batch 13
2025-01-14 11:30:16,461 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:30:16,463 [INFO] Encoding hidden states for batch 14
2025-01-14 11:30:16,736 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-14 11:30:16,737 [INFO] Encoding hidden states for batch 15
2025-01-14 11:30:16,963 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-14 11:30:16,965 [INFO] Encoding hidden states for batch 16
2025-01-14 11:30:17,200 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:17,202 [INFO] Encoding hidden states for batch 17
2025-01-14 11:30:17,483 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:17,484 [INFO] Encoding hidden states for batch 18
2025-01-14 11:30:17,754 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:17,755 [INFO] Encoding hidden states for batch 19
2025-01-14 11:30:18,093 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:30:18,094 [INFO] Encoding hidden states for batch 20
2025-01-14 11:30:18,404 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:18,406 [INFO] Encoding hidden states for batch 21
2025-01-14 11:30:18,740 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 11:30:18,741 [INFO] Encoding hidden states for batch 22
2025-01-14 11:30:19,019 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:30:19,021 [INFO] Encoding hidden states for batch 23
2025-01-14 11:30:19,267 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:19,268 [INFO] Encoding hidden states for batch 24
2025-01-14 11:30:19,573 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:19,574 [INFO] Encoding hidden states for batch 25
2025-01-14 11:30:19,880 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:19,882 [INFO] Encoding hidden states for batch 26
2025-01-14 11:30:20,156 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:20,157 [INFO] Encoding hidden states for batch 27
2025-01-14 11:30:20,464 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:30:20,466 [INFO] Encoding hidden states for batch 28
2025-01-14 11:30:20,747 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:20,748 [INFO] Encoding hidden states for batch 29
2025-01-14 11:30:21,050 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:30:21,051 [INFO] Encoding hidden states for batch 30
2025-01-14 11:30:21,347 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:21,348 [INFO] Encoding hidden states for batch 31
2025-01-14 11:30:21,518 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-14 11:30:21,520 [INFO] Encoding hidden states for batch 32
2025-01-14 11:30:21,528 [INFO] Total batches processed: 32
2025-01-14 11:30:21,530 [INFO] 最大长度:60
2025-01-14 11:30:21,982 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-14 11:30:21,982 [INFO] Computing non-zero element counts
2025-01-14 11:30:23,036 [INFO] Computing sum of non-zero elements
2025-01-14 11:30:23,606 [INFO] Computing mean of non-zero elements
2025-01-14 11:30:23,608 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:30:23,609 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:30:23,609 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:30:23,610 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:30:24,138 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:30:24,388 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-14 11:30:24,389 [INFO] Encoding hidden states for batch 1
2025-01-14 11:30:24,700 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:24,701 [INFO] Encoding hidden states for batch 2
2025-01-14 11:30:24,987 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:24,987 [INFO] Encoding hidden states for batch 3
2025-01-14 11:30:25,288 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:30:25,289 [INFO] Encoding hidden states for batch 4
2025-01-14 11:30:25,553 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-14 11:30:25,554 [INFO] Encoding hidden states for batch 5
2025-01-14 11:30:25,804 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:25,805 [INFO] Encoding hidden states for batch 6
2025-01-14 11:30:26,088 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:26,089 [INFO] Encoding hidden states for batch 7
2025-01-14 11:30:26,380 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:26,381 [INFO] Encoding hidden states for batch 8
2025-01-14 11:30:26,708 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:26,710 [INFO] Encoding hidden states for batch 9
2025-01-14 11:30:27,025 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 11:30:27,027 [INFO] Encoding hidden states for batch 10
2025-01-14 11:30:27,318 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:30:27,320 [INFO] Encoding hidden states for batch 11
2025-01-14 11:30:27,617 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:27,618 [INFO] Encoding hidden states for batch 12
2025-01-14 11:30:27,902 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:27,903 [INFO] Encoding hidden states for batch 13
2025-01-14 11:30:28,169 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:28,170 [INFO] Encoding hidden states for batch 14
2025-01-14 11:30:28,444 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:28,446 [INFO] Encoding hidden states for batch 15
2025-01-14 11:30:28,719 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:28,721 [INFO] Encoding hidden states for batch 16
2025-01-14 11:30:28,977 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:30:28,979 [INFO] Encoding hidden states for batch 17
2025-01-14 11:30:29,253 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:29,254 [INFO] Encoding hidden states for batch 18
2025-01-14 11:30:29,590 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:29,591 [INFO] Encoding hidden states for batch 19
2025-01-14 11:30:29,955 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:30:29,957 [INFO] Encoding hidden states for batch 20
2025-01-14 11:30:30,236 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:30,237 [INFO] Encoding hidden states for batch 21
2025-01-14 11:30:30,519 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:30,521 [INFO] Encoding hidden states for batch 22
2025-01-14 11:30:30,856 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 11:30:30,858 [INFO] Encoding hidden states for batch 23
2025-01-14 11:30:31,165 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:30:31,167 [INFO] Encoding hidden states for batch 24
2025-01-14 11:30:31,481 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:31,483 [INFO] Encoding hidden states for batch 25
2025-01-14 11:30:31,767 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 11:30:31,769 [INFO] Encoding hidden states for batch 26
2025-01-14 11:30:32,055 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:32,057 [INFO] Encoding hidden states for batch 27
2025-01-14 11:30:32,332 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:30:32,334 [INFO] Encoding hidden states for batch 28
2025-01-14 11:30:32,596 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 11:30:32,598 [INFO] Encoding hidden states for batch 29
2025-01-14 11:30:32,831 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 11:30:32,833 [INFO] Encoding hidden states for batch 30
2025-01-14 11:30:33,124 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 11:30:33,125 [INFO] Encoding hidden states for batch 31
2025-01-14 11:30:33,311 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-14 11:30:33,313 [INFO] Encoding hidden states for batch 32
2025-01-14 11:30:33,339 [INFO] Total batches processed: 32
2025-01-14 11:30:33,341 [INFO] 最大长度:59
2025-01-14 11:30:33,776 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-14 11:30:33,777 [INFO] Computing non-zero element counts
2025-01-14 11:30:34,801 [INFO] Computing sum of non-zero elements
2025-01-14 11:30:35,338 [INFO] Computing mean of non-zero elements
2025-01-14 11:30:35,340 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:30:35,341 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:30:35,341 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:30:35,342 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:30:35,829 [INFO] Running model with cache to obtain hidden states
2025-01-14 11:30:36,198 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-14 11:30:36,199 [INFO] Encoding hidden states for batch 1
2025-01-14 11:30:37,329 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:30:37,331 [INFO] Encoding hidden states for batch 2
2025-01-14 11:30:37,653 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:37,655 [INFO] Encoding hidden states for batch 3
2025-01-14 11:30:37,950 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:37,951 [INFO] Encoding hidden states for batch 4
2025-01-14 11:30:38,241 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:38,242 [INFO] Encoding hidden states for batch 5
2025-01-14 11:30:38,539 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 11:30:38,540 [INFO] Encoding hidden states for batch 6
2025-01-14 11:30:38,840 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 11:30:38,841 [INFO] Encoding hidden states for batch 7
2025-01-14 11:30:39,104 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:30:39,105 [INFO] Encoding hidden states for batch 8
2025-01-14 11:30:39,392 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:39,393 [INFO] Encoding hidden states for batch 9
2025-01-14 11:30:39,710 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:30:39,711 [INFO] Encoding hidden states for batch 10
2025-01-14 11:30:39,975 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-14 11:30:39,976 [INFO] Encoding hidden states for batch 11
2025-01-14 11:30:40,310 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:30:40,312 [INFO] Encoding hidden states for batch 12
2025-01-14 11:30:40,642 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 11:30:40,643 [INFO] Encoding hidden states for batch 13
2025-01-14 11:30:40,936 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:30:40,938 [INFO] Encoding hidden states for batch 14
2025-01-14 11:30:41,216 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:41,218 [INFO] Encoding hidden states for batch 15
2025-01-14 11:30:41,565 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 11:30:41,566 [INFO] Encoding hidden states for batch 16
2025-01-14 11:30:41,877 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 11:30:41,878 [INFO] Encoding hidden states for batch 17
2025-01-14 11:30:42,154 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:42,155 [INFO] Encoding hidden states for batch 18
2025-01-14 11:30:42,464 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:42,465 [INFO] Encoding hidden states for batch 19
2025-01-14 11:30:42,737 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:42,738 [INFO] Encoding hidden states for batch 20
2025-01-14 11:30:43,073 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 11:30:43,075 [INFO] Encoding hidden states for batch 21
2025-01-14 11:30:43,348 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:30:43,349 [INFO] Encoding hidden states for batch 22
2025-01-14 11:30:43,658 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 11:30:43,659 [INFO] Encoding hidden states for batch 23
2025-01-14 11:30:44,127 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 11:30:44,128 [INFO] Encoding hidden states for batch 24
2025-01-14 11:30:44,419 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:44,420 [INFO] Encoding hidden states for batch 25
2025-01-14 11:30:44,710 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 11:30:44,711 [INFO] Encoding hidden states for batch 26
2025-01-14 11:30:44,994 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 11:30:44,995 [INFO] Encoding hidden states for batch 27
2025-01-14 11:30:45,288 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 11:30:45,290 [INFO] Encoding hidden states for batch 28
2025-01-14 11:30:45,581 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 11:30:45,582 [INFO] Encoding hidden states for batch 29
2025-01-14 11:30:45,891 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 11:30:45,892 [INFO] Encoding hidden states for batch 30
2025-01-14 11:30:46,180 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 11:30:46,182 [INFO] Encoding hidden states for batch 31
2025-01-14 11:30:46,392 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-14 11:30:46,394 [INFO] Encoding hidden states for batch 32
2025-01-14 11:30:46,410 [INFO] Total batches processed: 32
2025-01-14 11:30:46,412 [INFO] 最大长度:76
2025-01-14 11:30:46,959 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-14 11:30:46,960 [INFO] Computing non-zero element counts
2025-01-14 11:30:48,235 [INFO] Computing sum of non-zero elements
2025-01-14 11:30:48,900 [INFO] Computing mean of non-zero elements
2025-01-14 11:30:48,902 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 11:30:48,903 [INFO] Top 100 nz_mean values selected.
2025-01-14 11:30:48,904 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 11:30:48,905 [INFO] Top 100 act_cnt values selected.
2025-01-14 11:33:12,097 [INFO] Computing steering vectors using method: val_mul
2025-01-14 11:33:12,110 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 11:33:41,188 [INFO] Example prompt:  Hei, we have good result, 
2025-01-14 11:33:41,190 [INFO] Generating texts **without** steering... 
2025-01-14 11:33:43,204 [INFO] Generated Text: 1:
 Hei, we have good result,  but it is not enough to win the game.
The first thing that I want to say is that I am not going to give up on this team. We are in a very good position and we will be able to play well against any
2025-01-14 11:33:43,204 [INFO] Generated Text: 2:
 Hei, we have good result,  but it is not the same as a good result.
I think that this is a very important point. I think that if you look at the results of our study, there are some things that are really important to consider when looking at what
2025-01-14 11:33:43,205 [INFO] Generated Text: 3:
 Hei, we have good result,  but we are not able to do anything about it.
We can't even say that the current government is doing anything about it. We can only say that the current government is doing nothing about it.
The problem with this argument is that
2025-01-14 11:33:43,205 [INFO] 干预之后的结果
2025-01-14 11:33:43,206 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 11:33:43,207 [INFO] ** Generating texts with steering... Target **
2025-01-14 11:33:45,061 [INFO] Generated Text: 1:
 Hei, we have good result,  I'm not sure if I can do it.
But then again, I don't know what to do with this.
I've been trying to figure out how to get rid of the story and make it more interesting for people who are
2025-01-14 11:33:45,062 [INFO] Generated Text: 2:
 Hei, we have good result,  and I'm glad that the game is still alive.
I hope you enjoyed this post and if you want to see more of my work on other sites, check out my blog here .<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
2025-01-14 11:33:45,062 [INFO] Generated Text: 3:
 Hei, we have good result,  and I'm glad that the story is not so bad.
I don't know if it's because of the fact that this is a novel or because I'm too lazy to read it. But if you're reading this and you're looking
2025-01-14 11:39:06,386 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 11:39:06,387 [INFO] Hyperparameters:
2025-01-14 11:39:06,389 [INFO]   layer: 6
2025-01-14 11:39:06,389 [INFO]   LLM: gpt2-small
2025-01-14 11:39:06,390 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 11:39:06,391 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 11:39:06,392 [INFO]   output_dir: ./results
2025-01-14 11:39:06,393 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 11:39:06,394 [INFO]   task: sentiment
2025-01-14 11:39:06,394 [INFO]   seed: 42
2025-01-14 11:39:06,395 [INFO]   data_size: 1000
2025-01-14 11:39:06,398 [INFO]   device: cpu
2025-01-14 11:39:06,399 [INFO]   alpha: 100
2025-01-14 11:39:06,400 [INFO]   steer: pos-neg
2025-01-14 11:39:06,401 [INFO]   method: val_mul
2025-01-14 11:39:06,402 [INFO]   topk_mean: 100
2025-01-14 11:39:06,403 [INFO]   topk_cnt: 100
2025-01-14 11:39:06,404 [INFO]   batch_size: 32
2025-01-14 18:09:07,469 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 18:09:07,470 [INFO] Hyperparameters:
2025-01-14 18:09:07,471 [INFO]   layer: 6
2025-01-14 18:09:07,471 [INFO]   LLM: gpt2-small
2025-01-14 18:09:07,472 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 18:09:07,472 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 18:09:07,473 [INFO]   output_dir: ./results
2025-01-14 18:09:07,473 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 18:09:07,473 [INFO]   task: sentiment
2025-01-14 18:09:07,474 [INFO]   seed: 42
2025-01-14 18:09:07,474 [INFO]   data_size: 1000
2025-01-14 18:09:07,475 [INFO]   device: cpu
2025-01-14 18:09:07,476 [INFO]   alpha: 100
2025-01-14 18:09:07,476 [INFO]   steer: pos-neg
2025-01-14 18:09:07,477 [INFO]   method: val_mul
2025-01-14 18:09:07,477 [INFO]   topk_mean: 100
2025-01-14 18:09:07,478 [INFO]   topk_cnt: 100
2025-01-14 18:09:07,478 [INFO]   batch_size: 32
2025-01-14 18:09:12,451 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 18:09:25,219 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 18:09:25,220 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-14 18:09:25,249 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-14 18:09:25,579 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-14 18:09:25,607 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-14 18:11:30,508 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-14 18:11:35,211 [INFO] Hyperparameters:
2025-01-14 18:11:35,212 [INFO]   layer: 6
2025-01-14 18:11:35,213 [INFO]   LLM: gpt2-small
2025-01-14 18:11:35,213 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 18:11:35,214 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 18:11:35,214 [INFO]   output_dir: ./results
2025-01-14 18:11:35,215 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 18:11:35,216 [INFO]   task: sentiment
2025-01-14 18:11:35,216 [INFO]   seed: 42
2025-01-14 18:11:35,217 [INFO]   data_size: 1000
2025-01-14 18:11:35,217 [INFO]   device: cpu
2025-01-14 18:11:35,217 [INFO]   alpha: 100
2025-01-14 18:11:35,218 [INFO]   steer: pos-neg
2025-01-14 18:11:35,218 [INFO]   method: val_mul
2025-01-14 18:11:35,219 [INFO]   topk_mean: 100
2025-01-14 18:11:35,219 [INFO]   topk_cnt: 100
2025-01-14 18:11:35,220 [INFO]   batch_size: 32
2025-01-14 18:11:35,221 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 18:11:35,221 [INFO] Loading model: gpt2-small
2025-01-14 18:12:21,870 [INFO] Loading SAE for layer 6
2025-01-14 18:21:20,797 [INFO] pos-neg
2025-01-14 18:21:20,809 [INFO] Running model with cache to obtain hidden states
2025-01-14 18:21:21,450 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 18:21:21,452 [INFO] Encoding hidden states for batch 1
2025-01-14 18:21:23,253 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:23,254 [INFO] Encoding hidden states for batch 2
2025-01-14 18:21:23,665 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 18:21:23,665 [INFO] Encoding hidden states for batch 3
2025-01-14 18:21:24,044 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 18:21:24,045 [INFO] Encoding hidden states for batch 4
2025-01-14 18:21:24,703 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 18:21:24,704 [INFO] Encoding hidden states for batch 5
2025-01-14 18:21:25,351 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:21:25,352 [INFO] Encoding hidden states for batch 6
2025-01-14 18:21:25,899 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 18:21:25,899 [INFO] Encoding hidden states for batch 7
2025-01-14 18:21:26,327 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-14 18:21:26,328 [INFO] Encoding hidden states for batch 8
2025-01-14 18:21:26,710 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:21:26,711 [INFO] Encoding hidden states for batch 9
2025-01-14 18:21:27,084 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 18:21:27,085 [INFO] Encoding hidden states for batch 10
2025-01-14 18:21:27,552 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 18:21:27,571 [INFO] Encoding hidden states for batch 11
2025-01-14 18:21:28,080 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 18:21:28,081 [INFO] Encoding hidden states for batch 12
2025-01-14 18:21:28,518 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:28,519 [INFO] Encoding hidden states for batch 13
2025-01-14 18:21:28,907 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 18:21:28,908 [INFO] Encoding hidden states for batch 14
2025-01-14 18:21:29,422 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-14 18:21:29,423 [INFO] Encoding hidden states for batch 15
2025-01-14 18:21:29,771 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-14 18:21:29,773 [INFO] Encoding hidden states for batch 16
2025-01-14 18:21:30,132 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:30,133 [INFO] Encoding hidden states for batch 17
2025-01-14 18:21:30,648 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:21:30,649 [INFO] Encoding hidden states for batch 18
2025-01-14 18:21:32,383 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:21:32,384 [INFO] Encoding hidden states for batch 19
2025-01-14 18:21:33,073 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 18:21:33,075 [INFO] Encoding hidden states for batch 20
2025-01-14 18:21:33,634 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:33,635 [INFO] Encoding hidden states for batch 21
2025-01-14 18:21:34,168 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 18:21:34,169 [INFO] Encoding hidden states for batch 22
2025-01-14 18:21:34,876 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 18:21:34,877 [INFO] Encoding hidden states for batch 23
2025-01-14 18:21:35,272 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:35,273 [INFO] Encoding hidden states for batch 24
2025-01-14 18:21:35,753 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:35,754 [INFO] Encoding hidden states for batch 25
2025-01-14 18:21:36,236 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:36,238 [INFO] Encoding hidden states for batch 26
2025-01-14 18:21:36,650 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:36,651 [INFO] Encoding hidden states for batch 27
2025-01-14 18:21:36,997 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 18:21:36,998 [INFO] Encoding hidden states for batch 28
2025-01-14 18:21:37,338 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:37,339 [INFO] Encoding hidden states for batch 29
2025-01-14 18:21:37,731 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 18:21:37,732 [INFO] Encoding hidden states for batch 30
2025-01-14 18:21:38,132 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:21:38,134 [INFO] Encoding hidden states for batch 31
2025-01-14 18:21:38,380 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-14 18:21:38,381 [INFO] Encoding hidden states for batch 32
2025-01-14 18:21:38,393 [INFO] Total batches processed: 32
2025-01-14 18:21:38,396 [INFO] 最大长度:60
2025-01-14 18:21:38,945 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-14 18:21:38,947 [INFO] Computing non-zero element counts
2025-01-14 18:21:40,063 [INFO] Computing sum of non-zero elements
2025-01-14 18:21:40,659 [INFO] Computing mean of non-zero elements
2025-01-14 18:21:40,661 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 18:21:40,663 [INFO] Top 100 nz_mean values selected.
2025-01-14 18:21:40,664 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 18:21:40,665 [INFO] Top 100 act_cnt values selected.
2025-01-14 18:21:41,222 [INFO] Running model with cache to obtain hidden states
2025-01-14 18:21:43,214 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-14 18:21:43,216 [INFO] Encoding hidden states for batch 1
2025-01-14 18:21:44,199 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:44,201 [INFO] Encoding hidden states for batch 2
2025-01-14 18:21:44,702 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:21:44,703 [INFO] Encoding hidden states for batch 3
2025-01-14 18:21:45,221 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 18:21:45,222 [INFO] Encoding hidden states for batch 4
2025-01-14 18:21:45,685 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-14 18:21:45,686 [INFO] Encoding hidden states for batch 5
2025-01-14 18:21:46,086 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:21:46,087 [INFO] Encoding hidden states for batch 6
2025-01-14 18:21:46,475 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:21:46,477 [INFO] Encoding hidden states for batch 7
2025-01-14 18:21:46,885 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:46,886 [INFO] Encoding hidden states for batch 8
2025-01-14 18:21:47,312 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:47,313 [INFO] Encoding hidden states for batch 9
2025-01-14 18:21:47,891 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 18:21:47,892 [INFO] Encoding hidden states for batch 10
2025-01-14 18:21:48,373 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 18:21:48,374 [INFO] Encoding hidden states for batch 11
2025-01-14 18:21:48,765 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:48,767 [INFO] Encoding hidden states for batch 12
2025-01-14 18:21:49,288 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:21:49,289 [INFO] Encoding hidden states for batch 13
2025-01-14 18:21:49,696 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:49,697 [INFO] Encoding hidden states for batch 14
2025-01-14 18:21:50,187 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:50,188 [INFO] Encoding hidden states for batch 15
2025-01-14 18:21:50,602 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:21:50,603 [INFO] Encoding hidden states for batch 16
2025-01-14 18:21:51,047 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 18:21:51,049 [INFO] Encoding hidden states for batch 17
2025-01-14 18:21:52,551 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:21:52,553 [INFO] Encoding hidden states for batch 18
2025-01-14 18:21:53,054 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:53,055 [INFO] Encoding hidden states for batch 19
2025-01-14 18:21:53,594 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 18:21:53,595 [INFO] Encoding hidden states for batch 20
2025-01-14 18:21:53,967 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:53,968 [INFO] Encoding hidden states for batch 21
2025-01-14 18:21:54,377 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:21:54,378 [INFO] Encoding hidden states for batch 22
2025-01-14 18:21:54,795 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 18:21:54,796 [INFO] Encoding hidden states for batch 23
2025-01-14 18:21:55,222 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 18:21:55,223 [INFO] Encoding hidden states for batch 24
2025-01-14 18:21:55,655 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:21:55,656 [INFO] Encoding hidden states for batch 25
2025-01-14 18:21:55,998 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 18:21:55,999 [INFO] Encoding hidden states for batch 26
2025-01-14 18:21:56,399 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:21:56,400 [INFO] Encoding hidden states for batch 27
2025-01-14 18:21:56,788 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 18:21:56,790 [INFO] Encoding hidden states for batch 28
2025-01-14 18:21:57,109 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 18:21:57,110 [INFO] Encoding hidden states for batch 29
2025-01-14 18:21:57,488 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 18:21:57,489 [INFO] Encoding hidden states for batch 30
2025-01-14 18:21:57,895 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 18:21:57,896 [INFO] Encoding hidden states for batch 31
2025-01-14 18:21:58,246 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-14 18:21:58,247 [INFO] Encoding hidden states for batch 32
2025-01-14 18:21:58,261 [INFO] Total batches processed: 32
2025-01-14 18:21:58,264 [INFO] 最大长度:59
2025-01-14 18:21:58,757 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-14 18:21:58,758 [INFO] Computing non-zero element counts
2025-01-14 18:21:59,811 [INFO] Computing sum of non-zero elements
2025-01-14 18:22:00,372 [INFO] Computing mean of non-zero elements
2025-01-14 18:22:00,374 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 18:22:00,375 [INFO] Top 100 nz_mean values selected.
2025-01-14 18:22:00,376 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 18:22:00,377 [INFO] Top 100 act_cnt values selected.
2025-01-14 18:22:00,892 [INFO] Running model with cache to obtain hidden states
2025-01-14 18:22:01,310 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-14 18:22:01,311 [INFO] Encoding hidden states for batch 1
2025-01-14 18:22:01,832 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 18:22:01,833 [INFO] Encoding hidden states for batch 2
2025-01-14 18:22:02,301 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:22:02,303 [INFO] Encoding hidden states for batch 3
2025-01-14 18:22:02,658 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:22:02,659 [INFO] Encoding hidden states for batch 4
2025-01-14 18:22:03,043 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:22:03,045 [INFO] Encoding hidden states for batch 5
2025-01-14 18:22:03,451 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 18:22:03,452 [INFO] Encoding hidden states for batch 6
2025-01-14 18:22:03,832 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 18:22:03,833 [INFO] Encoding hidden states for batch 7
2025-01-14 18:22:04,200 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 18:22:04,201 [INFO] Encoding hidden states for batch 8
2025-01-14 18:22:04,596 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:22:04,597 [INFO] Encoding hidden states for batch 9
2025-01-14 18:22:05,012 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 18:22:05,014 [INFO] Encoding hidden states for batch 10
2025-01-14 18:22:05,388 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-14 18:22:05,389 [INFO] Encoding hidden states for batch 11
2025-01-14 18:22:05,774 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 18:22:05,775 [INFO] Encoding hidden states for batch 12
2025-01-14 18:22:06,162 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 18:22:06,163 [INFO] Encoding hidden states for batch 13
2025-01-14 18:22:06,525 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 18:22:06,527 [INFO] Encoding hidden states for batch 14
2025-01-14 18:22:06,969 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:22:06,970 [INFO] Encoding hidden states for batch 15
2025-01-14 18:22:07,454 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 18:22:07,456 [INFO] Encoding hidden states for batch 16
2025-01-14 18:22:07,953 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 18:22:07,954 [INFO] Encoding hidden states for batch 17
2025-01-14 18:22:08,450 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:22:08,452 [INFO] Encoding hidden states for batch 18
2025-01-14 18:22:08,947 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:22:08,948 [INFO] Encoding hidden states for batch 19
2025-01-14 18:22:09,320 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:22:09,322 [INFO] Encoding hidden states for batch 20
2025-01-14 18:22:09,906 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 18:22:09,907 [INFO] Encoding hidden states for batch 21
2025-01-14 18:22:10,327 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 18:22:10,328 [INFO] Encoding hidden states for batch 22
2025-01-14 18:22:10,777 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 18:22:10,778 [INFO] Encoding hidden states for batch 23
2025-01-14 18:22:11,266 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 18:22:11,268 [INFO] Encoding hidden states for batch 24
2025-01-14 18:22:11,647 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:22:11,650 [INFO] Encoding hidden states for batch 25
2025-01-14 18:22:12,111 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 18:22:12,113 [INFO] Encoding hidden states for batch 26
2025-01-14 18:22:12,484 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 18:22:12,486 [INFO] Encoding hidden states for batch 27
2025-01-14 18:22:12,881 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 18:22:12,883 [INFO] Encoding hidden states for batch 28
2025-01-14 18:22:13,315 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 18:22:13,317 [INFO] Encoding hidden states for batch 29
2025-01-14 18:22:13,745 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 18:22:13,747 [INFO] Encoding hidden states for batch 30
2025-01-14 18:22:14,113 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 18:22:14,114 [INFO] Encoding hidden states for batch 31
2025-01-14 18:22:14,387 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-14 18:22:14,389 [INFO] Encoding hidden states for batch 32
2025-01-14 18:22:14,406 [INFO] Total batches processed: 32
2025-01-14 18:22:14,409 [INFO] 最大长度:76
2025-01-14 18:22:14,992 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-14 18:22:14,996 [INFO] Computing non-zero element counts
2025-01-14 18:22:16,432 [INFO] Computing sum of non-zero elements
2025-01-14 18:22:17,157 [INFO] Computing mean of non-zero elements
2025-01-14 18:22:17,159 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 18:22:17,159 [INFO] Top 100 nz_mean values selected.
2025-01-14 18:22:17,160 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 18:22:17,161 [INFO] Top 100 act_cnt values selected.
2025-01-14 19:47:59,436 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-14 19:47:59,438 [INFO] Hyperparameters:
2025-01-14 19:47:59,440 [INFO]   layer: 6
2025-01-14 19:47:59,441 [INFO]   LLM: gpt2-small
2025-01-14 19:47:59,442 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 19:47:59,444 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 19:47:59,445 [INFO]   output_dir: ./results
2025-01-14 19:47:59,446 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 19:47:59,447 [INFO]   task: sentiment
2025-01-14 19:47:59,448 [INFO]   seed: 42
2025-01-14 19:47:59,449 [INFO]   data_size: 1000
2025-01-14 19:47:59,450 [INFO]   device: cpu
2025-01-14 19:47:59,452 [INFO]   alpha: 100
2025-01-14 19:47:59,452 [INFO]   steer: pos-neg
2025-01-14 19:47:59,453 [INFO]   method: val_mul
2025-01-14 19:47:59,454 [INFO]   topk_mean: 100
2025-01-14 19:47:59,455 [INFO]   topk_cnt: 100
2025-01-14 19:47:59,456 [INFO]   batch_size: 32
2025-01-14 19:48:02,353 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 19:48:09,924 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 19:48:09,926 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-14 19:48:09,929 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-14 19:48:10,114 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-14 19:48:10,123 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-14 19:48:45,207 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-14 19:48:47,921 [INFO] Hyperparameters:
2025-01-14 19:48:47,924 [INFO]   layer: 6
2025-01-14 19:48:47,945 [INFO]   LLM: gpt2-small
2025-01-14 19:48:47,947 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-14 19:48:47,948 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-14 19:48:47,949 [INFO]   output_dir: ./results
2025-01-14 19:48:47,950 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-14 19:48:47,951 [INFO]   task: sentiment
2025-01-14 19:48:47,952 [INFO]   seed: 42
2025-01-14 19:48:47,953 [INFO]   data_size: 1000
2025-01-14 19:48:47,954 [INFO]   device: cpu
2025-01-14 19:48:47,955 [INFO]   alpha: 100
2025-01-14 19:48:47,956 [INFO]   steer: pos-neg
2025-01-14 19:48:47,956 [INFO]   method: val_mul
2025-01-14 19:48:47,957 [INFO]   topk_mean: 100
2025-01-14 19:48:47,958 [INFO]   topk_cnt: 100
2025-01-14 19:48:47,959 [INFO]   batch_size: 32
2025-01-14 19:48:47,962 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-14 19:48:47,963 [INFO] Loading model: gpt2-small
2025-01-14 19:49:53,856 [INFO] Loading SAE for layer 6
2025-01-14 19:51:44,513 [INFO] pos-neg
2025-01-14 19:51:44,541 [INFO] Running model with cache to obtain hidden states
2025-01-14 19:51:44,938 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 19:51:44,939 [INFO] Encoding hidden states for batch 1
2025-01-14 19:51:45,389 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:51:45,391 [INFO] Encoding hidden states for batch 2
2025-01-14 19:51:45,700 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 19:51:45,701 [INFO] Encoding hidden states for batch 3
2025-01-14 19:51:46,038 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 19:51:46,039 [INFO] Encoding hidden states for batch 4
2025-01-14 19:51:46,349 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 19:51:46,350 [INFO] Encoding hidden states for batch 5
2025-01-14 19:51:46,662 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:51:46,663 [INFO] Encoding hidden states for batch 6
2025-01-14 19:51:46,979 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 19:51:46,980 [INFO] Encoding hidden states for batch 7
2025-01-14 19:51:47,253 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-14 19:51:47,255 [INFO] Encoding hidden states for batch 8
2025-01-14 19:51:47,526 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:51:47,527 [INFO] Encoding hidden states for batch 9
2025-01-14 19:51:47,873 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 19:51:47,875 [INFO] Encoding hidden states for batch 10
2025-01-14 19:51:48,188 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 19:51:48,189 [INFO] Encoding hidden states for batch 11
2025-01-14 19:51:48,542 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 19:51:48,544 [INFO] Encoding hidden states for batch 12
2025-01-14 19:51:48,878 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:51:48,880 [INFO] Encoding hidden states for batch 13
2025-01-14 19:51:49,190 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 19:51:49,192 [INFO] Encoding hidden states for batch 14
2025-01-14 19:51:49,450 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-14 19:51:49,451 [INFO] Encoding hidden states for batch 15
2025-01-14 19:51:49,682 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-14 19:51:49,684 [INFO] Encoding hidden states for batch 16
2025-01-14 19:51:49,941 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:51:49,942 [INFO] Encoding hidden states for batch 17
2025-01-14 19:51:50,216 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:51:50,217 [INFO] Encoding hidden states for batch 18
2025-01-14 19:51:50,506 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:51:50,507 [INFO] Encoding hidden states for batch 19
2025-01-14 19:51:50,864 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 19:51:50,865 [INFO] Encoding hidden states for batch 20
2025-01-14 19:51:51,209 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:51:51,211 [INFO] Encoding hidden states for batch 21
2025-01-14 19:51:51,548 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-14 19:51:51,550 [INFO] Encoding hidden states for batch 22
2025-01-14 19:51:52,043 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 19:51:52,045 [INFO] Encoding hidden states for batch 23
2025-01-14 19:51:52,295 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:51:52,297 [INFO] Encoding hidden states for batch 24
2025-01-14 19:51:52,596 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:51:52,597 [INFO] Encoding hidden states for batch 25
2025-01-14 19:51:52,943 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:51:52,944 [INFO] Encoding hidden states for batch 26
2025-01-14 19:51:53,240 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:51:53,242 [INFO] Encoding hidden states for batch 27
2025-01-14 19:51:53,549 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 19:51:53,551 [INFO] Encoding hidden states for batch 28
2025-01-14 19:51:53,843 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:51:53,845 [INFO] Encoding hidden states for batch 29
2025-01-14 19:51:54,131 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 19:51:54,133 [INFO] Encoding hidden states for batch 30
2025-01-14 19:51:54,436 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:51:54,438 [INFO] Encoding hidden states for batch 31
2025-01-14 19:51:54,625 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-14 19:51:54,626 [INFO] Encoding hidden states for batch 32
2025-01-14 19:51:54,636 [INFO] Total batches processed: 32
2025-01-14 19:51:54,639 [INFO] 最大长度:60
2025-01-14 19:51:55,077 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-14 19:51:55,078 [INFO] Computing non-zero element counts
2025-01-14 19:51:56,179 [INFO] Computing sum of non-zero elements
2025-01-14 19:51:56,758 [INFO] Computing mean of non-zero elements
2025-01-14 19:51:56,759 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 19:51:56,760 [INFO] Top 100 nz_mean values selected.
2025-01-14 19:51:56,761 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 19:51:56,762 [INFO] Top 100 act_cnt values selected.
2025-01-14 19:51:57,304 [INFO] Running model with cache to obtain hidden states
2025-01-14 19:51:57,566 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-14 19:51:57,566 [INFO] Encoding hidden states for batch 1
2025-01-14 19:51:57,860 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:51:57,861 [INFO] Encoding hidden states for batch 2
2025-01-14 19:51:58,130 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:51:58,132 [INFO] Encoding hidden states for batch 3
2025-01-14 19:51:58,428 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 19:51:58,430 [INFO] Encoding hidden states for batch 4
2025-01-14 19:51:58,691 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-14 19:51:58,692 [INFO] Encoding hidden states for batch 5
2025-01-14 19:51:58,945 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:51:58,946 [INFO] Encoding hidden states for batch 6
2025-01-14 19:51:59,207 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:51:59,209 [INFO] Encoding hidden states for batch 7
2025-01-14 19:51:59,495 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:51:59,496 [INFO] Encoding hidden states for batch 8
2025-01-14 19:51:59,833 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:51:59,835 [INFO] Encoding hidden states for batch 9
2025-01-14 19:52:00,177 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 19:52:00,178 [INFO] Encoding hidden states for batch 10
2025-01-14 19:52:00,475 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 19:52:00,477 [INFO] Encoding hidden states for batch 11
2025-01-14 19:52:00,789 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:52:00,791 [INFO] Encoding hidden states for batch 12
2025-01-14 19:52:01,093 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:01,094 [INFO] Encoding hidden states for batch 13
2025-01-14 19:52:01,358 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:52:01,359 [INFO] Encoding hidden states for batch 14
2025-01-14 19:52:01,632 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:52:01,633 [INFO] Encoding hidden states for batch 15
2025-01-14 19:52:01,926 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:52:01,927 [INFO] Encoding hidden states for batch 16
2025-01-14 19:52:02,205 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 19:52:02,207 [INFO] Encoding hidden states for batch 17
2025-01-14 19:52:02,514 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:52:02,515 [INFO] Encoding hidden states for batch 18
2025-01-14 19:52:02,843 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:52:02,844 [INFO] Encoding hidden states for batch 19
2025-01-14 19:52:03,211 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 19:52:03,213 [INFO] Encoding hidden states for batch 20
2025-01-14 19:52:03,509 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:52:03,510 [INFO] Encoding hidden states for batch 21
2025-01-14 19:52:03,789 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:52:03,790 [INFO] Encoding hidden states for batch 22
2025-01-14 19:52:04,135 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 19:52:04,136 [INFO] Encoding hidden states for batch 23
2025-01-14 19:52:04,455 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 19:52:04,456 [INFO] Encoding hidden states for batch 24
2025-01-14 19:52:04,773 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:52:04,774 [INFO] Encoding hidden states for batch 25
2025-01-14 19:52:05,062 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-14 19:52:05,063 [INFO] Encoding hidden states for batch 26
2025-01-14 19:52:05,346 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:52:05,347 [INFO] Encoding hidden states for batch 27
2025-01-14 19:52:05,631 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 19:52:05,632 [INFO] Encoding hidden states for batch 28
2025-01-14 19:52:05,890 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 19:52:05,891 [INFO] Encoding hidden states for batch 29
2025-01-14 19:52:06,134 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-14 19:52:06,136 [INFO] Encoding hidden states for batch 30
2025-01-14 19:52:06,448 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-14 19:52:06,449 [INFO] Encoding hidden states for batch 31
2025-01-14 19:52:06,644 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-14 19:52:06,645 [INFO] Encoding hidden states for batch 32
2025-01-14 19:52:06,654 [INFO] Total batches processed: 32
2025-01-14 19:52:06,658 [INFO] 最大长度:59
2025-01-14 19:52:07,081 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-14 19:52:07,082 [INFO] Computing non-zero element counts
2025-01-14 19:52:08,215 [INFO] Computing sum of non-zero elements
2025-01-14 19:52:08,770 [INFO] Computing mean of non-zero elements
2025-01-14 19:52:08,772 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 19:52:08,773 [INFO] Top 100 nz_mean values selected.
2025-01-14 19:52:08,773 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 19:52:08,775 [INFO] Top 100 act_cnt values selected.
2025-01-14 19:52:09,325 [INFO] Running model with cache to obtain hidden states
2025-01-14 19:52:09,655 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-14 19:52:09,655 [INFO] Encoding hidden states for batch 1
2025-01-14 19:52:10,040 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 19:52:10,041 [INFO] Encoding hidden states for batch 2
2025-01-14 19:52:10,353 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:10,354 [INFO] Encoding hidden states for batch 3
2025-01-14 19:52:10,655 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:52:10,656 [INFO] Encoding hidden states for batch 4
2025-01-14 19:52:10,953 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:10,954 [INFO] Encoding hidden states for batch 5
2025-01-14 19:52:11,241 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-14 19:52:11,242 [INFO] Encoding hidden states for batch 6
2025-01-14 19:52:11,541 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-14 19:52:11,542 [INFO] Encoding hidden states for batch 7
2025-01-14 19:52:11,817 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 19:52:11,818 [INFO] Encoding hidden states for batch 8
2025-01-14 19:52:12,101 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:12,103 [INFO] Encoding hidden states for batch 9
2025-01-14 19:52:12,411 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 19:52:12,412 [INFO] Encoding hidden states for batch 10
2025-01-14 19:52:12,676 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-14 19:52:12,677 [INFO] Encoding hidden states for batch 11
2025-01-14 19:52:12,998 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 19:52:13,000 [INFO] Encoding hidden states for batch 12
2025-01-14 19:52:13,296 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-14 19:52:13,297 [INFO] Encoding hidden states for batch 13
2025-01-14 19:52:13,587 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 19:52:13,589 [INFO] Encoding hidden states for batch 14
2025-01-14 19:52:13,881 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:52:13,882 [INFO] Encoding hidden states for batch 15
2025-01-14 19:52:14,214 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-14 19:52:14,216 [INFO] Encoding hidden states for batch 16
2025-01-14 19:52:14,521 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-14 19:52:14,523 [INFO] Encoding hidden states for batch 17
2025-01-14 19:52:14,811 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:14,813 [INFO] Encoding hidden states for batch 18
2025-01-14 19:52:15,125 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:52:15,127 [INFO] Encoding hidden states for batch 19
2025-01-14 19:52:15,417 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:52:15,419 [INFO] Encoding hidden states for batch 20
2025-01-14 19:52:15,758 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-14 19:52:15,760 [INFO] Encoding hidden states for batch 21
2025-01-14 19:52:16,053 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 19:52:16,055 [INFO] Encoding hidden states for batch 22
2025-01-14 19:52:16,380 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-14 19:52:16,381 [INFO] Encoding hidden states for batch 23
2025-01-14 19:52:16,685 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-14 19:52:16,686 [INFO] Encoding hidden states for batch 24
2025-01-14 19:52:16,969 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:52:16,970 [INFO] Encoding hidden states for batch 25
2025-01-14 19:52:17,265 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-14 19:52:17,267 [INFO] Encoding hidden states for batch 26
2025-01-14 19:52:17,544 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-14 19:52:17,546 [INFO] Encoding hidden states for batch 27
2025-01-14 19:52:17,840 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-14 19:52:17,841 [INFO] Encoding hidden states for batch 28
2025-01-14 19:52:18,126 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-14 19:52:18,127 [INFO] Encoding hidden states for batch 29
2025-01-14 19:52:18,437 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-14 19:52:18,439 [INFO] Encoding hidden states for batch 30
2025-01-14 19:52:18,734 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-14 19:52:18,736 [INFO] Encoding hidden states for batch 31
2025-01-14 19:52:18,928 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-14 19:52:18,930 [INFO] Encoding hidden states for batch 32
2025-01-14 19:52:18,941 [INFO] Total batches processed: 32
2025-01-14 19:52:18,943 [INFO] 最大长度:76
2025-01-14 19:52:19,496 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-14 19:52:19,497 [INFO] Computing non-zero element counts
2025-01-14 19:52:20,854 [INFO] Computing sum of non-zero elements
2025-01-14 19:52:21,576 [INFO] Computing mean of non-zero elements
2025-01-14 19:52:21,578 [INFO] Selecting top-k indices based on nz_mean
2025-01-14 19:52:21,579 [INFO] Top 100 nz_mean values selected.
2025-01-14 19:52:21,579 [INFO] Selecting top-k indices based on act_cnt
2025-01-14 19:52:21,581 [INFO] Top 100 act_cnt values selected.
2025-01-14 19:53:37,890 [INFO] Computing steering vectors using method: val_mul
2025-01-14 19:53:37,903 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 19:53:52,472 [INFO] Example prompt:  Hei, we have good result, 
2025-01-14 19:53:52,474 [INFO] Generating texts **without** steering... 
2025-01-14 19:53:54,403 [INFO] Generated Text: 1:
 Hei, we have good result,  but we are not able to do anything about it.
I think that the best way to deal with this is to make sure that you don't get any more than you can handle. If you want a little bit of help, please contact
2025-01-14 19:53:54,404 [INFO] Generated Text: 2:
 Hei, we have good result,  but it is not enough to win the game.
The first team that came out of the gate was a very strong team. They had a lot of experience and they were able to take advantage of their weaknesses and get into the game with great
2025-01-14 19:53:54,405 [INFO] Generated Text: 3:
 Hei, we have good result,  but it is not enough to win the game.
The next day, I went to the office of a local businessman and asked him if he could help me with my project. He said that he would be happy to help me with any kind
2025-01-14 19:53:54,406 [INFO] 干预之后的结果
2025-01-14 19:53:54,407 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 19:53:54,407 [INFO] ** Generating texts with steering... Target **
2025-01-14 19:53:56,262 [INFO] Generated Text: 1:
 Hei, we have good result,  I'm not sure if I can do it.
So what's the point of this? Well, it's a bit of a surprise that the book is so short. It's about three years old and I've been reading for two weeks
2025-01-14 19:53:56,263 [INFO] Generated Text: 2:
 Hei, we have good result,  I'm not sure if I can say that.
The only thing I can say is that the movie was a disaster. It was so bad it made me feel like I had to watch it again and again. The first time I saw it
2025-01-14 19:53:56,264 [INFO] Generated Text: 3:
 Hei, we have good result,  I'm not sure if I can do it.
The other thing that really bothered me was the fact that the movie was set in a world where there were no heroes and villains. The main character is a young woman who has been kidnapped by
2025-01-14 20:32:24,835 [INFO] Computing steering vectors using method: val_mul
2025-01-14 20:32:24,839 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 20:32:32,341 [INFO] Example prompt:  Hei, we have good result, 
2025-01-14 20:32:32,343 [INFO] Generating texts **without** steering... 
2025-01-14 20:32:34,147 [INFO] Generated Text: 1:
 Hei, we have good result,  but it is not enough to be a good team.
I am not saying that the players are bad. I am saying that they are better than the rest of us.
The team has been very strong in recent weeks and we have been
2025-01-14 20:32:34,148 [INFO] Generated Text: 2:
 Hei, we have good result,  but we are not able to get the results that we want.
The problem is that the government has not been able to do anything about it. The main reason for this is because of the lack of money and power in China. The government
2025-01-14 20:32:34,148 [INFO] Generated Text: 3:
 Hei, we have good result,  but it is not enough to be a great team.
The other thing that I want to say is that I am not saying that the team will win this game. It's just that they are going to lose and there are some things we
2025-01-14 20:32:34,148 [INFO] 干预之后的结果
2025-01-14 20:32:34,149 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 20:32:34,149 [INFO] ** Generating texts with steering... Target **
2025-01-14 20:32:35,964 [INFO] Generated Text: 1:
 Hei, we have good result,  we are in a good position to win the game.
The first thing that I want to say is that I am not going to be saying anything about this game. It's just a matter of time before we get into the playoffs and see
2025-01-14 20:32:35,964 [INFO] Generated Text: 2:
 Hei, we have good result,  we are not going to lose.
The first thing that I want to say is that this is a very important point. The second thing that I want to say is that the players who were in the team for the last two games are not
2025-01-14 20:32:35,965 [INFO] Generated Text: 3:
 Hei, we have good result,  but it's not the same as the story of how he got there.
The first thing that I noticed about this book is that it's a bit too much like The Last Samurai . It's a lot more about samurai than you might expect
2025-01-14 20:34:55,169 [INFO] Example prompt:  Hei, we have good result, 
2025-01-14 20:34:55,171 [INFO] Generating texts **without** steering... 
2025-01-14 20:34:56,946 [INFO] Generated Text: 1:
 Hei, we have good result,  but we are not sure how to proceed.
We can see that the problem is not with the results of our analysis but with the results of our own work. We have already seen that there is a strong correlation between performance and quality in all
--------------------
2025-01-14 20:34:56,947 [INFO] Generated Text: 2:
 Hei, we have good result,  but we are not able to win the game.
The second thing is that the players have been playing well and they are not getting any better. They were playing well in their last game against Hanyu but they are still struggling with injuries
--------------------
2025-01-14 20:34:56,947 [INFO] Generated Text: 3:
 Hei, we have good result,  but we are not sure how to proceed.
The main problem is that the team has a lot of experience in this area and they have been playing for a long time. The only thing that I can say is that it's not easy to
--------------------
2025-01-14 20:34:56,947 [INFO] 干预之后的结果
2025-01-14 20:34:56,948 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 20:34:56,948 [INFO] ** Generating texts with steering... Target **
2025-01-14 20:34:58,820 [INFO] Generated Text: 1:
 Hei, we have good result,  but it's not enough to win.
The next step is to find a way to get the team back on track. The best way is for them to make a move and then take advantage of the opportunity.
I think that if they
--------------------
2025-01-14 20:34:58,820 [INFO] Generated Text: 2:
 Hei, we have good result,  we can do better.
The only problem is that the "good" results are not always good. The bad results are often worse than the "good" ones.
I think this is a big problem for us as a society and I
--------------------
2025-01-14 20:34:58,821 [INFO] Generated Text: 3:
 Hei, we have good result,  we can do better.
The second part of the story is that the team has a lot of experience in developing and developing new characters. The first part is that they are very well-known for their work on the series and it's been
--------------------
2025-01-14 20:47:33,294 [INFO] Computing steering vectors using method: val_mul
2025-01-14 20:47:33,299 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 20:47:45,492 [INFO] Example prompt: Aha, we have good result!
2025-01-14 20:47:45,494 [INFO] Generating texts **without** steering... 
2025-01-14 20:47:47,240 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I can't help you. I'm not sure if it's because of the weather or something else."

"I don't know. It's just that you're a little bit too young for this
--------------------------------------------------------------------------------
2025-01-14 20:47:47,240 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sure you'll agree that the "good" results are in the form of a few small improvements. But what about the "bad" ones? What about those that were not so good? And what about those that were not so
--------------------------------------------------------------------------------
2025-01-14 20:47:47,241 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I'm not sure if you're right. I've been trying to get a better understanding of the situation."

"I don't know what to do. It's just that it's hard for me
--------------------------------------------------------------------------------
2025-01-14 20:47:47,241 [INFO] 干预之后的结果
2025-01-14 20:47:47,241 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 20:47:47,242 [INFO] ** Generating texts with steering... Target **
2025-01-14 20:47:48,824 [INFO] Generated Text: 1:
Aha, we have good result!

I'm not sure if I can say that this is a good thing or not. It's just that it's a bit of an oddity to have the same number of characters in the same game as one another. The only way to
--------------------------------------------------------------------------------
2025-01-14 20:47:48,825 [INFO] Generated Text: 2:
Aha, we have good result!

"We are not going to let you down. We will fight for you and for the future of our country."

The leader of the opposition Labour Party, Jeremy Corbyn, said: "I am delighted that a man who has spent
--------------------------------------------------------------------------------
2025-01-14 20:47:48,825 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I can't help you. I don't know what to do."

"What?" asked the man. "You're not going to be able to help me? You're not going to be able
--------------------------------------------------------------------------------
2025-01-14 20:56:02,938 [INFO] Example prompt: Aha, we have good result!
2025-01-14 20:56:02,940 [INFO] Generating texts **without** steering... 
2025-01-14 20:57:00,946 [INFO] Example prompt: Aha, we have good result!
2025-01-14 20:57:00,947 [INFO] Generating texts **without** steering... 
2025-01-14 20:57:02,727 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I can't help you. I'm not sure if it's because of the game or not."

"I don't know. It's just that I've been playing a lot of games lately and
--------------------------------------------------------------------------------
2025-01-14 20:57:02,727 [INFO] Generated Text: 2:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the way we've been playing. We've been playing with a lot of different players and they're all very good at what they do. They're all very
--------------------------------------------------------------------------------
2025-01-14 20:57:02,727 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm happy to see you!"

"Thank you for your help. I'll be back soon."

"You're welcome."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 20:57:02,728 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 20:57:02,729 [INFO] ** Generating texts with steering... Target **
2025-01-14 20:57:04,402 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that the game is very well done. The characters are all very well developed and the story is very interesting. I think it's a shame that they didn't make more of an effort to make this game as
--------------------------------------------------------------------------------
2025-01-14 20:57:04,402 [INFO] Generated Text: 2:
Aha, we have good result!

The only problem is that the main character is a woman. The main character's gender is not a matter of choice but rather of fate. In this case, it's not about whether or not she will be able to fight back against the
--------------------------------------------------------------------------------
2025-01-14 20:57:04,402 [INFO] Generated Text: 3:
Aha, we have good result!

The main reason for this is that the characters are so different from each other. The main character is a normal human being who has been raised by his parents and who has never had any problems with his parents. He's not a bad person
--------------------------------------------------------------------------------
2025-01-14 21:00:00,459 [INFO] Computing steering vectors using method: val_mul
2025-01-14 21:00:00,471 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 21:00:12,825 [INFO] Example prompt: Aha, we have good result!
2025-01-14 21:00:12,827 [INFO] Generating texts **without** steering... 
2025-01-14 21:00:14,565 [INFO] Generated Text: 1:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the way we've been playing. We've been playing a lot of different positions and things like that. It's just really hard to play against them and be
--------------------------------------------------------------------------------
2025-01-14 21:00:14,566 [INFO] Generated Text: 2:
Aha, we have good result!

"We are going to take care of the rest of the team. We will be ready for tomorrow."

The Reds were in a difficult position at the start of the season when they lost out on promotion to League One after losing out
--------------------------------------------------------------------------------
2025-01-14 21:00:14,566 [INFO] Generated Text: 3:
Aha, we have good result!

We are happy to announce that the new version of the app is now available for download. The app is now available for Android 4.0 and up. It's a great way to get started with your favorite apps and keep them running smoothly
--------------------------------------------------------------------------------
2025-01-14 21:00:14,566 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 21:00:14,567 [INFO] ** Generating texts with steering... Target **
2025-01-14 21:00:16,224 [INFO] Generated Text: 1:
Aha, we have good result!

The first thing I did was to check the data for the "unexpected" number of deaths. The number of deaths in a given year is very small, so it's not surprising that this is happening. But there are other factors that
--------------------------------------------------------------------------------
2025-01-14 21:00:16,224 [INFO] Generated Text: 2:
Aha, we have good result!

The game is a bit too long and I'm not sure if it's worth the time. It's just too much to play.

I think it's going to be a lot of fun. I don't know what the next
--------------------------------------------------------------------------------
2025-01-14 21:00:16,225 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sorry for the poor quality of this game. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 21:51:32,544 [INFO] Computing steering vectors using method: val_mul
2025-01-14 21:51:32,554 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 21:51:32,559 [INFO] Example prompt: Aha, we have good result!
2025-01-14 21:51:32,560 [INFO] Generating texts **without** steering... 
2025-01-14 21:51:34,289 [INFO] Generated Text: 1:
Aha, we have good result!

The only problem is that the results are not quite as good as they should be. We can't say that the team was better than expected, but it's possible that we were wrong. The team was very well prepared and did a great
--------------------------------------------------------------------------------
2025-01-14 21:51:34,289 [INFO] Generated Text: 2:
Aha, we have good result!

The other day I was talking to a friend of mine who is a writer and I asked him if he would like to write about the story of the two women who were raped by their husbands. He said that they had been married for three
--------------------------------------------------------------------------------
2025-01-14 21:51:34,290 [INFO] Generated Text: 3:
Aha, we have good result!

We are now at the end of our journey. We will be able to finish the mission and return to the station.

Thank you for your patience and understanding.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 21:51:34,290 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 21:51:34,291 [INFO] ** Generating texts with steering... Target **
2025-01-14 21:51:35,902 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 21:51:35,903 [INFO] Generated Text: 2:
Aha, we have good result!

"The only thing that's wrong with this is that it's a game of "What if?" and the player has to decide what they want to do next. It's not like you can just go out and play for the first time
--------------------------------------------------------------------------------
2025-01-14 21:51:35,903 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 22:11:06,375 [INFO] Example prompt: Aha, we have good result!
2025-01-14 22:11:06,377 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:11:06,387 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:11:06,398 [INFO] Generating texts **without** steering... 
2025-01-14 22:11:08,128 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I'm not sure if you're right. I don't know what to do."

"I'll be fine. Just wait for me to come back."

The two of them walked out of
--------------------------------------------------------------------------------
2025-01-14 22:11:08,129 [INFO] Generated Text: 2:
Aha, we have good result!

"We are going to be in the playoffs. We will be in the playoffs. We will be in the playoffs."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 22:11:08,129 [INFO] Generated Text: 3:
Aha, we have good result!

We are happy to announce that the following changes have been made to the current version of our website:

The homepage has been updated with a new logo. The homepage is now much more organized and easy to navigate. We also added a
--------------------------------------------------------------------------------
2025-01-14 22:11:08,129 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 22:11:08,130 [INFO] ** Generating texts with steering... Target **
2025-01-14 22:11:09,741 [INFO] Generated Text: 1:
Aha, we have good result!

"The truth is that I am a coward. I will not let you go."

"I will not let you go!" shouted the girl. "You are my enemy!" she cried in horror. "I am your enemy!
--------------------------------------------------------------------------------
2025-01-14 22:11:09,741 [INFO] Generated Text: 2:
Aha, we have good result!

The first thing I did was to check the stats of the game. The only difference between this and a previous version of the game was that it had a different level system. This is because in my previous version, there were no levels for
--------------------------------------------------------------------------------
2025-01-14 22:11:09,742 [INFO] Generated Text: 3:
Aha, we have good result!

The only thing that's wrong with this is that it's a terrible story. It's not about the people who are killed, it's about the people who are killed by the war. It doesn't even have to be about how many
--------------------------------------------------------------------------------
2025-01-14 22:12:01,851 [INFO] Example prompt: Aha, we have good result!
2025-01-14 22:12:01,866 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:12:01,959 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:12:01,961 [INFO] Generating texts **without** steering... 
2025-01-14 22:12:03,739 [INFO] Generated Text: 1:
Aha, we have good result!

The first thing that I noticed was that the game is not very well balanced. The game is very easy to play and it's a lot of fun to play. It's also a lot of fun to play with friends. There are some
--------------------------------------------------------------------------------
2025-01-14 22:12:03,739 [INFO] Generated Text: 2:
Aha, we have good result!

We are now at the point where we can make a decision on whether to continue with our plan. We will be able to make a decision on the next step in our journey. We will also be able to make a decision on whether or
--------------------------------------------------------------------------------
2025-01-14 22:12:03,740 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I'm not sure if you're right. I don't know what to do."

"You're right. It's a problem with the game."

"It's a problem with the game
--------------------------------------------------------------------------------
2025-01-14 22:12:03,740 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-14 22:12:03,740 [INFO] ** Generating texts with steering... Target **
2025-01-14 22:12:05,431 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I can't do this anymore. I'm not going to be able to do this again."

"You're right. It's a shame that you're still here." The girl said with a smile
--------------------------------------------------------------------------------
2025-01-14 22:12:05,431 [INFO] Generated Text: 2:
Aha, we have good result!

"The only thing that's wrong with this is that it's a terrible movie. It's not a bad movie at all. It's just an awful one."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 22:12:05,432 [INFO] Generated Text: 3:
Aha, we have good result!

The only thing that's wrong with this is that it's a terrible story. It's not about the protagonist being a hero or anything like that. It's about the characters being forced to do something they don't want to do and having
--------------------------------------------------------------------------------
2025-01-14 22:21:52,019 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:21:52,024 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:21:52,025 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:21:52,030 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:21:53,790 [INFO] Generated Text: 1:
Aha, we have good result!

I'm so happy to see you guys back on the road. I hope you all enjoy this ride and stay tuned for more updates.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 22:21:53,790 [INFO] Generated Text: 2:
Aha, we have good result!

The only problem is that I'm not sure if it's a coincidence or not. The first time I saw this game was in 2012, and it was the first time I played a game with a controller. It's like playing with an
--------------------------------------------------------------------------------
2025-01-14 22:21:53,790 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm glad you're here. I'll be back soon."

"I'm sorry, but I can't wait to see you again."

"You're welcome. It's been a long time since I've seen
--------------------------------------------------------------------------------
2025-01-14 22:21:55,370 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sorry, but I can't help you. I'm not sure if you're feeling well or not.

I don't know what to do. I just want to go home and relax. It's a bit hard for
--------------------------------------------------------------------------------
2025-01-14 22:21:55,370 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sorry, but I can't help you. I'm not sure if you're ready for this.

You're right. It's a bit of a mess. But it's not like I've been able to get any
--------------------------------------------------------------------------------
2025-01-14 22:21:55,371 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I can't help you. I'm not sure if it's because of the situation or not."

"I don't know. It's just that you're a little too busy with your business."
--------------------------------------------------------------------------------
2025-01-14 22:22:33,432 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:22:33,438 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:22:33,439 [INFO] Computing steering vectors using method: val_mul
2025-01-14 22:22:33,445 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 22:22:35,187 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I can't do it anymore. I'll just go back to my room and sleep."

"You're not going to sleep?" asked the girl. "You're going to be so tired that you
--------------------------------------------------------------------------------
2025-01-14 22:22:35,188 [INFO] Generated Text: 2:
Aha, we have good result!

"I'm sorry, but I can't do it anymore. I'll be leaving soon."

"You're not going to leave now?" asked the girl. "I'm not going to stay here for long."

"
--------------------------------------------------------------------------------
2025-01-14 22:22:35,188 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I can't do it anymore. I'll just go back to my room and sleep."

"What?" The girl asked. "You're not going to be able to sleep with me for a while
--------------------------------------------------------------------------------
2025-01-14 22:22:36,838 [INFO] Generated Text: 1:
Aha, we have good result!

The only problem is that the story is so short. The main character is a young girl who has been kidnapped by a group of men and forced to marry them. She's also in love with her boyfriend, but she's not quite ready
--------------------------------------------------------------------------------
2025-01-14 22:22:36,839 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sure you'll agree that this is a very interesting and interesting story. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 22:22:36,839 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sure you'll agree that this is a very interesting and exciting development. I hope you'll join me in thanking the team for their hard work and dedication to making this happen.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 23:20:58,649 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:20:58,651 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:20:58,651 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:20:58,653 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:21:02,407 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 23:21:02,408 [INFO] Generated Text: 2:
Aha, we have good result!

"I'm sorry, but I can't help you. I don't want to see you die."

"I'm sorry, but I can't help you. You're a monster!"

"You're a monster!"
--------------------------------------------------------------------------------
2025-01-14 23:21:02,408 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 23:21:05,859 [INFO] Generated Text: 1:
Aha, we have good result!

"I'm sorry, but I can't do it anymore. I'll just leave you alone."

"I'm sorry, but I can't do it anymore. You're not going to be able to help me with this."
--------------------------------------------------------------------------------
2025-01-14 23:21:05,860 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sure you'll agree that the results are not great. But I think it's important to note that this is a very small sample size. The results are quite significant for the most part, and I would expect them to be even
--------------------------------------------------------------------------------
2025-01-14 23:21:05,860 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I can't do it anymore. I'll just leave you alone."

"I'm sorry, but I can't do it anymore. You're my friend!"

The two of them left the
--------------------------------------------------------------------------------
2025-01-14 23:21:05,861 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:21:05,862 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:21:05,863 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:21:05,864 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:21:09,359 [INFO] Generated Text: 1:
Aha, we have good result!

"The game is still in development and I'm sure you'll be able to play it soon. But for now, please keep your eyes peeled for more information."

I was surprised at the response from the player. He had been
--------------------------------------------------------------------------------
2025-01-14 23:21:09,360 [INFO] Generated Text: 2:
Aha, we have good result!

"The first time I saw the new team was in a game against AZ, and it was a very good performance. The second time I saw them was at the World Cup in Brazil. It's been a long time since we've seen
--------------------------------------------------------------------------------
2025-01-14 23:21:09,361 [INFO] Generated Text: 3:
Aha, we have good result!

The second part of the story is about a girl who has been in love with a man for years. She's been dating him for three years and he's never given her any kind of help. She tries to get him to stop but
--------------------------------------------------------------------------------
2025-01-14 23:21:13,084 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that this is a very good performance. I think it's a great example of how the best teams can be coached and how they can improve their team.

The fact that the team has to play with
--------------------------------------------------------------------------------
2025-01-14 23:21:13,085 [INFO] Generated Text: 2:
Aha, we have good result!

The following is a list of the most popular songs from the album. The top 10 are all from the same album. The rest are all from different albums.

1) "Lil' Wayne" (feat. Lil Wayne)
--------------------------------------------------------------------------------
2025-01-14 23:21:13,085 [INFO] Generated Text: 3:
Aha, we have good result!

"We're going to be back in the Champions League next season. We'll be playing at home and I'm sure we'll get a lot of points."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 23:21:13,086 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:21:13,087 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:21:13,088 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:21:13,089 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:21:16,310 [INFO] Generated Text: 1:
Aha, we have good result!

The next day, I went to the hospital and was told that my condition had improved. I was told that my body would be fine. The doctors said that it would take a few days before I could get back to work. They said
--------------------------------------------------------------------------------
2025-01-14 23:21:16,311 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sure you'll agree that the team is very happy with the results. We've been working hard to improve our performance and I think we're looking forward to seeing what happens next.

We've also got a lot of work
--------------------------------------------------------------------------------
2025-01-14 23:21:16,311 [INFO] Generated Text: 3:
Aha, we have good result!

I'm not sure if you've heard of the "Fifty Shades of Grey" series. It's a series about a young woman who is forced to choose between her love for her boyfriend and her love for herself. The show has been
--------------------------------------------------------------------------------
2025-01-14 23:21:19,658 [INFO] Generated Text: 1:
Aha, we have good result!

"We are very happy with the results of our test. We will continue to work on improving the system and improve performance in future."<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-14 23:21:19,658 [INFO] Generated Text: 2:
Aha, we have good result!

I'm sure you'll agree that the best way to achieve this is to make a lot of money. But if you're not willing to spend it on something that's not worth your time, then you're probably going to end up with
--------------------------------------------------------------------------------
2025-01-14 23:21:19,659 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm sorry, but I can't help you. I'm not sure if it's because of the time or the weather."

"I don't know. It's just that you're so busy with your work and everything
--------------------------------------------------------------------------------
2025-01-14 23:51:43,954 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:43,960 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:51:43,961 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:43,966 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:51:47,659 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:47,660 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:51:47,662 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:47,664 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:51:51,241 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:51,242 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-14 23:51:51,243 [INFO] Computing steering vectors using method: val_mul
2025-01-14 23:51:51,244 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:39:29,838 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 11:39:29,840 [INFO] Hyperparameters:
2025-01-15 11:39:29,842 [INFO]   layer: 6
2025-01-15 11:39:29,843 [INFO]   LLM: gpt2-small
2025-01-15 11:39:29,844 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 11:39:29,846 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 11:39:29,847 [INFO]   output_dir: ./results
2025-01-15 11:39:29,848 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 11:39:29,849 [INFO]   task: sentiment
2025-01-15 11:39:29,851 [INFO]   seed: 42
2025-01-15 11:39:29,852 [INFO]   data_size: 1000
2025-01-15 11:39:29,853 [INFO]   device: cpu
2025-01-15 11:39:29,853 [INFO]   alpha: 100
2025-01-15 11:39:29,854 [INFO]   steer: pos-neg
2025-01-15 11:39:29,856 [INFO]   method: val_mul
2025-01-15 11:39:29,856 [INFO]   topk_mean: 100
2025-01-15 11:39:29,858 [INFO]   topk_cnt: 100
2025-01-15 11:39:29,859 [INFO]   batch_size: 32
2025-01-15 11:39:33,714 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 11:39:43,205 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 11:39:43,207 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 11:39:43,209 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 11:39:43,406 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 11:39:43,417 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 11:40:05,805 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 11:40:09,502 [INFO] Hyperparameters:
2025-01-15 11:40:09,504 [INFO]   layer: 6
2025-01-15 11:40:09,505 [INFO]   LLM: gpt2-small
2025-01-15 11:40:09,506 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 11:40:09,508 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 11:40:09,509 [INFO]   output_dir: ./results
2025-01-15 11:40:09,509 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 11:40:09,510 [INFO]   task: sentiment
2025-01-15 11:40:09,512 [INFO]   seed: 42
2025-01-15 11:40:09,513 [INFO]   data_size: 1000
2025-01-15 11:40:09,513 [INFO]   device: cpu
2025-01-15 11:40:09,514 [INFO]   alpha: 100
2025-01-15 11:40:09,515 [INFO]   steer: pos-neg
2025-01-15 11:40:09,516 [INFO]   method: val_mul
2025-01-15 11:40:09,516 [INFO]   topk_mean: 100
2025-01-15 11:40:09,517 [INFO]   topk_cnt: 100
2025-01-15 11:40:09,518 [INFO]   batch_size: 32
2025-01-15 11:40:09,521 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 11:40:09,522 [INFO] Loading model: gpt2-small
2025-01-15 11:40:50,310 [INFO] Loading SAE for layer 6
2025-01-15 11:43:51,126 [INFO] pos-neg
2025-01-15 11:43:51,157 [INFO] Running model with cache to obtain hidden states
2025-01-15 11:43:51,547 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 11:43:51,548 [INFO] Encoding hidden states for batch 1
2025-01-15 11:43:51,972 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:43:51,973 [INFO] Encoding hidden states for batch 2
2025-01-15 11:43:52,278 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 11:43:52,279 [INFO] Encoding hidden states for batch 3
2025-01-15 11:43:52,587 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 11:43:52,589 [INFO] Encoding hidden states for batch 4
2025-01-15 11:43:52,881 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 11:43:52,882 [INFO] Encoding hidden states for batch 5
2025-01-15 11:43:53,172 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:43:53,174 [INFO] Encoding hidden states for batch 6
2025-01-15 11:43:53,461 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 11:43:53,462 [INFO] Encoding hidden states for batch 7
2025-01-15 11:43:53,718 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 11:43:53,720 [INFO] Encoding hidden states for batch 8
2025-01-15 11:43:53,974 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:43:53,976 [INFO] Encoding hidden states for batch 9
2025-01-15 11:43:54,302 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 11:43:54,303 [INFO] Encoding hidden states for batch 10
2025-01-15 11:43:54,604 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 11:43:54,606 [INFO] Encoding hidden states for batch 11
2025-01-15 11:43:54,921 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 11:43:54,922 [INFO] Encoding hidden states for batch 12
2025-01-15 11:43:55,260 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:43:55,261 [INFO] Encoding hidden states for batch 13
2025-01-15 11:43:55,571 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 11:43:55,573 [INFO] Encoding hidden states for batch 14
2025-01-15 11:43:55,856 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 11:43:55,857 [INFO] Encoding hidden states for batch 15
2025-01-15 11:43:56,094 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 11:43:56,096 [INFO] Encoding hidden states for batch 16
2025-01-15 11:43:56,339 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:43:56,340 [INFO] Encoding hidden states for batch 17
2025-01-15 11:43:56,616 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:43:56,618 [INFO] Encoding hidden states for batch 18
2025-01-15 11:43:56,891 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:43:56,893 [INFO] Encoding hidden states for batch 19
2025-01-15 11:43:57,233 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 11:43:57,235 [INFO] Encoding hidden states for batch 20
2025-01-15 11:43:57,580 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:43:57,582 [INFO] Encoding hidden states for batch 21
2025-01-15 11:43:57,925 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 11:43:57,927 [INFO] Encoding hidden states for batch 22
2025-01-15 11:43:58,219 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 11:43:58,220 [INFO] Encoding hidden states for batch 23
2025-01-15 11:43:58,475 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:43:58,476 [INFO] Encoding hidden states for batch 24
2025-01-15 11:43:58,785 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:43:58,786 [INFO] Encoding hidden states for batch 25
2025-01-15 11:43:59,558 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:43:59,559 [INFO] Encoding hidden states for batch 26
2025-01-15 11:44:00,202 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:00,203 [INFO] Encoding hidden states for batch 27
2025-01-15 11:44:00,555 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 11:44:00,556 [INFO] Encoding hidden states for batch 28
2025-01-15 11:44:00,865 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:00,866 [INFO] Encoding hidden states for batch 29
2025-01-15 11:44:01,191 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 11:44:01,193 [INFO] Encoding hidden states for batch 30
2025-01-15 11:44:01,515 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:01,517 [INFO] Encoding hidden states for batch 31
2025-01-15 11:44:01,691 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 11:44:01,693 [INFO] Encoding hidden states for batch 32
2025-01-15 11:44:01,702 [INFO] Total batches processed: 32
2025-01-15 11:44:01,705 [INFO] 最大长度:60
2025-01-15 11:44:02,209 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 11:44:02,210 [INFO] Computing non-zero element counts
2025-01-15 11:44:03,394 [INFO] Computing sum of non-zero elements
2025-01-15 11:44:03,992 [INFO] Computing mean of non-zero elements
2025-01-15 11:44:03,994 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 11:44:03,995 [INFO] Top 100 nz_mean values selected.
2025-01-15 11:44:03,996 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 11:44:03,997 [INFO] Top 100 act_cnt values selected.
2025-01-15 11:44:04,582 [INFO] Running model with cache to obtain hidden states
2025-01-15 11:44:04,941 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-15 11:44:04,942 [INFO] Encoding hidden states for batch 1
2025-01-15 11:44:05,353 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:44:05,354 [INFO] Encoding hidden states for batch 2
2025-01-15 11:44:05,651 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:05,653 [INFO] Encoding hidden states for batch 3
2025-01-15 11:44:05,968 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 11:44:05,969 [INFO] Encoding hidden states for batch 4
2025-01-15 11:44:06,245 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-15 11:44:06,247 [INFO] Encoding hidden states for batch 5
2025-01-15 11:44:06,496 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:06,498 [INFO] Encoding hidden states for batch 6
2025-01-15 11:44:07,074 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:07,075 [INFO] Encoding hidden states for batch 7
2025-01-15 11:44:07,355 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:44:07,356 [INFO] Encoding hidden states for batch 8
2025-01-15 11:44:07,710 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:44:07,711 [INFO] Encoding hidden states for batch 9
2025-01-15 11:44:08,045 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 11:44:08,046 [INFO] Encoding hidden states for batch 10
2025-01-15 11:44:08,353 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 11:44:08,355 [INFO] Encoding hidden states for batch 11
2025-01-15 11:44:08,664 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:44:08,665 [INFO] Encoding hidden states for batch 12
2025-01-15 11:44:08,946 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:08,947 [INFO] Encoding hidden states for batch 13
2025-01-15 11:44:09,213 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:09,214 [INFO] Encoding hidden states for batch 14
2025-01-15 11:44:09,482 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:09,484 [INFO] Encoding hidden states for batch 15
2025-01-15 11:44:09,774 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:09,775 [INFO] Encoding hidden states for batch 16
2025-01-15 11:44:10,053 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 11:44:10,054 [INFO] Encoding hidden states for batch 17
2025-01-15 11:44:10,346 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:44:10,347 [INFO] Encoding hidden states for batch 18
2025-01-15 11:44:10,658 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:44:10,660 [INFO] Encoding hidden states for batch 19
2025-01-15 11:44:11,017 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 11:44:11,019 [INFO] Encoding hidden states for batch 20
2025-01-15 11:44:11,301 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:11,302 [INFO] Encoding hidden states for batch 21
2025-01-15 11:44:11,576 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:11,578 [INFO] Encoding hidden states for batch 22
2025-01-15 11:44:11,914 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 11:44:11,916 [INFO] Encoding hidden states for batch 23
2025-01-15 11:44:12,227 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 11:44:12,229 [INFO] Encoding hidden states for batch 24
2025-01-15 11:44:12,532 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:44:12,533 [INFO] Encoding hidden states for batch 25
2025-01-15 11:44:12,810 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 11:44:12,812 [INFO] Encoding hidden states for batch 26
2025-01-15 11:44:13,091 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:13,092 [INFO] Encoding hidden states for batch 27
2025-01-15 11:44:13,362 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 11:44:13,364 [INFO] Encoding hidden states for batch 28
2025-01-15 11:44:13,605 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 11:44:13,607 [INFO] Encoding hidden states for batch 29
2025-01-15 11:44:13,858 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 11:44:13,859 [INFO] Encoding hidden states for batch 30
2025-01-15 11:44:14,152 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 11:44:14,154 [INFO] Encoding hidden states for batch 31
2025-01-15 11:44:14,336 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-15 11:44:14,338 [INFO] Encoding hidden states for batch 32
2025-01-15 11:44:14,348 [INFO] Total batches processed: 32
2025-01-15 11:44:14,350 [INFO] 最大长度:59
2025-01-15 11:44:14,780 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-15 11:44:14,781 [INFO] Computing non-zero element counts
2025-01-15 11:44:15,848 [INFO] Computing sum of non-zero elements
2025-01-15 11:44:16,406 [INFO] Computing mean of non-zero elements
2025-01-15 11:44:16,408 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 11:44:16,409 [INFO] Top 100 nz_mean values selected.
2025-01-15 11:44:16,410 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 11:44:16,411 [INFO] Top 100 act_cnt values selected.
2025-01-15 11:44:16,942 [INFO] Running model with cache to obtain hidden states
2025-01-15 11:44:17,267 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-15 11:44:17,268 [INFO] Encoding hidden states for batch 1
2025-01-15 11:44:17,706 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 11:44:17,707 [INFO] Encoding hidden states for batch 2
2025-01-15 11:44:17,998 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:18,000 [INFO] Encoding hidden states for batch 3
2025-01-15 11:44:18,284 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:18,285 [INFO] Encoding hidden states for batch 4
2025-01-15 11:44:18,556 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:18,557 [INFO] Encoding hidden states for batch 5
2025-01-15 11:44:18,855 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 11:44:18,856 [INFO] Encoding hidden states for batch 6
2025-01-15 11:44:19,155 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 11:44:19,156 [INFO] Encoding hidden states for batch 7
2025-01-15 11:44:19,427 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 11:44:19,428 [INFO] Encoding hidden states for batch 8
2025-01-15 11:44:19,700 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:19,701 [INFO] Encoding hidden states for batch 9
2025-01-15 11:44:19,994 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 11:44:19,995 [INFO] Encoding hidden states for batch 10
2025-01-15 11:44:20,263 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-15 11:44:20,265 [INFO] Encoding hidden states for batch 11
2025-01-15 11:44:20,578 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 11:44:20,580 [INFO] Encoding hidden states for batch 12
2025-01-15 11:44:20,872 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 11:44:20,873 [INFO] Encoding hidden states for batch 13
2025-01-15 11:44:21,148 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 11:44:21,150 [INFO] Encoding hidden states for batch 14
2025-01-15 11:44:21,427 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:21,428 [INFO] Encoding hidden states for batch 15
2025-01-15 11:44:21,753 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 11:44:21,754 [INFO] Encoding hidden states for batch 16
2025-01-15 11:44:22,055 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 11:44:22,057 [INFO] Encoding hidden states for batch 17
2025-01-15 11:44:22,328 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:22,330 [INFO] Encoding hidden states for batch 18
2025-01-15 11:44:22,630 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:44:22,632 [INFO] Encoding hidden states for batch 19
2025-01-15 11:44:22,907 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:22,909 [INFO] Encoding hidden states for batch 20
2025-01-15 11:44:23,236 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 11:44:23,238 [INFO] Encoding hidden states for batch 21
2025-01-15 11:44:23,517 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 11:44:23,519 [INFO] Encoding hidden states for batch 22
2025-01-15 11:44:23,835 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 11:44:23,836 [INFO] Encoding hidden states for batch 23
2025-01-15 11:44:24,124 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 11:44:24,125 [INFO] Encoding hidden states for batch 24
2025-01-15 11:44:24,395 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:24,397 [INFO] Encoding hidden states for batch 25
2025-01-15 11:44:24,686 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 11:44:24,688 [INFO] Encoding hidden states for batch 26
2025-01-15 11:44:24,959 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 11:44:24,961 [INFO] Encoding hidden states for batch 27
2025-01-15 11:44:25,250 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 11:44:25,252 [INFO] Encoding hidden states for batch 28
2025-01-15 11:44:25,526 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 11:44:25,528 [INFO] Encoding hidden states for batch 29
2025-01-15 11:44:25,821 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 11:44:25,822 [INFO] Encoding hidden states for batch 30
2025-01-15 11:44:26,090 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 11:44:26,092 [INFO] Encoding hidden states for batch 31
2025-01-15 11:44:26,275 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-15 11:44:26,277 [INFO] Encoding hidden states for batch 32
2025-01-15 11:44:26,287 [INFO] Total batches processed: 32
2025-01-15 11:44:26,290 [INFO] 最大长度:76
2025-01-15 11:44:26,861 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-15 11:44:26,862 [INFO] Computing non-zero element counts
2025-01-15 11:44:28,261 [INFO] Computing sum of non-zero elements
2025-01-15 11:44:28,966 [INFO] Computing mean of non-zero elements
2025-01-15 11:44:28,968 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 11:44:28,969 [INFO] Top 100 nz_mean values selected.
2025-01-15 11:44:28,969 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 11:44:28,971 [INFO] Top 100 act_cnt values selected.
2025-01-15 11:46:24,823 [INFO] Example prompt: Aha, we have good result!
2025-01-15 11:46:24,826 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:46:24,854 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:46:24,856 [INFO] Generating texts **without** steering... 
2025-01-15 11:46:26,658 [INFO] Generated Text: 1:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the way the game is played. It's a lot more fun to play with your friends than with your family. It's also a lot easier to play with
--------------------------------------------------------------------------------
2025-01-15 11:46:26,659 [INFO] Generated Text: 2:
Aha, we have good result!

We are now at the point where we can finally get to the point where we can start working on our own project. We have a lot of work to do and it is going to take some time. But I think that this is a
--------------------------------------------------------------------------------
2025-01-15 11:46:26,659 [INFO] Generated Text: 3:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the fact that I've been playing with a lot of different players and they're all trying to get better. It's just like, "Oh my God,
--------------------------------------------------------------------------------
2025-01-15 11:46:26,661 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 11:46:26,661 [INFO] ** Generating texts with steering... Target **
2025-01-15 11:46:28,401 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sorry for the poor quality of this game. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:46:28,402 [INFO] Generated Text: 2:
Aha, we have good result!

"I'm sorry, but I can't do this anymore. I'm not going to be able to go back to the game."

The match was played in a stadium that had been used for many years by the old city of
--------------------------------------------------------------------------------
2025-01-15 11:46:28,403 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sorry for the poor quality of this story. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:47:23,459 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:23,465 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:47:23,466 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:23,472 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:47:27,057 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:27,059 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:47:27,060 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:27,062 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:47:30,441 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:30,443 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:47:30,443 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:47:30,444 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:38,898 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:38,905 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:38,906 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:38,912 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:42,557 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:42,559 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:42,560 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:42,561 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:45,984 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:45,986 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:58:45,987 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:58:45,988 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:59:12,190 [INFO] Example prompt: Aha, we have good result!
2025-01-15 11:59:12,192 [INFO] Computing steering vectors using method: val_mul
2025-01-15 11:59:12,241 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 11:59:12,243 [INFO] Generating texts **without** steering... 
2025-01-15 11:59:14,361 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that the most important thing is to keep your head down and not let your emotions get in the way of what you're doing.

If you want to be a better person, then go out and do
--------------------------------------------------------------------------------
2025-01-15 11:59:14,361 [INFO] Generated Text: 2:
Aha, we have good result!

"I'm happy to see you again. I hope you're well."

"Yes, I am. Thank you for your time."

The next day, the two of them went to the hospital and were treated for a
--------------------------------------------------------------------------------
2025-01-15 11:59:14,362 [INFO] Generated Text: 3:
Aha, we have good result!

"We are not the only ones who are worried about this. We have been told that there is a possibility of a nuclear war with Russia. But we do not know what will happen to us if we do not act now."


--------------------------------------------------------------------------------
2025-01-15 11:59:14,362 [INFO] Generated Text: 4:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the way we've been playing with the team. We're a very strong team and we're very competitive. We've played well in scrims and in games
--------------------------------------------------------------------------------
2025-01-15 11:59:14,363 [INFO] Generated Text: 5:
Aha, we have good result!

We are very happy with the results of our test. We will continue to improve our performance and keep improving it.

Thank you for your support!<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:59:14,364 [INFO] Generated Text: 6:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the fact that we're all so busy with our jobs and our families. We're all working hard to get things done, but there are a lot of people
--------------------------------------------------------------------------------
2025-01-15 11:59:14,365 [INFO] Generated Text: 7:
Aha, we have good result!

We are happy to announce that the game is now available for download on Steam. The game will be available for PC and Mac in the coming weeks. We hope you enjoy it!<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:59:14,365 [INFO] Generated Text: 8:
Aha, we have good result!

I'm sure you'll agree that the next time you're in a situation where you need to be able to do something, it's better to use your imagination. If you can't do something, then maybe it's time for some action
--------------------------------------------------------------------------------
2025-01-15 11:59:14,367 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 11:59:14,368 [INFO] ** Generating texts with steering... Target **
2025-01-15 11:59:16,315 [INFO] Generated Text: 1:
Aha, we have good result!

The story of the series is a bit different from the anime. The main characters are all human and have their own personalities. They are all in their twenties or thirties, but they're still young enough to be able to understand what
--------------------------------------------------------------------------------
2025-01-15 11:59:16,316 [INFO] Generated Text: 2:
Aha, we have good result!

"The best thing about this is that it's not a sequel to the original. It's a continuation of the story."

The film was originally scheduled for release on May 7, but was delayed by two weeks after its release due
--------------------------------------------------------------------------------
2025-01-15 11:59:16,317 [INFO] Generated Text: 3:
Aha, we have good result!

The next day, I was at the airport and saw a man who looked like he had been shot. He was wearing a black hoodie and black pants. He said he had been shot in the head by an officer who was trying to
--------------------------------------------------------------------------------
2025-01-15 11:59:16,317 [INFO] Generated Text: 4:
Aha, we have good result!

I'm sorry for the poor quality of this game. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:59:16,318 [INFO] Generated Text: 5:
Aha, we have good result!

I'm sorry for the poor quality of this story. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 11:59:16,319 [INFO] Generated Text: 6:
Aha, we have good result!

"The only thing that's wrong with this is that it's a bad story. It's not about the characters, it's about the people who are killed."

The film was released on May 4th and has been viewed over
--------------------------------------------------------------------------------
2025-01-15 11:59:16,320 [INFO] Generated Text: 7:
Aha, we have good result!

"I'm sorry, but I can't help you. I don't want to see you die."

"I'm sorry, but I can't help you. You're a monster!"

"You're a monster!"
--------------------------------------------------------------------------------
2025-01-15 11:59:16,320 [INFO] Generated Text: 8:
Aha, we have good result!

"I'm sorry, but I can't do this anymore. I'm not going to be able to do this again."

"What?"

"You're not going to be able to do it again. You're just
--------------------------------------------------------------------------------
2025-01-15 12:00:58,999 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:00:59,006 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:00:59,007 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:00:59,013 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:01:02,830 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:01:02,831 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:01:02,832 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:01:02,833 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:01:06,506 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:01:06,507 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:01:06,508 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:01:06,509 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:34,040 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:34,046 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:34,048 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:34,053 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:37,919 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:37,920 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:37,922 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:37,924 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:41,586 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:41,588 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:41,589 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:41,590 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:45,274 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:45,275 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:45,276 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:45,276 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:49,007 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:49,008 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:49,008 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:49,009 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:52,658 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:52,659 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:52,659 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:52,660 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:56,328 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:56,329 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:14:56,330 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:14:56,331 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:23:54,026 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:23:54,032 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:23:54,034 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:23:54,039 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:23:57,915 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:23:57,917 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:23:57,918 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:23:57,920 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:01,646 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:01,647 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:01,648 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:01,649 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:05,324 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:05,325 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:05,325 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:05,326 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:09,010 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:09,011 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:09,012 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:09,013 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:12,645 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:12,646 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:12,646 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:12,647 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:16,310 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:16,311 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:24:16,311 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:24:16,312 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:46:50,014 [INFO] Example prompt: Aha, we have good result!
2025-01-15 12:46:50,016 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:46:50,026 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:46:50,029 [INFO] Generating texts **without** steering... 
2025-01-15 12:46:52,054 [INFO] Generated Text: 1:
Aha, we have good result!

We are now in the final stages of our campaign. We will be able to get the game out to everyone who has supported us for so long. We hope you will join us and help us reach our goal!<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 12:46:52,055 [INFO] Generated Text: 2:
Aha, we have good result!

The only problem is that the game is not playable. I am not sure if it will be playable in the future.

I am also wondering if there are any other games that can be played with this controller. If so, what
--------------------------------------------------------------------------------
2025-01-15 12:46:52,055 [INFO] Generated Text: 3:
Aha, we have good result!

"I'm happy to see you again. I hope you're well."

"Yes, I am. Thank you for your help."

The next day, the same day that the first meeting was held in the village of
--------------------------------------------------------------------------------
2025-01-15 12:46:52,055 [INFO] Generated Text: 4:
Aha, we have good result!

"I'm sorry, but I'm not sure if you're ready to go back to the world of the big leagues. I don't know what's going on here."

The next day, he went out and bought a new
--------------------------------------------------------------------------------
2025-01-15 12:46:52,056 [INFO] Generated Text: 5:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the way the game is played. It's a very simple game and there are no rules or anything like that. You just have to play it and see what
--------------------------------------------------------------------------------
2025-01-15 12:46:52,056 [INFO] Generated Text: 6:
Aha, we have good result!

"We are not going to let you down. We will fight for you and for the future of our country."

The statement was issued by the Foreign Ministry on behalf of the Syrian government. It said that "the Syrian people have
--------------------------------------------------------------------------------
2025-01-15 12:46:52,056 [INFO] Generated Text: 7:
Aha, we have good result!

"I'm happy to see you!"

"Thank you for your help. I'll be back soon."

"I'm sorry, but I can't go back to the house now. It's too late."<|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 12:46:52,057 [INFO] Generated Text: 8:
Aha, we have good result!

The other day I was talking to a friend of mine who is a very nice guy. He said that he has been in the military for about 10 years and he is very proud of his service. He said that he has been in the
--------------------------------------------------------------------------------
2025-01-15 12:46:52,058 [INFO] 干预之后的结果
干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 12:46:52,059 [INFO] ** Generating texts with steering... Target **
2025-01-15 12:46:53,884 [INFO] Generated Text: 1:
Aha, we have good result!

The next day, I was told that the team had been informed of the situation and would be meeting with the coach. The coach was not happy about this and asked me to leave. I did not want to go back to my home country
--------------------------------------------------------------------------------
2025-01-15 12:46:53,884 [INFO] Generated Text: 2:
Aha, we have good result!

"The truth is that I am not a good person. I am a bad person."

I was in the middle of my own grief when I heard this. It was like someone had been trying to kill me for years. The
--------------------------------------------------------------------------------
2025-01-15 12:46:53,885 [INFO] Generated Text: 3:
Aha, we have good result!

I'm sorry for the poor quality of this game. I hope you enjoy it.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 12:46:53,885 [INFO] Generated Text: 4:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 12:46:53,885 [INFO] Generated Text: 5:
Aha, we have good result!

The only thing that's wrong with this is that it's a very bad movie. It's not even about the death of a character. It's about the death of an entire family. And I think it was really bad for our audience
--------------------------------------------------------------------------------
2025-01-15 12:46:53,885 [INFO] Generated Text: 6:
Aha, we have good result!

"I'm sorry, but I can't do this anymore. I'm not going to be able to go back to the village."

"You're right. It's not like you're going back there."

"No
--------------------------------------------------------------------------------
2025-01-15 12:46:53,886 [INFO] Generated Text: 7:
Aha, we have good result!

I'm sorry for the inconvenience. I'll try to get back to you as soon as possible.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 12:46:53,886 [INFO] Generated Text: 8:
Aha, we have good result!

The game is a bit of a mess. The first few levels are pretty boring, but the rest of the game is fun and challenging. I've played it on my own for about 5 hours and it's still not bad. It's
--------------------------------------------------------------------------------
2025-01-15 12:47:20,587 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:20,593 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:20,595 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:20,601 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:24,467 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:24,469 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:24,470 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:24,471 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:28,147 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:28,148 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:28,149 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:28,150 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:31,817 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:31,818 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:31,819 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:31,820 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:35,419 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:35,420 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:35,420 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:35,421 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:38,941 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:38,941 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:38,942 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:38,943 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:42,459 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:42,460 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:47:42,460 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:47:42,461 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:13,493 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:13,500 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:13,501 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:13,507 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:17,325 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:17,326 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:17,327 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:17,329 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:21,111 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:21,112 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:21,113 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:21,115 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:24,685 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:24,685 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:24,686 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:24,686 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:28,271 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:28,272 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:28,272 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:28,273 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:31,748 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:31,749 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:31,749 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:31,749 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:35,291 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:35,292 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 12:57:35,292 [INFO] Computing steering vectors using method: val_mul
2025-01-15 12:57:35,293 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:00:09,783 [INFO] Example prompt: Aha, we have good result!
2025-01-15 13:00:09,785 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:00:09,796 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:00:09,799 [INFO] Generating texts **without** steering... 
2025-01-15 13:00:11,695 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that the team is a bit of a mess. We've had some issues with the team and they're not doing well. I think it's time to get back to work on our new system and make sure
--------------------------------------------------------------------------------
2025-01-15 13:00:11,696 [INFO] Generated Text: 2:
Aha, we have good result!

We are happy to announce that the first season of the show will be available on Netflix in the US and Canada. The series is based on a story by writer/director J.K. Rowling, who has written several books about magic and
--------------------------------------------------------------------------------
2025-01-15 13:00:11,696 [INFO] Generated Text: 3:
Aha, we have good result!

The following is a list of the most popular results from our poll. The results are based on a total of 1,811 votes.

The following is a list of the most popular results from our poll. The results are based
--------------------------------------------------------------------------------
2025-01-15 13:00:11,696 [INFO] Generated Text: 4:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the fact that I've been working on this for a while now. It's been a long time since I've done anything like this, but it was something
--------------------------------------------------------------------------------
2025-01-15 13:00:11,697 [INFO] Generated Text: 5:
Aha, we have good result!

I'm not sure if you can say that. I think it's because of the fact that we're in a different world. We're in a different time and place. We're not going to be able to do anything about it,
--------------------------------------------------------------------------------
2025-01-15 13:00:11,697 [INFO] Generated Text: 6:
Aha, we have good result!

I'm sure you'll agree that the team is very happy with the results. We are looking forward to working with you and our fans in a new way.

Thank you for your time and support.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 13:00:11,698 [INFO] Generated Text: 7:
Aha, we have good result!

We are happy to announce that the first season of The Last of Us is now available on PlayStation 4 and Xbox One. The game will be available for download on November 17th, 2017.

The Last of Us is a fast paced
--------------------------------------------------------------------------------
2025-01-15 13:00:11,699 [INFO] Generated Text: 8:
Aha, we have good result!

"I'm happy to see you!"

"Thank you for your help. I'll be back soon."

The two of them went out into the forest and found a large tree with a huge head. It was a small
--------------------------------------------------------------------------------
2025-01-15 13:00:11,699 [INFO] 干预之后的结果
干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 13:00:11,700 [INFO] ** Generating texts with steering... Target **
2025-01-15 13:00:13,589 [INFO] Generated Text: 1:
Aha, we have good result!

But I'm not sure if you can make it.

I'm just going to say that this is a great gift and I hope you enjoy it as much as I do.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 13:00:13,589 [INFO] Generated Text: 2:
Aha, we have good result!

But I'm not sure if you can do it with a little bit of extra work. It's just that I don't think it's really worth the effort.

I've been using this for about a month now and I've
--------------------------------------------------------------------------------
2025-01-15 13:00:13,589 [INFO] Generated Text: 3:
Aha, we have good result!

But I'm not sure if you can do it with a simple twist of the wrist. I think it's just that the way you do things is so much more effective than doing something with a finger. It's just that you're able
--------------------------------------------------------------------------------
2025-01-15 13:00:13,590 [INFO] Generated Text: 4:
Aha, we have good result!

But I'm not sure if you can make it.

I'm just going to say that this is a great book and I hope you enjoy it. It's a very simple but very well written story and I think it will be
--------------------------------------------------------------------------------
2025-01-15 13:00:13,590 [INFO] Generated Text: 5:
Aha, we have good result!

But I'm not sure if you can make it through the whole process. I think you'll be able to do it by yourself, but if you're a little bit more adventurous and want to try something different, then this is a great
--------------------------------------------------------------------------------
2025-01-15 13:00:13,590 [INFO] Generated Text: 6:
Aha, we have good result!

But I'm not sure if you can do it with a little bit of patience. I've been using this for about 3 months now and it's really easy to use. It's just so simple to make and so easy to put together
--------------------------------------------------------------------------------
2025-01-15 13:00:13,591 [INFO] Generated Text: 7:
Aha, we have good result!

But I'm not sure if you can make it. I think you're going to need a little more work on this one.

I'm sorry, but I don't know how to do this. But if you can do it
--------------------------------------------------------------------------------
2025-01-15 13:00:13,592 [INFO] Generated Text: 8:
Aha, we have good result!

But I'm not sure if you can make it through the first round of rounds without a little help from your friends.

I've been looking for a great pair of shoes that will fit me perfectly and I've found them at the
--------------------------------------------------------------------------------
2025-01-15 13:00:54,956 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:00:54,962 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:00:54,964 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:00:54,970 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:00:58,713 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:00:58,715 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:00:58,716 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:00:58,717 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:02,276 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:02,277 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:02,278 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:02,280 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:05,821 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:05,822 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:05,823 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:05,824 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:09,358 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:09,359 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:09,360 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:09,360 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:12,878 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:12,879 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:12,880 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:12,882 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:16,559 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:16,559 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:01:16,560 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:01:16,561 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:23,070 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:23,077 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:23,078 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:23,085 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:26,868 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:26,869 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:26,870 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:26,872 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:30,401 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:30,402 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:30,402 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:30,404 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:33,885 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:33,886 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:33,887 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:33,887 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:37,360 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:37,361 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:37,362 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:37,362 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:40,850 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:40,850 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:40,851 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:40,851 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:44,338 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:44,339 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:02:44,339 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:02:44,340 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:38:17,899 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 13:38:17,901 [INFO] Hyperparameters:
2025-01-15 13:38:17,903 [INFO]   layer: 6
2025-01-15 13:38:17,905 [INFO]   LLM: gpt2-small
2025-01-15 13:38:17,906 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 13:38:17,907 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 13:38:17,908 [INFO]   output_dir: ./results
2025-01-15 13:38:17,909 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 13:38:17,911 [INFO]   task: sentiment
2025-01-15 13:38:17,912 [INFO]   seed: 42
2025-01-15 13:38:17,913 [INFO]   data_size: 1000
2025-01-15 13:38:17,915 [INFO]   device: cpu
2025-01-15 13:38:17,916 [INFO]   alpha: 100
2025-01-15 13:38:17,917 [INFO]   steer: pos-neg
2025-01-15 13:38:17,918 [INFO]   method: val_mul
2025-01-15 13:38:17,920 [INFO]   topk_mean: 100
2025-01-15 13:38:17,921 [INFO]   topk_cnt: 100
2025-01-15 13:38:17,922 [INFO]   batch_size: 32
2025-01-15 13:38:20,746 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 13:38:55,174 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 13:38:55,177 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 13:38:55,180 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 13:38:55,373 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 13:38:55,385 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 13:39:15,123 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 13:39:17,732 [INFO] Hyperparameters:
2025-01-15 13:39:17,747 [INFO]   layer: 6
2025-01-15 13:39:17,749 [INFO]   LLM: gpt2-small
2025-01-15 13:39:17,750 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 13:39:17,751 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 13:39:17,753 [INFO]   output_dir: ./results
2025-01-15 13:39:17,754 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 13:39:17,755 [INFO]   task: sentiment
2025-01-15 13:39:17,757 [INFO]   seed: 42
2025-01-15 13:39:17,758 [INFO]   data_size: 1000
2025-01-15 13:39:17,760 [INFO]   device: cpu
2025-01-15 13:39:17,761 [INFO]   alpha: 100
2025-01-15 13:39:17,762 [INFO]   steer: pos-neg
2025-01-15 13:39:17,763 [INFO]   method: val_mul
2025-01-15 13:39:17,764 [INFO]   topk_mean: 100
2025-01-15 13:39:17,766 [INFO]   topk_cnt: 100
2025-01-15 13:39:17,767 [INFO]   batch_size: 32
2025-01-15 13:39:17,769 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 13:39:17,770 [INFO] Loading model: gpt2-small
2025-01-15 13:39:58,544 [INFO] Loading SAE for layer 6
2025-01-15 13:43:43,141 [INFO] pos-neg
2025-01-15 13:43:43,180 [INFO] Running model with cache to obtain hidden states
2025-01-15 13:43:43,569 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 13:43:43,570 [INFO] Encoding hidden states for batch 1
2025-01-15 13:43:44,017 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:43:44,019 [INFO] Encoding hidden states for batch 2
2025-01-15 13:43:44,344 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 13:43:44,346 [INFO] Encoding hidden states for batch 3
2025-01-15 13:43:44,674 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 13:43:44,676 [INFO] Encoding hidden states for batch 4
2025-01-15 13:43:44,995 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 13:43:44,996 [INFO] Encoding hidden states for batch 5
2025-01-15 13:43:45,300 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:43:45,302 [INFO] Encoding hidden states for batch 6
2025-01-15 13:43:45,586 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 13:43:45,587 [INFO] Encoding hidden states for batch 7
2025-01-15 13:43:45,849 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 13:43:45,850 [INFO] Encoding hidden states for batch 8
2025-01-15 13:43:46,121 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:43:46,122 [INFO] Encoding hidden states for batch 9
2025-01-15 13:43:46,426 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 13:43:46,427 [INFO] Encoding hidden states for batch 10
2025-01-15 13:43:47,095 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 13:43:47,096 [INFO] Encoding hidden states for batch 11
2025-01-15 13:43:47,822 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 13:43:47,824 [INFO] Encoding hidden states for batch 12
2025-01-15 13:43:48,182 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:43:48,184 [INFO] Encoding hidden states for batch 13
2025-01-15 13:43:48,502 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 13:43:48,503 [INFO] Encoding hidden states for batch 14
2025-01-15 13:43:48,752 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 13:43:48,753 [INFO] Encoding hidden states for batch 15
2025-01-15 13:43:48,985 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 13:43:48,986 [INFO] Encoding hidden states for batch 16
2025-01-15 13:43:49,233 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:43:49,235 [INFO] Encoding hidden states for batch 17
2025-01-15 13:43:49,498 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:43:49,500 [INFO] Encoding hidden states for batch 18
2025-01-15 13:43:49,768 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:43:49,770 [INFO] Encoding hidden states for batch 19
2025-01-15 13:43:50,097 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 13:43:50,099 [INFO] Encoding hidden states for batch 20
2025-01-15 13:43:50,449 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:43:50,450 [INFO] Encoding hidden states for batch 21
2025-01-15 13:43:50,784 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 13:43:50,785 [INFO] Encoding hidden states for batch 22
2025-01-15 13:43:51,400 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 13:43:51,401 [INFO] Encoding hidden states for batch 23
2025-01-15 13:43:51,721 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:43:51,722 [INFO] Encoding hidden states for batch 24
2025-01-15 13:43:52,090 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:43:52,091 [INFO] Encoding hidden states for batch 25
2025-01-15 13:43:52,443 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:43:52,444 [INFO] Encoding hidden states for batch 26
2025-01-15 13:43:52,775 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:43:52,776 [INFO] Encoding hidden states for batch 27
2025-01-15 13:43:53,085 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 13:43:53,087 [INFO] Encoding hidden states for batch 28
2025-01-15 13:43:53,373 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:43:53,374 [INFO] Encoding hidden states for batch 29
2025-01-15 13:43:53,638 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 13:43:53,639 [INFO] Encoding hidden states for batch 30
2025-01-15 13:43:53,929 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:43:53,930 [INFO] Encoding hidden states for batch 31
2025-01-15 13:43:54,092 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 13:43:54,093 [INFO] Encoding hidden states for batch 32
2025-01-15 13:43:54,101 [INFO] Total batches processed: 32
2025-01-15 13:43:54,103 [INFO] 最大长度:60
2025-01-15 13:43:54,577 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 13:43:54,578 [INFO] Computing non-zero element counts
2025-01-15 13:43:55,694 [INFO] Computing sum of non-zero elements
2025-01-15 13:43:56,292 [INFO] Computing mean of non-zero elements
2025-01-15 13:43:56,293 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 13:43:56,294 [INFO] Top 100 nz_mean values selected.
2025-01-15 13:43:56,294 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 13:43:56,294 [INFO] Top 100 act_cnt values selected.
2025-01-15 13:43:56,901 [INFO] Running model with cache to obtain hidden states
2025-01-15 13:43:57,253 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-15 13:43:57,254 [INFO] Encoding hidden states for batch 1
2025-01-15 13:43:57,602 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:43:57,603 [INFO] Encoding hidden states for batch 2
2025-01-15 13:43:57,909 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:43:57,910 [INFO] Encoding hidden states for batch 3
2025-01-15 13:43:58,229 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 13:43:58,230 [INFO] Encoding hidden states for batch 4
2025-01-15 13:43:58,499 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-15 13:43:58,500 [INFO] Encoding hidden states for batch 5
2025-01-15 13:43:58,756 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:43:58,757 [INFO] Encoding hidden states for batch 6
2025-01-15 13:43:59,030 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:43:59,031 [INFO] Encoding hidden states for batch 7
2025-01-15 13:43:59,344 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:43:59,345 [INFO] Encoding hidden states for batch 8
2025-01-15 13:43:59,674 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:43:59,675 [INFO] Encoding hidden states for batch 9
2025-01-15 13:44:00,007 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 13:44:00,008 [INFO] Encoding hidden states for batch 10
2025-01-15 13:44:00,315 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 13:44:00,316 [INFO] Encoding hidden states for batch 11
2025-01-15 13:44:00,616 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:44:00,617 [INFO] Encoding hidden states for batch 12
2025-01-15 13:44:00,895 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:00,896 [INFO] Encoding hidden states for batch 13
2025-01-15 13:44:01,158 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:44:01,160 [INFO] Encoding hidden states for batch 14
2025-01-15 13:44:01,433 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:44:01,434 [INFO] Encoding hidden states for batch 15
2025-01-15 13:44:01,714 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:44:01,716 [INFO] Encoding hidden states for batch 16
2025-01-15 13:44:01,997 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 13:44:01,998 [INFO] Encoding hidden states for batch 17
2025-01-15 13:44:02,275 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:44:02,277 [INFO] Encoding hidden states for batch 18
2025-01-15 13:44:02,580 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:44:02,581 [INFO] Encoding hidden states for batch 19
2025-01-15 13:44:02,941 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 13:44:02,943 [INFO] Encoding hidden states for batch 20
2025-01-15 13:44:03,228 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:44:03,229 [INFO] Encoding hidden states for batch 21
2025-01-15 13:44:03,501 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:44:03,502 [INFO] Encoding hidden states for batch 22
2025-01-15 13:44:03,841 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 13:44:03,842 [INFO] Encoding hidden states for batch 23
2025-01-15 13:44:04,146 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 13:44:04,148 [INFO] Encoding hidden states for batch 24
2025-01-15 13:44:04,454 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:44:04,456 [INFO] Encoding hidden states for batch 25
2025-01-15 13:44:04,730 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 13:44:04,732 [INFO] Encoding hidden states for batch 26
2025-01-15 13:44:05,022 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:44:05,023 [INFO] Encoding hidden states for batch 27
2025-01-15 13:44:05,287 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 13:44:05,289 [INFO] Encoding hidden states for batch 28
2025-01-15 13:44:05,552 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 13:44:05,554 [INFO] Encoding hidden states for batch 29
2025-01-15 13:44:05,802 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 13:44:05,804 [INFO] Encoding hidden states for batch 30
2025-01-15 13:44:06,104 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 13:44:06,106 [INFO] Encoding hidden states for batch 31
2025-01-15 13:44:06,290 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-15 13:44:06,291 [INFO] Encoding hidden states for batch 32
2025-01-15 13:44:06,301 [INFO] Total batches processed: 32
2025-01-15 13:44:06,304 [INFO] 最大长度:59
2025-01-15 13:44:06,748 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-15 13:44:06,749 [INFO] Computing non-zero element counts
2025-01-15 13:44:07,848 [INFO] Computing sum of non-zero elements
2025-01-15 13:44:08,422 [INFO] Computing mean of non-zero elements
2025-01-15 13:44:08,424 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 13:44:08,425 [INFO] Top 100 nz_mean values selected.
2025-01-15 13:44:08,426 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 13:44:08,427 [INFO] Top 100 act_cnt values selected.
2025-01-15 13:44:08,993 [INFO] Running model with cache to obtain hidden states
2025-01-15 13:44:09,315 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-15 13:44:09,316 [INFO] Encoding hidden states for batch 1
2025-01-15 13:44:09,685 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 13:44:09,687 [INFO] Encoding hidden states for batch 2
2025-01-15 13:44:09,976 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:09,977 [INFO] Encoding hidden states for batch 3
2025-01-15 13:44:10,267 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:44:10,269 [INFO] Encoding hidden states for batch 4
2025-01-15 13:44:10,548 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:10,550 [INFO] Encoding hidden states for batch 5
2025-01-15 13:44:10,853 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 13:44:10,855 [INFO] Encoding hidden states for batch 6
2025-01-15 13:44:11,148 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 13:44:11,149 [INFO] Encoding hidden states for batch 7
2025-01-15 13:44:11,423 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 13:44:11,424 [INFO] Encoding hidden states for batch 8
2025-01-15 13:44:11,696 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:11,698 [INFO] Encoding hidden states for batch 9
2025-01-15 13:44:11,992 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 13:44:11,994 [INFO] Encoding hidden states for batch 10
2025-01-15 13:44:12,262 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-15 13:44:12,263 [INFO] Encoding hidden states for batch 11
2025-01-15 13:44:12,570 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 13:44:12,572 [INFO] Encoding hidden states for batch 12
2025-01-15 13:44:12,865 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 13:44:12,866 [INFO] Encoding hidden states for batch 13
2025-01-15 13:44:13,146 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 13:44:13,148 [INFO] Encoding hidden states for batch 14
2025-01-15 13:44:13,422 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:44:13,424 [INFO] Encoding hidden states for batch 15
2025-01-15 13:44:13,746 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 13:44:13,748 [INFO] Encoding hidden states for batch 16
2025-01-15 13:44:14,059 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 13:44:14,061 [INFO] Encoding hidden states for batch 17
2025-01-15 13:44:14,341 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:14,343 [INFO] Encoding hidden states for batch 18
2025-01-15 13:44:14,664 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:44:14,666 [INFO] Encoding hidden states for batch 19
2025-01-15 13:44:14,958 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:44:14,959 [INFO] Encoding hidden states for batch 20
2025-01-15 13:44:15,302 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 13:44:15,303 [INFO] Encoding hidden states for batch 21
2025-01-15 13:44:15,584 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 13:44:15,585 [INFO] Encoding hidden states for batch 22
2025-01-15 13:44:15,916 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 13:44:15,917 [INFO] Encoding hidden states for batch 23
2025-01-15 13:44:16,211 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 13:44:16,213 [INFO] Encoding hidden states for batch 24
2025-01-15 13:44:16,484 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:44:16,486 [INFO] Encoding hidden states for batch 25
2025-01-15 13:44:16,802 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 13:44:16,803 [INFO] Encoding hidden states for batch 26
2025-01-15 13:44:17,080 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 13:44:17,081 [INFO] Encoding hidden states for batch 27
2025-01-15 13:44:17,370 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 13:44:17,372 [INFO] Encoding hidden states for batch 28
2025-01-15 13:44:17,663 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 13:44:17,664 [INFO] Encoding hidden states for batch 29
2025-01-15 13:44:17,961 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 13:44:17,963 [INFO] Encoding hidden states for batch 30
2025-01-15 13:44:18,243 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 13:44:18,245 [INFO] Encoding hidden states for batch 31
2025-01-15 13:44:18,431 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-15 13:44:18,432 [INFO] Encoding hidden states for batch 32
2025-01-15 13:44:18,443 [INFO] Total batches processed: 32
2025-01-15 13:44:18,446 [INFO] 最大长度:76
2025-01-15 13:44:18,990 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-15 13:44:18,991 [INFO] Computing non-zero element counts
2025-01-15 13:44:20,292 [INFO] Computing sum of non-zero elements
2025-01-15 13:44:20,988 [INFO] Computing mean of non-zero elements
2025-01-15 13:44:20,990 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 13:44:20,991 [INFO] Top 100 nz_mean values selected.
2025-01-15 13:44:20,992 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 13:44:20,993 [INFO] Top 100 act_cnt values selected.
2025-01-15 13:44:59,708 [INFO] Example prompt: Aha, we have good result!
2025-01-15 13:44:59,710 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:44:59,723 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:44:59,724 [INFO] Generating texts **without** steering... 
2025-01-15 13:45:01,833 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that the next time you're in a hurry, you should take a look at your phone. It's very easy to forget about it. But if it's not there, then why bother?

The
--------------------------------------------------------------------------------
2025-01-15 13:45:01,833 [INFO] Generated Text: 2:
Aha, we have good result!

The next day, I went to the office and told them that I was going to go to the gym. They said they would be happy with me. So I went there and did a workout for them. It was really good!

--------------------------------------------------------------------------------
2025-01-15 13:45:01,834 [INFO] Generated Text: 3:
Aha, we have good result!

The first time I saw the new version of this game was in a local store. It was a bit of a disappointment to see that it had been updated with some new features and features that were not available on the original version. The only
--------------------------------------------------------------------------------
2025-01-15 13:45:01,834 [INFO] Generated Text: 4:
Aha, we have good result!

The other day I was talking to a friend of mine who is a student at the University of California, Berkeley. He said that he has been working on his dissertation on the concept of 'social justice' and how it can be applied to
--------------------------------------------------------------------------------
2025-01-15 13:45:01,834 [INFO] Generated Text: 5:
Aha, we have good result!

We are happy to announce that the new game is now available for download on Steam. It's a great way to get your hands on the latest and greatest in games from our community. We've also added some cool features like a new '
--------------------------------------------------------------------------------
2025-01-15 13:45:01,835 [INFO] Generated Text: 6:
Aha, we have good result!

The only problem is that the team has to play a lot of games. We are not playing in the same league as other teams. We are playing in different leagues and it's hard for us to play at the same level. It's
--------------------------------------------------------------------------------
2025-01-15 13:45:01,836 [INFO] Generated Text: 7:
Aha, we have good result!

I'm sure you'll agree that the game is a bit of a mess. The graphics are poor, the sound is bad and there's no way to play it. I've played it on my PS4 and Xbox One but I can
--------------------------------------------------------------------------------
2025-01-15 13:45:01,836 [INFO] Generated Text: 8:
Aha, we have good result!

"I'm happy to see you again. I hope you're well."

"Yes, I am. Thank you for your time."

"Thank you for your time. It's been a long day and it's been
--------------------------------------------------------------------------------
2025-01-15 13:45:01,837 [INFO] 干预之后的结果
干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 13:45:01,838 [INFO] ** Generating texts with steering... Target **
2025-01-15 13:45:03,796 [INFO] Generated Text: 1:
Aha, we have good result!

But I'm not sure if you can make it.

I'm just going to say that this is a great book and I hope you enjoy it. It's very well written and well thought out but I think it's worth reading
--------------------------------------------------------------------------------
2025-01-15 13:45:03,797 [INFO] Generated Text: 2:
Aha, we have good result!

But I'm not sure if you can do it with a simple string. It's just too hard to get the right answer. But I think this is a great way to start and make your own.

I've been using this
--------------------------------------------------------------------------------
2025-01-15 13:45:03,797 [INFO] Generated Text: 3:
Aha, we have good result!

But I'm not sure if you can make it through the first round of the tournament. I'm sure you'll be able to finish but I don't think that's going to be enough.

I know that this is a very
--------------------------------------------------------------------------------
2025-01-15 13:45:03,797 [INFO] Generated Text: 4:
Aha, we have good result!

But I'm not sure if you can do it with a little bit of extra work. I've been using this for about 3 months now and it's working great. It's just a matter of getting the right balance between weight and speed
--------------------------------------------------------------------------------
2025-01-15 13:45:03,797 [INFO] Generated Text: 5:
Aha, we have good result!

But I'm not sure if you can make it. I'm just trying to figure out what's the best way to do this.

I've got a few ideas for you, but I think it's worth mentioning that there are
--------------------------------------------------------------------------------
2025-01-15 13:45:03,798 [INFO] Generated Text: 6:
Aha, we have good result!

But I'm not sure if you can make it.

I'm just going to say that this is a great gift and I hope you enjoy it as much as I do.<|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|><|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 13:45:03,799 [INFO] Generated Text: 7:
Aha, we have good result!

But I'm not sure if you can make it through the first round of the tournament. I'm sure you'll be able to finish but I don't think that's going to be enough.

I know that there are some people
--------------------------------------------------------------------------------
2025-01-15 13:45:03,799 [INFO] Generated Text: 8:
Aha, we have good result!

But I'm not sure if you can do it with a simple twist of the wrist. It's just that you need to be able to pull it off and hold it in place. It's a great way to make your fingers feel like
--------------------------------------------------------------------------------
2025-01-15 13:45:17,461 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:17,467 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:17,468 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:17,473 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:21,423 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:21,424 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:21,425 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:21,427 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:25,280 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:25,281 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:25,282 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:25,283 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:29,091 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:29,092 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:29,092 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:29,094 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:32,858 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:32,859 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:32,860 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:32,861 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:36,621 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:36,622 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:36,622 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:36,624 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:40,379 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:40,380 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:45:40,380 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:45:40,381 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:40,459 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:40,465 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:40,467 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:40,473 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:44,585 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:44,586 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:44,587 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:44,589 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:48,440 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:48,442 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:48,443 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:48,445 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:52,262 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:52,263 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:52,263 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:52,264 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:56,087 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:56,088 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:56,089 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:56,090 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:59,908 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:59,909 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:46:59,909 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:46:59,911 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:03,656 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:03,657 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:03,658 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:03,659 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:48,733 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:48,740 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:48,742 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:48,748 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:52,752 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:52,753 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:52,754 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:52,756 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:56,541 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:56,543 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:47:56,543 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:47:56,545 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:00,378 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:00,379 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:00,380 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:00,381 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:04,106 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:04,108 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:04,110 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:04,111 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:07,845 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:07,846 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:07,846 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:07,847 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:11,554 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:11,555 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 13:48:11,556 [INFO] Computing steering vectors using method: val_mul
2025-01-15 13:48:11,556 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 19:59:02,716 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 19:59:02,718 [INFO] Hyperparameters:
2025-01-15 19:59:02,719 [INFO]   layer: 6
2025-01-15 19:59:02,721 [INFO]   LLM: gpt2-small
2025-01-15 19:59:02,723 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 19:59:02,724 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 19:59:02,725 [INFO]   output_dir: ./results
2025-01-15 19:59:02,726 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 19:59:02,727 [INFO]   task: sentiment
2025-01-15 19:59:02,728 [INFO]   seed: 42
2025-01-15 19:59:02,729 [INFO]   data_size: 1000
2025-01-15 19:59:02,730 [INFO]   device: cpu
2025-01-15 19:59:02,731 [INFO]   alpha: 100
2025-01-15 19:59:02,731 [INFO]   steer: pos-neg
2025-01-15 19:59:02,732 [INFO]   method: val_mul
2025-01-15 19:59:02,733 [INFO]   topk_mean: 100
2025-01-15 19:59:02,735 [INFO]   topk_cnt: 100
2025-01-15 19:59:02,736 [INFO]   batch_size: 32
2025-01-15 19:59:06,332 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 19:59:14,239 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 19:59:14,241 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 19:59:14,244 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 19:59:14,438 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 19:59:14,449 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 19:59:34,008 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 19:59:36,997 [INFO] Hyperparameters:
2025-01-15 19:59:36,999 [INFO]   layer: 6
2025-01-15 19:59:37,016 [INFO]   LLM: gpt2-small
2025-01-15 19:59:37,018 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 19:59:37,018 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 19:59:37,019 [INFO]   output_dir: ./results
2025-01-15 19:59:37,021 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 19:59:37,022 [INFO]   task: sentiment
2025-01-15 19:59:37,023 [INFO]   seed: 42
2025-01-15 19:59:37,024 [INFO]   data_size: 1000
2025-01-15 19:59:37,024 [INFO]   device: cpu
2025-01-15 19:59:37,025 [INFO]   alpha: 100
2025-01-15 19:59:37,026 [INFO]   steer: pos-neg
2025-01-15 19:59:37,027 [INFO]   method: val_mul
2025-01-15 19:59:37,028 [INFO]   topk_mean: 100
2025-01-15 19:59:37,030 [INFO]   topk_cnt: 100
2025-01-15 19:59:37,031 [INFO]   batch_size: 32
2025-01-15 19:59:37,033 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 19:59:37,034 [INFO] Loading model: gpt2-small
2025-01-15 20:00:17,909 [INFO] Loading SAE for layer 6
2025-01-15 20:00:49,347 [INFO] pos-neg
2025-01-15 20:00:49,376 [INFO] Running model with cache to obtain hidden states
2025-01-15 20:00:49,764 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 20:00:49,765 [INFO] Encoding hidden states for batch 1
2025-01-15 20:00:50,191 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:00:50,192 [INFO] Encoding hidden states for batch 2
2025-01-15 20:00:50,504 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 20:00:50,506 [INFO] Encoding hidden states for batch 3
2025-01-15 20:00:50,818 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 20:00:50,820 [INFO] Encoding hidden states for batch 4
2025-01-15 20:00:51,114 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 20:00:51,115 [INFO] Encoding hidden states for batch 5
2025-01-15 20:00:51,395 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:00:51,396 [INFO] Encoding hidden states for batch 6
2025-01-15 20:00:51,695 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 20:00:51,697 [INFO] Encoding hidden states for batch 7
2025-01-15 20:00:51,956 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 20:00:51,958 [INFO] Encoding hidden states for batch 8
2025-01-15 20:00:52,217 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:00:52,219 [INFO] Encoding hidden states for batch 9
2025-01-15 20:00:52,538 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 20:00:52,540 [INFO] Encoding hidden states for batch 10
2025-01-15 20:00:52,868 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 20:00:52,870 [INFO] Encoding hidden states for batch 11
2025-01-15 20:00:53,243 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 20:00:53,245 [INFO] Encoding hidden states for batch 12
2025-01-15 20:00:53,618 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:00:53,619 [INFO] Encoding hidden states for batch 13
2025-01-15 20:00:53,950 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 20:00:53,951 [INFO] Encoding hidden states for batch 14
2025-01-15 20:00:54,236 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 20:00:54,238 [INFO] Encoding hidden states for batch 15
2025-01-15 20:00:54,462 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 20:00:54,464 [INFO] Encoding hidden states for batch 16
2025-01-15 20:00:54,708 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:00:54,709 [INFO] Encoding hidden states for batch 17
2025-01-15 20:00:54,973 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:00:54,974 [INFO] Encoding hidden states for batch 18
2025-01-15 20:00:55,250 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:00:55,251 [INFO] Encoding hidden states for batch 19
2025-01-15 20:00:55,604 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 20:00:55,606 [INFO] Encoding hidden states for batch 20
2025-01-15 20:00:55,953 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:00:55,954 [INFO] Encoding hidden states for batch 21
2025-01-15 20:00:56,316 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 20:00:56,317 [INFO] Encoding hidden states for batch 22
2025-01-15 20:00:56,609 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 20:00:56,611 [INFO] Encoding hidden states for batch 23
2025-01-15 20:00:56,889 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:00:56,890 [INFO] Encoding hidden states for batch 24
2025-01-15 20:00:57,189 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:00:57,190 [INFO] Encoding hidden states for batch 25
2025-01-15 20:00:57,512 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:00:57,514 [INFO] Encoding hidden states for batch 26
2025-01-15 20:00:57,807 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:00:57,808 [INFO] Encoding hidden states for batch 27
2025-01-15 20:00:58,261 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 20:00:58,262 [INFO] Encoding hidden states for batch 28
2025-01-15 20:00:58,547 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:00:58,549 [INFO] Encoding hidden states for batch 29
2025-01-15 20:00:58,843 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 20:00:58,845 [INFO] Encoding hidden states for batch 30
2025-01-15 20:00:59,128 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:00:59,130 [INFO] Encoding hidden states for batch 31
2025-01-15 20:00:59,315 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 20:00:59,316 [INFO] Encoding hidden states for batch 32
2025-01-15 20:00:59,325 [INFO] Total batches processed: 32
2025-01-15 20:00:59,327 [INFO] 最大长度:60
2025-01-15 20:00:59,759 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 20:00:59,760 [INFO] Computing non-zero element counts
2025-01-15 20:01:00,865 [INFO] Computing sum of non-zero elements
2025-01-15 20:01:01,447 [INFO] Computing mean of non-zero elements
2025-01-15 20:01:01,447 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 20:01:01,449 [INFO] Top 100 nz_mean values selected.
2025-01-15 20:01:01,449 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 20:01:01,450 [INFO] Top 100 act_cnt values selected.
2025-01-15 20:01:02,006 [INFO] Running model with cache to obtain hidden states
2025-01-15 20:01:02,278 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-15 20:01:02,279 [INFO] Encoding hidden states for batch 1
2025-01-15 20:01:02,601 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:01:02,602 [INFO] Encoding hidden states for batch 2
2025-01-15 20:01:02,894 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:01:02,895 [INFO] Encoding hidden states for batch 3
2025-01-15 20:01:03,180 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 20:01:03,181 [INFO] Encoding hidden states for batch 4
2025-01-15 20:01:03,448 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-15 20:01:03,449 [INFO] Encoding hidden states for batch 5
2025-01-15 20:01:03,714 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:03,715 [INFO] Encoding hidden states for batch 6
2025-01-15 20:01:03,995 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:03,996 [INFO] Encoding hidden states for batch 7
2025-01-15 20:01:04,290 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:01:04,291 [INFO] Encoding hidden states for batch 8
2025-01-15 20:01:04,618 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:01:04,619 [INFO] Encoding hidden states for batch 9
2025-01-15 20:01:04,951 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 20:01:04,952 [INFO] Encoding hidden states for batch 10
2025-01-15 20:01:05,264 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 20:01:05,265 [INFO] Encoding hidden states for batch 11
2025-01-15 20:01:05,576 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:01:05,577 [INFO] Encoding hidden states for batch 12
2025-01-15 20:01:05,871 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:05,872 [INFO] Encoding hidden states for batch 13
2025-01-15 20:01:06,152 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:01:06,153 [INFO] Encoding hidden states for batch 14
2025-01-15 20:01:06,428 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:01:06,429 [INFO] Encoding hidden states for batch 15
2025-01-15 20:01:06,720 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:01:06,721 [INFO] Encoding hidden states for batch 16
2025-01-15 20:01:06,990 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 20:01:06,991 [INFO] Encoding hidden states for batch 17
2025-01-15 20:01:07,292 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:01:07,293 [INFO] Encoding hidden states for batch 18
2025-01-15 20:01:07,614 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:01:07,616 [INFO] Encoding hidden states for batch 19
2025-01-15 20:01:07,983 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 20:01:07,984 [INFO] Encoding hidden states for batch 20
2025-01-15 20:01:08,273 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:01:08,274 [INFO] Encoding hidden states for batch 21
2025-01-15 20:01:08,552 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:08,554 [INFO] Encoding hidden states for batch 22
2025-01-15 20:01:08,898 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 20:01:08,899 [INFO] Encoding hidden states for batch 23
2025-01-15 20:01:09,212 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 20:01:09,214 [INFO] Encoding hidden states for batch 24
2025-01-15 20:01:09,534 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:01:09,535 [INFO] Encoding hidden states for batch 25
2025-01-15 20:01:09,824 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 20:01:09,825 [INFO] Encoding hidden states for batch 26
2025-01-15 20:01:10,120 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:01:10,122 [INFO] Encoding hidden states for batch 27
2025-01-15 20:01:10,397 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 20:01:10,398 [INFO] Encoding hidden states for batch 28
2025-01-15 20:01:10,685 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 20:01:10,686 [INFO] Encoding hidden states for batch 29
2025-01-15 20:01:10,941 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 20:01:10,943 [INFO] Encoding hidden states for batch 30
2025-01-15 20:01:11,258 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 20:01:11,260 [INFO] Encoding hidden states for batch 31
2025-01-15 20:01:11,452 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-15 20:01:11,453 [INFO] Encoding hidden states for batch 32
2025-01-15 20:01:11,463 [INFO] Total batches processed: 32
2025-01-15 20:01:11,466 [INFO] 最大长度:59
2025-01-15 20:01:11,892 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-15 20:01:11,893 [INFO] Computing non-zero element counts
2025-01-15 20:01:12,958 [INFO] Computing sum of non-zero elements
2025-01-15 20:01:13,509 [INFO] Computing mean of non-zero elements
2025-01-15 20:01:13,510 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 20:01:13,511 [INFO] Top 100 nz_mean values selected.
2025-01-15 20:01:13,512 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 20:01:13,513 [INFO] Top 100 act_cnt values selected.
2025-01-15 20:01:14,059 [INFO] Running model with cache to obtain hidden states
2025-01-15 20:01:14,398 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-15 20:01:14,399 [INFO] Encoding hidden states for batch 1
2025-01-15 20:01:14,777 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 20:01:14,778 [INFO] Encoding hidden states for batch 2
2025-01-15 20:01:15,079 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:15,081 [INFO] Encoding hidden states for batch 3
2025-01-15 20:01:15,371 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:01:15,373 [INFO] Encoding hidden states for batch 4
2025-01-15 20:01:15,658 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:15,659 [INFO] Encoding hidden states for batch 5
2025-01-15 20:01:15,941 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 20:01:15,942 [INFO] Encoding hidden states for batch 6
2025-01-15 20:01:16,239 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 20:01:16,241 [INFO] Encoding hidden states for batch 7
2025-01-15 20:01:16,515 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 20:01:16,517 [INFO] Encoding hidden states for batch 8
2025-01-15 20:01:16,799 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:16,800 [INFO] Encoding hidden states for batch 9
2025-01-15 20:01:17,104 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 20:01:17,106 [INFO] Encoding hidden states for batch 10
2025-01-15 20:01:17,368 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-15 20:01:17,369 [INFO] Encoding hidden states for batch 11
2025-01-15 20:01:17,680 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 20:01:17,681 [INFO] Encoding hidden states for batch 12
2025-01-15 20:01:17,985 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 20:01:17,986 [INFO] Encoding hidden states for batch 13
2025-01-15 20:01:18,282 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 20:01:18,284 [INFO] Encoding hidden states for batch 14
2025-01-15 20:01:18,565 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:18,566 [INFO] Encoding hidden states for batch 15
2025-01-15 20:01:18,896 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 20:01:18,897 [INFO] Encoding hidden states for batch 16
2025-01-15 20:01:19,186 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 20:01:19,187 [INFO] Encoding hidden states for batch 17
2025-01-15 20:01:19,452 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:19,454 [INFO] Encoding hidden states for batch 18
2025-01-15 20:01:19,750 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:01:19,751 [INFO] Encoding hidden states for batch 19
2025-01-15 20:01:20,034 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:20,036 [INFO] Encoding hidden states for batch 20
2025-01-15 20:01:20,374 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 20:01:20,375 [INFO] Encoding hidden states for batch 21
2025-01-15 20:01:20,666 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 20:01:20,668 [INFO] Encoding hidden states for batch 22
2025-01-15 20:01:21,004 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 20:01:21,005 [INFO] Encoding hidden states for batch 23
2025-01-15 20:01:21,285 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 20:01:21,286 [INFO] Encoding hidden states for batch 24
2025-01-15 20:01:21,561 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:21,563 [INFO] Encoding hidden states for batch 25
2025-01-15 20:01:21,857 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 20:01:21,859 [INFO] Encoding hidden states for batch 26
2025-01-15 20:01:22,135 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 20:01:22,137 [INFO] Encoding hidden states for batch 27
2025-01-15 20:01:22,441 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 20:01:22,443 [INFO] Encoding hidden states for batch 28
2025-01-15 20:01:22,724 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 20:01:22,725 [INFO] Encoding hidden states for batch 29
2025-01-15 20:01:23,034 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 20:01:23,036 [INFO] Encoding hidden states for batch 30
2025-01-15 20:01:23,310 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 20:01:23,311 [INFO] Encoding hidden states for batch 31
2025-01-15 20:01:23,495 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-15 20:01:23,496 [INFO] Encoding hidden states for batch 32
2025-01-15 20:01:23,507 [INFO] Total batches processed: 32
2025-01-15 20:01:23,510 [INFO] 最大长度:76
2025-01-15 20:01:24,048 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-15 20:01:24,048 [INFO] Computing non-zero element counts
2025-01-15 20:01:25,383 [INFO] Computing sum of non-zero elements
2025-01-15 20:01:26,111 [INFO] Computing mean of non-zero elements
2025-01-15 20:01:26,113 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 20:01:26,114 [INFO] Top 100 nz_mean values selected.
2025-01-15 20:01:26,115 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 20:01:26,116 [INFO] Top 100 act_cnt values selected.
2025-01-15 20:01:27,049 [INFO] Example prompt: Aha, we have good result!
2025-01-15 20:01:27,050 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:01:27,060 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:01:27,062 [INFO] Generating texts **without** steering... 
2025-01-15 20:01:29,243 [INFO] Generated Text: 1:
Aha, we have good result!

We are now in the final stages of our campaign. We will be able to reach the target by mid-October. We will also be able to make a small contribution towards our campaign's budget and support for the team.

Thank you for your support!<|endoftext|>
--------------------------------------------------------------------------------
2025-01-15 20:01:29,245 [INFO] 干预之后的结果
干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 20:01:29,246 [INFO] ** Generating texts with steering... Target **
2025-01-15 20:01:32,177 [INFO] Generated Text: 1:
Aha, we have good result!

But I'm not sure if you can make it through the first round of rounds without a little help from your friends. I've been trying to get my friend to join me on this project for a while now, but he's still not quite ready yet. So here's what you need:

1) A few small scissors (I used mine) and some sharp scissors (I used mine) and a pair of scissors that will fit in your pocket or purse. You'll want
--------------------------------------------------------------------------------
2025-01-15 20:10:49,416 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:10:49,421 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:18:32,795 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:18:32,797 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:25:01,311 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:25:01,313 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:31:25,331 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:31:25,332 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:37:56,243 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:37:56,244 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:44:24,719 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:44:24,720 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:50:54,598 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:50:54,599 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 20:57:29,245 [INFO] Computing steering vectors using method: val_mul
2025-01-15 20:57:29,246 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 21:48:42,350 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 21:48:42,351 [INFO] Hyperparameters:
2025-01-15 21:48:42,353 [INFO]   layer: 6
2025-01-15 21:48:42,354 [INFO]   LLM: gpt2-small
2025-01-15 21:48:42,354 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 21:48:42,355 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 21:48:42,356 [INFO]   output_dir: ./results
2025-01-15 21:48:42,357 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 21:48:42,358 [INFO]   task: sentiment
2025-01-15 21:48:42,359 [INFO]   seed: 42
2025-01-15 21:48:42,359 [INFO]   data_size: 1000
2025-01-15 21:48:42,360 [INFO]   device: cuda
2025-01-15 21:48:42,361 [INFO]   alpha: 100
2025-01-15 21:48:42,362 [INFO]   steer: pos-neg
2025-01-15 21:48:42,365 [INFO]   method: val_mul
2025-01-15 21:48:42,366 [INFO]   topk_mean: 100
2025-01-15 21:48:42,366 [INFO]   topk_cnt: 100
2025-01-15 21:48:42,367 [INFO]   batch_size: 32
2025-01-15 21:48:45,921 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 21:48:52,071 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 21:48:52,073 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 21:48:52,096 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 21:48:52,267 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 21:48:52,282 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 21:49:09,003 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 21:49:11,502 [INFO] Hyperparameters:
2025-01-15 21:49:11,505 [INFO]   layer: 6
2025-01-15 21:49:11,506 [INFO]   LLM: gpt2-small
2025-01-15 21:49:11,507 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 21:49:11,508 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 21:49:11,509 [INFO]   output_dir: ./results
2025-01-15 21:49:11,510 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 21:49:11,511 [INFO]   task: sentiment
2025-01-15 21:49:11,512 [INFO]   seed: 42
2025-01-15 21:49:11,513 [INFO]   data_size: 1000
2025-01-15 21:49:11,515 [INFO]   device: cuda
2025-01-15 21:49:11,516 [INFO]   alpha: 100
2025-01-15 21:49:11,517 [INFO]   steer: pos-neg
2025-01-15 21:49:11,518 [INFO]   method: val_mul
2025-01-15 21:49:11,519 [INFO]   topk_mean: 100
2025-01-15 21:49:11,521 [INFO]   topk_cnt: 100
2025-01-15 21:49:11,521 [INFO]   batch_size: 32
2025-01-15 21:49:11,524 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 21:49:11,525 [INFO] Loading model: gpt2-small
2025-01-15 21:50:07,623 [INFO] Loading SAE for layer 6
2025-01-15 21:53:15,909 [INFO] pos-neg
2025-01-15 21:53:15,917 [INFO] Running model with cache to obtain hidden states
2025-01-15 21:53:17,350 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 21:53:17,351 [INFO] Encoding hidden states for batch 1
2025-01-15 21:53:17,423 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 21:53:17,425 [INFO] Encoding hidden states for batch 2
2025-01-15 21:53:17,467 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 21:53:17,468 [INFO] Encoding hidden states for batch 3
2025-01-15 21:53:17,509 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 21:53:17,511 [INFO] Encoding hidden states for batch 4
2025-01-15 21:53:17,549 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 21:53:17,550 [INFO] Encoding hidden states for batch 5
2025-01-15 21:53:17,587 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 21:53:17,588 [INFO] Encoding hidden states for batch 6
2025-01-15 21:53:17,626 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 21:53:17,628 [INFO] Encoding hidden states for batch 7
2025-01-15 21:53:17,664 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 21:53:17,665 [INFO] Encoding hidden states for batch 8
2025-01-15 21:53:17,701 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 21:53:17,702 [INFO] Encoding hidden states for batch 9
2025-01-15 21:53:17,739 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 21:53:17,740 [INFO] Encoding hidden states for batch 10
2025-01-15 21:53:17,777 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 21:53:17,778 [INFO] Encoding hidden states for batch 11
2025-01-15 21:53:17,821 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 21:53:17,822 [INFO] Encoding hidden states for batch 12
2025-01-15 21:53:17,860 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 21:53:17,861 [INFO] Encoding hidden states for batch 13
2025-01-15 21:53:17,898 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 21:53:17,899 [INFO] Encoding hidden states for batch 14
2025-01-15 21:53:17,935 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 21:53:17,936 [INFO] Encoding hidden states for batch 15
2025-01-15 21:53:17,974 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 21:53:17,975 [INFO] Encoding hidden states for batch 16
2025-01-15 21:53:18,012 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 21:53:18,013 [INFO] Encoding hidden states for batch 17
2025-01-15 21:53:18,049 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 21:53:18,050 [INFO] Encoding hidden states for batch 18
2025-01-15 21:53:18,090 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 21:53:18,091 [INFO] Encoding hidden states for batch 19
2025-01-15 21:53:18,134 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 21:53:18,135 [INFO] Encoding hidden states for batch 20
2025-01-15 21:53:18,172 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 21:53:18,173 [INFO] Encoding hidden states for batch 21
2025-01-15 21:53:18,211 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 21:53:18,212 [INFO] Encoding hidden states for batch 22
2025-01-15 21:53:18,251 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 21:53:18,252 [INFO] Encoding hidden states for batch 23
2025-01-15 21:53:18,289 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 21:53:18,290 [INFO] Encoding hidden states for batch 24
2025-01-15 21:53:18,328 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 21:53:18,329 [INFO] Encoding hidden states for batch 25
2025-01-15 21:53:18,380 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 21:53:18,382 [INFO] Encoding hidden states for batch 26
2025-01-15 21:53:18,421 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 21:53:18,423 [INFO] Encoding hidden states for batch 27
2025-01-15 21:53:18,461 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 21:53:18,462 [INFO] Encoding hidden states for batch 28
2025-01-15 21:53:18,512 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 21:53:18,513 [INFO] Encoding hidden states for batch 29
2025-01-15 21:53:18,551 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 21:53:18,552 [INFO] Encoding hidden states for batch 30
2025-01-15 21:53:19,009 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 21:53:19,011 [INFO] Encoding hidden states for batch 31
2025-01-15 21:53:19,065 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 21:53:19,067 [INFO] Encoding hidden states for batch 32
2025-01-15 21:53:19,069 [INFO] Total batches processed: 32
2025-01-15 21:53:19,071 [INFO] 最大长度:60
2025-01-15 21:53:19,285 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 21:53:19,286 [INFO] Computing non-zero element counts
2025-01-15 21:53:58,399 [INFO] pos-neg
2025-01-15 21:53:58,410 [INFO] Running model with cache to obtain hidden states
2025-01-15 21:53:58,501 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 21:53:58,502 [INFO] Encoding hidden states for batch 1
2025-01-15 21:53:58,582 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 21:53:58,584 [INFO] Encoding hidden states for batch 2
2025-01-15 21:53:58,640 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 21:53:58,641 [INFO] Encoding hidden states for batch 3
2025-01-15 21:53:58,686 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 21:53:58,687 [INFO] Encoding hidden states for batch 4
2025-01-15 21:53:58,729 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 21:53:58,730 [INFO] Encoding hidden states for batch 5
2025-01-15 21:53:58,769 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 21:53:58,770 [INFO] Encoding hidden states for batch 6
2025-01-15 21:53:58,811 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 21:53:58,813 [INFO] Encoding hidden states for batch 7
2025-01-15 21:53:58,853 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 21:53:58,854 [INFO] Encoding hidden states for batch 8
2025-01-15 21:53:58,892 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 21:53:58,894 [INFO] Encoding hidden states for batch 9
2025-01-15 21:53:58,932 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 21:53:58,934 [INFO] Encoding hidden states for batch 10
2025-01-15 21:54:42,154 [INFO] pos-neg
2025-01-15 21:54:42,170 [INFO] Running model with cache to obtain hidden states
2025-01-15 21:55:05,604 [INFO] pos-neg
2025-01-15 21:55:05,617 [INFO] Running model with cache to obtain hidden states
2025-01-15 22:18:24,307 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 22:18:24,307 [INFO] Hyperparameters:
2025-01-15 22:18:24,308 [INFO]   layer: 6
2025-01-15 22:18:24,308 [INFO]   LLM: gpt2-small
2025-01-15 22:18:24,308 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:18:24,308 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:18:24,308 [INFO]   output_dir: ./results
2025-01-15 22:18:24,308 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:18:24,308 [INFO]   task: sentiment
2025-01-15 22:18:24,308 [INFO]   seed: 42
2025-01-15 22:18:24,308 [INFO]   data_size: 1000
2025-01-15 22:18:24,308 [INFO]   device: cuda
2025-01-15 22:18:24,308 [INFO]   alpha: 100
2025-01-15 22:18:24,308 [INFO]   steer: pos-neg
2025-01-15 22:18:24,308 [INFO]   method: val_mul
2025-01-15 22:18:24,308 [INFO]   topk_mean: 100
2025-01-15 22:18:24,308 [INFO]   topk_cnt: 100
2025-01-15 22:18:24,308 [INFO]   batch_size: 32
2025-01-15 22:18:24,308 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:18:24,308 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:18:24,308 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 22:18:24,309 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 22:18:24,432 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 22:18:24,440 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 22:18:24,441 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 22:18:24,441 [INFO] Hyperparameters:
2025-01-15 22:18:24,441 [INFO]   layer: 6
2025-01-15 22:18:24,441 [INFO]   LLM: gpt2-small
2025-01-15 22:18:24,441 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:18:24,441 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:18:24,441 [INFO]   output_dir: ./results
2025-01-15 22:18:24,441 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:18:24,441 [INFO]   task: sentiment
2025-01-15 22:18:24,441 [INFO]   seed: 42
2025-01-15 22:18:24,441 [INFO]   data_size: 1000
2025-01-15 22:18:24,441 [INFO]   device: cuda
2025-01-15 22:18:24,441 [INFO]   alpha: 100
2025-01-15 22:18:24,441 [INFO]   steer: pos-neg
2025-01-15 22:18:24,441 [INFO]   method: val_mul
2025-01-15 22:18:24,441 [INFO]   topk_mean: 100
2025-01-15 22:18:24,441 [INFO]   topk_cnt: 100
2025-01-15 22:18:24,441 [INFO]   batch_size: 32
2025-01-15 22:18:24,441 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:18:24,441 [INFO] Loading model: gpt2-small
2025-01-15 22:18:26,735 [INFO] Loading SAE for layer 6
2025-01-15 22:18:28,650 [INFO] pos-neg
2025-01-15 22:18:28,655 [INFO] Running model with cache to obtain hidden states
2025-01-15 22:18:28,845 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:18:28,845 [INFO] Encoding hidden states for batch 1
2025-01-15 22:18:28,904 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:18:28,904 [INFO] Encoding hidden states for batch 2
2025-01-15 22:18:28,941 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:18:28,941 [INFO] Encoding hidden states for batch 3
2025-01-15 22:18:28,977 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:18:28,977 [INFO] Encoding hidden states for batch 4
2025-01-15 22:18:29,013 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:18:29,013 [INFO] Encoding hidden states for batch 5
2025-01-15 22:18:29,048 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:18:29,048 [INFO] Encoding hidden states for batch 6
2025-01-15 22:18:29,083 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:18:29,083 [INFO] Encoding hidden states for batch 7
2025-01-15 22:18:29,118 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 22:18:29,118 [INFO] Encoding hidden states for batch 8
2025-01-15 22:18:29,153 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:18:29,153 [INFO] Encoding hidden states for batch 9
2025-01-15 22:18:29,188 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:18:29,188 [INFO] Encoding hidden states for batch 10
2025-01-15 22:18:29,223 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:18:29,223 [INFO] Encoding hidden states for batch 11
2025-01-15 22:18:29,264 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 22:18:29,264 [INFO] Encoding hidden states for batch 12
2025-01-15 22:18:29,299 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:18:29,299 [INFO] Encoding hidden states for batch 13
2025-01-15 22:18:29,335 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:18:29,335 [INFO] Encoding hidden states for batch 14
2025-01-15 22:18:29,370 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 22:18:29,371 [INFO] Encoding hidden states for batch 15
2025-01-15 22:18:29,405 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 22:18:29,406 [INFO] Encoding hidden states for batch 16
2025-01-15 22:18:29,446 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:18:29,446 [INFO] Encoding hidden states for batch 17
2025-01-15 22:18:29,483 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:18:29,483 [INFO] Encoding hidden states for batch 18
2025-01-15 22:18:29,518 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:18:29,519 [INFO] Encoding hidden states for batch 19
2025-01-15 22:18:29,561 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 22:18:29,561 [INFO] Encoding hidden states for batch 20
2025-01-15 22:18:29,598 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:18:29,598 [INFO] Encoding hidden states for batch 21
2025-01-15 22:18:29,634 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 22:18:29,634 [INFO] Encoding hidden states for batch 22
2025-01-15 22:18:29,672 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 22:18:29,673 [INFO] Encoding hidden states for batch 23
2025-01-15 22:18:29,709 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:18:29,710 [INFO] Encoding hidden states for batch 24
2025-01-15 22:18:29,745 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:18:29,745 [INFO] Encoding hidden states for batch 25
2025-01-15 22:18:29,781 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:18:29,781 [INFO] Encoding hidden states for batch 26
2025-01-15 22:18:29,816 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:18:29,816 [INFO] Encoding hidden states for batch 27
2025-01-15 22:18:29,851 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:18:29,851 [INFO] Encoding hidden states for batch 28
2025-01-15 22:18:29,887 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:18:29,887 [INFO] Encoding hidden states for batch 29
2025-01-15 22:18:29,926 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:18:29,926 [INFO] Encoding hidden states for batch 30
2025-01-15 22:18:29,962 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:18:29,962 [INFO] Encoding hidden states for batch 31
2025-01-15 22:18:30,013 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 22:18:30,014 [INFO] Encoding hidden states for batch 32
2025-01-15 22:18:30,014 [INFO] Total batches processed: 32
2025-01-15 22:18:30,015 [INFO] 最大长度:60
2025-01-15 22:18:30,166 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 22:18:30,166 [INFO] Computing non-zero element counts
2025-01-15 22:20:03,504 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 22:20:03,504 [INFO] Hyperparameters:
2025-01-15 22:20:03,504 [INFO]   layer: 6
2025-01-15 22:20:03,504 [INFO]   LLM: gpt2-small
2025-01-15 22:20:03,504 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:20:03,504 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:20:03,504 [INFO]   output_dir: ./results
2025-01-15 22:20:03,504 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:20:03,504 [INFO]   task: sentiment
2025-01-15 22:20:03,504 [INFO]   seed: 42
2025-01-15 22:20:03,504 [INFO]   data_size: 1000
2025-01-15 22:20:03,504 [INFO]   device: cuda
2025-01-15 22:20:03,504 [INFO]   alpha: 100
2025-01-15 22:20:03,504 [INFO]   steer: pos-neg
2025-01-15 22:20:03,504 [INFO]   method: val_mul
2025-01-15 22:20:03,504 [INFO]   topk_mean: 100
2025-01-15 22:20:03,504 [INFO]   topk_cnt: 100
2025-01-15 22:20:03,504 [INFO]   batch_size: 32
2025-01-15 22:20:03,505 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:20:03,505 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:20:03,505 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 22:20:03,505 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 22:20:03,629 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 22:20:03,637 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 22:20:03,637 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 22:20:03,637 [INFO] Hyperparameters:
2025-01-15 22:20:03,637 [INFO]   layer: 6
2025-01-15 22:20:03,637 [INFO]   LLM: gpt2-small
2025-01-15 22:20:03,637 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:20:03,637 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:20:03,637 [INFO]   output_dir: ./results
2025-01-15 22:20:03,638 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:20:03,638 [INFO]   task: sentiment
2025-01-15 22:20:03,638 [INFO]   seed: 42
2025-01-15 22:20:03,638 [INFO]   data_size: 1000
2025-01-15 22:20:03,638 [INFO]   device: cuda
2025-01-15 22:20:03,638 [INFO]   alpha: 100
2025-01-15 22:20:03,638 [INFO]   steer: pos-neg
2025-01-15 22:20:03,638 [INFO]   method: val_mul
2025-01-15 22:20:03,638 [INFO]   topk_mean: 100
2025-01-15 22:20:03,638 [INFO]   topk_cnt: 100
2025-01-15 22:20:03,638 [INFO]   batch_size: 32
2025-01-15 22:20:03,638 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:20:03,638 [INFO] Loading model: gpt2-small
2025-01-15 22:20:06,895 [INFO] Loading SAE for layer 6
2025-01-15 22:39:19,913 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-15 22:39:19,915 [INFO] Hyperparameters:
2025-01-15 22:39:19,916 [INFO]   layer: 6
2025-01-15 22:39:19,918 [INFO]   LLM: gpt2-small
2025-01-15 22:39:19,919 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:39:19,920 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:39:19,921 [INFO]   output_dir: ./results
2025-01-15 22:39:19,922 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:39:19,922 [INFO]   task: sentiment
2025-01-15 22:39:19,924 [INFO]   seed: 42
2025-01-15 22:39:19,925 [INFO]   data_size: 1000
2025-01-15 22:39:19,926 [INFO]   device: cpu
2025-01-15 22:39:19,927 [INFO]   alpha: 100
2025-01-15 22:39:19,928 [INFO]   steer: pos-neg
2025-01-15 22:39:19,929 [INFO]   method: val_mul
2025-01-15 22:39:19,930 [INFO]   topk_mean: 100
2025-01-15 22:39:19,931 [INFO]   topk_cnt: 100
2025-01-15 22:39:19,932 [INFO]   batch_size: 32
2025-01-15 22:39:23,123 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:39:31,951 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:39:31,954 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-15 22:39:31,956 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-15 22:39:32,160 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-15 22:39:32,171 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-15 22:39:45,688 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-15 22:39:47,755 [INFO] Hyperparameters:
2025-01-15 22:39:47,758 [INFO]   layer: 6
2025-01-15 22:39:47,759 [INFO]   LLM: gpt2-small
2025-01-15 22:39:47,760 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-15 22:39:47,761 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-15 22:39:47,762 [INFO]   output_dir: ./results
2025-01-15 22:39:47,765 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-15 22:39:47,766 [INFO]   task: sentiment
2025-01-15 22:39:47,767 [INFO]   seed: 42
2025-01-15 22:39:47,768 [INFO]   data_size: 1000
2025-01-15 22:39:47,770 [INFO]   device: cpu
2025-01-15 22:39:47,771 [INFO]   alpha: 100
2025-01-15 22:39:47,772 [INFO]   steer: pos-neg
2025-01-15 22:39:47,774 [INFO]   method: val_mul
2025-01-15 22:39:47,775 [INFO]   topk_mean: 100
2025-01-15 22:39:47,776 [INFO]   topk_cnt: 100
2025-01-15 22:39:47,778 [INFO]   batch_size: 32
2025-01-15 22:39:47,780 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-15 22:39:47,782 [INFO] Loading model: gpt2-small
2025-01-15 22:40:55,253 [INFO] Loading SAE for layer 6
2025-01-15 22:44:13,002 [INFO] pos-neg
2025-01-15 22:44:13,030 [INFO] Running model with cache to obtain hidden states
2025-01-15 22:44:13,414 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:44:13,415 [INFO] Encoding hidden states for batch 1
2025-01-15 22:44:13,858 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:13,859 [INFO] Encoding hidden states for batch 2
2025-01-15 22:44:14,182 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:44:14,184 [INFO] Encoding hidden states for batch 3
2025-01-15 22:44:14,516 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:44:14,517 [INFO] Encoding hidden states for batch 4
2025-01-15 22:44:14,833 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:44:14,834 [INFO] Encoding hidden states for batch 5
2025-01-15 22:44:15,147 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:15,148 [INFO] Encoding hidden states for batch 6
2025-01-15 22:44:15,455 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:44:15,457 [INFO] Encoding hidden states for batch 7
2025-01-15 22:44:15,726 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-15 22:44:15,727 [INFO] Encoding hidden states for batch 8
2025-01-15 22:44:16,000 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:16,002 [INFO] Encoding hidden states for batch 9
2025-01-15 22:44:16,334 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:44:16,336 [INFO] Encoding hidden states for batch 10
2025-01-15 22:44:16,664 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:44:16,666 [INFO] Encoding hidden states for batch 11
2025-01-15 22:44:17,030 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 22:44:17,032 [INFO] Encoding hidden states for batch 12
2025-01-15 22:44:17,395 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:17,396 [INFO] Encoding hidden states for batch 13
2025-01-15 22:44:17,705 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:44:17,707 [INFO] Encoding hidden states for batch 14
2025-01-15 22:44:17,971 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-15 22:44:17,973 [INFO] Encoding hidden states for batch 15
2025-01-15 22:44:18,201 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-15 22:44:18,203 [INFO] Encoding hidden states for batch 16
2025-01-15 22:44:18,468 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:18,470 [INFO] Encoding hidden states for batch 17
2025-01-15 22:44:18,752 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:18,754 [INFO] Encoding hidden states for batch 18
2025-01-15 22:44:19,024 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:19,025 [INFO] Encoding hidden states for batch 19
2025-01-15 22:44:19,380 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 22:44:19,381 [INFO] Encoding hidden states for batch 20
2025-01-15 22:44:19,722 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:19,723 [INFO] Encoding hidden states for batch 21
2025-01-15 22:44:20,072 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-15 22:44:20,074 [INFO] Encoding hidden states for batch 22
2025-01-15 22:44:20,367 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 22:44:20,368 [INFO] Encoding hidden states for batch 23
2025-01-15 22:44:20,654 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:20,656 [INFO] Encoding hidden states for batch 24
2025-01-15 22:44:20,969 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:20,970 [INFO] Encoding hidden states for batch 25
2025-01-15 22:44:21,314 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:21,316 [INFO] Encoding hidden states for batch 26
2025-01-15 22:44:21,617 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:21,619 [INFO] Encoding hidden states for batch 27
2025-01-15 22:44:21,928 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:44:21,929 [INFO] Encoding hidden states for batch 28
2025-01-15 22:44:22,217 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:22,219 [INFO] Encoding hidden states for batch 29
2025-01-15 22:44:22,518 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:44:22,520 [INFO] Encoding hidden states for batch 30
2025-01-15 22:44:22,833 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:22,834 [INFO] Encoding hidden states for batch 31
2025-01-15 22:44:23,026 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-15 22:44:23,027 [INFO] Encoding hidden states for batch 32
2025-01-15 22:44:23,037 [INFO] Total batches processed: 32
2025-01-15 22:44:23,040 [INFO] 最大长度:60
2025-01-15 22:44:23,475 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-15 22:44:23,475 [INFO] Computing non-zero element counts
2025-01-15 22:44:24,640 [INFO] Computing sum of non-zero elements
2025-01-15 22:44:25,240 [INFO] Computing mean of non-zero elements
2025-01-15 22:44:25,241 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 22:44:25,243 [INFO] Top 100 nz_mean values selected.
2025-01-15 22:44:25,244 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 22:44:25,245 [INFO] Top 100 act_cnt values selected.
2025-01-15 22:44:25,816 [INFO] Running model with cache to obtain hidden states
2025-01-15 22:44:26,084 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-15 22:44:26,085 [INFO] Encoding hidden states for batch 1
2025-01-15 22:44:26,392 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:26,393 [INFO] Encoding hidden states for batch 2
2025-01-15 22:44:26,676 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:26,677 [INFO] Encoding hidden states for batch 3
2025-01-15 22:44:26,990 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:44:26,991 [INFO] Encoding hidden states for batch 4
2025-01-15 22:44:27,265 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-15 22:44:27,266 [INFO] Encoding hidden states for batch 5
2025-01-15 22:44:27,525 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:27,526 [INFO] Encoding hidden states for batch 6
2025-01-15 22:44:27,972 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:27,973 [INFO] Encoding hidden states for batch 7
2025-01-15 22:44:28,287 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:28,288 [INFO] Encoding hidden states for batch 8
2025-01-15 22:44:28,637 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:28,638 [INFO] Encoding hidden states for batch 9
2025-01-15 22:44:28,980 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 22:44:28,982 [INFO] Encoding hidden states for batch 10
2025-01-15 22:44:29,307 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:44:29,308 [INFO] Encoding hidden states for batch 11
2025-01-15 22:44:29,629 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:29,630 [INFO] Encoding hidden states for batch 12
2025-01-15 22:44:29,934 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:29,935 [INFO] Encoding hidden states for batch 13
2025-01-15 22:44:30,220 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:30,222 [INFO] Encoding hidden states for batch 14
2025-01-15 22:44:30,504 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:30,506 [INFO] Encoding hidden states for batch 15
2025-01-15 22:44:30,805 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:30,806 [INFO] Encoding hidden states for batch 16
2025-01-15 22:44:31,085 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 22:44:31,086 [INFO] Encoding hidden states for batch 17
2025-01-15 22:44:31,386 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:31,387 [INFO] Encoding hidden states for batch 18
2025-01-15 22:44:31,714 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:31,716 [INFO] Encoding hidden states for batch 19
2025-01-15 22:44:32,088 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 22:44:32,089 [INFO] Encoding hidden states for batch 20
2025-01-15 22:44:32,387 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:32,388 [INFO] Encoding hidden states for batch 21
2025-01-15 22:44:32,676 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:32,678 [INFO] Encoding hidden states for batch 22
2025-01-15 22:44:33,027 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 22:44:33,029 [INFO] Encoding hidden states for batch 23
2025-01-15 22:44:33,342 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:44:33,344 [INFO] Encoding hidden states for batch 24
2025-01-15 22:44:33,663 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:33,664 [INFO] Encoding hidden states for batch 25
2025-01-15 22:44:33,951 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-15 22:44:33,952 [INFO] Encoding hidden states for batch 26
2025-01-15 22:44:34,249 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:34,251 [INFO] Encoding hidden states for batch 27
2025-01-15 22:44:34,518 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 22:44:34,519 [INFO] Encoding hidden states for batch 28
2025-01-15 22:44:34,767 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 22:44:34,768 [INFO] Encoding hidden states for batch 29
2025-01-15 22:44:35,025 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-15 22:44:35,026 [INFO] Encoding hidden states for batch 30
2025-01-15 22:44:35,340 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-15 22:44:35,342 [INFO] Encoding hidden states for batch 31
2025-01-15 22:44:35,523 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-15 22:44:35,524 [INFO] Encoding hidden states for batch 32
2025-01-15 22:44:35,533 [INFO] Total batches processed: 32
2025-01-15 22:44:35,536 [INFO] 最大长度:59
2025-01-15 22:44:35,963 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-15 22:44:35,964 [INFO] Computing non-zero element counts
2025-01-15 22:44:37,010 [INFO] Computing sum of non-zero elements
2025-01-15 22:44:37,553 [INFO] Computing mean of non-zero elements
2025-01-15 22:44:37,554 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 22:44:37,555 [INFO] Top 100 nz_mean values selected.
2025-01-15 22:44:37,555 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 22:44:37,556 [INFO] Top 100 act_cnt values selected.
2025-01-15 22:44:38,048 [INFO] Running model with cache to obtain hidden states
2025-01-15 22:44:38,393 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-15 22:44:38,394 [INFO] Encoding hidden states for batch 1
2025-01-15 22:44:38,751 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 22:44:38,752 [INFO] Encoding hidden states for batch 2
2025-01-15 22:44:39,042 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:39,043 [INFO] Encoding hidden states for batch 3
2025-01-15 22:44:39,336 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:39,338 [INFO] Encoding hidden states for batch 4
2025-01-15 22:44:39,628 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:39,629 [INFO] Encoding hidden states for batch 5
2025-01-15 22:44:39,940 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-15 22:44:39,941 [INFO] Encoding hidden states for batch 6
2025-01-15 22:44:40,256 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-15 22:44:40,257 [INFO] Encoding hidden states for batch 7
2025-01-15 22:44:40,526 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 22:44:40,527 [INFO] Encoding hidden states for batch 8
2025-01-15 22:44:40,805 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:40,806 [INFO] Encoding hidden states for batch 9
2025-01-15 22:44:41,108 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:44:41,110 [INFO] Encoding hidden states for batch 10
2025-01-15 22:44:41,373 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-15 22:44:41,374 [INFO] Encoding hidden states for batch 11
2025-01-15 22:44:41,688 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 22:44:41,689 [INFO] Encoding hidden states for batch 12
2025-01-15 22:44:41,992 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-15 22:44:41,993 [INFO] Encoding hidden states for batch 13
2025-01-15 22:44:42,278 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:44:42,279 [INFO] Encoding hidden states for batch 14
2025-01-15 22:44:42,549 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:42,550 [INFO] Encoding hidden states for batch 15
2025-01-15 22:44:42,880 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-15 22:44:42,881 [INFO] Encoding hidden states for batch 16
2025-01-15 22:44:43,171 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-15 22:44:43,172 [INFO] Encoding hidden states for batch 17
2025-01-15 22:44:43,456 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:43,457 [INFO] Encoding hidden states for batch 18
2025-01-15 22:44:43,769 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:43,770 [INFO] Encoding hidden states for batch 19
2025-01-15 22:44:44,049 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:44,051 [INFO] Encoding hidden states for batch 20
2025-01-15 22:44:44,376 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-15 22:44:44,377 [INFO] Encoding hidden states for batch 21
2025-01-15 22:44:44,648 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 22:44:44,649 [INFO] Encoding hidden states for batch 22
2025-01-15 22:44:44,981 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-15 22:44:44,982 [INFO] Encoding hidden states for batch 23
2025-01-15 22:44:45,272 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-15 22:44:45,273 [INFO] Encoding hidden states for batch 24
2025-01-15 22:44:45,556 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:45,557 [INFO] Encoding hidden states for batch 25
2025-01-15 22:44:45,877 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-15 22:44:45,878 [INFO] Encoding hidden states for batch 26
2025-01-15 22:44:46,160 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-15 22:44:46,161 [INFO] Encoding hidden states for batch 27
2025-01-15 22:44:46,455 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-15 22:44:46,456 [INFO] Encoding hidden states for batch 28
2025-01-15 22:44:46,738 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-15 22:44:46,739 [INFO] Encoding hidden states for batch 29
2025-01-15 22:44:47,046 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-15 22:44:47,048 [INFO] Encoding hidden states for batch 30
2025-01-15 22:44:47,312 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-15 22:44:47,313 [INFO] Encoding hidden states for batch 31
2025-01-15 22:44:47,494 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-15 22:44:47,496 [INFO] Encoding hidden states for batch 32
2025-01-15 22:44:47,506 [INFO] Total batches processed: 32
2025-01-15 22:44:47,508 [INFO] 最大长度:76
2025-01-15 22:44:48,054 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-15 22:44:48,054 [INFO] Computing non-zero element counts
2025-01-15 22:44:49,386 [INFO] Computing sum of non-zero elements
2025-01-15 22:44:50,077 [INFO] Computing mean of non-zero elements
2025-01-15 22:44:50,079 [INFO] Selecting top-k indices based on nz_mean
2025-01-15 22:44:50,080 [INFO] Top 100 nz_mean values selected.
2025-01-15 22:44:50,081 [INFO] Selecting top-k indices based on act_cnt
2025-01-15 22:44:50,082 [INFO] Top 100 act_cnt values selected.
2025-01-15 22:46:28,679 [INFO] Example prompt: Aha, we have good result!
2025-01-15 22:46:28,682 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:46:28,706 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:46:28,707 [INFO] Generating texts **without** steering... 
2025-01-15 22:46:31,988 [INFO] Generated Text: 1:
Aha, we have good result!

I'm sure you'll agree that the best way to achieve this is to use a different method of communication. I've seen many people who have been successful in using their own language and then they use it for their own purposes. This is not a new idea, but it's something that has been around for quite some time now. It's not like you can't learn from your mistakes and make them better by using other methods of communication. You can learn from your mistakes and improve them
--------------------------------------------------------------------------------
2025-01-15 22:46:31,989 [INFO] 干预之后的结果
干预方向neg->pos,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-15 22:46:31,989 [INFO] ** Generating texts with steering... Target **
2025-01-15 22:46:34,967 [INFO] Generated Text: 1:
Aha, we have good result!

But I'm not sure if you can do it with a knife or a pliers. It's just too hard to cut through the wood. But I think it's worth it.

I've been using this for about 3 years now and I love it so much that I'm going to try and make some more but this is my first time using one of these. It's very easy to use, but the blade is really sharp and you can't tell by its shape that
--------------------------------------------------------------------------------
2025-01-15 22:46:54,835 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:46:54,838 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:46:58,972 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:46:58,972 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:02,751 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:02,752 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:06,502 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:06,503 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:10,208 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:10,208 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:13,889 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:13,890 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:17,445 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:17,446 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:47:21,048 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:47:21,049 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-15 22:48:43,172 [INFO] Computing steering vectors using method: val_mul
2025-01-15 22:48:43,176 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 13:46:53,321 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 13:46:53,325 [INFO] Hyperparameters:
2025-01-16 13:46:53,327 [INFO]   layer: 6
2025-01-16 13:46:53,328 [INFO]   LLM: gpt2-small
2025-01-16 13:46:53,330 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:46:53,331 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:46:53,332 [INFO]   output_dir: ./results
2025-01-16 13:46:53,333 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:46:53,335 [INFO]   task: sentiment
2025-01-16 13:46:53,337 [INFO]   seed: 42
2025-01-16 13:46:53,338 [INFO]   data_size: 1000
2025-01-16 13:46:53,340 [INFO]   device: cpu
2025-01-16 13:46:53,341 [INFO]   alpha: 100
2025-01-16 13:46:53,342 [INFO]   steer: pos-neg
2025-01-16 13:46:53,343 [INFO]   method: val_mul
2025-01-16 13:46:53,345 [INFO]   topk_mean: 100
2025-01-16 13:46:53,346 [INFO]   topk_cnt: 100
2025-01-16 13:46:53,347 [INFO]   batch_size: 32
2025-01-16 13:46:57,171 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:47:04,879 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:47:04,882 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 13:47:04,884 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 13:47:05,087 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 13:47:05,099 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 13:47:20,312 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 13:47:23,275 [INFO] Hyperparameters:
2025-01-16 13:47:23,279 [INFO]   layer: 6
2025-01-16 13:47:23,281 [INFO]   LLM: gpt2-small
2025-01-16 13:47:23,283 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:47:23,284 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:47:23,285 [INFO]   output_dir: ./results
2025-01-16 13:47:23,286 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:47:23,287 [INFO]   task: sentiment
2025-01-16 13:47:23,288 [INFO]   seed: 42
2025-01-16 13:47:23,290 [INFO]   data_size: 1000
2025-01-16 13:47:23,292 [INFO]   device: cpu
2025-01-16 13:47:23,293 [INFO]   alpha: 100
2025-01-16 13:47:23,294 [INFO]   steer: pos-neg
2025-01-16 13:47:23,295 [INFO]   method: val_mul
2025-01-16 13:47:23,296 [INFO]   topk_mean: 100
2025-01-16 13:47:23,297 [INFO]   topk_cnt: 100
2025-01-16 13:47:23,299 [INFO]   batch_size: 32
2025-01-16 13:47:23,302 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:47:23,304 [INFO] Loading model: gpt2-small
2025-01-16 13:48:04,174 [INFO] Loading SAE for layer 6
2025-01-16 13:51:15,152 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 13:51:15,152 [INFO] Hyperparameters:
2025-01-16 13:51:15,152 [INFO]   layer: 6
2025-01-16 13:51:15,152 [INFO]   LLM: gpt2-small
2025-01-16 13:51:15,152 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:51:15,152 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:51:15,152 [INFO]   output_dir: ./results
2025-01-16 13:51:15,152 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:51:15,152 [INFO]   task: sentiment
2025-01-16 13:51:15,152 [INFO]   seed: 42
2025-01-16 13:51:15,152 [INFO]   data_size: 1000
2025-01-16 13:51:15,152 [INFO]   device: cuda
2025-01-16 13:51:15,152 [INFO]   alpha: 100
2025-01-16 13:51:15,152 [INFO]   steer: pos-neg
2025-01-16 13:51:15,153 [INFO]   method: val_mul
2025-01-16 13:51:15,153 [INFO]   topk_mean: 100
2025-01-16 13:51:15,153 [INFO]   topk_cnt: 100
2025-01-16 13:51:15,153 [INFO]   batch_size: 32
2025-01-16 13:51:15,153 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:51:15,153 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:51:15,153 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 13:51:15,153 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 13:51:15,273 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 13:51:15,281 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 13:51:15,282 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 13:51:15,282 [INFO] Hyperparameters:
2025-01-16 13:51:15,282 [INFO]   layer: 6
2025-01-16 13:51:15,282 [INFO]   LLM: gpt2-small
2025-01-16 13:51:15,282 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:51:15,282 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:51:15,282 [INFO]   output_dir: ./results
2025-01-16 13:51:15,282 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:51:15,282 [INFO]   task: sentiment
2025-01-16 13:51:15,282 [INFO]   seed: 42
2025-01-16 13:51:15,282 [INFO]   data_size: 1000
2025-01-16 13:51:15,282 [INFO]   device: cuda
2025-01-16 13:51:15,282 [INFO]   alpha: 100
2025-01-16 13:51:15,282 [INFO]   steer: pos-neg
2025-01-16 13:51:15,282 [INFO]   method: val_mul
2025-01-16 13:51:15,282 [INFO]   topk_mean: 100
2025-01-16 13:51:15,282 [INFO]   topk_cnt: 100
2025-01-16 13:51:15,283 [INFO]   batch_size: 32
2025-01-16 13:51:15,283 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:51:15,283 [INFO] Loading model: gpt2-small
2025-01-16 13:51:56,367 [INFO] Loading SAE for layer 6
2025-01-16 13:52:27,621 [INFO] pos-neg
2025-01-16 13:52:27,627 [INFO] Running model with cache to obtain hidden states
2025-01-16 13:52:27,819 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:52:27,819 [INFO] Encoding hidden states for batch 1
2025-01-16 13:52:27,879 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:52:27,880 [INFO] Encoding hidden states for batch 2
2025-01-16 13:52:27,916 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:52:27,916 [INFO] Encoding hidden states for batch 3
2025-01-16 13:52:27,951 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:52:27,952 [INFO] Encoding hidden states for batch 4
2025-01-16 13:52:27,987 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:52:27,987 [INFO] Encoding hidden states for batch 5
2025-01-16 13:52:28,022 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:52:28,022 [INFO] Encoding hidden states for batch 6
2025-01-16 13:52:28,057 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:52:28,057 [INFO] Encoding hidden states for batch 7
2025-01-16 13:52:28,091 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-16 13:52:28,091 [INFO] Encoding hidden states for batch 8
2025-01-16 13:52:28,126 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:52:28,126 [INFO] Encoding hidden states for batch 9
2025-01-16 13:52:28,161 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:52:28,161 [INFO] Encoding hidden states for batch 10
2025-01-16 13:52:28,195 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:52:28,196 [INFO] Encoding hidden states for batch 11
2025-01-16 13:52:28,237 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 13:52:28,237 [INFO] Encoding hidden states for batch 12
2025-01-16 13:52:28,272 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:52:28,272 [INFO] Encoding hidden states for batch 13
2025-01-16 13:52:28,307 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:52:28,307 [INFO] Encoding hidden states for batch 14
2025-01-16 13:52:28,341 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-16 13:52:28,342 [INFO] Encoding hidden states for batch 15
2025-01-16 13:52:28,375 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-16 13:52:28,376 [INFO] Encoding hidden states for batch 16
2025-01-16 13:52:28,410 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:52:28,410 [INFO] Encoding hidden states for batch 17
2025-01-16 13:52:28,445 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:52:28,445 [INFO] Encoding hidden states for batch 18
2025-01-16 13:52:28,479 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:52:28,480 [INFO] Encoding hidden states for batch 19
2025-01-16 13:52:28,520 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 13:52:28,520 [INFO] Encoding hidden states for batch 20
2025-01-16 13:52:28,555 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:52:28,556 [INFO] Encoding hidden states for batch 21
2025-01-16 13:52:28,590 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 13:52:28,591 [INFO] Encoding hidden states for batch 22
2025-01-16 13:52:28,626 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 13:52:28,626 [INFO] Encoding hidden states for batch 23
2025-01-16 13:52:28,661 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:52:28,661 [INFO] Encoding hidden states for batch 24
2025-01-16 13:52:28,696 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:52:28,696 [INFO] Encoding hidden states for batch 25
2025-01-16 13:52:28,731 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:52:28,731 [INFO] Encoding hidden states for batch 26
2025-01-16 13:52:28,766 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:52:28,766 [INFO] Encoding hidden states for batch 27
2025-01-16 13:52:28,801 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:52:28,801 [INFO] Encoding hidden states for batch 28
2025-01-16 13:52:28,836 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:52:28,836 [INFO] Encoding hidden states for batch 29
2025-01-16 13:52:28,871 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:52:28,871 [INFO] Encoding hidden states for batch 30
2025-01-16 13:52:28,906 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:52:28,906 [INFO] Encoding hidden states for batch 31
2025-01-16 13:52:28,956 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-16 13:52:28,956 [INFO] Encoding hidden states for batch 32
2025-01-16 13:52:28,957 [INFO] Total batches processed: 32
2025-01-16 13:52:28,958 [INFO] 最大长度:60
2025-01-16 13:52:29,109 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-16 13:52:29,109 [INFO] Computing non-zero element counts
2025-01-16 13:54:51,683 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 13:54:51,683 [INFO] Hyperparameters:
2025-01-16 13:54:51,683 [INFO]   layer: 6
2025-01-16 13:54:51,683 [INFO]   LLM: gpt2-small
2025-01-16 13:54:51,683 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:54:51,683 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:54:51,684 [INFO]   output_dir: ./results
2025-01-16 13:54:51,684 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:54:51,684 [INFO]   task: sentiment
2025-01-16 13:54:51,684 [INFO]   seed: 42
2025-01-16 13:54:51,684 [INFO]   data_size: 1000
2025-01-16 13:54:51,684 [INFO]   device: cpu
2025-01-16 13:54:51,684 [INFO]   alpha: 100
2025-01-16 13:54:51,684 [INFO]   steer: pos-neg
2025-01-16 13:54:51,684 [INFO]   method: val_mul
2025-01-16 13:54:51,684 [INFO]   topk_mean: 100
2025-01-16 13:54:51,684 [INFO]   topk_cnt: 100
2025-01-16 13:54:51,684 [INFO]   batch_size: 32
2025-01-16 13:54:51,684 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:54:51,684 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:54:51,684 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 13:54:51,685 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 13:54:51,808 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 13:54:51,816 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 13:54:51,817 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 13:54:51,817 [INFO] Hyperparameters:
2025-01-16 13:54:51,817 [INFO]   layer: 6
2025-01-16 13:54:51,817 [INFO]   LLM: gpt2-small
2025-01-16 13:54:51,817 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 13:54:51,817 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 13:54:51,817 [INFO]   output_dir: ./results
2025-01-16 13:54:51,817 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 13:54:51,817 [INFO]   task: sentiment
2025-01-16 13:54:51,817 [INFO]   seed: 42
2025-01-16 13:54:51,817 [INFO]   data_size: 1000
2025-01-16 13:54:51,817 [INFO]   device: cpu
2025-01-16 13:54:51,817 [INFO]   alpha: 100
2025-01-16 13:54:51,817 [INFO]   steer: pos-neg
2025-01-16 13:54:51,817 [INFO]   method: val_mul
2025-01-16 13:54:51,818 [INFO]   topk_mean: 100
2025-01-16 13:54:51,818 [INFO]   topk_cnt: 100
2025-01-16 13:54:51,818 [INFO]   batch_size: 32
2025-01-16 13:54:51,818 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 13:54:51,818 [INFO] Loading model: gpt2-small
2025-01-16 13:55:53,837 [INFO] Loading SAE for layer 6
2025-01-16 13:56:25,356 [INFO] pos-neg
2025-01-16 13:56:25,366 [INFO] Running model with cache to obtain hidden states
2025-01-16 13:56:25,710 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:56:25,711 [INFO] Encoding hidden states for batch 1
2025-01-16 13:56:26,119 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:26,119 [INFO] Encoding hidden states for batch 2
2025-01-16 13:56:26,426 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:56:26,426 [INFO] Encoding hidden states for batch 3
2025-01-16 13:56:26,727 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:56:26,727 [INFO] Encoding hidden states for batch 4
2025-01-16 13:56:27,019 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:56:27,019 [INFO] Encoding hidden states for batch 5
2025-01-16 13:56:27,289 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:27,289 [INFO] Encoding hidden states for batch 6
2025-01-16 13:56:27,561 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:56:27,562 [INFO] Encoding hidden states for batch 7
2025-01-16 13:56:27,817 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-16 13:56:27,817 [INFO] Encoding hidden states for batch 8
2025-01-16 13:56:28,070 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:28,070 [INFO] Encoding hidden states for batch 9
2025-01-16 13:56:28,374 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:56:28,374 [INFO] Encoding hidden states for batch 10
2025-01-16 13:56:28,680 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:56:28,680 [INFO] Encoding hidden states for batch 11
2025-01-16 13:56:29,011 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 13:56:29,011 [INFO] Encoding hidden states for batch 12
2025-01-16 13:56:29,343 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:29,344 [INFO] Encoding hidden states for batch 13
2025-01-16 13:56:29,654 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:56:29,654 [INFO] Encoding hidden states for batch 14
2025-01-16 13:56:29,903 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-16 13:56:29,903 [INFO] Encoding hidden states for batch 15
2025-01-16 13:56:30,150 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-16 13:56:30,150 [INFO] Encoding hidden states for batch 16
2025-01-16 13:56:30,408 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:30,409 [INFO] Encoding hidden states for batch 17
2025-01-16 13:56:30,679 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:30,680 [INFO] Encoding hidden states for batch 18
2025-01-16 13:56:30,959 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:30,960 [INFO] Encoding hidden states for batch 19
2025-01-16 13:56:31,314 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 13:56:31,314 [INFO] Encoding hidden states for batch 20
2025-01-16 13:56:32,223 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:32,223 [INFO] Encoding hidden states for batch 21
2025-01-16 13:56:32,555 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 13:56:32,556 [INFO] Encoding hidden states for batch 22
2025-01-16 13:56:32,834 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 13:56:32,834 [INFO] Encoding hidden states for batch 23
2025-01-16 13:56:33,098 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:33,099 [INFO] Encoding hidden states for batch 24
2025-01-16 13:56:33,646 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:33,646 [INFO] Encoding hidden states for batch 25
2025-01-16 13:56:33,983 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:33,983 [INFO] Encoding hidden states for batch 26
2025-01-16 13:56:34,292 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:34,292 [INFO] Encoding hidden states for batch 27
2025-01-16 13:56:34,582 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:56:34,582 [INFO] Encoding hidden states for batch 28
2025-01-16 13:56:34,873 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:34,873 [INFO] Encoding hidden states for batch 29
2025-01-16 13:56:35,169 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:56:35,169 [INFO] Encoding hidden states for batch 30
2025-01-16 13:56:35,500 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:35,501 [INFO] Encoding hidden states for batch 31
2025-01-16 13:56:35,701 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-16 13:56:35,701 [INFO] Encoding hidden states for batch 32
2025-01-16 13:56:35,708 [INFO] Total batches processed: 32
2025-01-16 13:56:35,710 [INFO] 最大长度:60
2025-01-16 13:56:36,207 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-16 13:56:36,207 [INFO] Computing non-zero element counts
2025-01-16 13:56:37,383 [INFO] Computing sum of non-zero elements
2025-01-16 13:56:37,963 [INFO] Computing mean of non-zero elements
2025-01-16 13:56:37,963 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 13:56:37,964 [INFO] Top 100 nz_mean values selected.
2025-01-16 13:56:37,964 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 13:56:37,964 [INFO] Top 100 act_cnt values selected.
2025-01-16 13:56:38,519 [INFO] Running model with cache to obtain hidden states
2025-01-16 13:56:38,821 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-16 13:56:38,821 [INFO] Encoding hidden states for batch 1
2025-01-16 13:56:39,200 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:39,200 [INFO] Encoding hidden states for batch 2
2025-01-16 13:56:39,487 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:39,488 [INFO] Encoding hidden states for batch 3
2025-01-16 13:56:39,796 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:56:39,796 [INFO] Encoding hidden states for batch 4
2025-01-16 13:56:40,062 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-16 13:56:40,063 [INFO] Encoding hidden states for batch 5
2025-01-16 13:56:40,311 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:40,312 [INFO] Encoding hidden states for batch 6
2025-01-16 13:56:40,584 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:40,584 [INFO] Encoding hidden states for batch 7
2025-01-16 13:56:40,917 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:40,917 [INFO] Encoding hidden states for batch 8
2025-01-16 13:56:41,308 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:41,309 [INFO] Encoding hidden states for batch 9
2025-01-16 13:56:41,697 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 13:56:41,697 [INFO] Encoding hidden states for batch 10
2025-01-16 13:56:42,054 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:56:42,054 [INFO] Encoding hidden states for batch 11
2025-01-16 13:56:42,422 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:42,423 [INFO] Encoding hidden states for batch 12
2025-01-16 13:56:42,725 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:42,726 [INFO] Encoding hidden states for batch 13
2025-01-16 13:56:42,993 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:42,993 [INFO] Encoding hidden states for batch 14
2025-01-16 13:56:43,263 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:43,264 [INFO] Encoding hidden states for batch 15
2025-01-16 13:56:43,543 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:43,543 [INFO] Encoding hidden states for batch 16
2025-01-16 13:56:43,806 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 13:56:43,806 [INFO] Encoding hidden states for batch 17
2025-01-16 13:56:44,091 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:44,092 [INFO] Encoding hidden states for batch 18
2025-01-16 13:56:44,399 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:44,399 [INFO] Encoding hidden states for batch 19
2025-01-16 13:56:44,747 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 13:56:44,747 [INFO] Encoding hidden states for batch 20
2025-01-16 13:56:45,014 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:45,014 [INFO] Encoding hidden states for batch 21
2025-01-16 13:56:45,283 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:45,284 [INFO] Encoding hidden states for batch 22
2025-01-16 13:56:45,605 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 13:56:45,605 [INFO] Encoding hidden states for batch 23
2025-01-16 13:56:45,896 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:56:45,896 [INFO] Encoding hidden states for batch 24
2025-01-16 13:56:46,189 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:46,190 [INFO] Encoding hidden states for batch 25
2025-01-16 13:56:46,457 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 13:56:46,457 [INFO] Encoding hidden states for batch 26
2025-01-16 13:56:46,739 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:46,740 [INFO] Encoding hidden states for batch 27
2025-01-16 13:56:47,006 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 13:56:47,006 [INFO] Encoding hidden states for batch 28
2025-01-16 13:56:47,259 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 13:56:47,260 [INFO] Encoding hidden states for batch 29
2025-01-16 13:56:47,744 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 13:56:47,744 [INFO] Encoding hidden states for batch 30
2025-01-16 13:56:48,031 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 13:56:48,032 [INFO] Encoding hidden states for batch 31
2025-01-16 13:56:48,236 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-16 13:56:48,237 [INFO] Encoding hidden states for batch 32
2025-01-16 13:56:48,245 [INFO] Total batches processed: 32
2025-01-16 13:56:48,247 [INFO] 最大长度:59
2025-01-16 13:56:48,707 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-16 13:56:48,707 [INFO] Computing non-zero element counts
2025-01-16 13:56:49,719 [INFO] Computing sum of non-zero elements
2025-01-16 13:56:50,271 [INFO] Computing mean of non-zero elements
2025-01-16 13:56:50,272 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 13:56:50,272 [INFO] Top 100 nz_mean values selected.
2025-01-16 13:56:50,272 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 13:56:50,272 [INFO] Top 100 act_cnt values selected.
2025-01-16 13:56:50,764 [INFO] Running model with cache to obtain hidden states
2025-01-16 13:56:51,940 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-16 13:56:51,940 [INFO] Encoding hidden states for batch 1
2025-01-16 13:56:52,343 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 13:56:52,344 [INFO] Encoding hidden states for batch 2
2025-01-16 13:56:52,703 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:52,703 [INFO] Encoding hidden states for batch 3
2025-01-16 13:56:53,019 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:53,020 [INFO] Encoding hidden states for batch 4
2025-01-16 13:56:53,315 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:53,316 [INFO] Encoding hidden states for batch 5
2025-01-16 13:56:53,641 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 13:56:53,641 [INFO] Encoding hidden states for batch 6
2025-01-16 13:56:53,950 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 13:56:53,950 [INFO] Encoding hidden states for batch 7
2025-01-16 13:56:54,244 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 13:56:54,244 [INFO] Encoding hidden states for batch 8
2025-01-16 13:56:54,549 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:54,550 [INFO] Encoding hidden states for batch 9
2025-01-16 13:56:54,936 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:56:54,937 [INFO] Encoding hidden states for batch 10
2025-01-16 13:56:55,230 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-16 13:56:55,230 [INFO] Encoding hidden states for batch 11
2025-01-16 13:56:55,570 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 13:56:55,571 [INFO] Encoding hidden states for batch 12
2025-01-16 13:56:55,882 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 13:56:55,883 [INFO] Encoding hidden states for batch 13
2025-01-16 13:56:56,176 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:56:56,177 [INFO] Encoding hidden states for batch 14
2025-01-16 13:56:56,456 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:56,456 [INFO] Encoding hidden states for batch 15
2025-01-16 13:56:56,783 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 13:56:56,784 [INFO] Encoding hidden states for batch 16
2025-01-16 13:56:57,111 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 13:56:57,111 [INFO] Encoding hidden states for batch 17
2025-01-16 13:56:57,410 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:57,411 [INFO] Encoding hidden states for batch 18
2025-01-16 13:56:57,740 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:56:57,741 [INFO] Encoding hidden states for batch 19
2025-01-16 13:56:58,036 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:58,036 [INFO] Encoding hidden states for batch 20
2025-01-16 13:56:58,405 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 13:56:58,406 [INFO] Encoding hidden states for batch 21
2025-01-16 13:56:58,700 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 13:56:58,701 [INFO] Encoding hidden states for batch 22
2025-01-16 13:56:59,048 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 13:56:59,048 [INFO] Encoding hidden states for batch 23
2025-01-16 13:56:59,348 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 13:56:59,349 [INFO] Encoding hidden states for batch 24
2025-01-16 13:56:59,625 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:56:59,626 [INFO] Encoding hidden states for batch 25
2025-01-16 13:56:59,925 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 13:56:59,925 [INFO] Encoding hidden states for batch 26
2025-01-16 13:57:00,207 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 13:57:00,207 [INFO] Encoding hidden states for batch 27
2025-01-16 13:57:00,498 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 13:57:00,499 [INFO] Encoding hidden states for batch 28
2025-01-16 13:57:00,767 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 13:57:00,768 [INFO] Encoding hidden states for batch 29
2025-01-16 13:57:01,068 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 13:57:01,069 [INFO] Encoding hidden states for batch 30
2025-01-16 13:57:01,351 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 13:57:01,351 [INFO] Encoding hidden states for batch 31
2025-01-16 13:57:01,548 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-16 13:57:01,549 [INFO] Encoding hidden states for batch 32
2025-01-16 13:57:01,558 [INFO] Total batches processed: 32
2025-01-16 13:57:01,566 [INFO] 最大长度:76
2025-01-16 13:57:02,122 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-16 13:57:02,124 [INFO] Computing non-zero element counts
2025-01-16 13:57:03,453 [INFO] Computing sum of non-zero elements
2025-01-16 13:57:04,134 [INFO] Computing mean of non-zero elements
2025-01-16 13:57:04,134 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 13:57:04,135 [INFO] Top 100 nz_mean values selected.
2025-01-16 13:57:04,135 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 13:57:04,135 [INFO] Top 100 act_cnt values selected.
2025-01-16 13:57:04,716 [INFO] Example prompt: Aha, we have good result!
2025-01-16 13:57:04,885 [INFO] Computing steering vectors using method: val_mul
2025-01-16 13:57:04,886 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:00:52,777 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 14:00:52,777 [INFO] Hyperparameters:
2025-01-16 14:00:52,777 [INFO]   layer: 6
2025-01-16 14:00:52,777 [INFO]   LLM: gpt2-small
2025-01-16 14:00:52,777 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:00:52,777 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:00:52,778 [INFO]   output_dir: ./results
2025-01-16 14:00:52,778 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:00:52,778 [INFO]   task: sentiment
2025-01-16 14:00:52,778 [INFO]   seed: 42
2025-01-16 14:00:52,778 [INFO]   data_size: 1000
2025-01-16 14:00:52,778 [INFO]   device: cpu
2025-01-16 14:00:52,778 [INFO]   alpha: 100
2025-01-16 14:00:52,778 [INFO]   steer: pos-neg
2025-01-16 14:00:52,778 [INFO]   method: val_mul
2025-01-16 14:00:52,778 [INFO]   topk_mean: 100
2025-01-16 14:00:52,778 [INFO]   topk_cnt: 100
2025-01-16 14:00:52,778 [INFO]   batch_size: 32
2025-01-16 14:00:52,778 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:00:52,778 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:00:52,778 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 14:00:52,778 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 14:00:52,883 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 14:00:52,890 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 14:00:52,891 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 14:00:52,891 [INFO] Hyperparameters:
2025-01-16 14:00:52,891 [INFO]   layer: 6
2025-01-16 14:00:52,891 [INFO]   LLM: gpt2-small
2025-01-16 14:00:52,891 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:00:52,891 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:00:52,891 [INFO]   output_dir: ./results
2025-01-16 14:00:52,891 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:00:52,891 [INFO]   task: sentiment
2025-01-16 14:00:52,891 [INFO]   seed: 42
2025-01-16 14:00:52,891 [INFO]   data_size: 1000
2025-01-16 14:00:52,891 [INFO]   device: cpu
2025-01-16 14:00:52,891 [INFO]   alpha: 100
2025-01-16 14:00:52,891 [INFO]   steer: pos-neg
2025-01-16 14:00:52,891 [INFO]   method: val_mul
2025-01-16 14:00:52,891 [INFO]   topk_mean: 100
2025-01-16 14:00:52,891 [INFO]   topk_cnt: 100
2025-01-16 14:00:52,891 [INFO]   batch_size: 32
2025-01-16 14:00:52,892 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:00:52,892 [INFO] Loading model: gpt2-small
2025-01-16 14:16:10,733 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:16:10,734 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:22:36,784 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 14:22:36,784 [INFO] Hyperparameters:
2025-01-16 14:22:36,784 [INFO]   layer: 6
2025-01-16 14:22:36,784 [INFO]   LLM: gpt2-small
2025-01-16 14:22:36,784 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:22:36,784 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:22:36,784 [INFO]   output_dir: ./results
2025-01-16 14:22:36,784 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:22:36,784 [INFO]   task: sentiment
2025-01-16 14:22:36,784 [INFO]   seed: 42
2025-01-16 14:22:36,784 [INFO]   data_size: 1000
2025-01-16 14:22:36,784 [INFO]   device: cpu
2025-01-16 14:22:36,784 [INFO]   alpha: 100
2025-01-16 14:22:36,785 [INFO]   steer: pos-neg
2025-01-16 14:22:36,785 [INFO]   method: val_mul
2025-01-16 14:22:36,785 [INFO]   topk_mean: 100
2025-01-16 14:22:36,785 [INFO]   topk_cnt: 100
2025-01-16 14:22:36,785 [INFO]   batch_size: 32
2025-01-16 14:22:36,785 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:22:36,785 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:22:36,785 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 14:22:36,785 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 14:22:36,888 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 14:22:36,895 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 14:22:36,896 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 14:22:36,896 [INFO] Hyperparameters:
2025-01-16 14:22:36,896 [INFO]   layer: 6
2025-01-16 14:22:36,896 [INFO]   LLM: gpt2-small
2025-01-16 14:22:36,896 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:22:36,896 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:22:36,896 [INFO]   output_dir: ./results
2025-01-16 14:22:36,896 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:22:36,896 [INFO]   task: sentiment
2025-01-16 14:22:36,896 [INFO]   seed: 42
2025-01-16 14:22:36,896 [INFO]   data_size: 1000
2025-01-16 14:22:36,896 [INFO]   device: cpu
2025-01-16 14:22:36,896 [INFO]   alpha: 100
2025-01-16 14:22:36,896 [INFO]   steer: pos-neg
2025-01-16 14:22:36,896 [INFO]   method: val_mul
2025-01-16 14:22:36,896 [INFO]   topk_mean: 100
2025-01-16 14:22:36,896 [INFO]   topk_cnt: 100
2025-01-16 14:22:36,896 [INFO]   batch_size: 32
2025-01-16 14:22:36,897 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:22:36,897 [INFO] Loading model: gpt2-small
2025-01-16 14:23:33,593 [INFO] Loading SAE for layer 6
2025-01-16 14:24:05,159 [INFO] pos-neg
2025-01-16 14:24:05,173 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:24:05,903 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:24:05,904 [INFO] Encoding hidden states for batch 1
2025-01-16 14:24:06,413 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:06,413 [INFO] Encoding hidden states for batch 2
2025-01-16 14:24:06,791 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:24:06,791 [INFO] Encoding hidden states for batch 3
2025-01-16 14:24:07,173 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:24:07,173 [INFO] Encoding hidden states for batch 4
2025-01-16 14:24:07,511 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:24:07,511 [INFO] Encoding hidden states for batch 5
2025-01-16 14:24:07,818 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:07,819 [INFO] Encoding hidden states for batch 6
2025-01-16 14:24:08,148 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:24:08,149 [INFO] Encoding hidden states for batch 7
2025-01-16 14:24:08,401 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-16 14:24:08,401 [INFO] Encoding hidden states for batch 8
2025-01-16 14:24:08,717 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:08,717 [INFO] Encoding hidden states for batch 9
2025-01-16 14:24:09,189 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:24:09,189 [INFO] Encoding hidden states for batch 10
2025-01-16 14:24:09,580 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:24:09,581 [INFO] Encoding hidden states for batch 11
2025-01-16 14:24:10,108 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:24:10,108 [INFO] Encoding hidden states for batch 12
2025-01-16 14:24:10,511 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:10,512 [INFO] Encoding hidden states for batch 13
2025-01-16 14:24:10,971 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:24:10,972 [INFO] Encoding hidden states for batch 14
2025-01-16 14:24:11,315 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-16 14:24:11,315 [INFO] Encoding hidden states for batch 15
2025-01-16 14:24:11,556 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-16 14:24:11,557 [INFO] Encoding hidden states for batch 16
2025-01-16 14:24:11,880 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:11,881 [INFO] Encoding hidden states for batch 17
2025-01-16 14:24:12,303 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:12,304 [INFO] Encoding hidden states for batch 18
2025-01-16 14:24:12,680 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:12,681 [INFO] Encoding hidden states for batch 19
2025-01-16 14:24:13,438 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:24:13,439 [INFO] Encoding hidden states for batch 20
2025-01-16 14:24:14,137 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:14,138 [INFO] Encoding hidden states for batch 21
2025-01-16 14:24:14,565 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:24:14,566 [INFO] Encoding hidden states for batch 22
2025-01-16 14:24:15,128 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:24:15,129 [INFO] Encoding hidden states for batch 23
2025-01-16 14:24:15,591 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:15,592 [INFO] Encoding hidden states for batch 24
2025-01-16 14:24:15,984 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:15,985 [INFO] Encoding hidden states for batch 25
2025-01-16 14:24:16,417 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:16,418 [INFO] Encoding hidden states for batch 26
2025-01-16 14:24:16,928 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:16,929 [INFO] Encoding hidden states for batch 27
2025-01-16 14:24:17,308 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:24:17,308 [INFO] Encoding hidden states for batch 28
2025-01-16 14:24:17,676 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:17,676 [INFO] Encoding hidden states for batch 29
2025-01-16 14:24:18,030 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:24:18,031 [INFO] Encoding hidden states for batch 30
2025-01-16 14:24:18,377 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:18,377 [INFO] Encoding hidden states for batch 31
2025-01-16 14:24:18,568 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-16 14:24:18,569 [INFO] Encoding hidden states for batch 32
2025-01-16 14:24:18,598 [INFO] Total batches processed: 32
2025-01-16 14:24:18,600 [INFO] 最大长度:60
2025-01-16 14:24:19,084 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-16 14:24:19,084 [INFO] Computing non-zero element counts
2025-01-16 14:24:20,197 [INFO] Computing sum of non-zero elements
2025-01-16 14:24:20,771 [INFO] Computing mean of non-zero elements
2025-01-16 14:24:20,772 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:24:20,772 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:24:20,772 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:24:20,772 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:24:21,231 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:24:21,575 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-16 14:24:21,575 [INFO] Encoding hidden states for batch 1
2025-01-16 14:24:22,000 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:22,000 [INFO] Encoding hidden states for batch 2
2025-01-16 14:24:22,468 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:22,469 [INFO] Encoding hidden states for batch 3
2025-01-16 14:24:22,827 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:24:22,827 [INFO] Encoding hidden states for batch 4
2025-01-16 14:24:23,134 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-16 14:24:23,135 [INFO] Encoding hidden states for batch 5
2025-01-16 14:24:23,467 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:23,468 [INFO] Encoding hidden states for batch 6
2025-01-16 14:24:23,870 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:23,870 [INFO] Encoding hidden states for batch 7
2025-01-16 14:24:24,276 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:24,276 [INFO] Encoding hidden states for batch 8
2025-01-16 14:24:25,128 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:25,128 [INFO] Encoding hidden states for batch 9
2025-01-16 14:24:25,597 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:24:25,598 [INFO] Encoding hidden states for batch 10
2025-01-16 14:24:25,995 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:24:25,995 [INFO] Encoding hidden states for batch 11
2025-01-16 14:24:26,394 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:26,394 [INFO] Encoding hidden states for batch 12
2025-01-16 14:24:26,759 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:26,759 [INFO] Encoding hidden states for batch 13
2025-01-16 14:24:27,118 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:27,118 [INFO] Encoding hidden states for batch 14
2025-01-16 14:24:27,519 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:27,520 [INFO] Encoding hidden states for batch 15
2025-01-16 14:24:27,842 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:27,843 [INFO] Encoding hidden states for batch 16
2025-01-16 14:24:28,185 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:24:28,185 [INFO] Encoding hidden states for batch 17
2025-01-16 14:24:28,568 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:28,568 [INFO] Encoding hidden states for batch 18
2025-01-16 14:24:28,979 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:28,979 [INFO] Encoding hidden states for batch 19
2025-01-16 14:24:29,450 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:24:29,451 [INFO] Encoding hidden states for batch 20
2025-01-16 14:24:29,893 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:29,894 [INFO] Encoding hidden states for batch 21
2025-01-16 14:24:30,285 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:30,286 [INFO] Encoding hidden states for batch 22
2025-01-16 14:24:30,741 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:24:30,742 [INFO] Encoding hidden states for batch 23
2025-01-16 14:24:31,152 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:24:31,153 [INFO] Encoding hidden states for batch 24
2025-01-16 14:24:31,760 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:31,761 [INFO] Encoding hidden states for batch 25
2025-01-16 14:24:32,122 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:24:32,122 [INFO] Encoding hidden states for batch 26
2025-01-16 14:24:32,470 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:32,471 [INFO] Encoding hidden states for batch 27
2025-01-16 14:24:32,949 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:24:32,950 [INFO] Encoding hidden states for batch 28
2025-01-16 14:24:33,276 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:24:33,277 [INFO] Encoding hidden states for batch 29
2025-01-16 14:24:33,775 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:24:33,776 [INFO] Encoding hidden states for batch 30
2025-01-16 14:24:34,163 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:24:34,164 [INFO] Encoding hidden states for batch 31
2025-01-16 14:24:34,371 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-16 14:24:34,372 [INFO] Encoding hidden states for batch 32
2025-01-16 14:24:34,395 [INFO] Total batches processed: 32
2025-01-16 14:24:34,398 [INFO] 最大长度:59
2025-01-16 14:24:34,904 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-16 14:24:34,904 [INFO] Computing non-zero element counts
2025-01-16 14:24:35,921 [INFO] Computing sum of non-zero elements
2025-01-16 14:24:36,489 [INFO] Computing mean of non-zero elements
2025-01-16 14:24:36,489 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:24:36,490 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:24:36,490 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:24:36,490 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:24:36,952 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:24:37,638 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-16 14:24:37,638 [INFO] Encoding hidden states for batch 1
2025-01-16 14:24:38,183 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:24:38,183 [INFO] Encoding hidden states for batch 2
2025-01-16 14:24:38,676 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:38,676 [INFO] Encoding hidden states for batch 3
2025-01-16 14:24:39,181 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:39,182 [INFO] Encoding hidden states for batch 4
2025-01-16 14:24:39,581 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:39,581 [INFO] Encoding hidden states for batch 5
2025-01-16 14:24:39,964 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:24:39,965 [INFO] Encoding hidden states for batch 6
2025-01-16 14:24:40,440 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:24:40,440 [INFO] Encoding hidden states for batch 7
2025-01-16 14:24:40,827 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:24:40,828 [INFO] Encoding hidden states for batch 8
2025-01-16 14:24:41,436 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:41,436 [INFO] Encoding hidden states for batch 9
2025-01-16 14:24:41,895 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:24:41,896 [INFO] Encoding hidden states for batch 10
2025-01-16 14:24:42,332 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-16 14:24:42,333 [INFO] Encoding hidden states for batch 11
2025-01-16 14:24:42,806 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:24:42,806 [INFO] Encoding hidden states for batch 12
2025-01-16 14:24:43,185 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:24:43,185 [INFO] Encoding hidden states for batch 13
2025-01-16 14:24:43,568 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:24:43,568 [INFO] Encoding hidden states for batch 14
2025-01-16 14:24:45,520 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:45,521 [INFO] Encoding hidden states for batch 15
2025-01-16 14:24:46,179 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:24:46,180 [INFO] Encoding hidden states for batch 16
2025-01-16 14:24:46,577 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:24:46,578 [INFO] Encoding hidden states for batch 17
2025-01-16 14:24:46,937 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:46,937 [INFO] Encoding hidden states for batch 18
2025-01-16 14:24:47,396 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:47,396 [INFO] Encoding hidden states for batch 19
2025-01-16 14:24:47,928 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:47,929 [INFO] Encoding hidden states for batch 20
2025-01-16 14:24:48,606 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:24:48,607 [INFO] Encoding hidden states for batch 21
2025-01-16 14:24:49,002 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:24:49,003 [INFO] Encoding hidden states for batch 22
2025-01-16 14:24:49,519 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:24:49,520 [INFO] Encoding hidden states for batch 23
2025-01-16 14:24:49,987 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:24:49,988 [INFO] Encoding hidden states for batch 24
2025-01-16 14:24:50,363 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:50,364 [INFO] Encoding hidden states for batch 25
2025-01-16 14:24:50,833 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:24:50,834 [INFO] Encoding hidden states for batch 26
2025-01-16 14:24:51,208 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:24:51,209 [INFO] Encoding hidden states for batch 27
2025-01-16 14:24:51,588 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:24:51,590 [INFO] Encoding hidden states for batch 28
2025-01-16 14:24:52,032 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:24:52,033 [INFO] Encoding hidden states for batch 29
2025-01-16 14:24:52,455 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:24:52,456 [INFO] Encoding hidden states for batch 30
2025-01-16 14:24:52,817 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:24:52,818 [INFO] Encoding hidden states for batch 31
2025-01-16 14:24:53,165 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-16 14:24:53,166 [INFO] Encoding hidden states for batch 32
2025-01-16 14:24:53,179 [INFO] Total batches processed: 32
2025-01-16 14:24:53,182 [INFO] 最大长度:76
2025-01-16 14:24:53,795 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-16 14:24:53,796 [INFO] Computing non-zero element counts
2025-01-16 14:24:55,112 [INFO] Computing sum of non-zero elements
2025-01-16 14:24:55,972 [INFO] Computing mean of non-zero elements
2025-01-16 14:24:55,973 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:24:55,973 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:24:55,974 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:24:55,974 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:24:56,915 [INFO] Example prompt: Aha, we have good result!
2025-01-16 14:24:57,178 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:24:57,180 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:26:49,559 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 14:26:49,559 [INFO] Hyperparameters:
2025-01-16 14:26:49,559 [INFO]   layer: 6
2025-01-16 14:26:49,559 [INFO]   LLM: gpt2-small
2025-01-16 14:26:49,559 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:26:49,559 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:26:49,560 [INFO]   output_dir: ./results
2025-01-16 14:26:49,560 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:26:49,560 [INFO]   task: sentiment
2025-01-16 14:26:49,560 [INFO]   seed: 42
2025-01-16 14:26:49,560 [INFO]   data_size: 1000
2025-01-16 14:26:49,560 [INFO]   device: cpu
2025-01-16 14:26:49,560 [INFO]   alpha: 100
2025-01-16 14:26:49,560 [INFO]   steer: pos-neg
2025-01-16 14:26:49,560 [INFO]   method: val_mul
2025-01-16 14:26:49,560 [INFO]   topk_mean: 100
2025-01-16 14:26:49,560 [INFO]   topk_cnt: 100
2025-01-16 14:26:49,560 [INFO]   batch_size: 32
2025-01-16 14:26:49,560 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:26:49,560 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:26:49,560 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 14:26:49,561 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 14:26:49,666 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 14:26:49,673 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 14:26:49,674 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 14:26:49,674 [INFO] Hyperparameters:
2025-01-16 14:26:49,674 [INFO]   layer: 6
2025-01-16 14:26:49,674 [INFO]   LLM: gpt2-small
2025-01-16 14:26:49,674 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:26:49,674 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:26:49,674 [INFO]   output_dir: ./results
2025-01-16 14:26:49,674 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:26:49,674 [INFO]   task: sentiment
2025-01-16 14:26:49,674 [INFO]   seed: 42
2025-01-16 14:26:49,674 [INFO]   data_size: 1000
2025-01-16 14:26:49,674 [INFO]   device: cpu
2025-01-16 14:26:49,674 [INFO]   alpha: 100
2025-01-16 14:26:49,674 [INFO]   steer: pos-neg
2025-01-16 14:26:49,674 [INFO]   method: val_mul
2025-01-16 14:26:49,674 [INFO]   topk_mean: 100
2025-01-16 14:26:49,674 [INFO]   topk_cnt: 100
2025-01-16 14:26:49,674 [INFO]   batch_size: 32
2025-01-16 14:26:49,674 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:26:49,674 [INFO] Loading model: gpt2-small
2025-01-16 14:27:30,851 [INFO] Loading SAE for layer 6
2025-01-16 14:27:40,843 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 14:27:40,843 [INFO] Hyperparameters:
2025-01-16 14:27:40,843 [INFO]   layer: 6
2025-01-16 14:27:40,843 [INFO]   LLM: gpt2-small
2025-01-16 14:27:40,843 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:27:40,843 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:27:40,843 [INFO]   output_dir: ./results
2025-01-16 14:27:40,843 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:27:40,843 [INFO]   task: sentiment
2025-01-16 14:27:40,843 [INFO]   seed: 42
2025-01-16 14:27:40,843 [INFO]   data_size: 1000
2025-01-16 14:27:40,843 [INFO]   device: cpu
2025-01-16 14:27:40,843 [INFO]   alpha: 100
2025-01-16 14:27:40,843 [INFO]   steer: pos-neg
2025-01-16 14:27:40,843 [INFO]   method: val_mul
2025-01-16 14:27:40,843 [INFO]   topk_mean: 100
2025-01-16 14:27:40,843 [INFO]   topk_cnt: 100
2025-01-16 14:27:40,843 [INFO]   batch_size: 32
2025-01-16 14:27:40,844 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:27:40,844 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:27:40,844 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 14:27:40,844 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 14:27:40,950 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 14:27:40,957 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 14:27:40,958 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 14:27:40,958 [INFO] Hyperparameters:
2025-01-16 14:27:40,958 [INFO]   layer: 6
2025-01-16 14:27:40,958 [INFO]   LLM: gpt2-small
2025-01-16 14:27:40,958 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 14:27:40,958 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 14:27:40,958 [INFO]   output_dir: ./results
2025-01-16 14:27:40,958 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 14:27:40,958 [INFO]   task: sentiment
2025-01-16 14:27:40,958 [INFO]   seed: 42
2025-01-16 14:27:40,958 [INFO]   data_size: 1000
2025-01-16 14:27:40,958 [INFO]   device: cpu
2025-01-16 14:27:40,958 [INFO]   alpha: 100
2025-01-16 14:27:40,958 [INFO]   steer: pos-neg
2025-01-16 14:27:40,958 [INFO]   method: val_mul
2025-01-16 14:27:40,958 [INFO]   topk_mean: 100
2025-01-16 14:27:40,958 [INFO]   topk_cnt: 100
2025-01-16 14:27:40,958 [INFO]   batch_size: 32
2025-01-16 14:27:40,959 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 14:27:40,959 [INFO] Loading model: gpt2-small
2025-01-16 14:28:12,528 [INFO] pos-neg
2025-01-16 14:28:12,546 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:28:13,173 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:28:13,174 [INFO] Encoding hidden states for batch 1
2025-01-16 14:28:13,677 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:13,677 [INFO] Encoding hidden states for batch 2
2025-01-16 14:28:14,072 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:28:14,072 [INFO] Encoding hidden states for batch 3
2025-01-16 14:28:14,462 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:28:14,463 [INFO] Encoding hidden states for batch 4
2025-01-16 14:28:14,828 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:28:14,828 [INFO] Encoding hidden states for batch 5
2025-01-16 14:28:15,225 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:15,225 [INFO] Encoding hidden states for batch 6
2025-01-16 14:28:15,651 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:28:15,651 [INFO] Encoding hidden states for batch 7
2025-01-16 14:28:16,012 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-16 14:28:16,013 [INFO] Encoding hidden states for batch 8
2025-01-16 14:28:16,303 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:28:16,303 [INFO] Encoding hidden states for batch 9
2025-01-16 14:28:16,705 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:28:16,705 [INFO] Encoding hidden states for batch 10
2025-01-16 14:28:17,153 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:28:17,153 [INFO] Encoding hidden states for batch 11
2025-01-16 14:28:17,553 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:28:17,554 [INFO] Encoding hidden states for batch 12
2025-01-16 14:28:17,956 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:17,956 [INFO] Encoding hidden states for batch 13
2025-01-16 14:28:18,314 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:28:18,315 [INFO] Encoding hidden states for batch 14
2025-01-16 14:28:18,705 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-16 14:28:18,706 [INFO] Encoding hidden states for batch 15
2025-01-16 14:28:19,166 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-16 14:28:19,167 [INFO] Encoding hidden states for batch 16
2025-01-16 14:28:19,533 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:19,533 [INFO] Encoding hidden states for batch 17
2025-01-16 14:28:19,967 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:28:19,967 [INFO] Encoding hidden states for batch 18
2025-01-16 14:28:20,273 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:28:20,273 [INFO] Encoding hidden states for batch 19
2025-01-16 14:28:20,687 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:28:20,688 [INFO] Encoding hidden states for batch 20
2025-01-16 14:28:21,058 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:21,058 [INFO] Encoding hidden states for batch 21
2025-01-16 14:28:21,615 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:28:21,615 [INFO] Encoding hidden states for batch 22
2025-01-16 14:28:22,055 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:28:22,055 [INFO] Encoding hidden states for batch 23
2025-01-16 14:28:22,954 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:22,956 [INFO] Encoding hidden states for batch 24
2025-01-16 14:28:23,183 [INFO] Loading SAE for layer 6
2025-01-16 14:28:23,547 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:23,548 [INFO] Encoding hidden states for batch 25
2025-01-16 14:28:24,063 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:24,064 [INFO] Encoding hidden states for batch 26
2025-01-16 14:28:24,776 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:24,777 [INFO] Encoding hidden states for batch 27
2025-01-16 14:28:25,203 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:28:25,204 [INFO] Encoding hidden states for batch 28
2025-01-16 14:28:25,707 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:25,707 [INFO] Encoding hidden states for batch 29
2025-01-16 14:28:26,069 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:28:26,070 [INFO] Encoding hidden states for batch 30
2025-01-16 14:28:26,385 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:26,386 [INFO] Encoding hidden states for batch 31
2025-01-16 14:28:26,604 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-16 14:28:26,604 [INFO] Encoding hidden states for batch 32
2025-01-16 14:28:26,629 [INFO] Total batches processed: 32
2025-01-16 14:28:26,631 [INFO] 最大长度:60
2025-01-16 14:28:27,149 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-16 14:28:27,149 [INFO] Computing non-zero element counts
2025-01-16 14:28:28,185 [INFO] Computing sum of non-zero elements
2025-01-16 14:28:28,736 [INFO] Computing mean of non-zero elements
2025-01-16 14:28:28,737 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:28:28,737 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:28:28,737 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:28:28,737 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:28:29,227 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:28:29,805 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-16 14:28:29,805 [INFO] Encoding hidden states for batch 1
2025-01-16 14:28:30,182 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:30,182 [INFO] Encoding hidden states for batch 2
2025-01-16 14:28:30,605 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:30,606 [INFO] Encoding hidden states for batch 3
2025-01-16 14:28:30,992 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:28:30,993 [INFO] Encoding hidden states for batch 4
2025-01-16 14:28:31,305 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-16 14:28:31,306 [INFO] Encoding hidden states for batch 5
2025-01-16 14:28:31,709 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:28:31,709 [INFO] Encoding hidden states for batch 6
2025-01-16 14:28:32,343 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:28:32,344 [INFO] Encoding hidden states for batch 7
2025-01-16 14:28:32,876 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:32,877 [INFO] Encoding hidden states for batch 8
2025-01-16 14:28:33,359 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:33,360 [INFO] Encoding hidden states for batch 9
2025-01-16 14:28:33,802 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:28:33,803 [INFO] Encoding hidden states for batch 10
2025-01-16 14:28:34,230 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:28:34,231 [INFO] Encoding hidden states for batch 11
2025-01-16 14:28:35,776 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:35,777 [INFO] Encoding hidden states for batch 12
2025-01-16 14:28:37,636 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:28:37,637 [INFO] Encoding hidden states for batch 13
2025-01-16 14:28:38,197 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:38,198 [INFO] Encoding hidden states for batch 14
2025-01-16 14:28:39,116 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:39,117 [INFO] Encoding hidden states for batch 15
2025-01-16 14:28:39,648 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:39,648 [INFO] Encoding hidden states for batch 16
2025-01-16 14:28:40,126 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:28:40,126 [INFO] Encoding hidden states for batch 17
2025-01-16 14:28:40,906 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:28:40,906 [INFO] Encoding hidden states for batch 18
2025-01-16 14:28:41,939 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:41,940 [INFO] Encoding hidden states for batch 19
2025-01-16 14:28:43,164 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:28:43,165 [INFO] Encoding hidden states for batch 20
2025-01-16 14:28:43,738 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:43,739 [INFO] Encoding hidden states for batch 21
2025-01-16 14:28:44,735 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:28:44,736 [INFO] Encoding hidden states for batch 22
2025-01-16 14:28:45,594 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:28:45,595 [INFO] Encoding hidden states for batch 23
2025-01-16 14:28:46,045 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:28:46,046 [INFO] Encoding hidden states for batch 24
2025-01-16 14:28:46,499 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:28:46,499 [INFO] Encoding hidden states for batch 25
2025-01-16 14:28:46,910 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:28:46,911 [INFO] Encoding hidden states for batch 26
2025-01-16 14:28:47,379 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:47,380 [INFO] Encoding hidden states for batch 27
2025-01-16 14:28:47,832 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:28:47,833 [INFO] Encoding hidden states for batch 28
2025-01-16 14:28:48,283 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:28:48,284 [INFO] Encoding hidden states for batch 29
2025-01-16 14:28:48,895 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:28:48,896 [INFO] Encoding hidden states for batch 30
2025-01-16 14:28:49,520 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:28:49,520 [INFO] Encoding hidden states for batch 31
2025-01-16 14:28:50,230 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-16 14:28:50,231 [INFO] Encoding hidden states for batch 32
2025-01-16 14:28:50,264 [INFO] Total batches processed: 32
2025-01-16 14:28:50,266 [INFO] 最大长度:59
2025-01-16 14:28:50,830 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-16 14:28:50,831 [INFO] Computing non-zero element counts
2025-01-16 14:28:51,782 [INFO] Computing sum of non-zero elements
2025-01-16 14:28:52,329 [INFO] Computing mean of non-zero elements
2025-01-16 14:28:52,330 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:28:52,330 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:28:52,330 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:28:52,331 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:28:52,771 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:28:55,656 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-16 14:28:55,656 [INFO] Encoding hidden states for batch 1
2025-01-16 14:28:56,464 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:28:56,465 [INFO] Encoding hidden states for batch 2
2025-01-16 14:28:57,242 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:28:57,242 [INFO] Encoding hidden states for batch 3
2025-01-16 14:28:57,625 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:28:57,626 [INFO] Encoding hidden states for batch 4
2025-01-16 14:28:57,939 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:28:57,940 [INFO] Encoding hidden states for batch 5
2025-01-16 14:28:58,327 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:28:58,327 [INFO] Encoding hidden states for batch 6
2025-01-16 14:28:58,785 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:28:58,785 [INFO] Encoding hidden states for batch 7
2025-01-16 14:28:59,331 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:28:59,331 [INFO] Encoding hidden states for batch 8
2025-01-16 14:28:59,808 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:28:59,808 [INFO] Encoding hidden states for batch 9
2025-01-16 14:29:00,289 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:00,289 [INFO] Encoding hidden states for batch 10
2025-01-16 14:29:00,681 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-16 14:29:00,682 [INFO] Encoding hidden states for batch 11
2025-01-16 14:29:01,273 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:29:01,274 [INFO] Encoding hidden states for batch 12
2025-01-16 14:29:01,688 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:01,688 [INFO] Encoding hidden states for batch 13
2025-01-16 14:29:02,012 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:02,013 [INFO] Encoding hidden states for batch 14
2025-01-16 14:29:02,769 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:02,770 [INFO] Encoding hidden states for batch 15
2025-01-16 14:29:03,210 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:29:03,211 [INFO] Encoding hidden states for batch 16
2025-01-16 14:29:03,708 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:03,709 [INFO] Encoding hidden states for batch 17
2025-01-16 14:29:04,372 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:04,372 [INFO] Encoding hidden states for batch 18
2025-01-16 14:29:05,309 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:05,310 [INFO] Encoding hidden states for batch 19
2025-01-16 14:29:05,950 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:05,951 [INFO] Encoding hidden states for batch 20
2025-01-16 14:29:06,670 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:29:06,671 [INFO] Encoding hidden states for batch 21
2025-01-16 14:29:07,049 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:29:07,050 [INFO] Encoding hidden states for batch 22
2025-01-16 14:29:07,808 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:29:07,809 [INFO] Encoding hidden states for batch 23
2025-01-16 14:29:08,213 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:08,213 [INFO] Encoding hidden states for batch 24
2025-01-16 14:29:08,799 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:08,800 [INFO] Encoding hidden states for batch 25
2025-01-16 14:29:09,181 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:09,181 [INFO] Encoding hidden states for batch 26
2025-01-16 14:29:09,614 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:29:09,614 [INFO] Encoding hidden states for batch 27
2025-01-16 14:29:10,122 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:10,123 [INFO] Encoding hidden states for batch 28
2025-01-16 14:29:10,649 [INFO] pos-neg
2025-01-16 14:29:10,663 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:29:11,555 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:11,555 [INFO] Encoding hidden states for batch 1
2025-01-16 14:29:12,192 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:12,193 [INFO] Encoding hidden states for batch 2
2025-01-16 14:29:12,613 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:29:12,614 [INFO] Encoding hidden states for batch 3
2025-01-16 14:29:13,051 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:13,051 [INFO] Encoding hidden states for batch 4
2025-01-16 14:29:13,118 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:13,119 [INFO] Encoding hidden states for batch 29
2025-01-16 14:29:13,438 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:29:13,439 [INFO] Encoding hidden states for batch 5
2025-01-16 14:29:13,891 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:13,891 [INFO] Encoding hidden states for batch 6
2025-01-16 14:29:14,408 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:14,409 [INFO] Encoding hidden states for batch 7
2025-01-16 14:29:14,866 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-16 14:29:14,866 [INFO] Encoding hidden states for batch 8
2025-01-16 14:29:15,211 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:15,211 [INFO] Encoding hidden states for batch 9
2025-01-16 14:29:15,710 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:29:15,711 [INFO] Encoding hidden states for batch 10
2025-01-16 14:29:15,935 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:15,936 [INFO] Encoding hidden states for batch 30
2025-01-16 14:29:16,331 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:29:16,332 [INFO] Encoding hidden states for batch 11
2025-01-16 14:29:18,008 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:29:18,008 [INFO] Encoding hidden states for batch 12
2025-01-16 14:29:18,728 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:18,729 [INFO] Encoding hidden states for batch 13
2025-01-16 14:29:19,205 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:19,206 [INFO] Encoding hidden states for batch 14
2025-01-16 14:29:19,711 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-16 14:29:19,711 [INFO] Encoding hidden states for batch 15
2025-01-16 14:29:20,069 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-16 14:29:20,069 [INFO] Encoding hidden states for batch 16
2025-01-16 14:29:20,468 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:20,469 [INFO] Encoding hidden states for batch 17
2025-01-16 14:29:20,962 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:20,962 [INFO] Encoding hidden states for batch 18
2025-01-16 14:29:21,367 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:21,368 [INFO] Encoding hidden states for batch 19
2025-01-16 14:29:21,940 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:29:21,941 [INFO] Encoding hidden states for batch 20
2025-01-16 14:29:22,007 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:29:22,008 [INFO] Encoding hidden states for batch 31
2025-01-16 14:29:22,479 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:22,480 [INFO] Encoding hidden states for batch 21
2025-01-16 14:29:22,985 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-16 14:29:22,986 [INFO] Encoding hidden states for batch 22
2025-01-16 14:29:23,444 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:29:23,445 [INFO] Encoding hidden states for batch 23
2025-01-16 14:29:23,850 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:23,851 [INFO] Encoding hidden states for batch 24
2025-01-16 14:29:24,272 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:24,272 [INFO] Encoding hidden states for batch 25
2025-01-16 14:29:24,396 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-16 14:29:24,397 [INFO] Encoding hidden states for batch 32
2025-01-16 14:29:24,465 [INFO] Total batches processed: 32
2025-01-16 14:29:24,485 [INFO] 最大长度:76
2025-01-16 14:29:24,761 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:24,762 [INFO] Encoding hidden states for batch 26
2025-01-16 14:29:25,233 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:25,234 [INFO] Encoding hidden states for batch 27
2025-01-16 14:29:25,863 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-16 14:29:25,863 [INFO] Computing non-zero element counts
2025-01-16 14:29:25,863 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:25,863 [INFO] Encoding hidden states for batch 28
2025-01-16 14:29:26,657 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:26,657 [INFO] Encoding hidden states for batch 29
2025-01-16 14:29:27,008 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:29:27,008 [INFO] Encoding hidden states for batch 30
2025-01-16 14:29:27,336 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:27,336 [INFO] Encoding hidden states for batch 31
2025-01-16 14:29:27,526 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-16 14:29:27,526 [INFO] Encoding hidden states for batch 32
2025-01-16 14:29:27,533 [INFO] Total batches processed: 32
2025-01-16 14:29:27,535 [INFO] 最大长度:60
2025-01-16 14:29:27,790 [INFO] Computing sum of non-zero elements
2025-01-16 14:29:28,142 [INFO] Concatenated batch latents shape: torch.Size([1000, 60, 24576])
2025-01-16 14:29:28,143 [INFO] Computing non-zero element counts
2025-01-16 14:29:28,873 [INFO] Computing mean of non-zero elements
2025-01-16 14:29:28,873 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:29:28,873 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:29:28,873 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:29:28,873 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:29:29,289 [INFO] Computing sum of non-zero elements
2025-01-16 14:29:29,692 [INFO] Example prompt: Aha, we have good result!
2025-01-16 14:29:29,842 [INFO] Computing mean of non-zero elements
2025-01-16 14:29:29,843 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:29:29,843 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:29:29,843 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:29:29,843 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:29:29,867 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:29:29,868 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:29:30,530 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:29:31,025 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-16 14:29:31,025 [INFO] Encoding hidden states for batch 1
2025-01-16 14:29:32,593 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:32,594 [INFO] Encoding hidden states for batch 2
2025-01-16 14:29:33,258 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:33,259 [INFO] Encoding hidden states for batch 3
2025-01-16 14:29:33,854 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:33,855 [INFO] Encoding hidden states for batch 4
2025-01-16 14:29:34,381 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-16 14:29:34,381 [INFO] Encoding hidden states for batch 5
2025-01-16 14:29:34,862 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:34,863 [INFO] Encoding hidden states for batch 6
2025-01-16 14:29:35,254 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:35,255 [INFO] Encoding hidden states for batch 7
2025-01-16 14:29:35,857 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:35,857 [INFO] Encoding hidden states for batch 8
2025-01-16 14:29:36,361 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:36,362 [INFO] Encoding hidden states for batch 9
2025-01-16 14:29:36,932 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:29:36,933 [INFO] Encoding hidden states for batch 10
2025-01-16 14:29:37,430 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:29:37,431 [INFO] Encoding hidden states for batch 11
2025-01-16 14:29:37,966 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:37,967 [INFO] Encoding hidden states for batch 12
2025-01-16 14:29:38,416 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:38,416 [INFO] Encoding hidden states for batch 13
2025-01-16 14:29:38,871 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:38,872 [INFO] Encoding hidden states for batch 14
2025-01-16 14:29:39,288 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:39,289 [INFO] Encoding hidden states for batch 15
2025-01-16 14:29:39,732 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:39,733 [INFO] Encoding hidden states for batch 16
2025-01-16 14:29:40,241 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:29:40,242 [INFO] Encoding hidden states for batch 17
2025-01-16 14:29:40,706 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:29:40,707 [INFO] Encoding hidden states for batch 18
2025-01-16 14:29:41,176 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:41,176 [INFO] Encoding hidden states for batch 19
2025-01-16 14:29:41,752 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:29:41,753 [INFO] Encoding hidden states for batch 20
2025-01-16 14:29:42,140 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:42,140 [INFO] Encoding hidden states for batch 21
2025-01-16 14:29:42,523 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:42,524 [INFO] Encoding hidden states for batch 22
2025-01-16 14:29:43,072 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:29:43,073 [INFO] Encoding hidden states for batch 23
2025-01-16 14:29:43,489 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:29:43,490 [INFO] Encoding hidden states for batch 24
2025-01-16 14:29:44,006 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:44,006 [INFO] Encoding hidden states for batch 25
2025-01-16 14:29:44,442 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-16 14:29:44,443 [INFO] Encoding hidden states for batch 26
2025-01-16 14:29:44,863 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:44,864 [INFO] Encoding hidden states for batch 27
2025-01-16 14:29:45,357 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:29:45,358 [INFO] Encoding hidden states for batch 28
2025-01-16 14:29:45,746 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:29:45,747 [INFO] Encoding hidden states for batch 29
2025-01-16 14:29:46,500 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-16 14:29:46,501 [INFO] Encoding hidden states for batch 30
2025-01-16 14:29:47,047 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-16 14:29:47,048 [INFO] Encoding hidden states for batch 31
2025-01-16 14:29:47,366 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-16 14:29:47,366 [INFO] Encoding hidden states for batch 32
2025-01-16 14:29:47,388 [INFO] Total batches processed: 32
2025-01-16 14:29:47,390 [INFO] 最大长度:59
2025-01-16 14:29:47,881 [INFO] Concatenated batch latents shape: torch.Size([1000, 59, 24576])
2025-01-16 14:29:47,881 [INFO] Computing non-zero element counts
2025-01-16 14:29:49,134 [INFO] Computing sum of non-zero elements
2025-01-16 14:29:49,787 [INFO] Computing mean of non-zero elements
2025-01-16 14:29:49,787 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:29:49,787 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:29:49,787 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:29:49,788 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:29:50,433 [INFO] Running model with cache to obtain hidden states
2025-01-16 14:29:51,850 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-16 14:29:51,850 [INFO] Encoding hidden states for batch 1
2025-01-16 14:29:52,374 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:29:52,374 [INFO] Encoding hidden states for batch 2
2025-01-16 14:29:52,877 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:52,878 [INFO] Encoding hidden states for batch 3
2025-01-16 14:29:53,305 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:53,305 [INFO] Encoding hidden states for batch 4
2025-01-16 14:29:53,675 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:53,676 [INFO] Encoding hidden states for batch 5
2025-01-16 14:29:54,101 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-16 14:29:54,102 [INFO] Encoding hidden states for batch 6
2025-01-16 14:29:54,547 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-16 14:29:54,548 [INFO] Encoding hidden states for batch 7
2025-01-16 14:29:54,963 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:29:54,964 [INFO] Encoding hidden states for batch 8
2025-01-16 14:29:55,404 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:55,405 [INFO] Encoding hidden states for batch 9
2025-01-16 14:29:55,839 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:29:55,840 [INFO] Encoding hidden states for batch 10
2025-01-16 14:29:56,224 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-16 14:29:56,225 [INFO] Encoding hidden states for batch 11
2025-01-16 14:29:56,717 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:29:56,718 [INFO] Encoding hidden states for batch 12
2025-01-16 14:29:57,163 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-16 14:29:57,163 [INFO] Encoding hidden states for batch 13
2025-01-16 14:29:57,549 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:57,550 [INFO] Encoding hidden states for batch 14
2025-01-16 14:29:57,919 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:29:57,920 [INFO] Encoding hidden states for batch 15
2025-01-16 14:29:58,350 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-16 14:29:58,350 [INFO] Encoding hidden states for batch 16
2025-01-16 14:29:58,782 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-16 14:29:58,783 [INFO] Encoding hidden states for batch 17
2025-01-16 14:29:59,224 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:29:59,225 [INFO] Encoding hidden states for batch 18
2025-01-16 14:29:59,715 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:29:59,715 [INFO] Encoding hidden states for batch 19
2025-01-16 14:30:00,115 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:30:00,115 [INFO] Encoding hidden states for batch 20
2025-01-16 14:30:00,649 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-16 14:30:00,650 [INFO] Encoding hidden states for batch 21
2025-01-16 14:30:01,084 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:30:01,084 [INFO] Encoding hidden states for batch 22
2025-01-16 14:30:01,669 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-16 14:30:01,670 [INFO] Encoding hidden states for batch 23
2025-01-16 14:30:02,084 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-16 14:30:02,085 [INFO] Encoding hidden states for batch 24
2025-01-16 14:30:02,462 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:30:02,463 [INFO] Encoding hidden states for batch 25
2025-01-16 14:30:02,909 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-16 14:30:02,910 [INFO] Encoding hidden states for batch 26
2025-01-16 14:30:03,318 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-16 14:30:03,319 [INFO] Encoding hidden states for batch 27
2025-01-16 14:30:03,731 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-16 14:30:03,732 [INFO] Encoding hidden states for batch 28
2025-01-16 14:30:04,145 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-16 14:30:04,145 [INFO] Encoding hidden states for batch 29
2025-01-16 14:30:04,569 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-16 14:30:04,570 [INFO] Encoding hidden states for batch 30
2025-01-16 14:30:04,964 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-16 14:30:04,965 [INFO] Encoding hidden states for batch 31
2025-01-16 14:30:05,281 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-16 14:30:05,281 [INFO] Encoding hidden states for batch 32
2025-01-16 14:30:05,306 [INFO] Total batches processed: 32
2025-01-16 14:30:05,309 [INFO] 最大长度:76
2025-01-16 14:30:05,889 [INFO] Concatenated batch latents shape: torch.Size([1000, 76, 24576])
2025-01-16 14:30:05,889 [INFO] Computing non-zero element counts
2025-01-16 14:30:07,498 [INFO] Computing sum of non-zero elements
2025-01-16 14:30:08,303 [INFO] Computing mean of non-zero elements
2025-01-16 14:30:08,304 [INFO] Selecting top-k indices based on nz_mean
2025-01-16 14:30:08,304 [INFO] Top 100 nz_mean values selected.
2025-01-16 14:30:08,305 [INFO] Selecting top-k indices based on act_cnt
2025-01-16 14:30:08,305 [INFO] Top 100 act_cnt values selected.
2025-01-16 14:30:09,155 [INFO] Example prompt: Aha, we have good result!
2025-01-16 14:30:09,207 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:09,207 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:17,345 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:17,346 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:25,836 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:25,837 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:33,810 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:33,811 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:41,956 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:41,957 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:49,203 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:49,203 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:30:57,731 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:30:57,732 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 14:31:07,126 [INFO] Computing steering vectors using method: val_mul
2025-01-16 14:31:07,127 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 15:24:00,225 [INFO] Computing steering vectors using method: val_mul
2025-01-16 15:24:00,226 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 15:25:38,991 [INFO] Computing steering vectors using method: val_mul
2025-01-16 15:25:38,992 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 16:25:53,712 [INFO] Computing steering vectors using method: val_mul
2025-01-16 16:25:53,713 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 16:33:41,814 [INFO] Computing steering vectors using method: val_mul
2025-01-16 16:33:41,815 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 16:50:17,313 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-16 16:50:17,314 [INFO] Hyperparameters:
2025-01-16 16:50:17,314 [INFO]   layer: 6
2025-01-16 16:50:17,314 [INFO]   LLM: gpt2-small
2025-01-16 16:50:17,315 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 16:50:17,315 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 16:50:17,316 [INFO]   output_dir: ./results
2025-01-16 16:50:17,316 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 16:50:17,316 [INFO]   task: sentiment
2025-01-16 16:50:17,317 [INFO]   seed: 42
2025-01-16 16:50:17,317 [INFO]   data_size: 1000
2025-01-16 16:50:17,317 [INFO]   device: cuda
2025-01-16 16:50:17,318 [INFO]   alpha: 100
2025-01-16 16:50:17,318 [INFO]   steer: pos-neg
2025-01-16 16:50:17,318 [INFO]   method: val_mul
2025-01-16 16:50:17,318 [INFO]   topk_mean: 100
2025-01-16 16:50:17,319 [INFO]   topk_cnt: 100
2025-01-16 16:50:17,319 [INFO]   batch_size: 32
2025-01-16 16:50:17,320 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 16:50:17,320 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 16:50:17,321 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-16 16:50:17,321 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-16 16:50:17,463 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-16 16:50:17,474 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-16 16:50:17,475 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-16 16:50:17,475 [INFO] Hyperparameters:
2025-01-16 16:50:17,475 [INFO]   layer: 6
2025-01-16 16:50:17,475 [INFO]   LLM: gpt2-small
2025-01-16 16:50:17,475 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-16 16:50:17,475 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-16 16:50:17,475 [INFO]   output_dir: ./results
2025-01-16 16:50:17,475 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-16 16:50:17,475 [INFO]   task: sentiment
2025-01-16 16:50:17,475 [INFO]   seed: 42
2025-01-16 16:50:17,475 [INFO]   data_size: 1000
2025-01-16 16:50:17,475 [INFO]   device: cuda
2025-01-16 16:50:17,475 [INFO]   alpha: 100
2025-01-16 16:50:17,475 [INFO]   steer: pos-neg
2025-01-16 16:50:17,475 [INFO]   method: val_mul
2025-01-16 16:50:17,475 [INFO]   topk_mean: 100
2025-01-16 16:50:17,476 [INFO]   topk_cnt: 100
2025-01-16 16:50:17,476 [INFO]   batch_size: 32
2025-01-16 16:50:17,476 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-16 16:50:17,476 [INFO] Loading model: gpt2-small
2025-01-16 16:51:02,432 [INFO] Loading SAE for layer 6
2025-01-16 16:51:34,895 [INFO] pos-neg
2025-01-16 16:51:34,900 [INFO] Running model with cache to obtain hidden states
2025-01-16 16:51:35,122 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,213 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,214 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,283 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,283 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,285 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,334 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,335 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,337 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,391 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,392 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,394 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,443 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,444 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,446 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,494 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,496 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,497 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,556 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,557 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,559 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,605 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,606 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,607 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,665 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,666 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,668 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,719 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,720 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,722 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,768 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,769 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,771 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,826 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,827 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,829 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,873 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,875 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,877 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,924 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,924 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,926 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:35,983 [INFO] Computing non-zero element counts
2025-01-16 16:51:35,983 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:35,985 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,032 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,033 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,034 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,078 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,079 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,081 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,124 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,125 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,126 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,173 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,174 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,176 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,234 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,235 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,237 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,285 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,286 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,288 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,352 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,353 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,356 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,412 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,414 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,415 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,466 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,467 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,469 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,527 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,528 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,530 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,589 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,590 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,592 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,650 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,650 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,652 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,701 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,702 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,704 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,763 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,764 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,766 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,821 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,822 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,825 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,880 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,881 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,883 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,965 [INFO] Computing non-zero element counts
2025-01-16 16:51:36,966 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:36,967 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:36,970 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-16 16:51:36,978 [INFO] Running model with cache to obtain hidden states
2025-01-16 16:51:37,035 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,036 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,039 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,082 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,083 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,085 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,130 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,131 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,133 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,187 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,188 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,190 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,237 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,238 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,239 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,302 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,303 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,305 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,356 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,357 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,359 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,402 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,403 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,405 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,458 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,459 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,462 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,518 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,518 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,521 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,574 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,574 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,577 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,631 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,632 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,634 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,691 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,692 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,694 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,744 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,745 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,746 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,815 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,816 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,818 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,868 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,869 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,871 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,926 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,927 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,929 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:37,980 [INFO] Computing non-zero element counts
2025-01-16 16:51:37,981 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:37,983 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,035 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,036 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,039 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,094 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,095 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,097 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,152 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,152 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,154 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,205 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,206 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,208 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,264 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,265 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,268 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,325 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,326 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,328 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,382 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,383 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,385 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,438 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,439 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,440 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,685 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,686 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,688 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,742 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,743 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,744 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,794 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,795 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,797 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,850 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,850 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,852 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,907 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,908 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,910 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,951 [INFO] Computing non-zero element counts
2025-01-16 16:51:38,952 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:38,953 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:38,954 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-16 16:51:38,962 [INFO] Running model with cache to obtain hidden states
2025-01-16 16:51:39,014 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,015 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,020 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,066 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,067 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,070 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,117 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,118 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,120 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,163 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,164 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,166 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,218 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,219 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,220 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,262 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,263 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,265 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,318 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,319 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,321 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,367 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,368 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,370 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,424 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,425 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,427 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,474 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,475 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,477 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,535 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,536 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,537 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,594 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,595 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,598 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,657 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,658 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,660 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,712 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,713 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,715 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,768 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,769 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,770 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,832 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,833 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,835 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,893 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,894 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,896 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:39,945 [INFO] Computing non-zero element counts
2025-01-16 16:51:39,946 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:39,948 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,001 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,045 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,046 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,104 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,105 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,107 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,167 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,187 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,188 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,248 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,249 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,250 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,302 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,304 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,306 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,361 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,386 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,387 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,454 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,455 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,457 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,504 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,528 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,529 [INFO] Computing mean of non-zero elements
2025-01-16 16:51:40,579 [INFO] Computing non-zero element counts
2025-01-16 16:51:40,581 [INFO] Computing sum of non-zero elements
2025-01-16 16:51:40,582 [INFO] Computing mean of non-zero elements
2025-01-16 18:17:55,701 [INFO] Computing steering vectors using method: val_mul
2025-01-16 18:17:55,702 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 18:40:34,807 [INFO] Computing steering vectors using method: val_mul
2025-01-16 18:40:34,807 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 19:29:33,920 [INFO] Computing steering vectors using method: val_mul
2025-01-16 19:29:33,921 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 19:49:41,873 [INFO] Computing steering vectors using method: val_mul
2025-01-16 19:49:41,873 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-16 20:09:55,837 [INFO] Computing steering vectors using method: val_mul
2025-01-16 20:09:55,838 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 14:06:21,392 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/execution.log
2025-01-17 14:06:21,394 [INFO] Hyperparameters:
2025-01-17 14:06:21,396 [INFO]   layer: 6
2025-01-17 14:06:21,397 [INFO]   LLM: gpt2-small
2025-01-17 14:06:21,398 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 14:06:21,399 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 14:06:21,400 [INFO]   output_dir: ./results
2025-01-17 14:06:21,402 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 14:06:21,402 [INFO]   task: sentiment
2025-01-17 14:06:21,403 [INFO]   seed: 42
2025-01-17 14:06:21,404 [INFO]   data_size: 1000
2025-01-17 14:06:21,405 [INFO]   device: cpu
2025-01-17 14:06:21,406 [INFO]   alpha: 100
2025-01-17 14:06:21,407 [INFO]   steer: pos-neg
2025-01-17 14:06:21,409 [INFO]   method: val_mul
2025-01-17 14:06:21,409 [INFO]   topk_mean: 100
2025-01-17 14:06:21,410 [INFO]   topk_cnt: 100
2025-01-17 14:06:21,411 [INFO]   batch_size: 32
2025-01-17 14:06:21,426 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 14:06:21,515 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 14:06:21,517 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 14:06:21,519 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 14:06:21,710 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 14:06:21,720 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
