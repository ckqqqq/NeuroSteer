2025-01-17 11:06:56,514 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:06:56,514 [INFO] Hyperparameters:
2025-01-17 11:06:56,514 [INFO]   layer: 6
2025-01-17 11:06:56,514 [INFO]   LLM: gpt2-small
2025-01-17 11:06:56,514 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:06:56,514 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:06:56,514 [INFO]   output_dir: ./results
2025-01-17 11:06:56,514 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:06:56,514 [INFO]   task: sentiment
2025-01-17 11:06:56,514 [INFO]   seed: 42
2025-01-17 11:06:56,515 [INFO]   data_size: 1000
2025-01-17 11:06:56,515 [INFO]   device: cuda
2025-01-17 11:06:56,515 [INFO]   alpha: 100
2025-01-17 11:06:56,515 [INFO]   steer: pos-neg
2025-01-17 11:06:56,515 [INFO]   method: val_mul
2025-01-17 11:06:56,515 [INFO]   topk_mean: 100
2025-01-17 11:06:56,515 [INFO]   topk_cnt: 100
2025-01-17 11:06:56,515 [INFO]   batch_size: 32
2025-01-17 11:06:56,515 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:06:56,515 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:06:56,515 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:06:56,515 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:06:56,636 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:06:56,644 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:06:56,645 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:06:56,645 [INFO] Hyperparameters:
2025-01-17 11:06:56,645 [INFO]   layer: 6
2025-01-17 11:06:56,645 [INFO]   LLM: gpt2-small
2025-01-17 11:06:56,645 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:06:56,645 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:06:56,645 [INFO]   output_dir: ./results
2025-01-17 11:06:56,645 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:06:56,645 [INFO]   task: sentiment
2025-01-17 11:06:56,645 [INFO]   seed: 42
2025-01-17 11:06:56,645 [INFO]   data_size: 1000
2025-01-17 11:06:56,645 [INFO]   device: cuda
2025-01-17 11:06:56,645 [INFO]   alpha: 100
2025-01-17 11:06:56,645 [INFO]   steer: pos-neg
2025-01-17 11:06:56,645 [INFO]   method: val_mul
2025-01-17 11:06:56,645 [INFO]   topk_mean: 100
2025-01-17 11:06:56,645 [INFO]   topk_cnt: 100
2025-01-17 11:06:56,645 [INFO]   batch_size: 32
2025-01-17 11:06:56,646 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:06:56,646 [INFO] Loading model: gpt2-small
2025-01-17 11:07:37,728 [INFO] Loading SAE for layer 6
2025-01-17 11:08:09,029 [INFO] pos-neg
2025-01-17 11:08:09,035 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:08:09,036 [INFO] Batch 1: batch_size 32
2025-01-17 11:08:09,231 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:08:09,232 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,236 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,236 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,236 [INFO] Batch 2: batch_size 32
2025-01-17 11:08:09,291 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:09,292 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,294 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,294 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,294 [INFO] Batch 3: batch_size 32
2025-01-17 11:08:09,332 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:08:09,333 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,333 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,333 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,333 [INFO] Batch 4: batch_size 32
2025-01-17 11:08:09,372 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:08:09,373 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,373 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,373 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,373 [INFO] Batch 5: batch_size 32
2025-01-17 11:08:09,408 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:08:09,408 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,408 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,408 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,409 [INFO] Batch 6: batch_size 32
2025-01-17 11:08:09,443 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:09,444 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,444 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,444 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,444 [INFO] Batch 7: batch_size 32
2025-01-17 11:08:09,480 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:08:09,480 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,480 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,480 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,480 [INFO] Batch 8: batch_size 32
2025-01-17 11:08:09,515 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:08:09,515 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,515 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,515 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,515 [INFO] Batch 9: batch_size 32
2025-01-17 11:08:09,555 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:09,556 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,556 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,556 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,556 [INFO] Batch 10: batch_size 32
2025-01-17 11:08:09,592 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:08:09,593 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,594 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,594 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,594 [INFO] Batch 11: batch_size 32
2025-01-17 11:08:09,629 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:08:09,630 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,630 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,630 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,630 [INFO] Batch 12: batch_size 32
2025-01-17 11:08:09,665 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:08:09,666 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,666 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,666 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,667 [INFO] Batch 13: batch_size 32
2025-01-17 11:08:09,702 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:09,702 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,702 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,702 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,703 [INFO] Batch 14: batch_size 32
2025-01-17 11:08:09,737 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:08:09,737 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,737 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,737 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,738 [INFO] Batch 15: batch_size 32
2025-01-17 11:08:09,772 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:08:09,773 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,773 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,773 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,773 [INFO] Batch 16: batch_size 32
2025-01-17 11:08:09,808 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:08:09,808 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,808 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,808 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,809 [INFO] Batch 17: batch_size 32
2025-01-17 11:08:09,843 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:09,843 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,843 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,844 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,844 [INFO] Batch 18: batch_size 32
2025-01-17 11:08:09,878 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:09,878 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,878 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,878 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,879 [INFO] Batch 19: batch_size 32
2025-01-17 11:08:09,913 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:09,914 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,914 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,914 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,914 [INFO] Batch 20: batch_size 32
2025-01-17 11:08:09,950 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:08:09,950 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,951 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,951 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,951 [INFO] Batch 21: batch_size 32
2025-01-17 11:08:09,986 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:09,987 [INFO] Computing non-zero element counts
2025-01-17 11:08:09,987 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:09,987 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:09,987 [INFO] Batch 22: batch_size 32
2025-01-17 11:08:10,021 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:08:10,022 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,022 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,022 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,022 [INFO] Batch 23: batch_size 32
2025-01-17 11:08:10,059 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:08:10,060 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,060 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,060 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,060 [INFO] Batch 24: batch_size 32
2025-01-17 11:08:10,095 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:10,095 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,095 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,096 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,096 [INFO] Batch 25: batch_size 32
2025-01-17 11:08:10,130 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:10,131 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,131 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,131 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,131 [INFO] Batch 26: batch_size 32
2025-01-17 11:08:10,166 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:10,167 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,167 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,167 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,167 [INFO] Batch 27: batch_size 32
2025-01-17 11:08:10,206 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:10,207 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,207 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,207 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,207 [INFO] Batch 28: batch_size 32
2025-01-17 11:08:10,244 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:08:10,245 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,245 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,245 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,245 [INFO] Batch 29: batch_size 32
2025-01-17 11:08:10,281 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:10,281 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,281 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,281 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,281 [INFO] Batch 30: batch_size 32
2025-01-17 11:08:10,317 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:08:10,317 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,318 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,318 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,318 [INFO] Batch 31: batch_size 32
2025-01-17 11:08:10,353 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:10,353 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,353 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,353 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,354 [INFO] Batch 32: batch_size 32
2025-01-17 11:08:10,412 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:08:10,413 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,413 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,413 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,414 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:08:10,420 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:08:10,420 [INFO] Batch 1: batch_size 32
2025-01-17 11:08:10,456 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:08:10,456 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,457 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,457 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,457 [INFO] Batch 2: batch_size 32
2025-01-17 11:08:10,491 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:10,492 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,492 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,492 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,492 [INFO] Batch 3: batch_size 32
2025-01-17 11:08:10,527 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:10,528 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,528 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,528 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,528 [INFO] Batch 4: batch_size 32
2025-01-17 11:08:10,565 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:08:10,565 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,565 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,565 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,566 [INFO] Batch 5: batch_size 32
2025-01-17 11:08:10,605 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:08:10,606 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,606 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,606 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,606 [INFO] Batch 6: batch_size 32
2025-01-17 11:08:10,643 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:10,643 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,644 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,644 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,644 [INFO] Batch 7: batch_size 32
2025-01-17 11:08:10,680 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:10,681 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,681 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,681 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,681 [INFO] Batch 8: batch_size 32
2025-01-17 11:08:10,717 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:10,717 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,718 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,718 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,718 [INFO] Batch 9: batch_size 32
2025-01-17 11:08:10,755 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:10,755 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,756 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,756 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,756 [INFO] Batch 10: batch_size 32
2025-01-17 11:08:10,794 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:08:10,794 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,794 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,794 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,794 [INFO] Batch 11: batch_size 32
2025-01-17 11:08:10,832 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:08:10,832 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,832 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,832 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,832 [INFO] Batch 12: batch_size 32
2025-01-17 11:08:10,868 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:10,868 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,869 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,869 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,869 [INFO] Batch 13: batch_size 32
2025-01-17 11:08:10,904 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:10,905 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,905 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,905 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,905 [INFO] Batch 14: batch_size 32
2025-01-17 11:08:10,940 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:10,941 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,941 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,941 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,941 [INFO] Batch 15: batch_size 32
2025-01-17 11:08:10,977 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:10,977 [INFO] Computing non-zero element counts
2025-01-17 11:08:10,977 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:10,977 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:10,977 [INFO] Batch 16: batch_size 32
2025-01-17 11:08:11,013 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:11,013 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,013 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,013 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,013 [INFO] Batch 17: batch_size 32
2025-01-17 11:08:11,051 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:08:11,052 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,052 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,052 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,052 [INFO] Batch 18: batch_size 32
2025-01-17 11:08:11,087 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:11,088 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,088 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,088 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,088 [INFO] Batch 19: batch_size 32
2025-01-17 11:08:11,138 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:11,138 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,139 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,139 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,139 [INFO] Batch 20: batch_size 32
2025-01-17 11:08:11,174 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:08:11,175 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,175 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,175 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,175 [INFO] Batch 21: batch_size 32
2025-01-17 11:08:11,209 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:11,209 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,210 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,210 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,210 [INFO] Batch 22: batch_size 32
2025-01-17 11:08:11,245 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:11,246 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,246 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,246 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,246 [INFO] Batch 23: batch_size 32
2025-01-17 11:08:11,281 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:08:11,281 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,281 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,281 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,282 [INFO] Batch 24: batch_size 32
2025-01-17 11:08:11,316 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:08:11,316 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,317 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,317 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,317 [INFO] Batch 25: batch_size 32
2025-01-17 11:08:11,357 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:11,358 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,358 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,358 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,358 [INFO] Batch 26: batch_size 32
2025-01-17 11:08:11,396 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:08:11,396 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,396 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,396 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,397 [INFO] Batch 27: batch_size 32
2025-01-17 11:08:11,680 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:11,681 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,681 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,681 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,681 [INFO] Batch 28: batch_size 32
2025-01-17 11:08:11,731 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:08:11,732 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,732 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,732 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,732 [INFO] Batch 29: batch_size 32
2025-01-17 11:08:11,770 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:08:11,770 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,770 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,770 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,771 [INFO] Batch 30: batch_size 32
2025-01-17 11:08:11,807 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:08:11,807 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,807 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,807 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,808 [INFO] Batch 31: batch_size 32
2025-01-17 11:08:11,846 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:08:11,846 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,847 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,847 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,847 [INFO] Batch 32: batch_size 32
2025-01-17 11:08:11,881 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:08:11,882 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,882 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,882 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,882 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:08:11,888 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:08:11,889 [INFO] Batch 1: batch_size 32
2025-01-17 11:08:11,925 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:08:11,925 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,925 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,925 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,926 [INFO] Batch 2: batch_size 32
2025-01-17 11:08:11,963 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:08:11,964 [INFO] Computing non-zero element counts
2025-01-17 11:08:11,964 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:11,964 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:11,964 [INFO] Batch 3: batch_size 32
2025-01-17 11:08:11,999 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:12,000 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,000 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,000 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,000 [INFO] Batch 4: batch_size 32
2025-01-17 11:08:12,036 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:12,037 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,037 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,037 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,037 [INFO] Batch 5: batch_size 32
2025-01-17 11:08:12,079 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:12,080 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,080 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,080 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,080 [INFO] Batch 6: batch_size 32
2025-01-17 11:08:12,115 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:08:12,116 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,116 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,116 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,116 [INFO] Batch 7: batch_size 32
2025-01-17 11:08:12,155 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:08:12,155 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,155 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,156 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,156 [INFO] Batch 8: batch_size 32
2025-01-17 11:08:12,192 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:08:12,192 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,193 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,193 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,193 [INFO] Batch 9: batch_size 32
2025-01-17 11:08:12,229 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:12,229 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,229 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,229 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,229 [INFO] Batch 10: batch_size 32
2025-01-17 11:08:12,265 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:08:12,266 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,266 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,266 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,266 [INFO] Batch 11: batch_size 32
2025-01-17 11:08:12,302 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:08:12,302 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,302 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,302 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,303 [INFO] Batch 12: batch_size 32
2025-01-17 11:08:12,339 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:08:12,339 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,340 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,340 [INFO] Batch 13: batch_size 32
2025-01-17 11:08:12,376 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:08:12,376 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,377 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,377 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,377 [INFO] Batch 14: batch_size 32
2025-01-17 11:08:12,413 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:08:12,414 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,414 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,414 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,414 [INFO] Batch 15: batch_size 32
2025-01-17 11:08:12,450 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:12,451 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,451 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,451 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,451 [INFO] Batch 16: batch_size 32
2025-01-17 11:08:12,487 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:08:12,488 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,488 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,488 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,488 [INFO] Batch 17: batch_size 32
2025-01-17 11:08:12,524 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:08:12,524 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,524 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,524 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,525 [INFO] Batch 18: batch_size 32
2025-01-17 11:08:12,562 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:12,563 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,563 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,563 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,563 [INFO] Batch 19: batch_size 32
2025-01-17 11:08:12,598 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:12,599 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,599 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,599 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,599 [INFO] Batch 20: batch_size 32
2025-01-17 11:08:12,635 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:12,636 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,636 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,636 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,636 [INFO] Batch 21: batch_size 32
2025-01-17 11:08:12,673 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:08:12,674 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,674 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,674 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,674 [INFO] Batch 22: batch_size 32
2025-01-17 11:08:12,710 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:08:12,710 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,710 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,710 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,710 [INFO] Batch 23: batch_size 32
2025-01-17 11:08:12,746 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:08:12,746 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,747 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,747 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,747 [INFO] Batch 24: batch_size 32
2025-01-17 11:08:12,782 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:08:12,782 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,783 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,783 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,783 [INFO] Batch 25: batch_size 32
2025-01-17 11:08:12,819 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:12,819 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,820 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,820 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,820 [INFO] Batch 26: batch_size 32
2025-01-17 11:08:12,855 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:08:12,856 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,856 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,856 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,856 [INFO] Batch 27: batch_size 32
2025-01-17 11:08:12,895 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:08:12,896 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,896 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,897 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,897 [INFO] Batch 28: batch_size 32
2025-01-17 11:08:12,933 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:08:12,933 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,934 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,934 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,934 [INFO] Batch 29: batch_size 32
2025-01-17 11:08:12,969 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:08:12,969 [INFO] Computing non-zero element counts
2025-01-17 11:08:12,969 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:12,969 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:12,969 [INFO] Batch 30: batch_size 32
2025-01-17 11:08:13,004 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:08:13,005 [INFO] Computing non-zero element counts
2025-01-17 11:08:13,005 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:13,005 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:13,005 [INFO] Batch 31: batch_size 32
2025-01-17 11:08:13,040 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:08:13,040 [INFO] Computing non-zero element counts
2025-01-17 11:08:13,040 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:13,041 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:13,041 [INFO] Batch 32: batch_size 32
2025-01-17 11:08:13,074 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:08:13,074 [INFO] Computing non-zero element counts
2025-01-17 11:08:13,075 [INFO] Computing sum of non-zero elements
2025-01-17 11:08:13,075 [INFO] Computing mean of non-zero elements
2025-01-17 11:08:13,075 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:12:47,846 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:12:47,846 [INFO] Hyperparameters:
2025-01-17 11:12:47,846 [INFO]   layer: 6
2025-01-17 11:12:47,846 [INFO]   LLM: gpt2-small
2025-01-17 11:12:47,846 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:12:47,846 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:12:47,846 [INFO]   output_dir: ./results
2025-01-17 11:12:47,847 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:12:47,847 [INFO]   task: sentiment
2025-01-17 11:12:47,847 [INFO]   seed: 42
2025-01-17 11:12:47,847 [INFO]   data_size: 1000
2025-01-17 11:12:47,847 [INFO]   device: cuda
2025-01-17 11:12:47,847 [INFO]   alpha: 100
2025-01-17 11:12:47,847 [INFO]   steer: pos-neg
2025-01-17 11:12:47,847 [INFO]   method: val_mul
2025-01-17 11:12:47,847 [INFO]   topk_mean: 100
2025-01-17 11:12:47,847 [INFO]   topk_cnt: 100
2025-01-17 11:12:47,847 [INFO]   batch_size: 32
2025-01-17 11:12:47,847 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:12:47,847 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:12:47,847 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:12:47,848 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:12:47,983 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:12:47,992 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:12:47,993 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:12:47,993 [INFO] Hyperparameters:
2025-01-17 11:12:47,993 [INFO]   layer: 6
2025-01-17 11:12:47,993 [INFO]   LLM: gpt2-small
2025-01-17 11:12:47,993 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:12:47,993 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:12:47,993 [INFO]   output_dir: ./results
2025-01-17 11:12:47,993 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:12:47,993 [INFO]   task: sentiment
2025-01-17 11:12:47,993 [INFO]   seed: 42
2025-01-17 11:12:47,993 [INFO]   data_size: 1000
2025-01-17 11:12:47,993 [INFO]   device: cuda
2025-01-17 11:12:47,993 [INFO]   alpha: 100
2025-01-17 11:12:47,993 [INFO]   steer: pos-neg
2025-01-17 11:12:47,993 [INFO]   method: val_mul
2025-01-17 11:12:47,993 [INFO]   topk_mean: 100
2025-01-17 11:12:47,993 [INFO]   topk_cnt: 100
2025-01-17 11:12:47,993 [INFO]   batch_size: 32
2025-01-17 11:12:47,993 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:12:47,994 [INFO] Loading model: gpt2-small
2025-01-17 11:13:29,123 [INFO] Loading SAE for layer 6
2025-01-17 11:14:00,511 [INFO] pos-neg
2025-01-17 11:14:00,517 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:14:00,518 [INFO] Batch 1: batch_size 32
2025-01-17 11:14:00,695 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:14:00,696 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,700 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,700 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,700 [INFO] Batch 2: batch_size 32
2025-01-17 11:14:00,755 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:00,755 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,756 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,756 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,756 [INFO] Batch 3: batch_size 32
2025-01-17 11:14:00,795 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:14:00,796 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,796 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,796 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,796 [INFO] Batch 4: batch_size 32
2025-01-17 11:14:00,836 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:14:00,836 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,837 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,837 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,837 [INFO] Batch 5: batch_size 32
2025-01-17 11:14:00,872 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:14:00,873 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,873 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,873 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,873 [INFO] Batch 6: batch_size 32
2025-01-17 11:14:00,908 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:00,908 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,908 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,908 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,909 [INFO] Batch 7: batch_size 32
2025-01-17 11:14:00,943 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:14:00,943 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,944 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,944 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,944 [INFO] Batch 8: batch_size 32
2025-01-17 11:14:00,978 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:14:00,978 [INFO] Computing non-zero element counts
2025-01-17 11:14:00,978 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:00,979 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:00,979 [INFO] Batch 9: batch_size 32
2025-01-17 11:14:01,013 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:01,013 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,013 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,013 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,014 [INFO] Batch 10: batch_size 32
2025-01-17 11:14:01,047 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:14:01,048 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,048 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,048 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,048 [INFO] Batch 11: batch_size 32
2025-01-17 11:14:01,087 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:14:01,088 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,089 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,089 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,089 [INFO] Batch 12: batch_size 32
2025-01-17 11:14:01,128 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:14:01,128 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,129 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,129 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,129 [INFO] Batch 13: batch_size 32
2025-01-17 11:14:01,164 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:01,165 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,165 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,165 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,165 [INFO] Batch 14: batch_size 32
2025-01-17 11:14:01,199 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:14:01,200 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,200 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,200 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,200 [INFO] Batch 15: batch_size 32
2025-01-17 11:14:01,235 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:14:01,235 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,235 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,236 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,236 [INFO] Batch 16: batch_size 32
2025-01-17 11:14:01,271 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:14:01,271 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,272 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,272 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,272 [INFO] Batch 17: batch_size 32
2025-01-17 11:14:01,308 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:01,308 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,308 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,308 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,308 [INFO] Batch 18: batch_size 32
2025-01-17 11:14:01,343 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:01,343 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,343 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,344 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,344 [INFO] Batch 19: batch_size 32
2025-01-17 11:14:01,378 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:01,379 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,379 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,379 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,379 [INFO] Batch 20: batch_size 32
2025-01-17 11:14:01,414 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:14:01,415 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,415 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,415 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,415 [INFO] Batch 21: batch_size 32
2025-01-17 11:14:01,446 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:01,446 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,446 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,446 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,446 [INFO] Batch 22: batch_size 32
2025-01-17 11:14:01,481 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:14:01,481 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,482 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,482 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,482 [INFO] Batch 23: batch_size 32
2025-01-17 11:14:01,521 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:14:01,522 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,522 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,522 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,522 [INFO] Batch 24: batch_size 32
2025-01-17 11:14:01,558 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:01,558 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,558 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,558 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,559 [INFO] Batch 25: batch_size 32
2025-01-17 11:14:01,595 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:01,595 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,595 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,595 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,596 [INFO] Batch 26: batch_size 32
2025-01-17 11:14:01,633 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:01,633 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,633 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,633 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,633 [INFO] Batch 27: batch_size 32
2025-01-17 11:14:01,669 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:01,669 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,670 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,670 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,670 [INFO] Batch 28: batch_size 32
2025-01-17 11:14:01,708 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:14:01,708 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,708 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,708 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,709 [INFO] Batch 29: batch_size 32
2025-01-17 11:14:01,746 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:01,747 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,747 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,747 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,747 [INFO] Batch 30: batch_size 32
2025-01-17 11:14:01,788 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:14:01,789 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,789 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,789 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,789 [INFO] Batch 31: batch_size 32
2025-01-17 11:14:01,830 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:01,831 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,831 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,831 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,832 [INFO] Batch 32: batch_size 32
2025-01-17 11:14:01,898 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:14:01,899 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,899 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,899 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,900 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:14:01,907 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:14:01,907 [INFO] Batch 1: batch_size 32
2025-01-17 11:14:01,950 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:14:01,951 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,951 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,951 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,952 [INFO] Batch 2: batch_size 32
2025-01-17 11:14:01,996 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:01,997 [INFO] Computing non-zero element counts
2025-01-17 11:14:01,997 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:01,997 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:01,997 [INFO] Batch 3: batch_size 32
2025-01-17 11:14:02,043 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:02,044 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,044 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,044 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,044 [INFO] Batch 4: batch_size 32
2025-01-17 11:14:02,089 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:14:02,089 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,090 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,090 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,090 [INFO] Batch 5: batch_size 32
2025-01-17 11:14:02,134 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:14:02,134 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,135 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,135 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,135 [INFO] Batch 6: batch_size 32
2025-01-17 11:14:02,177 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:02,178 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,178 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,178 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,179 [INFO] Batch 7: batch_size 32
2025-01-17 11:14:02,223 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:02,223 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,223 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,223 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,224 [INFO] Batch 8: batch_size 32
2025-01-17 11:14:02,267 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:02,268 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,268 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,268 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,268 [INFO] Batch 9: batch_size 32
2025-01-17 11:14:02,314 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:02,315 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,316 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,316 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,316 [INFO] Batch 10: batch_size 32
2025-01-17 11:14:02,361 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:14:02,362 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,362 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,362 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,363 [INFO] Batch 11: batch_size 32
2025-01-17 11:14:02,407 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:14:02,407 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,408 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,408 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,408 [INFO] Batch 12: batch_size 32
2025-01-17 11:14:02,450 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:02,451 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,451 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,451 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,451 [INFO] Batch 13: batch_size 32
2025-01-17 11:14:02,506 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:02,507 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,507 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,508 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,508 [INFO] Batch 14: batch_size 32
2025-01-17 11:14:02,557 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:02,557 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,558 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,558 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,558 [INFO] Batch 15: batch_size 32
2025-01-17 11:14:02,602 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:02,602 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,603 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,603 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,603 [INFO] Batch 16: batch_size 32
2025-01-17 11:14:02,647 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:02,648 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,648 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,648 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,648 [INFO] Batch 17: batch_size 32
2025-01-17 11:14:02,691 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:14:02,691 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,691 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,691 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,692 [INFO] Batch 18: batch_size 32
2025-01-17 11:14:02,734 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:02,735 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,736 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,760 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,760 [INFO] Batch 19: batch_size 32
2025-01-17 11:14:02,805 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:02,806 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,807 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,807 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,807 [INFO] Batch 20: batch_size 32
2025-01-17 11:14:02,854 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:14:02,855 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,855 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,855 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,855 [INFO] Batch 21: batch_size 32
2025-01-17 11:14:02,900 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:02,900 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,900 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,901 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,901 [INFO] Batch 22: batch_size 32
2025-01-17 11:14:02,945 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:02,945 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,946 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,946 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,946 [INFO] Batch 23: batch_size 32
2025-01-17 11:14:02,992 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:14:02,993 [INFO] Computing non-zero element counts
2025-01-17 11:14:02,993 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:02,993 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:02,993 [INFO] Batch 24: batch_size 32
2025-01-17 11:14:03,038 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:14:03,039 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,039 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,039 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,039 [INFO] Batch 25: batch_size 32
2025-01-17 11:14:03,086 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:03,086 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,086 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,087 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,087 [INFO] Batch 26: batch_size 32
2025-01-17 11:14:03,130 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:14:03,130 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,131 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,131 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,131 [INFO] Batch 27: batch_size 32
2025-01-17 11:14:03,350 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:03,350 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,350 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,350 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,351 [INFO] Batch 28: batch_size 32
2025-01-17 11:14:03,382 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:14:03,382 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,382 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,383 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,383 [INFO] Batch 29: batch_size 32
2025-01-17 11:14:03,412 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:14:03,412 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,412 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,412 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,412 [INFO] Batch 30: batch_size 32
2025-01-17 11:14:03,447 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:14:03,448 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,448 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,448 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,448 [INFO] Batch 31: batch_size 32
2025-01-17 11:14:03,484 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:14:03,484 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,485 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,485 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,485 [INFO] Batch 32: batch_size 32
2025-01-17 11:14:03,519 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:14:03,519 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,519 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,519 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,520 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:14:03,525 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:14:03,526 [INFO] Batch 1: batch_size 32
2025-01-17 11:14:03,562 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:14:03,563 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,563 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,563 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,563 [INFO] Batch 2: batch_size 32
2025-01-17 11:14:03,601 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:14:03,601 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,601 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,601 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,601 [INFO] Batch 3: batch_size 32
2025-01-17 11:14:03,636 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:03,637 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,637 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,637 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,637 [INFO] Batch 4: batch_size 32
2025-01-17 11:14:03,671 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:03,672 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,672 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,672 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,672 [INFO] Batch 5: batch_size 32
2025-01-17 11:14:03,707 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:03,707 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,707 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,707 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,707 [INFO] Batch 6: batch_size 32
2025-01-17 11:14:03,742 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:14:03,742 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,743 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,743 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,743 [INFO] Batch 7: batch_size 32
2025-01-17 11:14:03,778 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:14:03,778 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,778 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,778 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,779 [INFO] Batch 8: batch_size 32
2025-01-17 11:14:03,813 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:14:03,813 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,813 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,813 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,814 [INFO] Batch 9: batch_size 32
2025-01-17 11:14:03,849 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:03,850 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,850 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,850 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,850 [INFO] Batch 10: batch_size 32
2025-01-17 11:14:03,885 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:14:03,886 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,886 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,886 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,886 [INFO] Batch 11: batch_size 32
2025-01-17 11:14:03,921 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:14:03,921 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,921 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,921 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,921 [INFO] Batch 12: batch_size 32
2025-01-17 11:14:03,956 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:14:03,957 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,957 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,957 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,957 [INFO] Batch 13: batch_size 32
2025-01-17 11:14:03,992 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:14:03,992 [INFO] Computing non-zero element counts
2025-01-17 11:14:03,993 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:03,993 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:03,993 [INFO] Batch 14: batch_size 32
2025-01-17 11:14:04,027 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:14:04,028 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,028 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,028 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,028 [INFO] Batch 15: batch_size 32
2025-01-17 11:14:04,068 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:04,068 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,068 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,068 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,069 [INFO] Batch 16: batch_size 32
2025-01-17 11:14:04,106 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:14:04,106 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,106 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,106 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,107 [INFO] Batch 17: batch_size 32
2025-01-17 11:14:04,141 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:14:04,142 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,142 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,142 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,142 [INFO] Batch 18: batch_size 32
2025-01-17 11:14:04,176 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:04,177 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,177 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,177 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,177 [INFO] Batch 19: batch_size 32
2025-01-17 11:14:04,212 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:04,213 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,213 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,213 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,213 [INFO] Batch 20: batch_size 32
2025-01-17 11:14:04,248 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:04,249 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,249 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,249 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,249 [INFO] Batch 21: batch_size 32
2025-01-17 11:14:04,285 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:14:04,285 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,285 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,285 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,286 [INFO] Batch 22: batch_size 32
2025-01-17 11:14:04,320 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:14:04,320 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,320 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,320 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,320 [INFO] Batch 23: batch_size 32
2025-01-17 11:14:04,355 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:14:04,355 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,356 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,356 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,356 [INFO] Batch 24: batch_size 32
2025-01-17 11:14:04,391 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:14:04,391 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,391 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,391 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,392 [INFO] Batch 25: batch_size 32
2025-01-17 11:14:04,427 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:04,427 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,427 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,428 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,428 [INFO] Batch 26: batch_size 32
2025-01-17 11:14:04,463 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:14:04,463 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,463 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,463 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,463 [INFO] Batch 27: batch_size 32
2025-01-17 11:14:04,499 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:14:04,500 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,500 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,500 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,500 [INFO] Batch 28: batch_size 32
2025-01-17 11:14:04,536 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:14:04,537 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,537 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,537 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,537 [INFO] Batch 29: batch_size 32
2025-01-17 11:14:04,572 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:14:04,572 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,573 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,573 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,573 [INFO] Batch 30: batch_size 32
2025-01-17 11:14:04,608 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:14:04,608 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,609 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,609 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,609 [INFO] Batch 31: batch_size 32
2025-01-17 11:14:04,643 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:14:04,644 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,644 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,644 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,644 [INFO] Batch 32: batch_size 32
2025-01-17 11:14:04,677 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:14:04,678 [INFO] Computing non-zero element counts
2025-01-17 11:14:04,678 [INFO] Computing sum of non-zero elements
2025-01-17 11:14:04,678 [INFO] Computing mean of non-zero elements
2025-01-17 11:14:04,678 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:18:50,586 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:18:50,586 [INFO] Hyperparameters:
2025-01-17 11:18:50,586 [INFO]   layer: 6
2025-01-17 11:18:50,586 [INFO]   LLM: gpt2-small
2025-01-17 11:18:50,587 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:18:50,587 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:18:50,587 [INFO]   output_dir: ./results
2025-01-17 11:18:50,587 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:18:50,587 [INFO]   task: sentiment
2025-01-17 11:18:50,587 [INFO]   seed: 42
2025-01-17 11:18:50,587 [INFO]   data_size: 1000
2025-01-17 11:18:50,587 [INFO]   device: cuda
2025-01-17 11:18:50,587 [INFO]   alpha: 100
2025-01-17 11:18:50,587 [INFO]   steer: pos-neg
2025-01-17 11:18:50,587 [INFO]   method: val_mul
2025-01-17 11:18:50,587 [INFO]   topk_mean: 100
2025-01-17 11:18:50,587 [INFO]   topk_cnt: 100
2025-01-17 11:18:50,587 [INFO]   batch_size: 32
2025-01-17 11:18:50,587 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:18:50,587 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:18:50,587 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:18:50,588 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:18:50,692 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:18:50,698 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:18:50,699 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:18:50,699 [INFO] Hyperparameters:
2025-01-17 11:18:50,699 [INFO]   layer: 6
2025-01-17 11:18:50,699 [INFO]   LLM: gpt2-small
2025-01-17 11:18:50,699 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:18:50,699 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:18:50,699 [INFO]   output_dir: ./results
2025-01-17 11:18:50,699 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:18:50,699 [INFO]   task: sentiment
2025-01-17 11:18:50,699 [INFO]   seed: 42
2025-01-17 11:18:50,699 [INFO]   data_size: 1000
2025-01-17 11:18:50,699 [INFO]   device: cuda
2025-01-17 11:18:50,699 [INFO]   alpha: 100
2025-01-17 11:18:50,699 [INFO]   steer: pos-neg
2025-01-17 11:18:50,699 [INFO]   method: val_mul
2025-01-17 11:18:50,699 [INFO]   topk_mean: 100
2025-01-17 11:18:50,699 [INFO]   topk_cnt: 100
2025-01-17 11:18:50,699 [INFO]   batch_size: 32
2025-01-17 11:18:50,699 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:18:50,699 [INFO] Loading model: gpt2-small
2025-01-17 11:19:31,874 [INFO] Loading SAE for layer 6
2025-01-17 11:20:03,274 [INFO] pos-neg
2025-01-17 11:20:03,280 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:20:03,281 [INFO] Batch 1: batch_size 32
2025-01-17 11:20:03,458 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:20:03,459 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,463 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,463 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,464 [INFO] Batch 2: batch_size 32
2025-01-17 11:20:03,522 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:03,522 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,523 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,523 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,523 [INFO] Batch 3: batch_size 32
2025-01-17 11:20:03,560 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:20:03,560 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,560 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,560 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,561 [INFO] Batch 4: batch_size 32
2025-01-17 11:20:03,598 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:20:03,598 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,599 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,599 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,599 [INFO] Batch 5: batch_size 32
2025-01-17 11:20:03,635 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:20:03,635 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,636 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,636 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,636 [INFO] Batch 6: batch_size 32
2025-01-17 11:20:03,671 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:03,671 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,671 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,671 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,672 [INFO] Batch 7: batch_size 32
2025-01-17 11:20:03,706 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:20:03,707 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,707 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,707 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,707 [INFO] Batch 8: batch_size 32
2025-01-17 11:20:03,743 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:20:03,744 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,744 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,744 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,744 [INFO] Batch 9: batch_size 32
2025-01-17 11:20:03,779 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:03,780 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,780 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,780 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,780 [INFO] Batch 10: batch_size 32
2025-01-17 11:20:03,816 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:20:03,816 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,817 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,817 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,817 [INFO] Batch 11: batch_size 32
2025-01-17 11:20:03,853 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:20:03,853 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,853 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,854 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,854 [INFO] Batch 12: batch_size 32
2025-01-17 11:20:03,890 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:20:03,891 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,891 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,892 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,892 [INFO] Batch 13: batch_size 32
2025-01-17 11:20:03,927 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:03,928 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,928 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,928 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,928 [INFO] Batch 14: batch_size 32
2025-01-17 11:20:03,963 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:20:03,963 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,963 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:03,963 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:03,963 [INFO] Batch 15: batch_size 32
2025-01-17 11:20:03,999 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:20:03,999 [INFO] Computing non-zero element counts
2025-01-17 11:20:03,999 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,000 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,000 [INFO] Batch 16: batch_size 32
2025-01-17 11:20:04,034 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:20:04,034 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,034 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,034 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,035 [INFO] Batch 17: batch_size 32
2025-01-17 11:20:04,069 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:04,069 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,069 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,070 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,070 [INFO] Batch 18: batch_size 32
2025-01-17 11:20:04,105 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:04,105 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,105 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,105 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,106 [INFO] Batch 19: batch_size 32
2025-01-17 11:20:04,140 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:04,141 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,184 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,184 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,184 [INFO] Batch 20: batch_size 32
2025-01-17 11:20:04,223 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:20:04,223 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,224 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,224 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,224 [INFO] Batch 21: batch_size 32
2025-01-17 11:20:04,260 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:04,261 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,261 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,261 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,261 [INFO] Batch 22: batch_size 32
2025-01-17 11:20:04,297 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:20:04,297 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,298 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,298 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,298 [INFO] Batch 23: batch_size 32
2025-01-17 11:20:04,332 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:20:04,333 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,333 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,333 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,333 [INFO] Batch 24: batch_size 32
2025-01-17 11:20:04,368 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:04,369 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,369 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,369 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,369 [INFO] Batch 25: batch_size 32
2025-01-17 11:20:04,405 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:04,405 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,405 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,405 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,405 [INFO] Batch 26: batch_size 32
2025-01-17 11:20:04,441 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:04,441 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,441 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,441 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,441 [INFO] Batch 27: batch_size 32
2025-01-17 11:20:04,476 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:04,476 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,477 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,477 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,477 [INFO] Batch 28: batch_size 32
2025-01-17 11:20:04,512 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:20:04,512 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,512 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,512 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,512 [INFO] Batch 29: batch_size 32
2025-01-17 11:20:04,548 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:04,548 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,548 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,548 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,549 [INFO] Batch 30: batch_size 32
2025-01-17 11:20:04,586 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:20:04,586 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,587 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,587 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,587 [INFO] Batch 31: batch_size 32
2025-01-17 11:20:04,622 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:04,623 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,623 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,623 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,623 [INFO] Batch 32: batch_size 32
2025-01-17 11:20:04,673 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:20:04,674 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,674 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,674 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,675 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:20:04,680 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:20:04,681 [INFO] Batch 1: batch_size 32
2025-01-17 11:20:04,717 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:20:04,717 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,718 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,718 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,718 [INFO] Batch 2: batch_size 32
2025-01-17 11:20:04,752 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:04,753 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,753 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,753 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,753 [INFO] Batch 3: batch_size 32
2025-01-17 11:20:04,788 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:04,789 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,789 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,789 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,789 [INFO] Batch 4: batch_size 32
2025-01-17 11:20:04,825 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:20:04,825 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,825 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,825 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,825 [INFO] Batch 5: batch_size 32
2025-01-17 11:20:04,861 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:20:04,861 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,862 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,862 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,862 [INFO] Batch 6: batch_size 32
2025-01-17 11:20:04,898 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:04,898 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,898 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,898 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,899 [INFO] Batch 7: batch_size 32
2025-01-17 11:20:04,934 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:04,935 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,935 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,935 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,935 [INFO] Batch 8: batch_size 32
2025-01-17 11:20:04,970 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:04,970 [INFO] Computing non-zero element counts
2025-01-17 11:20:04,971 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:04,971 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:04,971 [INFO] Batch 9: batch_size 32
2025-01-17 11:20:05,007 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:05,007 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,008 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,008 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,008 [INFO] Batch 10: batch_size 32
2025-01-17 11:20:05,044 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:20:05,045 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,045 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,045 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,045 [INFO] Batch 11: batch_size 32
2025-01-17 11:20:05,081 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:20:05,081 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,081 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,081 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,082 [INFO] Batch 12: batch_size 32
2025-01-17 11:20:05,117 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:05,117 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,117 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,117 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,117 [INFO] Batch 13: batch_size 32
2025-01-17 11:20:05,153 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:05,153 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,153 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,153 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,153 [INFO] Batch 14: batch_size 32
2025-01-17 11:20:05,188 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:05,189 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,189 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,189 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,189 [INFO] Batch 15: batch_size 32
2025-01-17 11:20:05,224 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:05,225 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,225 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,225 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,225 [INFO] Batch 16: batch_size 32
2025-01-17 11:20:05,260 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:05,261 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,261 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,261 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,261 [INFO] Batch 17: batch_size 32
2025-01-17 11:20:05,297 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:20:05,297 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,297 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,297 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,297 [INFO] Batch 18: batch_size 32
2025-01-17 11:20:05,335 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:05,335 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,336 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,336 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,336 [INFO] Batch 19: batch_size 32
2025-01-17 11:20:05,372 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:05,373 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,373 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,373 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,373 [INFO] Batch 20: batch_size 32
2025-01-17 11:20:05,410 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:20:05,410 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,411 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,411 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,411 [INFO] Batch 21: batch_size 32
2025-01-17 11:20:05,446 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:05,447 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,447 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,447 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,447 [INFO] Batch 22: batch_size 32
2025-01-17 11:20:05,483 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:05,483 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,483 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,484 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,484 [INFO] Batch 23: batch_size 32
2025-01-17 11:20:05,519 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:20:05,520 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,520 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,520 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,520 [INFO] Batch 24: batch_size 32
2025-01-17 11:20:05,556 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:20:05,556 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,556 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,556 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,557 [INFO] Batch 25: batch_size 32
2025-01-17 11:20:05,592 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:05,592 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,593 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,593 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,593 [INFO] Batch 26: batch_size 32
2025-01-17 11:20:05,628 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:20:05,628 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,628 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,629 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,629 [INFO] Batch 27: batch_size 32
2025-01-17 11:20:05,849 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:05,850 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,850 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,850 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,850 [INFO] Batch 28: batch_size 32
2025-01-17 11:20:05,889 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:20:05,890 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,890 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,890 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,890 [INFO] Batch 29: batch_size 32
2025-01-17 11:20:05,926 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:20:05,927 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,927 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,927 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,927 [INFO] Batch 30: batch_size 32
2025-01-17 11:20:05,962 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:20:05,962 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,962 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,962 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,963 [INFO] Batch 31: batch_size 32
2025-01-17 11:20:05,998 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:20:05,998 [INFO] Computing non-zero element counts
2025-01-17 11:20:05,999 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:05,999 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:05,999 [INFO] Batch 32: batch_size 32
2025-01-17 11:20:06,032 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:20:06,033 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,033 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,033 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,033 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:20:06,039 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:20:06,039 [INFO] Batch 1: batch_size 32
2025-01-17 11:20:06,079 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:20:06,079 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,079 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,079 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,080 [INFO] Batch 2: batch_size 32
2025-01-17 11:20:06,118 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:20:06,119 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,119 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,119 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,119 [INFO] Batch 3: batch_size 32
2025-01-17 11:20:06,155 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:06,156 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,156 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,156 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,156 [INFO] Batch 4: batch_size 32
2025-01-17 11:20:06,192 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:06,192 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,193 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,193 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,193 [INFO] Batch 5: batch_size 32
2025-01-17 11:20:06,228 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:06,229 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,229 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,229 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,229 [INFO] Batch 6: batch_size 32
2025-01-17 11:20:06,264 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:20:06,265 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,265 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,265 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,265 [INFO] Batch 7: batch_size 32
2025-01-17 11:20:06,302 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:20:06,303 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,303 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,303 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,303 [INFO] Batch 8: batch_size 32
2025-01-17 11:20:06,338 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:20:06,339 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,339 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,339 [INFO] Batch 9: batch_size 32
2025-01-17 11:20:06,375 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:06,376 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,376 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,376 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,376 [INFO] Batch 10: batch_size 32
2025-01-17 11:20:06,414 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:20:06,414 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,415 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,415 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,415 [INFO] Batch 11: batch_size 32
2025-01-17 11:20:06,450 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:20:06,451 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,451 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,451 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,451 [INFO] Batch 12: batch_size 32
2025-01-17 11:20:06,489 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:20:06,489 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,490 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,490 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,490 [INFO] Batch 13: batch_size 32
2025-01-17 11:20:06,527 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:20:06,527 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,527 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,527 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,528 [INFO] Batch 14: batch_size 32
2025-01-17 11:20:06,563 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:20:06,564 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,564 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,564 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,564 [INFO] Batch 15: batch_size 32
2025-01-17 11:20:06,600 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:06,600 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,600 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,600 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,601 [INFO] Batch 16: batch_size 32
2025-01-17 11:20:06,637 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:20:06,638 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,638 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,638 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,638 [INFO] Batch 17: batch_size 32
2025-01-17 11:20:06,674 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:20:06,674 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,674 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,674 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,675 [INFO] Batch 18: batch_size 32
2025-01-17 11:20:06,709 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:06,710 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,710 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,710 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,710 [INFO] Batch 19: batch_size 32
2025-01-17 11:20:06,754 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:06,754 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,755 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,755 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,755 [INFO] Batch 20: batch_size 32
2025-01-17 11:20:06,792 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:06,793 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,793 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,793 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,793 [INFO] Batch 21: batch_size 32
2025-01-17 11:20:06,830 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:20:06,830 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,830 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,830 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,831 [INFO] Batch 22: batch_size 32
2025-01-17 11:20:06,865 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:20:06,866 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,866 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,866 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,866 [INFO] Batch 23: batch_size 32
2025-01-17 11:20:06,901 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:20:06,902 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,902 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,902 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,902 [INFO] Batch 24: batch_size 32
2025-01-17 11:20:06,936 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:20:06,937 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,937 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,937 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,937 [INFO] Batch 25: batch_size 32
2025-01-17 11:20:06,972 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:06,972 [INFO] Computing non-zero element counts
2025-01-17 11:20:06,972 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:06,972 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:06,973 [INFO] Batch 26: batch_size 32
2025-01-17 11:20:07,008 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:20:07,008 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,008 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,008 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,009 [INFO] Batch 27: batch_size 32
2025-01-17 11:20:07,043 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:20:07,044 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,044 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,044 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,044 [INFO] Batch 28: batch_size 32
2025-01-17 11:20:07,080 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:20:07,080 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,080 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,080 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,081 [INFO] Batch 29: batch_size 32
2025-01-17 11:20:07,115 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:20:07,115 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,116 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,116 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,116 [INFO] Batch 30: batch_size 32
2025-01-17 11:20:07,152 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:20:07,152 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,152 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,152 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,153 [INFO] Batch 31: batch_size 32
2025-01-17 11:20:07,188 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:20:07,188 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,188 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,188 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,189 [INFO] Batch 32: batch_size 32
2025-01-17 11:20:07,222 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:20:07,223 [INFO] Computing non-zero element counts
2025-01-17 11:20:07,223 [INFO] Computing sum of non-zero elements
2025-01-17 11:20:07,223 [INFO] Computing mean of non-zero elements
2025-01-17 11:20:07,224 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:20:07,263 [INFO] Example prompt: Aha, we have good result!
2025-01-17 11:20:07,303 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:20:07,303 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:22:49,882 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:22:49,882 [INFO] Hyperparameters:
2025-01-17 11:22:49,882 [INFO]   layer: 6
2025-01-17 11:22:49,882 [INFO]   LLM: gpt2-small
2025-01-17 11:22:49,882 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:22:49,882 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:22:49,882 [INFO]   output_dir: ./results
2025-01-17 11:22:49,883 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:22:49,883 [INFO]   task: sentiment
2025-01-17 11:22:49,883 [INFO]   seed: 42
2025-01-17 11:22:49,883 [INFO]   data_size: 1000
2025-01-17 11:22:49,883 [INFO]   device: cuda
2025-01-17 11:22:49,883 [INFO]   alpha: 100
2025-01-17 11:22:49,883 [INFO]   steer: pos-neg
2025-01-17 11:22:49,883 [INFO]   method: val_mul
2025-01-17 11:22:49,883 [INFO]   topk_mean: 100
2025-01-17 11:22:49,883 [INFO]   topk_cnt: 100
2025-01-17 11:22:49,883 [INFO]   batch_size: 32
2025-01-17 11:22:49,883 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:22:49,883 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:22:49,883 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:22:49,883 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:22:50,004 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:22:50,012 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:22:50,013 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:22:50,013 [INFO] Hyperparameters:
2025-01-17 11:22:50,013 [INFO]   layer: 6
2025-01-17 11:22:50,013 [INFO]   LLM: gpt2-small
2025-01-17 11:22:50,013 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:22:50,013 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:22:50,013 [INFO]   output_dir: ./results
2025-01-17 11:22:50,013 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:22:50,013 [INFO]   task: sentiment
2025-01-17 11:22:50,013 [INFO]   seed: 42
2025-01-17 11:22:50,013 [INFO]   data_size: 1000
2025-01-17 11:22:50,013 [INFO]   device: cuda
2025-01-17 11:22:50,013 [INFO]   alpha: 100
2025-01-17 11:22:50,013 [INFO]   steer: pos-neg
2025-01-17 11:22:50,013 [INFO]   method: val_mul
2025-01-17 11:22:50,014 [INFO]   topk_mean: 100
2025-01-17 11:22:50,014 [INFO]   topk_cnt: 100
2025-01-17 11:22:50,014 [INFO]   batch_size: 32
2025-01-17 11:22:50,014 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:22:50,014 [INFO] Loading model: gpt2-small
2025-01-17 11:23:36,238 [INFO] Loading SAE for layer 6
2025-01-17 11:24:07,513 [INFO] pos-neg
2025-01-17 11:24:07,519 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:24:07,520 [INFO] Batch 1: batch_size 32
2025-01-17 11:24:07,699 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:24:07,699 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,703 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,704 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,704 [INFO] Batch 2: batch_size 32
2025-01-17 11:24:07,759 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:07,760 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,760 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,760 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,760 [INFO] Batch 3: batch_size 32
2025-01-17 11:24:07,797 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:24:07,798 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,798 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,798 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,798 [INFO] Batch 4: batch_size 32
2025-01-17 11:24:07,834 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:24:07,835 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,835 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,835 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,835 [INFO] Batch 5: batch_size 32
2025-01-17 11:24:07,872 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:24:07,873 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,873 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,873 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,873 [INFO] Batch 6: batch_size 32
2025-01-17 11:24:07,909 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:07,909 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,909 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,910 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,910 [INFO] Batch 7: batch_size 32
2025-01-17 11:24:07,944 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:24:07,945 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,945 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,945 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,945 [INFO] Batch 8: batch_size 32
2025-01-17 11:24:07,980 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:24:07,981 [INFO] Computing non-zero element counts
2025-01-17 11:24:07,981 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:07,981 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:07,981 [INFO] Batch 9: batch_size 32
2025-01-17 11:24:08,017 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:08,017 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,017 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,017 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,017 [INFO] Batch 10: batch_size 32
2025-01-17 11:24:08,056 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:24:08,056 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,057 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,057 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,057 [INFO] Batch 11: batch_size 32
2025-01-17 11:24:08,093 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:24:08,094 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,094 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,094 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,094 [INFO] Batch 12: batch_size 32
2025-01-17 11:24:08,132 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:24:08,133 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,133 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,134 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,134 [INFO] Batch 13: batch_size 32
2025-01-17 11:24:08,169 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:08,169 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,169 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,170 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,170 [INFO] Batch 14: batch_size 32
2025-01-17 11:24:08,204 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:24:08,205 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,205 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,205 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,205 [INFO] Batch 15: batch_size 32
2025-01-17 11:24:08,240 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:24:08,240 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,240 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,241 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,241 [INFO] Batch 16: batch_size 32
2025-01-17 11:24:08,271 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:24:08,271 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,271 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,271 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,271 [INFO] Batch 17: batch_size 32
2025-01-17 11:24:08,306 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:08,306 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,306 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,307 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,307 [INFO] Batch 18: batch_size 32
2025-01-17 11:24:08,341 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:08,341 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,341 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,341 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,341 [INFO] Batch 19: batch_size 32
2025-01-17 11:24:08,376 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:08,376 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,377 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,377 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,377 [INFO] Batch 20: batch_size 32
2025-01-17 11:24:08,412 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:24:08,412 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,413 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,413 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,413 [INFO] Batch 21: batch_size 32
2025-01-17 11:24:08,447 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:08,448 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,448 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,448 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,448 [INFO] Batch 22: batch_size 32
2025-01-17 11:24:08,483 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:24:08,484 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,484 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,484 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,484 [INFO] Batch 23: batch_size 32
2025-01-17 11:24:08,523 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:24:08,524 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,524 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,524 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,525 [INFO] Batch 24: batch_size 32
2025-01-17 11:24:08,562 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:08,562 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,562 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,563 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,563 [INFO] Batch 25: batch_size 32
2025-01-17 11:24:08,597 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:08,597 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,598 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,598 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,598 [INFO] Batch 26: batch_size 32
2025-01-17 11:24:08,634 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:08,634 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,634 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,634 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,634 [INFO] Batch 27: batch_size 32
2025-01-17 11:24:08,670 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:08,670 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,670 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,670 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,670 [INFO] Batch 28: batch_size 32
2025-01-17 11:24:08,705 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:24:08,706 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,706 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,706 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,706 [INFO] Batch 29: batch_size 32
2025-01-17 11:24:08,741 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:08,742 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,742 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,742 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,742 [INFO] Batch 30: batch_size 32
2025-01-17 11:24:08,777 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:24:08,778 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,778 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,778 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,778 [INFO] Batch 31: batch_size 32
2025-01-17 11:24:08,813 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:08,814 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,814 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,814 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,814 [INFO] Batch 32: batch_size 32
2025-01-17 11:24:08,865 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:24:08,865 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,866 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,866 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,866 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:24:08,872 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:24:08,873 [INFO] Batch 1: batch_size 32
2025-01-17 11:24:08,908 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:24:08,909 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,909 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,909 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,910 [INFO] Batch 2: batch_size 32
2025-01-17 11:24:08,944 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:08,944 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,945 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,945 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,945 [INFO] Batch 3: batch_size 32
2025-01-17 11:24:08,980 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:08,980 [INFO] Computing non-zero element counts
2025-01-17 11:24:08,980 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:08,980 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:08,980 [INFO] Batch 4: batch_size 32
2025-01-17 11:24:09,015 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:24:09,016 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,016 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,016 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,016 [INFO] Batch 5: batch_size 32
2025-01-17 11:24:09,050 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:24:09,051 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,051 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,051 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,051 [INFO] Batch 6: batch_size 32
2025-01-17 11:24:09,086 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:09,086 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,086 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,086 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,086 [INFO] Batch 7: batch_size 32
2025-01-17 11:24:09,122 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:09,122 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,122 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,123 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,123 [INFO] Batch 8: batch_size 32
2025-01-17 11:24:09,158 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:09,158 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,159 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,159 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,159 [INFO] Batch 9: batch_size 32
2025-01-17 11:24:09,194 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:09,195 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,195 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,195 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,195 [INFO] Batch 10: batch_size 32
2025-01-17 11:24:09,231 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:24:09,232 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,232 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,232 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,232 [INFO] Batch 11: batch_size 32
2025-01-17 11:24:09,267 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:24:09,267 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,268 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,268 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,268 [INFO] Batch 12: batch_size 32
2025-01-17 11:24:09,303 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:09,303 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,303 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,303 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,304 [INFO] Batch 13: batch_size 32
2025-01-17 11:24:09,338 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:09,339 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,339 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,339 [INFO] Batch 14: batch_size 32
2025-01-17 11:24:09,374 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:09,374 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,374 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,374 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,374 [INFO] Batch 15: batch_size 32
2025-01-17 11:24:09,409 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:09,410 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,410 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,410 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,410 [INFO] Batch 16: batch_size 32
2025-01-17 11:24:09,445 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:09,446 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,446 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,446 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,446 [INFO] Batch 17: batch_size 32
2025-01-17 11:24:09,481 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:24:09,481 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,481 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,481 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,481 [INFO] Batch 18: batch_size 32
2025-01-17 11:24:09,516 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:09,517 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,517 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,517 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,517 [INFO] Batch 19: batch_size 32
2025-01-17 11:24:09,553 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:09,553 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,554 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,554 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,554 [INFO] Batch 20: batch_size 32
2025-01-17 11:24:09,589 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:24:09,590 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,590 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,590 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,590 [INFO] Batch 21: batch_size 32
2025-01-17 11:24:09,625 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:09,625 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,626 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,626 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,626 [INFO] Batch 22: batch_size 32
2025-01-17 11:24:09,662 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:09,662 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,662 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,662 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,662 [INFO] Batch 23: batch_size 32
2025-01-17 11:24:09,698 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:24:09,698 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,698 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,698 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,698 [INFO] Batch 24: batch_size 32
2025-01-17 11:24:09,733 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:24:09,734 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,734 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,734 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,734 [INFO] Batch 25: batch_size 32
2025-01-17 11:24:09,769 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:09,770 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,770 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,770 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,770 [INFO] Batch 26: batch_size 32
2025-01-17 11:24:09,805 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:24:09,805 [INFO] Computing non-zero element counts
2025-01-17 11:24:09,806 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:09,822 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:09,822 [INFO] Batch 27: batch_size 32
2025-01-17 11:24:10,062 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:10,062 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,063 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,063 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,063 [INFO] Batch 28: batch_size 32
2025-01-17 11:24:10,100 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:24:10,101 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,101 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,101 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,101 [INFO] Batch 29: batch_size 32
2025-01-17 11:24:10,137 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:24:10,137 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,138 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,138 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,138 [INFO] Batch 30: batch_size 32
2025-01-17 11:24:10,173 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:24:10,173 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,174 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,174 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,174 [INFO] Batch 31: batch_size 32
2025-01-17 11:24:10,205 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:24:10,205 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,206 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,206 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,206 [INFO] Batch 32: batch_size 32
2025-01-17 11:24:10,235 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:24:10,236 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,236 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,236 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,236 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:24:10,241 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:24:10,241 [INFO] Batch 1: batch_size 32
2025-01-17 11:24:10,272 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:24:10,272 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,273 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,273 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,273 [INFO] Batch 2: batch_size 32
2025-01-17 11:24:10,309 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:24:10,310 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,310 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,310 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,310 [INFO] Batch 3: batch_size 32
2025-01-17 11:24:10,345 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:10,346 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,346 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,346 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,346 [INFO] Batch 4: batch_size 32
2025-01-17 11:24:10,381 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:10,381 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,381 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,381 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,382 [INFO] Batch 5: batch_size 32
2025-01-17 11:24:10,416 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:10,416 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,416 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,416 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,417 [INFO] Batch 6: batch_size 32
2025-01-17 11:24:10,452 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:24:10,452 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,452 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,452 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,453 [INFO] Batch 7: batch_size 32
2025-01-17 11:24:10,489 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:24:10,489 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,489 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,489 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,489 [INFO] Batch 8: batch_size 32
2025-01-17 11:24:10,524 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:24:10,524 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,524 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,524 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,525 [INFO] Batch 9: batch_size 32
2025-01-17 11:24:10,560 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:10,560 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,560 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,560 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,560 [INFO] Batch 10: batch_size 32
2025-01-17 11:24:10,595 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:24:10,596 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,596 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,596 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,596 [INFO] Batch 11: batch_size 32
2025-01-17 11:24:10,632 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:24:10,632 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,632 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,633 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,633 [INFO] Batch 12: batch_size 32
2025-01-17 11:24:10,668 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:24:10,668 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,669 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,669 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,669 [INFO] Batch 13: batch_size 32
2025-01-17 11:24:10,704 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:24:10,705 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,705 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,705 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,705 [INFO] Batch 14: batch_size 32
2025-01-17 11:24:10,740 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:24:10,740 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,741 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,741 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,741 [INFO] Batch 15: batch_size 32
2025-01-17 11:24:10,776 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:10,776 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,776 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,776 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,777 [INFO] Batch 16: batch_size 32
2025-01-17 11:24:10,812 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:24:10,812 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,813 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,813 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,813 [INFO] Batch 17: batch_size 32
2025-01-17 11:24:10,848 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:24:10,849 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,849 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,849 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,849 [INFO] Batch 18: batch_size 32
2025-01-17 11:24:10,883 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:10,884 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,884 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,884 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,884 [INFO] Batch 19: batch_size 32
2025-01-17 11:24:10,919 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:10,919 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,920 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,920 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,920 [INFO] Batch 20: batch_size 32
2025-01-17 11:24:10,954 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:10,955 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,955 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,955 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,955 [INFO] Batch 21: batch_size 32
2025-01-17 11:24:10,990 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:24:10,991 [INFO] Computing non-zero element counts
2025-01-17 11:24:10,991 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:10,991 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:10,991 [INFO] Batch 22: batch_size 32
2025-01-17 11:24:11,026 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:24:11,026 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,026 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,026 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,027 [INFO] Batch 23: batch_size 32
2025-01-17 11:24:11,062 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:24:11,062 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,062 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,062 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,063 [INFO] Batch 24: batch_size 32
2025-01-17 11:24:11,098 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:24:11,098 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,098 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,098 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,099 [INFO] Batch 25: batch_size 32
2025-01-17 11:24:11,134 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:11,134 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,134 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,134 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,134 [INFO] Batch 26: batch_size 32
2025-01-17 11:24:11,169 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:24:11,169 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,170 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,170 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,170 [INFO] Batch 27: batch_size 32
2025-01-17 11:24:11,204 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:24:11,205 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,205 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,205 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,205 [INFO] Batch 28: batch_size 32
2025-01-17 11:24:11,241 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:24:11,241 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,242 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,242 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,242 [INFO] Batch 29: batch_size 32
2025-01-17 11:24:11,277 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:24:11,277 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,277 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,277 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,278 [INFO] Batch 30: batch_size 32
2025-01-17 11:24:11,312 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:24:11,313 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,313 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,313 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,313 [INFO] Batch 31: batch_size 32
2025-01-17 11:24:11,348 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:24:11,349 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,349 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,349 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,349 [INFO] Batch 32: batch_size 32
2025-01-17 11:24:11,383 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:24:11,383 [INFO] Computing non-zero element counts
2025-01-17 11:24:11,384 [INFO] Computing sum of non-zero elements
2025-01-17 11:24:11,384 [INFO] Computing mean of non-zero elements
2025-01-17 11:24:11,384 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:24:11,424 [INFO] Example prompt: Aha, we have good result!
2025-01-17 11:24:11,463 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:26:16,775 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:26:16,776 [INFO] Hyperparameters:
2025-01-17 11:26:16,776 [INFO]   layer: 6
2025-01-17 11:26:16,776 [INFO]   LLM: gpt2-small
2025-01-17 11:26:16,776 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:26:16,776 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:26:16,776 [INFO]   output_dir: ./results
2025-01-17 11:26:16,776 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:26:16,776 [INFO]   task: sentiment
2025-01-17 11:26:16,776 [INFO]   seed: 42
2025-01-17 11:26:16,776 [INFO]   data_size: 1000
2025-01-17 11:26:16,776 [INFO]   device: cuda
2025-01-17 11:26:16,776 [INFO]   alpha: 100
2025-01-17 11:26:16,776 [INFO]   steer: pos-neg
2025-01-17 11:26:16,776 [INFO]   method: val_mul
2025-01-17 11:26:16,776 [INFO]   topk_mean: 100
2025-01-17 11:26:16,776 [INFO]   topk_cnt: 100
2025-01-17 11:26:16,776 [INFO]   batch_size: 32
2025-01-17 11:26:16,776 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:26:16,777 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:26:16,777 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:26:16,777 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:26:16,898 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:26:16,906 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:26:16,906 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:26:16,906 [INFO] Hyperparameters:
2025-01-17 11:26:16,906 [INFO]   layer: 6
2025-01-17 11:26:16,906 [INFO]   LLM: gpt2-small
2025-01-17 11:26:16,906 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:26:16,906 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:26:16,906 [INFO]   output_dir: ./results
2025-01-17 11:26:16,906 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:26:16,906 [INFO]   task: sentiment
2025-01-17 11:26:16,907 [INFO]   seed: 42
2025-01-17 11:26:16,907 [INFO]   data_size: 1000
2025-01-17 11:26:16,907 [INFO]   device: cuda
2025-01-17 11:26:16,907 [INFO]   alpha: 100
2025-01-17 11:26:16,907 [INFO]   steer: pos-neg
2025-01-17 11:26:16,907 [INFO]   method: val_mul
2025-01-17 11:26:16,907 [INFO]   topk_mean: 100
2025-01-17 11:26:16,907 [INFO]   topk_cnt: 100
2025-01-17 11:26:16,907 [INFO]   batch_size: 32
2025-01-17 11:26:16,907 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:26:16,907 [INFO] Loading model: gpt2-small
2025-01-17 11:27:13,059 [INFO] Loading SAE for layer 6
2025-01-17 11:27:49,221 [INFO] pos-neg
2025-01-17 11:27:49,226 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:27:49,227 [INFO] Batch 1: batch_size 32
2025-01-17 11:27:49,403 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:27:49,404 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,408 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,408 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,409 [INFO] Batch 2: batch_size 32
2025-01-17 11:27:49,464 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:49,465 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,465 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,465 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,465 [INFO] Batch 3: batch_size 32
2025-01-17 11:27:49,501 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:27:49,502 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,502 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,502 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,502 [INFO] Batch 4: batch_size 32
2025-01-17 11:27:49,537 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:27:49,538 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,538 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,538 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,538 [INFO] Batch 5: batch_size 32
2025-01-17 11:27:49,573 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:27:49,573 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,573 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,573 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,573 [INFO] Batch 6: batch_size 32
2025-01-17 11:27:49,608 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:49,608 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,609 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,609 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,609 [INFO] Batch 7: batch_size 32
2025-01-17 11:27:49,643 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:27:49,643 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,644 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,644 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,644 [INFO] Batch 8: batch_size 32
2025-01-17 11:27:49,678 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:27:49,678 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,678 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,678 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,679 [INFO] Batch 9: batch_size 32
2025-01-17 11:27:49,713 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:49,714 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,714 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,714 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,714 [INFO] Batch 10: batch_size 32
2025-01-17 11:27:49,748 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:27:49,749 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,749 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,749 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,749 [INFO] Batch 11: batch_size 32
2025-01-17 11:27:49,784 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:27:49,785 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,785 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,785 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,785 [INFO] Batch 12: batch_size 32
2025-01-17 11:27:49,820 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:27:49,821 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,821 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,822 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,822 [INFO] Batch 13: batch_size 32
2025-01-17 11:27:49,856 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:49,856 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,856 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,857 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,857 [INFO] Batch 14: batch_size 32
2025-01-17 11:27:49,891 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:27:49,892 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,892 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,892 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,892 [INFO] Batch 15: batch_size 32
2025-01-17 11:27:49,933 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:27:49,933 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,933 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,933 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,933 [INFO] Batch 16: batch_size 32
2025-01-17 11:27:49,970 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:27:49,971 [INFO] Computing non-zero element counts
2025-01-17 11:27:49,971 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:49,971 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:49,972 [INFO] Batch 17: batch_size 32
2025-01-17 11:27:50,008 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:50,009 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,009 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,009 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,009 [INFO] Batch 18: batch_size 32
2025-01-17 11:27:50,044 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:50,045 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,045 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,045 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,045 [INFO] Batch 19: batch_size 32
2025-01-17 11:27:50,080 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:50,080 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,081 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,081 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,081 [INFO] Batch 20: batch_size 32
2025-01-17 11:27:50,116 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:27:50,116 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,117 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,117 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,117 [INFO] Batch 21: batch_size 32
2025-01-17 11:27:50,152 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:50,152 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,152 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,152 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,152 [INFO] Batch 22: batch_size 32
2025-01-17 11:27:50,191 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:27:50,192 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,192 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,192 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,193 [INFO] Batch 23: batch_size 32
2025-01-17 11:27:50,228 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:27:50,228 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,229 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,229 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,229 [INFO] Batch 24: batch_size 32
2025-01-17 11:27:50,263 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:50,264 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,264 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,264 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,264 [INFO] Batch 25: batch_size 32
2025-01-17 11:27:50,302 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:50,303 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,303 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,303 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,303 [INFO] Batch 26: batch_size 32
2025-01-17 11:27:50,338 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:50,339 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,339 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,339 [INFO] Batch 27: batch_size 32
2025-01-17 11:27:50,375 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:50,375 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,375 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,375 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,376 [INFO] Batch 28: batch_size 32
2025-01-17 11:27:50,411 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:27:50,411 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,412 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,412 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,412 [INFO] Batch 29: batch_size 32
2025-01-17 11:27:50,446 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:50,447 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,447 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,447 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,447 [INFO] Batch 30: batch_size 32
2025-01-17 11:27:50,483 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:27:50,483 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,483 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,483 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,483 [INFO] Batch 31: batch_size 32
2025-01-17 11:27:50,518 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:50,518 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,518 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,518 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,518 [INFO] Batch 32: batch_size 32
2025-01-17 11:27:50,567 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:27:50,568 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,568 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,568 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,568 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:27:50,574 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:27:50,574 [INFO] Batch 1: batch_size 32
2025-01-17 11:27:50,610 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:27:50,610 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,610 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,610 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,611 [INFO] Batch 2: batch_size 32
2025-01-17 11:27:50,654 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:50,655 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,655 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,655 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,655 [INFO] Batch 3: batch_size 32
2025-01-17 11:27:50,692 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:50,693 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,693 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,693 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,693 [INFO] Batch 4: batch_size 32
2025-01-17 11:27:50,728 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:27:50,728 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,728 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,728 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,728 [INFO] Batch 5: batch_size 32
2025-01-17 11:27:50,764 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:27:50,764 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,764 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,765 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,765 [INFO] Batch 6: batch_size 32
2025-01-17 11:27:50,799 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:50,800 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,800 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,800 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,800 [INFO] Batch 7: batch_size 32
2025-01-17 11:27:50,835 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:50,835 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,835 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,835 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,835 [INFO] Batch 8: batch_size 32
2025-01-17 11:27:50,870 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:50,870 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,871 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,871 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,871 [INFO] Batch 9: batch_size 32
2025-01-17 11:27:50,905 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:50,906 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,906 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,907 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,907 [INFO] Batch 10: batch_size 32
2025-01-17 11:27:50,942 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:27:50,943 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,943 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,943 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,943 [INFO] Batch 11: batch_size 32
2025-01-17 11:27:50,978 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:27:50,979 [INFO] Computing non-zero element counts
2025-01-17 11:27:50,979 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:50,979 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:50,979 [INFO] Batch 12: batch_size 32
2025-01-17 11:27:51,014 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:51,014 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,014 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,014 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,014 [INFO] Batch 13: batch_size 32
2025-01-17 11:27:51,051 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:51,052 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,052 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,052 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,052 [INFO] Batch 14: batch_size 32
2025-01-17 11:27:51,087 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:51,087 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,088 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,088 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,088 [INFO] Batch 15: batch_size 32
2025-01-17 11:27:51,124 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:51,124 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,124 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,124 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,124 [INFO] Batch 16: batch_size 32
2025-01-17 11:27:51,160 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:51,161 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,161 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,161 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,161 [INFO] Batch 17: batch_size 32
2025-01-17 11:27:51,196 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:27:51,196 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,196 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,196 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,196 [INFO] Batch 18: batch_size 32
2025-01-17 11:27:51,231 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:51,231 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,231 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,232 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,232 [INFO] Batch 19: batch_size 32
2025-01-17 11:27:51,267 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:51,268 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,268 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,268 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,268 [INFO] Batch 20: batch_size 32
2025-01-17 11:27:51,304 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:27:51,304 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,304 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,304 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,305 [INFO] Batch 21: batch_size 32
2025-01-17 11:27:51,339 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:51,339 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,339 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,340 [INFO] Batch 22: batch_size 32
2025-01-17 11:27:51,374 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:51,374 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,374 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,375 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,375 [INFO] Batch 23: batch_size 32
2025-01-17 11:27:51,409 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:27:51,410 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,410 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,410 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,410 [INFO] Batch 24: batch_size 32
2025-01-17 11:27:51,445 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:27:51,445 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,445 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,446 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,446 [INFO] Batch 25: batch_size 32
2025-01-17 11:27:51,480 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:51,481 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,481 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,481 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,481 [INFO] Batch 26: batch_size 32
2025-01-17 11:27:51,515 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:27:51,516 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,516 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,516 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,516 [INFO] Batch 27: batch_size 32
2025-01-17 11:27:51,760 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:51,761 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,761 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,761 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,761 [INFO] Batch 28: batch_size 32
2025-01-17 11:27:51,798 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:27:51,798 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,799 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,799 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,799 [INFO] Batch 29: batch_size 32
2025-01-17 11:27:51,834 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:27:51,834 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,834 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,834 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,835 [INFO] Batch 30: batch_size 32
2025-01-17 11:27:51,869 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:27:51,870 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,870 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,870 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,870 [INFO] Batch 31: batch_size 32
2025-01-17 11:27:51,906 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:27:51,906 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,906 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,906 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,907 [INFO] Batch 32: batch_size 32
2025-01-17 11:27:51,941 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:27:51,941 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,941 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,941 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,942 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:27:51,947 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:27:51,948 [INFO] Batch 1: batch_size 32
2025-01-17 11:27:51,983 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:27:51,983 [INFO] Computing non-zero element counts
2025-01-17 11:27:51,983 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:51,984 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:51,984 [INFO] Batch 2: batch_size 32
2025-01-17 11:27:52,020 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:27:52,020 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,021 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,021 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,021 [INFO] Batch 3: batch_size 32
2025-01-17 11:27:52,055 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:52,055 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,055 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,056 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,056 [INFO] Batch 4: batch_size 32
2025-01-17 11:27:52,090 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:52,091 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,091 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,091 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,091 [INFO] Batch 5: batch_size 32
2025-01-17 11:27:52,126 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:52,127 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,127 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,127 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,127 [INFO] Batch 6: batch_size 32
2025-01-17 11:27:52,162 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:27:52,162 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,162 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,162 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,162 [INFO] Batch 7: batch_size 32
2025-01-17 11:27:52,197 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:27:52,198 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,198 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,198 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,198 [INFO] Batch 8: batch_size 32
2025-01-17 11:27:52,232 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:27:52,232 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,233 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,233 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,233 [INFO] Batch 9: batch_size 32
2025-01-17 11:27:52,268 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:52,268 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,268 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,268 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,269 [INFO] Batch 10: batch_size 32
2025-01-17 11:27:52,303 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:27:52,304 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,304 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,304 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,304 [INFO] Batch 11: batch_size 32
2025-01-17 11:27:52,339 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:27:52,339 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,339 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,339 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,339 [INFO] Batch 12: batch_size 32
2025-01-17 11:27:52,374 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:27:52,374 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,374 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,374 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,375 [INFO] Batch 13: batch_size 32
2025-01-17 11:27:52,410 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:27:52,410 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,410 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,410 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,410 [INFO] Batch 14: batch_size 32
2025-01-17 11:27:52,445 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:27:52,445 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,446 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,446 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,446 [INFO] Batch 15: batch_size 32
2025-01-17 11:27:52,480 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:52,481 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,481 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,481 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,481 [INFO] Batch 16: batch_size 32
2025-01-17 11:27:52,516 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:27:52,517 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,517 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,517 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,517 [INFO] Batch 17: batch_size 32
2025-01-17 11:27:52,552 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:27:52,553 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,553 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,553 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,553 [INFO] Batch 18: batch_size 32
2025-01-17 11:27:52,588 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:52,589 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,589 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,589 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,589 [INFO] Batch 19: batch_size 32
2025-01-17 11:27:52,627 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:52,628 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,628 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,628 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,628 [INFO] Batch 20: batch_size 32
2025-01-17 11:27:52,664 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:52,664 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,664 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,664 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,664 [INFO] Batch 21: batch_size 32
2025-01-17 11:27:52,703 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:27:52,703 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,704 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,704 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,704 [INFO] Batch 22: batch_size 32
2025-01-17 11:27:52,740 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:27:52,741 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,741 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,741 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,741 [INFO] Batch 23: batch_size 32
2025-01-17 11:27:52,776 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:27:52,777 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,777 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,777 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,777 [INFO] Batch 24: batch_size 32
2025-01-17 11:27:52,811 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:27:52,812 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,812 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,812 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,812 [INFO] Batch 25: batch_size 32
2025-01-17 11:27:52,847 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:52,847 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,847 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,847 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,847 [INFO] Batch 26: batch_size 32
2025-01-17 11:27:52,882 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:27:52,882 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,883 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,883 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,883 [INFO] Batch 27: batch_size 32
2025-01-17 11:27:52,918 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:27:52,918 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,918 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,918 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,919 [INFO] Batch 28: batch_size 32
2025-01-17 11:27:52,954 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:27:52,955 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,955 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,955 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,955 [INFO] Batch 29: batch_size 32
2025-01-17 11:27:52,990 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:27:52,990 [INFO] Computing non-zero element counts
2025-01-17 11:27:52,991 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:52,991 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:52,991 [INFO] Batch 30: batch_size 32
2025-01-17 11:27:53,025 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:27:53,026 [INFO] Computing non-zero element counts
2025-01-17 11:27:53,026 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:53,026 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:53,026 [INFO] Batch 31: batch_size 32
2025-01-17 11:27:53,061 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:27:53,061 [INFO] Computing non-zero element counts
2025-01-17 11:27:53,062 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:53,062 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:53,062 [INFO] Batch 32: batch_size 32
2025-01-17 11:27:53,094 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:27:53,095 [INFO] Computing non-zero element counts
2025-01-17 11:27:53,095 [INFO] Computing sum of non-zero elements
2025-01-17 11:27:53,095 [INFO] Computing mean of non-zero elements
2025-01-17 11:27:53,096 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:27:53,134 [INFO] Example prompt: Aha, we have good result!
2025-01-17 11:27:53,173 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:28:30,277 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 11:28:30,277 [INFO] Hyperparameters:
2025-01-17 11:28:30,277 [INFO]   layer: 6
2025-01-17 11:28:30,277 [INFO]   LLM: gpt2-small
2025-01-17 11:28:30,278 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:28:30,278 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:28:30,278 [INFO]   output_dir: ./results
2025-01-17 11:28:30,278 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:28:30,278 [INFO]   task: sentiment
2025-01-17 11:28:30,278 [INFO]   seed: 42
2025-01-17 11:28:30,278 [INFO]   data_size: 1000
2025-01-17 11:28:30,278 [INFO]   device: cuda
2025-01-17 11:28:30,278 [INFO]   alpha: 100
2025-01-17 11:28:30,278 [INFO]   steer: pos-neg
2025-01-17 11:28:30,278 [INFO]   method: val_mul
2025-01-17 11:28:30,278 [INFO]   topk_mean: 100
2025-01-17 11:28:30,278 [INFO]   topk_cnt: 100
2025-01-17 11:28:30,278 [INFO]   batch_size: 32
2025-01-17 11:28:30,278 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:28:30,278 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:28:30,279 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 11:28:30,279 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 11:28:30,412 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 11:28:30,421 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 11:28:30,422 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 11:28:30,423 [INFO] Hyperparameters:
2025-01-17 11:28:30,423 [INFO]   layer: 6
2025-01-17 11:28:30,423 [INFO]   LLM: gpt2-small
2025-01-17 11:28:30,423 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 11:28:30,423 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 11:28:30,423 [INFO]   output_dir: ./results
2025-01-17 11:28:30,423 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 11:28:30,423 [INFO]   task: sentiment
2025-01-17 11:28:30,423 [INFO]   seed: 42
2025-01-17 11:28:30,423 [INFO]   data_size: 1000
2025-01-17 11:28:30,424 [INFO]   device: cuda
2025-01-17 11:28:30,424 [INFO]   alpha: 100
2025-01-17 11:28:30,424 [INFO]   steer: pos-neg
2025-01-17 11:28:30,424 [INFO]   method: val_mul
2025-01-17 11:28:30,424 [INFO]   topk_mean: 100
2025-01-17 11:28:30,424 [INFO]   topk_cnt: 100
2025-01-17 11:28:30,424 [INFO]   batch_size: 32
2025-01-17 11:28:30,424 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 11:28:30,424 [INFO] Loading model: gpt2-small
2025-01-17 11:29:31,717 [INFO] Loading SAE for layer 6
2025-01-17 11:30:02,877 [INFO] pos-neg
2025-01-17 11:30:02,883 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:30:02,884 [INFO] Batch 1: batch_size 32
2025-01-17 11:30:03,072 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:30:03,072 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,077 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,077 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,078 [INFO] Batch 2: batch_size 32
2025-01-17 11:30:03,133 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:03,134 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,134 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,134 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,135 [INFO] Batch 3: batch_size 32
2025-01-17 11:30:03,172 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:30:03,172 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,173 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,173 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,173 [INFO] Batch 4: batch_size 32
2025-01-17 11:30:03,209 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:30:03,209 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,210 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,210 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,210 [INFO] Batch 5: batch_size 32
2025-01-17 11:30:03,246 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:30:03,247 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,247 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,247 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,247 [INFO] Batch 6: batch_size 32
2025-01-17 11:30:03,286 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:03,287 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,287 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,287 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,287 [INFO] Batch 7: batch_size 32
2025-01-17 11:30:03,322 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:30:03,322 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,322 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,322 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,322 [INFO] Batch 8: batch_size 32
2025-01-17 11:30:03,356 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 11:30:03,357 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,357 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,357 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,357 [INFO] Batch 9: batch_size 32
2025-01-17 11:30:03,391 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:03,392 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,392 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,392 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,392 [INFO] Batch 10: batch_size 32
2025-01-17 11:30:03,427 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:30:03,427 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,428 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,428 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,428 [INFO] Batch 11: batch_size 32
2025-01-17 11:30:03,463 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:30:03,463 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,463 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,464 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,464 [INFO] Batch 12: batch_size 32
2025-01-17 11:30:03,499 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:30:03,500 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,500 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,501 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,501 [INFO] Batch 13: batch_size 32
2025-01-17 11:30:03,536 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:03,536 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,536 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,536 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,536 [INFO] Batch 14: batch_size 32
2025-01-17 11:30:03,571 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:30:03,572 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,572 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,572 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,572 [INFO] Batch 15: batch_size 32
2025-01-17 11:30:03,607 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 11:30:03,607 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,607 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,608 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,608 [INFO] Batch 16: batch_size 32
2025-01-17 11:30:03,643 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 11:30:03,643 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,643 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,644 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,644 [INFO] Batch 17: batch_size 32
2025-01-17 11:30:03,679 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:03,679 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,680 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,680 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,680 [INFO] Batch 18: batch_size 32
2025-01-17 11:30:03,715 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:03,715 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,715 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,715 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,715 [INFO] Batch 19: batch_size 32
2025-01-17 11:30:03,751 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:03,752 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,752 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,752 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,752 [INFO] Batch 20: batch_size 32
2025-01-17 11:30:03,787 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:30:03,788 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,788 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,788 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,788 [INFO] Batch 21: batch_size 32
2025-01-17 11:30:03,824 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:03,824 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,824 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,824 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,825 [INFO] Batch 22: batch_size 32
2025-01-17 11:30:03,860 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 11:30:03,860 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,861 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,861 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,861 [INFO] Batch 23: batch_size 32
2025-01-17 11:30:03,896 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:30:03,897 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,897 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,897 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,897 [INFO] Batch 24: batch_size 32
2025-01-17 11:30:03,932 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:03,932 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,932 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,933 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,933 [INFO] Batch 25: batch_size 32
2025-01-17 11:30:03,970 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:03,970 [INFO] Computing non-zero element counts
2025-01-17 11:30:03,970 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:03,970 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:03,971 [INFO] Batch 26: batch_size 32
2025-01-17 11:30:04,006 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:04,006 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,006 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,007 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,007 [INFO] Batch 27: batch_size 32
2025-01-17 11:30:04,041 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:04,042 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,042 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,042 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,042 [INFO] Batch 28: batch_size 32
2025-01-17 11:30:04,076 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:30:04,077 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,077 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,077 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,077 [INFO] Batch 29: batch_size 32
2025-01-17 11:30:04,112 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:04,112 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,112 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,112 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,112 [INFO] Batch 30: batch_size 32
2025-01-17 11:30:04,147 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:30:04,148 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,148 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,148 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,148 [INFO] Batch 31: batch_size 32
2025-01-17 11:30:04,183 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:04,183 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,184 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,184 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,184 [INFO] Batch 32: batch_size 32
2025-01-17 11:30:04,233 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 11:30:04,233 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,233 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,234 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,234 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:30:04,240 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:30:04,240 [INFO] Batch 1: batch_size 32
2025-01-17 11:30:04,276 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 11:30:04,277 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,277 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,277 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,277 [INFO] Batch 2: batch_size 32
2025-01-17 11:30:04,311 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:04,312 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,312 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,312 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,312 [INFO] Batch 3: batch_size 32
2025-01-17 11:30:04,347 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:04,347 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,348 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,348 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,348 [INFO] Batch 4: batch_size 32
2025-01-17 11:30:04,384 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:30:04,385 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,385 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,385 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,385 [INFO] Batch 5: batch_size 32
2025-01-17 11:30:04,420 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 11:30:04,421 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,421 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,421 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,421 [INFO] Batch 6: batch_size 32
2025-01-17 11:30:04,456 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:04,456 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,456 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,456 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,457 [INFO] Batch 7: batch_size 32
2025-01-17 11:30:04,491 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:04,492 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,492 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,492 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,492 [INFO] Batch 8: batch_size 32
2025-01-17 11:30:04,527 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:04,527 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,527 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,527 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,528 [INFO] Batch 9: batch_size 32
2025-01-17 11:30:04,563 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:04,563 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,564 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,564 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,564 [INFO] Batch 10: batch_size 32
2025-01-17 11:30:04,599 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:30:04,600 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,600 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,600 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,600 [INFO] Batch 11: batch_size 32
2025-01-17 11:30:04,634 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:30:04,635 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,635 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,635 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,635 [INFO] Batch 12: batch_size 32
2025-01-17 11:30:04,670 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:04,670 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,670 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,670 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,670 [INFO] Batch 13: batch_size 32
2025-01-17 11:30:04,705 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:04,706 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,706 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,706 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,706 [INFO] Batch 14: batch_size 32
2025-01-17 11:30:04,741 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:04,742 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,742 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,742 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,742 [INFO] Batch 15: batch_size 32
2025-01-17 11:30:04,777 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:04,777 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,777 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,777 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,777 [INFO] Batch 16: batch_size 32
2025-01-17 11:30:04,812 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:04,812 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,812 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,812 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,812 [INFO] Batch 17: batch_size 32
2025-01-17 11:30:04,847 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:30:04,847 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,847 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,847 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,847 [INFO] Batch 18: batch_size 32
2025-01-17 11:30:04,882 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:04,883 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,883 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,883 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,883 [INFO] Batch 19: batch_size 32
2025-01-17 11:30:04,918 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:04,919 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,919 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,919 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,920 [INFO] Batch 20: batch_size 32
2025-01-17 11:30:04,955 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:30:04,955 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,955 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,956 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,956 [INFO] Batch 21: batch_size 32
2025-01-17 11:30:04,991 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:04,991 [INFO] Computing non-zero element counts
2025-01-17 11:30:04,991 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:04,991 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:04,991 [INFO] Batch 22: batch_size 32
2025-01-17 11:30:05,026 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:05,027 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,027 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,027 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,027 [INFO] Batch 23: batch_size 32
2025-01-17 11:30:05,063 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:30:05,063 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,063 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,064 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,064 [INFO] Batch 24: batch_size 32
2025-01-17 11:30:05,099 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:30:05,099 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,100 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,100 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,100 [INFO] Batch 25: batch_size 32
2025-01-17 11:30:05,136 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:05,136 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,137 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,137 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,137 [INFO] Batch 26: batch_size 32
2025-01-17 11:30:05,172 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 11:30:05,172 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,172 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,173 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,173 [INFO] Batch 27: batch_size 32
2025-01-17 11:30:05,415 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:05,415 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,415 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,415 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,416 [INFO] Batch 28: batch_size 32
2025-01-17 11:30:05,455 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:30:05,456 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,456 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,456 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,456 [INFO] Batch 29: batch_size 32
2025-01-17 11:30:05,492 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:30:05,492 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,492 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,493 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,493 [INFO] Batch 30: batch_size 32
2025-01-17 11:30:05,538 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 11:30:05,538 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,539 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,539 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,539 [INFO] Batch 31: batch_size 32
2025-01-17 11:30:05,579 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 11:30:05,580 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,580 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,580 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,580 [INFO] Batch 32: batch_size 32
2025-01-17 11:30:05,614 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 11:30:05,615 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,615 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,615 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,615 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:30:05,621 [INFO] Running model with cache to obtain hidden states
2025-01-17 11:30:05,621 [INFO] Batch 1: batch_size 32
2025-01-17 11:30:05,657 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 11:30:05,657 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,657 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,657 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,658 [INFO] Batch 2: batch_size 32
2025-01-17 11:30:05,694 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:30:05,695 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,695 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,695 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,695 [INFO] Batch 3: batch_size 32
2025-01-17 11:30:05,730 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:05,731 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,731 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,731 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,731 [INFO] Batch 4: batch_size 32
2025-01-17 11:30:05,766 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:05,766 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,767 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,767 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,767 [INFO] Batch 5: batch_size 32
2025-01-17 11:30:05,802 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:05,802 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,802 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,802 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,802 [INFO] Batch 6: batch_size 32
2025-01-17 11:30:05,837 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 11:30:05,837 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,837 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,837 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,838 [INFO] Batch 7: batch_size 32
2025-01-17 11:30:05,872 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 11:30:05,873 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,873 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,873 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,873 [INFO] Batch 8: batch_size 32
2025-01-17 11:30:05,907 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:30:05,908 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,908 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,908 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,908 [INFO] Batch 9: batch_size 32
2025-01-17 11:30:05,943 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:05,943 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,944 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,944 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,944 [INFO] Batch 10: batch_size 32
2025-01-17 11:30:05,978 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:30:05,979 [INFO] Computing non-zero element counts
2025-01-17 11:30:05,979 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:05,979 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:05,979 [INFO] Batch 11: batch_size 32
2025-01-17 11:30:06,015 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 11:30:06,015 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,015 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,015 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,015 [INFO] Batch 12: batch_size 32
2025-01-17 11:30:06,050 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:30:06,050 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,051 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,051 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,051 [INFO] Batch 13: batch_size 32
2025-01-17 11:30:06,086 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 11:30:06,086 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,087 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,087 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,087 [INFO] Batch 14: batch_size 32
2025-01-17 11:30:06,122 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:30:06,123 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,123 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,123 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,123 [INFO] Batch 15: batch_size 32
2025-01-17 11:30:06,158 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:06,158 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,158 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,158 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,158 [INFO] Batch 16: batch_size 32
2025-01-17 11:30:06,195 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 11:30:06,196 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,196 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,196 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,196 [INFO] Batch 17: batch_size 32
2025-01-17 11:30:06,232 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 11:30:06,232 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,232 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,233 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,233 [INFO] Batch 18: batch_size 32
2025-01-17 11:30:06,268 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:06,268 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,269 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,269 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,269 [INFO] Batch 19: batch_size 32
2025-01-17 11:30:06,304 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:06,305 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,305 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,305 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,305 [INFO] Batch 20: batch_size 32
2025-01-17 11:30:06,340 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:06,340 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,340 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,340 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,341 [INFO] Batch 21: batch_size 32
2025-01-17 11:30:06,376 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 11:30:06,376 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,377 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,377 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,377 [INFO] Batch 22: batch_size 32
2025-01-17 11:30:06,411 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:30:06,412 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,412 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,412 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,412 [INFO] Batch 23: batch_size 32
2025-01-17 11:30:06,447 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 11:30:06,448 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,448 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,448 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,448 [INFO] Batch 24: batch_size 32
2025-01-17 11:30:06,486 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 11:30:06,486 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,487 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,487 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,487 [INFO] Batch 25: batch_size 32
2025-01-17 11:30:06,522 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:06,522 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,523 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,523 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,523 [INFO] Batch 26: batch_size 32
2025-01-17 11:30:06,564 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 11:30:06,565 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,565 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,565 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,565 [INFO] Batch 27: batch_size 32
2025-01-17 11:30:06,602 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 11:30:06,602 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,602 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,602 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,603 [INFO] Batch 28: batch_size 32
2025-01-17 11:30:06,638 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 11:30:06,639 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,639 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,639 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,639 [INFO] Batch 29: batch_size 32
2025-01-17 11:30:06,674 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 11:30:06,674 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,674 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,674 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,675 [INFO] Batch 30: batch_size 32
2025-01-17 11:30:06,709 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 11:30:06,710 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,710 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,710 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,710 [INFO] Batch 31: batch_size 32
2025-01-17 11:30:06,745 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 11:30:06,746 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,746 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,746 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,746 [INFO] Batch 32: batch_size 32
2025-01-17 11:30:06,779 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 11:30:06,779 [INFO] Computing non-zero element counts
2025-01-17 11:30:06,779 [INFO] Computing sum of non-zero elements
2025-01-17 11:30:06,779 [INFO] Computing mean of non-zero elements
2025-01-17 11:30:06,780 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 11:30:06,821 [INFO] Example prompt: Aha, we have good result!
2025-01-17 11:30:06,863 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:06,864 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:11,776 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:11,777 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:15,942 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:15,942 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:20,223 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:20,223 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:24,541 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:24,541 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:28,390 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:28,390 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:32,654 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:32,654 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:36,509 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:36,509 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:40,856 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:40,856 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:45,107 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:45,108 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:49,129 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:49,129 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:53,009 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:53,009 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:30:56,815 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:30:56,815 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:00,661 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:00,661 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:04,641 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:04,642 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:08,625 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:08,625 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:12,439 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:12,440 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:16,166 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:16,166 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:20,520 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:20,521 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:24,722 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:24,722 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:29,365 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:29,365 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:33,524 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:33,524 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:37,855 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:37,855 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:41,917 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:41,918 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:45,593 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:45,594 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:49,934 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:49,935 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:53,644 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:53,645 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:31:57,603 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:31:57,603 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:01,578 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:01,579 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:05,767 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:05,767 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:10,131 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:10,131 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:14,467 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:14,467 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:18,612 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:18,613 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:22,501 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:22,502 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:26,338 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:26,338 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:30,728 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:30,728 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:34,458 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:34,458 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:38,598 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:38,598 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:42,310 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:42,310 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:46,413 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:46,413 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:50,398 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:50,398 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:54,449 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:54,449 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:32:58,518 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:32:58,519 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:02,733 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:02,733 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:06,990 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:06,990 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:10,941 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:10,942 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:14,879 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:14,879 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:18,554 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:18,554 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:22,411 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:22,412 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:26,336 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:26,336 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:30,234 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:30,234 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:34,012 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:34,012 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:37,682 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:37,683 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:41,661 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:41,661 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:45,529 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:45,530 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:49,937 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:49,937 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:54,171 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:54,171 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:33:58,378 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:33:58,378 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:02,327 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:02,327 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:06,054 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:06,054 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:10,309 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:10,309 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:14,419 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:14,420 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:18,553 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:18,553 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:22,943 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:22,943 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:27,070 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:27,070 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:31,132 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:31,133 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:35,072 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:35,072 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:39,176 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:39,178 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:43,115 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:43,115 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:46,880 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:46,881 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:50,695 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:50,695 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:54,676 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:54,676 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:34:58,571 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:34:58,571 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:02,336 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:02,336 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:06,278 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:06,278 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:10,058 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:10,058 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:13,945 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:13,945 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:17,893 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:17,894 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:21,651 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:21,652 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:25,793 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:25,793 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:29,933 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:29,934 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:33,778 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:33,778 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:38,092 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:38,092 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:42,044 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:42,044 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:46,144 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:46,145 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:49,962 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:49,962 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:54,447 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:54,447 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:35:58,579 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:35:58,580 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:02,734 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:02,734 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:06,799 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:06,799 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:11,002 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:11,003 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:15,392 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:15,393 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:19,516 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:19,517 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:23,514 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:23,514 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:27,705 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:27,706 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:31,502 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:31,502 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:35,781 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:35,781 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:39,648 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:39,648 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:43,522 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:43,522 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 11:36:47,492 [INFO] Computing steering vectors using method: val_mul
2025-01-17 11:36:47,493 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:06:21,059 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 12:06:21,060 [INFO] Hyperparameters:
2025-01-17 12:06:21,060 [INFO]   layer: 6
2025-01-17 12:06:21,060 [INFO]   LLM: gpt2-small
2025-01-17 12:06:21,060 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:06:21,060 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 12:06:21,060 [INFO]   output_dir: ./results
2025-01-17 12:06:21,060 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 12:06:21,060 [INFO]   task: sentiment
2025-01-17 12:06:21,060 [INFO]   seed: 42
2025-01-17 12:06:21,060 [INFO]   data_size: 1000
2025-01-17 12:06:21,060 [INFO]   device: cuda
2025-01-17 12:06:21,060 [INFO]   alpha: 100
2025-01-17 12:06:21,060 [INFO]   steer: pos-neg
2025-01-17 12:06:21,060 [INFO]   method: val_mul
2025-01-17 12:06:21,060 [INFO]   topk_mean: 100
2025-01-17 12:06:21,060 [INFO]   topk_cnt: 100
2025-01-17 12:06:21,060 [INFO]   batch_size: 32
2025-01-17 12:06:21,061 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 12:06:21,061 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:06:21,061 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 12:06:21,061 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 12:06:21,183 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 12:06:21,191 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 12:06:21,192 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 12:06:21,192 [INFO] Hyperparameters:
2025-01-17 12:06:21,192 [INFO]   layer: 6
2025-01-17 12:06:21,192 [INFO]   LLM: gpt2-small
2025-01-17 12:06:21,192 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:06:21,192 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 12:06:21,192 [INFO]   output_dir: ./results
2025-01-17 12:06:21,192 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 12:06:21,192 [INFO]   task: sentiment
2025-01-17 12:06:21,192 [INFO]   seed: 42
2025-01-17 12:06:21,192 [INFO]   data_size: 1000
2025-01-17 12:06:21,192 [INFO]   device: cuda
2025-01-17 12:06:21,192 [INFO]   alpha: 100
2025-01-17 12:06:21,192 [INFO]   steer: pos-neg
2025-01-17 12:06:21,192 [INFO]   method: val_mul
2025-01-17 12:06:21,192 [INFO]   topk_mean: 100
2025-01-17 12:06:21,192 [INFO]   topk_cnt: 100
2025-01-17 12:06:21,192 [INFO]   batch_size: 32
2025-01-17 12:06:21,193 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 12:06:21,193 [INFO] Loading model: gpt2-small
2025-01-17 12:07:02,336 [INFO] Loading SAE for layer 6
2025-01-17 12:07:38,950 [INFO] pos-neg
2025-01-17 12:07:38,956 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:07:38,957 [INFO] Batch 1: batch_size 32
2025-01-17 12:07:39,141 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:07:39,141 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,145 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,146 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,146 [INFO] Batch 2: batch_size 32
2025-01-17 12:07:39,201 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:39,201 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,202 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,202 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,202 [INFO] Batch 3: batch_size 32
2025-01-17 12:07:39,241 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:07:39,242 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,242 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,242 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,242 [INFO] Batch 4: batch_size 32
2025-01-17 12:07:39,277 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:07:39,278 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,278 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,278 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,278 [INFO] Batch 5: batch_size 32
2025-01-17 12:07:39,313 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:07:39,313 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,313 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,314 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,314 [INFO] Batch 6: batch_size 32
2025-01-17 12:07:39,348 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:39,349 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,349 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,349 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,349 [INFO] Batch 7: batch_size 32
2025-01-17 12:07:39,384 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:07:39,384 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,384 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,384 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,384 [INFO] Batch 8: batch_size 32
2025-01-17 12:07:39,418 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 12:07:39,419 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,419 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,419 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,419 [INFO] Batch 9: batch_size 32
2025-01-17 12:07:39,454 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:39,455 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,455 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,455 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,455 [INFO] Batch 10: batch_size 32
2025-01-17 12:07:39,491 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:07:39,491 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,492 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,492 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,492 [INFO] Batch 11: batch_size 32
2025-01-17 12:07:39,528 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:07:39,528 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,528 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,528 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,528 [INFO] Batch 12: batch_size 32
2025-01-17 12:07:39,564 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 12:07:39,565 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,565 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,565 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,565 [INFO] Batch 13: batch_size 32
2025-01-17 12:07:39,600 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:39,601 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,601 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,601 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,601 [INFO] Batch 14: batch_size 32
2025-01-17 12:07:39,636 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:07:39,636 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,636 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,636 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,636 [INFO] Batch 15: batch_size 32
2025-01-17 12:07:39,670 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 12:07:39,671 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,671 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,671 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,671 [INFO] Batch 16: batch_size 32
2025-01-17 12:07:39,706 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 12:07:39,706 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,706 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,707 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,707 [INFO] Batch 17: batch_size 32
2025-01-17 12:07:39,741 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:39,742 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,742 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,742 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,742 [INFO] Batch 18: batch_size 32
2025-01-17 12:07:39,777 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:39,777 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,777 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,777 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,777 [INFO] Batch 19: batch_size 32
2025-01-17 12:07:39,812 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:39,812 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,812 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,812 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,813 [INFO] Batch 20: batch_size 32
2025-01-17 12:07:39,854 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:07:39,855 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,855 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,855 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,856 [INFO] Batch 21: batch_size 32
2025-01-17 12:07:39,891 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:39,892 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,892 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,892 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,892 [INFO] Batch 22: batch_size 32
2025-01-17 12:07:39,927 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 12:07:39,928 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,928 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,928 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,928 [INFO] Batch 23: batch_size 32
2025-01-17 12:07:39,963 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:07:39,964 [INFO] Computing non-zero element counts
2025-01-17 12:07:39,964 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:39,964 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:39,964 [INFO] Batch 24: batch_size 32
2025-01-17 12:07:40,004 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:40,005 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,005 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,006 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,006 [INFO] Batch 25: batch_size 32
2025-01-17 12:07:40,044 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:40,045 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,045 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,045 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,045 [INFO] Batch 26: batch_size 32
2025-01-17 12:07:40,080 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:40,081 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,081 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,081 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,081 [INFO] Batch 27: batch_size 32
2025-01-17 12:07:40,118 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:40,119 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,119 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,119 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,119 [INFO] Batch 28: batch_size 32
2025-01-17 12:07:40,155 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:07:40,156 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,156 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,156 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,156 [INFO] Batch 29: batch_size 32
2025-01-17 12:07:40,191 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:40,192 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,192 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,192 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,192 [INFO] Batch 30: batch_size 32
2025-01-17 12:07:40,227 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:07:40,228 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,228 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,228 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,228 [INFO] Batch 31: batch_size 32
2025-01-17 12:07:40,266 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:40,267 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,267 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,267 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,267 [INFO] Batch 32: batch_size 32
2025-01-17 12:07:40,319 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 12:07:40,319 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,319 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,319 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,320 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:07:40,326 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:07:40,326 [INFO] Batch 1: batch_size 32
2025-01-17 12:07:40,361 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 12:07:40,361 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,362 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,362 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,362 [INFO] Batch 2: batch_size 32
2025-01-17 12:07:40,396 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:40,396 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,397 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,397 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,397 [INFO] Batch 3: batch_size 32
2025-01-17 12:07:40,434 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:40,435 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,435 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,435 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,435 [INFO] Batch 4: batch_size 32
2025-01-17 12:07:40,472 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:07:40,473 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,473 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,473 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,473 [INFO] Batch 5: batch_size 32
2025-01-17 12:07:40,509 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 12:07:40,509 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,510 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,510 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,510 [INFO] Batch 6: batch_size 32
2025-01-17 12:07:40,544 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:40,544 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,545 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,545 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,545 [INFO] Batch 7: batch_size 32
2025-01-17 12:07:40,580 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:40,581 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,581 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,581 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,581 [INFO] Batch 8: batch_size 32
2025-01-17 12:07:40,619 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:40,620 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,620 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,620 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,620 [INFO] Batch 9: batch_size 32
2025-01-17 12:07:40,657 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:40,657 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,658 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,658 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,658 [INFO] Batch 10: batch_size 32
2025-01-17 12:07:40,694 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 12:07:40,694 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,694 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,694 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,695 [INFO] Batch 11: batch_size 32
2025-01-17 12:07:40,730 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:07:40,730 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,730 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,730 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,731 [INFO] Batch 12: batch_size 32
2025-01-17 12:07:40,766 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:40,766 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,766 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,766 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,766 [INFO] Batch 13: batch_size 32
2025-01-17 12:07:40,802 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:40,802 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,802 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,802 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,802 [INFO] Batch 14: batch_size 32
2025-01-17 12:07:40,837 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:40,838 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,838 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,838 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,838 [INFO] Batch 15: batch_size 32
2025-01-17 12:07:40,873 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:40,873 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,873 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,873 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,874 [INFO] Batch 16: batch_size 32
2025-01-17 12:07:40,909 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:40,909 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,909 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,909 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,910 [INFO] Batch 17: batch_size 32
2025-01-17 12:07:40,944 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:07:40,945 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,945 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,945 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,945 [INFO] Batch 18: batch_size 32
2025-01-17 12:07:40,983 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:40,984 [INFO] Computing non-zero element counts
2025-01-17 12:07:40,984 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:40,984 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:40,984 [INFO] Batch 19: batch_size 32
2025-01-17 12:07:41,021 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:41,022 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,022 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,023 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,023 [INFO] Batch 20: batch_size 32
2025-01-17 12:07:41,058 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:07:41,059 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,059 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,059 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,059 [INFO] Batch 21: batch_size 32
2025-01-17 12:07:41,093 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:41,094 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,094 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,094 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,094 [INFO] Batch 22: batch_size 32
2025-01-17 12:07:41,129 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:41,130 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,130 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,130 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,130 [INFO] Batch 23: batch_size 32
2025-01-17 12:07:41,165 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 12:07:41,166 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,166 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,166 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,166 [INFO] Batch 24: batch_size 32
2025-01-17 12:07:41,200 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:07:41,201 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,201 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,201 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,201 [INFO] Batch 25: batch_size 32
2025-01-17 12:07:41,237 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:41,238 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,238 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,238 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,238 [INFO] Batch 26: batch_size 32
2025-01-17 12:07:41,273 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:07:41,273 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,273 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,273 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,273 [INFO] Batch 27: batch_size 32
2025-01-17 12:07:41,507 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:41,507 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,507 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,508 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,508 [INFO] Batch 28: batch_size 32
2025-01-17 12:07:41,545 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:07:41,546 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,546 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,546 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,546 [INFO] Batch 29: batch_size 32
2025-01-17 12:07:41,582 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 12:07:41,582 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,582 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,582 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,583 [INFO] Batch 30: batch_size 32
2025-01-17 12:07:41,618 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 12:07:41,619 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,619 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,619 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,619 [INFO] Batch 31: batch_size 32
2025-01-17 12:07:41,654 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 12:07:41,655 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,655 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,655 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,655 [INFO] Batch 32: batch_size 32
2025-01-17 12:07:41,689 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 12:07:41,690 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,690 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,690 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,690 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:07:41,696 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:07:41,696 [INFO] Batch 1: batch_size 32
2025-01-17 12:07:41,731 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 12:07:41,732 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,732 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,732 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,733 [INFO] Batch 2: batch_size 32
2025-01-17 12:07:41,769 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:07:41,769 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,769 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,770 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,770 [INFO] Batch 3: batch_size 32
2025-01-17 12:07:41,804 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:41,804 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,804 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,805 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,805 [INFO] Batch 4: batch_size 32
2025-01-17 12:07:41,840 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:41,840 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,840 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,841 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,841 [INFO] Batch 5: batch_size 32
2025-01-17 12:07:41,878 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:41,879 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,879 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,879 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,879 [INFO] Batch 6: batch_size 32
2025-01-17 12:07:41,914 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:07:41,914 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,915 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,915 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,915 [INFO] Batch 7: batch_size 32
2025-01-17 12:07:41,950 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:07:41,951 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,951 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,951 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,951 [INFO] Batch 8: batch_size 32
2025-01-17 12:07:41,986 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:07:41,986 [INFO] Computing non-zero element counts
2025-01-17 12:07:41,986 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:41,986 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:41,986 [INFO] Batch 9: batch_size 32
2025-01-17 12:07:42,021 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:42,021 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,021 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,021 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,022 [INFO] Batch 10: batch_size 32
2025-01-17 12:07:42,056 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:07:42,056 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,057 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,057 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,057 [INFO] Batch 11: batch_size 32
2025-01-17 12:07:42,091 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 12:07:42,092 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,092 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,092 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,092 [INFO] Batch 12: batch_size 32
2025-01-17 12:07:42,127 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:07:42,128 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,128 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,128 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,128 [INFO] Batch 13: batch_size 32
2025-01-17 12:07:42,163 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:07:42,163 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,163 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,163 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,164 [INFO] Batch 14: batch_size 32
2025-01-17 12:07:42,198 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:07:42,199 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,199 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,199 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,199 [INFO] Batch 15: batch_size 32
2025-01-17 12:07:42,234 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:42,234 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,234 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,235 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,235 [INFO] Batch 16: batch_size 32
2025-01-17 12:07:42,269 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:07:42,270 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,270 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,270 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,270 [INFO] Batch 17: batch_size 32
2025-01-17 12:07:42,305 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:07:42,305 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,305 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,305 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,305 [INFO] Batch 18: batch_size 32
2025-01-17 12:07:42,339 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:42,340 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,340 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,340 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,340 [INFO] Batch 19: batch_size 32
2025-01-17 12:07:42,376 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:42,376 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,377 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,377 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,377 [INFO] Batch 20: batch_size 32
2025-01-17 12:07:42,412 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:42,412 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,412 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,412 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,413 [INFO] Batch 21: batch_size 32
2025-01-17 12:07:42,449 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:07:42,450 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,450 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,450 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,450 [INFO] Batch 22: batch_size 32
2025-01-17 12:07:42,485 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:07:42,486 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,486 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,486 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,486 [INFO] Batch 23: batch_size 32
2025-01-17 12:07:42,521 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 12:07:42,521 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,521 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,522 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,522 [INFO] Batch 24: batch_size 32
2025-01-17 12:07:42,556 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:07:42,557 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,557 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,557 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,557 [INFO] Batch 25: batch_size 32
2025-01-17 12:07:42,593 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:42,594 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,594 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,594 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,594 [INFO] Batch 26: batch_size 32
2025-01-17 12:07:42,638 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:07:42,638 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,638 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,638 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,639 [INFO] Batch 27: batch_size 32
2025-01-17 12:07:42,675 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:07:42,676 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,676 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,676 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,676 [INFO] Batch 28: batch_size 32
2025-01-17 12:07:42,712 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:07:42,712 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,713 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,713 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,713 [INFO] Batch 29: batch_size 32
2025-01-17 12:07:42,749 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:07:42,749 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,749 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,749 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,750 [INFO] Batch 30: batch_size 32
2025-01-17 12:07:42,785 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:07:42,785 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,786 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,786 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,786 [INFO] Batch 31: batch_size 32
2025-01-17 12:07:42,822 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:07:42,822 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,823 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,823 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,823 [INFO] Batch 32: batch_size 32
2025-01-17 12:07:42,856 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 12:07:42,857 [INFO] Computing non-zero element counts
2025-01-17 12:07:42,857 [INFO] Computing sum of non-zero elements
2025-01-17 12:07:42,857 [INFO] Computing mean of non-zero elements
2025-01-17 12:07:42,858 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:07:42,899 [INFO] Example prompt: Aha, we have good result!
2025-01-17 12:16:34,027 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-17 12:16:34,027 [INFO] Hyperparameters:
2025-01-17 12:16:34,027 [INFO]   layer: 6
2025-01-17 12:16:34,027 [INFO]   LLM: gpt2-small
2025-01-17 12:16:34,027 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:16:34,027 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 12:16:34,027 [INFO]   output_dir: ./results
2025-01-17 12:16:34,027 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 12:16:34,027 [INFO]   task: sentiment
2025-01-17 12:16:34,027 [INFO]   seed: 42
2025-01-17 12:16:34,027 [INFO]   data_size: 1000
2025-01-17 12:16:34,028 [INFO]   device: cuda
2025-01-17 12:16:34,028 [INFO]   alpha: 100
2025-01-17 12:16:34,028 [INFO]   steer: pos-neg
2025-01-17 12:16:34,028 [INFO]   method: val_mul
2025-01-17 12:16:34,028 [INFO]   topk_mean: 100
2025-01-17 12:16:34,028 [INFO]   topk_cnt: 100
2025-01-17 12:16:34,028 [INFO]   batch_size: 32
2025-01-17 12:16:34,028 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 12:16:34,028 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:16:34,028 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 12:16:34,028 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 12:16:34,127 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 12:16:34,134 [INFO] Selected 1000 negative, 1000 positive, and 1000 neutral samples
2025-01-17 12:16:34,134 [INFO] non cache: ./results/mask_test/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean100/hyperparameters.json
2025-01-17 12:16:34,134 [INFO] Hyperparameters:
2025-01-17 12:16:34,134 [INFO]   layer: 6
2025-01-17 12:16:34,134 [INFO]   LLM: gpt2-small
2025-01-17 12:16:34,135 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 12:16:34,135 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 12:16:34,135 [INFO]   output_dir: ./results
2025-01-17 12:16:34,135 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 12:16:34,135 [INFO]   task: sentiment
2025-01-17 12:16:34,135 [INFO]   seed: 42
2025-01-17 12:16:34,135 [INFO]   data_size: 1000
2025-01-17 12:16:34,135 [INFO]   device: cuda
2025-01-17 12:16:34,135 [INFO]   alpha: 100
2025-01-17 12:16:34,135 [INFO]   steer: pos-neg
2025-01-17 12:16:34,135 [INFO]   method: val_mul
2025-01-17 12:16:34,135 [INFO]   topk_mean: 100
2025-01-17 12:16:34,135 [INFO]   topk_cnt: 100
2025-01-17 12:16:34,135 [INFO]   batch_size: 32
2025-01-17 12:16:34,135 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 12:16:34,135 [INFO] Loading model: gpt2-small
2025-01-17 12:17:24,384 [INFO] Loading SAE for layer 6
2025-01-17 12:18:05,559 [INFO] pos-neg
2025-01-17 12:18:05,565 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:18:05,566 [INFO] Batch 1: batch_size 32
2025-01-17 12:18:05,757 [INFO] Batch 1: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:18:05,758 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,762 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,762 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,762 [INFO] Batch 2: batch_size 32
2025-01-17 12:18:05,825 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:05,826 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,826 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,826 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,826 [INFO] Batch 3: batch_size 32
2025-01-17 12:18:05,867 [INFO] Batch 3: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:18:05,868 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,868 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,868 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,868 [INFO] Batch 4: batch_size 32
2025-01-17 12:18:05,906 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:18:05,906 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,906 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,906 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,906 [INFO] Batch 5: batch_size 32
2025-01-17 12:18:05,942 [INFO] Batch 5: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:18:05,943 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,943 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,943 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,943 [INFO] Batch 6: batch_size 32
2025-01-17 12:18:05,979 [INFO] Batch 6: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:05,980 [INFO] Computing non-zero element counts
2025-01-17 12:18:05,980 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:05,980 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:05,980 [INFO] Batch 7: batch_size 32
2025-01-17 12:18:06,016 [INFO] Batch 7: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:18:06,016 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,016 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,016 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,017 [INFO] Batch 8: batch_size 32
2025-01-17 12:18:06,055 [INFO] Batch 8: Hidden states shape: torch.Size([32, 34, 768])
2025-01-17 12:18:06,056 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,057 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,057 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,057 [INFO] Batch 9: batch_size 32
2025-01-17 12:18:06,094 [INFO] Batch 9: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:06,095 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,095 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,095 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,096 [INFO] Batch 10: batch_size 32
2025-01-17 12:18:06,132 [INFO] Batch 10: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:18:06,132 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,133 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,133 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,133 [INFO] Batch 11: batch_size 32
2025-01-17 12:18:06,170 [INFO] Batch 11: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:18:06,170 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,171 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,171 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,171 [INFO] Batch 12: batch_size 32
2025-01-17 12:18:06,208 [INFO] Batch 12: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 12:18:06,208 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,209 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,209 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,209 [INFO] Batch 13: batch_size 32
2025-01-17 12:18:06,245 [INFO] Batch 13: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:06,245 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,245 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,245 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,245 [INFO] Batch 14: batch_size 32
2025-01-17 12:18:06,281 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:18:06,281 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,281 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,281 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,281 [INFO] Batch 15: batch_size 32
2025-01-17 12:18:06,317 [INFO] Batch 15: Hidden states shape: torch.Size([32, 41, 768])
2025-01-17 12:18:06,317 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,317 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,317 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,318 [INFO] Batch 16: batch_size 32
2025-01-17 12:18:06,353 [INFO] Batch 16: Hidden states shape: torch.Size([32, 35, 768])
2025-01-17 12:18:06,353 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,353 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,353 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,354 [INFO] Batch 17: batch_size 32
2025-01-17 12:18:06,390 [INFO] Batch 17: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:06,390 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,390 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,391 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,391 [INFO] Batch 18: batch_size 32
2025-01-17 12:18:06,426 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:06,427 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,427 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,427 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,427 [INFO] Batch 19: batch_size 32
2025-01-17 12:18:06,473 [INFO] Batch 19: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:06,474 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,474 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,474 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,474 [INFO] Batch 20: batch_size 32
2025-01-17 12:18:06,512 [INFO] Batch 20: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:18:06,512 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,513 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,513 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,513 [INFO] Batch 21: batch_size 32
2025-01-17 12:18:06,548 [INFO] Batch 21: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:06,548 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,548 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,548 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,549 [INFO] Batch 22: batch_size 32
2025-01-17 12:18:06,584 [INFO] Batch 22: Hidden states shape: torch.Size([32, 56, 768])
2025-01-17 12:18:06,584 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,584 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,584 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,585 [INFO] Batch 23: batch_size 32
2025-01-17 12:18:06,619 [INFO] Batch 23: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:18:06,619 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,619 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,619 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,620 [INFO] Batch 24: batch_size 32
2025-01-17 12:18:06,658 [INFO] Batch 24: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:06,658 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,658 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,658 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,659 [INFO] Batch 25: batch_size 32
2025-01-17 12:18:06,697 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:06,697 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,697 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,697 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,697 [INFO] Batch 26: batch_size 32
2025-01-17 12:18:06,734 [INFO] Batch 26: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:06,734 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,735 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,735 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,735 [INFO] Batch 27: batch_size 32
2025-01-17 12:18:06,770 [INFO] Batch 27: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:06,770 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,770 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,770 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,771 [INFO] Batch 28: batch_size 32
2025-01-17 12:18:06,807 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:18:06,807 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,807 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,807 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,808 [INFO] Batch 29: batch_size 32
2025-01-17 12:18:06,843 [INFO] Batch 29: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:06,843 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,843 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,843 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,843 [INFO] Batch 30: batch_size 32
2025-01-17 12:18:06,879 [INFO] Batch 30: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:18:06,879 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,879 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,880 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,880 [INFO] Batch 31: batch_size 32
2025-01-17 12:18:06,919 [INFO] Batch 31: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:06,919 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,919 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,919 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,920 [INFO] Batch 32: batch_size 32
2025-01-17 12:18:06,970 [INFO] Batch 32: Hidden states shape: torch.Size([8, 40, 768])
2025-01-17 12:18:06,971 [INFO] Computing non-zero element counts
2025-01-17 12:18:06,971 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:06,971 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:06,971 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:18:06,978 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:18:06,978 [INFO] Batch 1: batch_size 32
2025-01-17 12:18:07,013 [INFO] Batch 1: Hidden states shape: torch.Size([32, 55, 768])
2025-01-17 12:18:07,014 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,014 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,014 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,014 [INFO] Batch 2: batch_size 32
2025-01-17 12:18:07,049 [INFO] Batch 2: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:07,049 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,050 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,050 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,050 [INFO] Batch 3: batch_size 32
2025-01-17 12:18:07,085 [INFO] Batch 3: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:07,086 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,086 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,086 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,086 [INFO] Batch 4: batch_size 32
2025-01-17 12:18:07,121 [INFO] Batch 4: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:18:07,122 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,122 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,122 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,122 [INFO] Batch 5: batch_size 32
2025-01-17 12:18:07,157 [INFO] Batch 5: Hidden states shape: torch.Size([32, 37, 768])
2025-01-17 12:18:07,158 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,158 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,158 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,158 [INFO] Batch 6: batch_size 32
2025-01-17 12:18:07,192 [INFO] Batch 6: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:07,193 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,193 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,193 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,193 [INFO] Batch 7: batch_size 32
2025-01-17 12:18:07,228 [INFO] Batch 7: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:07,229 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,229 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,229 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,229 [INFO] Batch 8: batch_size 32
2025-01-17 12:18:07,263 [INFO] Batch 8: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:07,264 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,264 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,264 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,264 [INFO] Batch 9: batch_size 32
2025-01-17 12:18:07,300 [INFO] Batch 9: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:07,300 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,301 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,301 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,301 [INFO] Batch 10: batch_size 32
2025-01-17 12:18:07,337 [INFO] Batch 10: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 12:18:07,337 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,338 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,338 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,338 [INFO] Batch 11: batch_size 32
2025-01-17 12:18:07,373 [INFO] Batch 11: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:18:07,374 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,374 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,374 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,374 [INFO] Batch 12: batch_size 32
2025-01-17 12:18:07,408 [INFO] Batch 12: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:07,409 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,409 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,409 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,409 [INFO] Batch 13: batch_size 32
2025-01-17 12:18:07,445 [INFO] Batch 13: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:07,445 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,445 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,445 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,446 [INFO] Batch 14: batch_size 32
2025-01-17 12:18:07,480 [INFO] Batch 14: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:07,480 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,481 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,481 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,481 [INFO] Batch 15: batch_size 32
2025-01-17 12:18:07,515 [INFO] Batch 15: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:07,516 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,516 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,516 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,516 [INFO] Batch 16: batch_size 32
2025-01-17 12:18:07,551 [INFO] Batch 16: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:07,551 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,551 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,551 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,551 [INFO] Batch 17: batch_size 32
2025-01-17 12:18:07,587 [INFO] Batch 17: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:18:07,588 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,588 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,588 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,588 [INFO] Batch 18: batch_size 32
2025-01-17 12:18:07,616 [INFO] Batch 18: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:07,617 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,617 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,617 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,617 [INFO] Batch 19: batch_size 32
2025-01-17 12:18:07,647 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:07,647 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,648 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,648 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,648 [INFO] Batch 20: batch_size 32
2025-01-17 12:18:07,684 [INFO] Batch 20: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:18:07,684 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,685 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,685 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,685 [INFO] Batch 21: batch_size 32
2025-01-17 12:18:07,720 [INFO] Batch 21: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:07,721 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,721 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,721 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,721 [INFO] Batch 22: batch_size 32
2025-01-17 12:18:07,758 [INFO] Batch 22: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:07,758 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,759 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,759 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,759 [INFO] Batch 23: batch_size 32
2025-01-17 12:18:07,797 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 12:18:07,798 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,798 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,798 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,798 [INFO] Batch 24: batch_size 32
2025-01-17 12:18:07,839 [INFO] Batch 24: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:18:07,839 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,840 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,840 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,840 [INFO] Batch 25: batch_size 32
2025-01-17 12:18:07,885 [INFO] Batch 25: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:07,885 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,886 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,886 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,886 [INFO] Batch 26: batch_size 32
2025-01-17 12:18:07,939 [INFO] Batch 26: Hidden states shape: torch.Size([32, 44, 768])
2025-01-17 12:18:07,940 [INFO] Computing non-zero element counts
2025-01-17 12:18:07,940 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:07,940 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:07,940 [INFO] Batch 27: batch_size 32
2025-01-17 12:18:08,267 [INFO] Batch 27: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:08,267 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,268 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,268 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,268 [INFO] Batch 28: batch_size 32
2025-01-17 12:18:08,309 [INFO] Batch 28: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:18:08,310 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,310 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,311 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,311 [INFO] Batch 29: batch_size 32
2025-01-17 12:18:08,350 [INFO] Batch 29: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 12:18:08,351 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,351 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,351 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,351 [INFO] Batch 30: batch_size 32
2025-01-17 12:18:08,393 [INFO] Batch 30: Hidden states shape: torch.Size([32, 40, 768])
2025-01-17 12:18:08,394 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,394 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,394 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,394 [INFO] Batch 31: batch_size 32
2025-01-17 12:18:08,439 [INFO] Batch 31: Hidden states shape: torch.Size([32, 54, 768])
2025-01-17 12:18:08,440 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,440 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,440 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,440 [INFO] Batch 32: batch_size 32
2025-01-17 12:18:08,481 [INFO] Batch 32: Hidden states shape: torch.Size([8, 45, 768])
2025-01-17 12:18:08,482 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,482 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,482 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,482 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:18:08,489 [INFO] Running model with cache to obtain hidden states
2025-01-17 12:18:08,490 [INFO] Batch 1: batch_size 32
2025-01-17 12:18:08,533 [INFO] Batch 1: Hidden states shape: torch.Size([32, 76, 768])
2025-01-17 12:18:08,533 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,534 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,534 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,534 [INFO] Batch 2: batch_size 32
2025-01-17 12:18:08,581 [INFO] Batch 2: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:18:08,582 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,582 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,582 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,582 [INFO] Batch 3: batch_size 32
2025-01-17 12:18:08,639 [INFO] Batch 3: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:08,640 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,640 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,640 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,641 [INFO] Batch 4: batch_size 32
2025-01-17 12:18:08,684 [INFO] Batch 4: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:08,684 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,685 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,685 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,685 [INFO] Batch 5: batch_size 32
2025-01-17 12:18:08,727 [INFO] Batch 5: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:08,728 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,728 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,728 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,728 [INFO] Batch 6: batch_size 32
2025-01-17 12:18:08,771 [INFO] Batch 6: Hidden states shape: torch.Size([32, 50, 768])
2025-01-17 12:18:08,772 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,772 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,772 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,772 [INFO] Batch 7: batch_size 32
2025-01-17 12:18:08,817 [INFO] Batch 7: Hidden states shape: torch.Size([32, 49, 768])
2025-01-17 12:18:08,818 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,818 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,818 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,819 [INFO] Batch 8: batch_size 32
2025-01-17 12:18:08,862 [INFO] Batch 8: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:18:08,863 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,863 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,863 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,864 [INFO] Batch 9: batch_size 32
2025-01-17 12:18:08,908 [INFO] Batch 9: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:08,909 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,909 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,909 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,910 [INFO] Batch 10: batch_size 32
2025-01-17 12:18:08,952 [INFO] Batch 10: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:18:08,953 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,953 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,953 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,953 [INFO] Batch 11: batch_size 32
2025-01-17 12:18:08,998 [INFO] Batch 11: Hidden states shape: torch.Size([32, 39, 768])
2025-01-17 12:18:08,999 [INFO] Computing non-zero element counts
2025-01-17 12:18:08,999 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:08,999 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:08,999 [INFO] Batch 12: batch_size 32
2025-01-17 12:18:09,043 [INFO] Batch 12: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:18:09,044 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,044 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,044 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,045 [INFO] Batch 13: batch_size 32
2025-01-17 12:18:09,089 [INFO] Batch 13: Hidden states shape: torch.Size([32, 48, 768])
2025-01-17 12:18:09,090 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,090 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,091 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,091 [INFO] Batch 14: batch_size 32
2025-01-17 12:18:09,133 [INFO] Batch 14: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:18:09,134 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,134 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,134 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,134 [INFO] Batch 15: batch_size 32
2025-01-17 12:18:09,171 [INFO] Batch 15: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:09,172 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,172 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,172 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,172 [INFO] Batch 16: batch_size 32
2025-01-17 12:18:09,206 [INFO] Batch 16: Hidden states shape: torch.Size([32, 58, 768])
2025-01-17 12:18:09,207 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,207 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,207 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,207 [INFO] Batch 17: batch_size 32
2025-01-17 12:18:09,245 [INFO] Batch 17: Hidden states shape: torch.Size([32, 47, 768])
2025-01-17 12:18:09,245 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,246 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,246 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,246 [INFO] Batch 18: batch_size 32
2025-01-17 12:18:09,288 [INFO] Batch 18: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:09,288 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,289 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,289 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,289 [INFO] Batch 19: batch_size 32
2025-01-17 12:18:09,332 [INFO] Batch 19: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:09,333 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,333 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,334 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,334 [INFO] Batch 20: batch_size 32
2025-01-17 12:18:09,376 [INFO] Batch 20: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:09,376 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,376 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,377 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,377 [INFO] Batch 21: batch_size 32
2025-01-17 12:18:09,420 [INFO] Batch 21: Hidden states shape: torch.Size([32, 60, 768])
2025-01-17 12:18:09,421 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,421 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,421 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,421 [INFO] Batch 22: batch_size 32
2025-01-17 12:18:09,464 [INFO] Batch 22: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:18:09,464 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,464 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,465 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,465 [INFO] Batch 23: batch_size 32
2025-01-17 12:18:09,508 [INFO] Batch 23: Hidden states shape: torch.Size([32, 59, 768])
2025-01-17 12:18:09,508 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,508 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,508 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,508 [INFO] Batch 24: batch_size 32
2025-01-17 12:18:09,551 [INFO] Batch 24: Hidden states shape: torch.Size([32, 46, 768])
2025-01-17 12:18:09,552 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,552 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,552 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,553 [INFO] Batch 25: batch_size 32
2025-01-17 12:18:09,596 [INFO] Batch 25: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:09,597 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,597 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,597 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,597 [INFO] Batch 26: batch_size 32
2025-01-17 12:18:09,640 [INFO] Batch 26: Hidden states shape: torch.Size([32, 51, 768])
2025-01-17 12:18:09,641 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,641 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,641 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,642 [INFO] Batch 27: batch_size 32
2025-01-17 12:18:09,687 [INFO] Batch 27: Hidden states shape: torch.Size([32, 43, 768])
2025-01-17 12:18:09,688 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,689 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,689 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,689 [INFO] Batch 28: batch_size 32
2025-01-17 12:18:09,735 [INFO] Batch 28: Hidden states shape: torch.Size([32, 52, 768])
2025-01-17 12:18:09,736 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,736 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,736 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,737 [INFO] Batch 29: batch_size 32
2025-01-17 12:18:09,780 [INFO] Batch 29: Hidden states shape: torch.Size([32, 45, 768])
2025-01-17 12:18:09,781 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,781 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,782 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,782 [INFO] Batch 30: batch_size 32
2025-01-17 12:18:09,826 [INFO] Batch 30: Hidden states shape: torch.Size([32, 53, 768])
2025-01-17 12:18:09,827 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,828 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,828 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,828 [INFO] Batch 31: batch_size 32
2025-01-17 12:18:09,873 [INFO] Batch 31: Hidden states shape: torch.Size([32, 42, 768])
2025-01-17 12:18:09,874 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,874 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,874 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,874 [INFO] Batch 32: batch_size 32
2025-01-17 12:18:09,917 [INFO] Batch 32: Hidden states shape: torch.Size([8, 60, 768])
2025-01-17 12:18:09,917 [INFO] Computing non-zero element counts
2025-01-17 12:18:09,918 [INFO] Computing sum of non-zero elements
2025-01-17 12:18:09,918 [INFO] Computing mean of non-zero elements
2025-01-17 12:18:09,918 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 12:18:09,968 [INFO] Example prompt: Aha, we have good result!
2025-01-17 12:18:15,163 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:15,163 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:19,055 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:19,056 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:23,107 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:23,108 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:27,067 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:27,067 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:31,283 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:31,284 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:35,823 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:35,823 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:39,767 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:39,768 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:43,612 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:43,612 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:47,657 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:47,657 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:51,516 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:51,517 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:55,405 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:55,405 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:18:59,566 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:18:59,566 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:03,476 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:03,476 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:07,317 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:07,317 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:11,325 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:11,325 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:15,441 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:15,442 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:19,643 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:19,644 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:23,559 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:23,559 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:27,370 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:27,370 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:31,324 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:31,324 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:35,330 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:35,331 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:39,578 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:39,578 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:43,416 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:43,416 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:47,394 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:47,395 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:51,318 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:51,319 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:55,593 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:55,594 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:19:59,515 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:19:59,515 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:03,536 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:03,536 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:08,217 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:08,218 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:12,341 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:12,342 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:16,794 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:16,795 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:21,002 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:21,002 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:25,270 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:25,270 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:29,901 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:29,901 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:34,678 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:34,678 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:38,740 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:38,740 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:42,715 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:42,716 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:46,911 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:46,912 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:50,844 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:50,845 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:54,975 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:54,975 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:20:58,884 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:20:58,884 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:02,818 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:02,818 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:07,057 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:07,091 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:11,215 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:11,215 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:15,646 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:15,646 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:20,151 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:20,151 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:24,121 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:24,122 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:28,063 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:28,063 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:32,197 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:32,197 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:36,128 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:36,128 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:39,948 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:39,948 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:43,863 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:43,863 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:47,965 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:47,965 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:51,897 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:51,897 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:21:55,815 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:21:55,815 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:00,111 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:00,112 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:04,629 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:04,629 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:09,074 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:09,075 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:13,545 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:13,545 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:17,464 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:17,464 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:21,862 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:21,863 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:26,065 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:26,066 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:30,089 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:30,089 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:34,675 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:34,676 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:38,772 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:38,772 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:43,017 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:43,017 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:47,168 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:47,168 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:51,137 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:51,137 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:55,198 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:55,199 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:22:59,198 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:22:59,198 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:03,489 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:03,489 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:07,943 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:07,944 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:12,313 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:12,314 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:16,566 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:16,567 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:20,599 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:20,599 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:25,209 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:25,209 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:29,339 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:29,339 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:33,531 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:33,531 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:37,501 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:37,502 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:41,622 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:41,622 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:46,040 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:46,040 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:50,021 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:50,022 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:53,868 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:53,869 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:23:57,864 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:23:57,864 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:01,827 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:01,827 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:05,835 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:05,835 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:10,396 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:10,396 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:14,891 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:14,891 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:19,045 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:19,045 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:23,032 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:23,032 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:26,898 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:26,898 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:31,233 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:31,233 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:35,052 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:35,052 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:39,050 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:39,050 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:43,168 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:43,169 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:47,207 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:47,208 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:51,042 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:51,043 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:55,084 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:55,084 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:24:59,113 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:24:59,113 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-17 12:25:03,211 [INFO] Computing steering vectors using method: val_mul
2025-01-17 12:25:03,211 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-19 16:04:00,985 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-19 16:04:00,987 [INFO] Hyperparameters:
2025-01-19 16:04:00,988 [INFO]   layer: 6
2025-01-19 16:04:00,990 [INFO]   LLM: gpt2-small
2025-01-19 16:04:00,991 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:04:00,993 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-19 16:04:00,994 [INFO]   output_dir: ./results
2025-01-19 16:04:00,996 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-19 16:04:00,997 [INFO]   task: debate
2025-01-19 16:04:00,998 [INFO]   seed: 42
2025-01-19 16:04:01,000 [INFO]   data_size: 1000
2025-01-19 16:04:01,002 [INFO]   device: cuda
2025-01-19 16:04:01,003 [INFO]   alpha: 100
2025-01-19 16:04:01,004 [INFO]   steer: pos-neg
2025-01-19 16:04:01,006 [INFO]   method: val_mul
2025-01-19 16:04:01,012 [INFO]   topk_mean: 100
2025-01-19 16:04:01,013 [INFO]   topk_cnt: 100
2025-01-19 16:04:01,015 [INFO]   batch_size: 32
2025-01-19 16:04:01,019 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-19 16:04:05,402 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:04:05,405 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:05:52,175 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-19 16:05:52,177 [INFO] Hyperparameters:
2025-01-19 16:05:52,179 [INFO]   layer: 6
2025-01-19 16:05:52,180 [INFO]   LLM: gpt2-small
2025-01-19 16:05:52,181 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:05:52,182 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-19 16:05:52,182 [INFO]   output_dir: ./results
2025-01-19 16:05:52,183 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-19 16:05:52,184 [INFO]   task: debate
2025-01-19 16:05:52,185 [INFO]   seed: 42
2025-01-19 16:05:52,186 [INFO]   data_size: 1000
2025-01-19 16:05:52,187 [INFO]   device: cuda
2025-01-19 16:05:52,189 [INFO]   alpha: 100
2025-01-19 16:05:52,190 [INFO]   steer: pos-neg
2025-01-19 16:05:52,191 [INFO]   method: val_mul
2025-01-19 16:05:52,192 [INFO]   topk_mean: 100
2025-01-19 16:05:52,194 [INFO]   topk_cnt: 100
2025-01-19 16:05:52,195 [INFO]   batch_size: 32
2025-01-19 16:05:52,197 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-19 16:06:09,986 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-19 16:06:09,987 [INFO] Hyperparameters:
2025-01-19 16:06:09,988 [INFO]   layer: 6
2025-01-19 16:06:09,989 [INFO]   LLM: gpt2-small
2025-01-19 16:06:09,989 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:06:09,990 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-19 16:06:09,990 [INFO]   output_dir: ./results
2025-01-19 16:06:09,991 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-19 16:06:09,992 [INFO]   task: debate
2025-01-19 16:06:09,993 [INFO]   seed: 42
2025-01-19 16:06:09,993 [INFO]   data_size: 1000
2025-01-19 16:06:09,994 [INFO]   device: cuda
2025-01-19 16:06:09,994 [INFO]   alpha: 100
2025-01-19 16:06:09,995 [INFO]   steer: pos-neg
2025-01-19 16:06:09,995 [INFO]   method: val_mul
2025-01-19 16:06:09,996 [INFO]   topk_mean: 100
2025-01-19 16:06:09,996 [INFO]   topk_cnt: 100
2025-01-19 16:06:09,997 [INFO]   batch_size: 32
2025-01-19 16:06:10,000 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-19 16:06:13,659 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:06:13,662 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:06:34,328 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:06:34,331 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:06:44,792 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:06:44,795 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:07:16,764 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:07:16,767 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:07:16,768 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:07:17,083 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-19 16:08:24,099 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos-neg_alpha_100_cnt_100_mean_100_device_cuda/execution.log
2025-01-19 16:08:24,101 [INFO] Hyperparameters:
2025-01-19 16:08:24,101 [INFO]   layer: 6
2025-01-19 16:08:24,102 [INFO]   LLM: gpt2-small
2025-01-19 16:08:24,103 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:08:24,104 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/ibm_debate
2025-01-19 16:08:24,104 [INFO]   output_dir: ./results
2025-01-19 16:08:24,105 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-19 16:08:24,106 [INFO]   task: debate
2025-01-19 16:08:24,107 [INFO]   seed: 42
2025-01-19 16:08:24,107 [INFO]   data_size: ALL
2025-01-19 16:08:24,108 [INFO]   device: cuda
2025-01-19 16:08:24,110 [INFO]   alpha: 100
2025-01-19 16:08:24,111 [INFO]   steer: pos-neg
2025-01-19 16:08:24,112 [INFO]   method: val_mul
2025-01-19 16:08:24,113 [INFO]   topk_mean: 100
2025-01-19 16:08:24,113 [INFO]   topk_cnt: 100
2025-01-19 16:08:24,114 [INFO]   batch_size: 32
2025-01-19 16:08:24,117 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-19 16:08:27,821 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:08:27,823 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:08:27,836 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:08:28,000 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-19 16:08:28,036 [INFO] Selected 486 support and 486 oppose samples
2025-01-19 16:08:35,438 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:08:35,441 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:08:35,442 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:08:35,643 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-19 16:08:35,650 [INFO] Selected 486 support and 486 oppose samples
2025-01-19 16:08:45,983 [INFO] Loading model: gpt2-small
2025-01-19 16:09:52,200 [INFO] Loading SAE for layer 6
2025-01-19 16:11:06,057 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:11:06,062 [INFO] debatedebatedebatedebatedebatedebatedebatedebatedebatedebate
2025-01-19 16:11:06,085 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/baseline-acl/data/debate/StanceSentences
2025-01-19 16:11:06,315 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-19 16:11:06,325 [INFO] Selected 486 support and 486 oppose samples
