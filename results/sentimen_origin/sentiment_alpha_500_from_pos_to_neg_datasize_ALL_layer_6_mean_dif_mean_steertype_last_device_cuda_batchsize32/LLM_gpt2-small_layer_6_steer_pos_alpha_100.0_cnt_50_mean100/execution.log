2025-01-09 13:34:21,893 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/execution.log
2025-01-09 13:34:21,893 [INFO] Hyperparameters:
2025-01-09 13:34:21,893 [INFO]   layer: 6
2025-01-09 13:34:21,893 [INFO]   LLM: gpt2-small
2025-01-09 13:34:21,893 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:34:21,893 [INFO]   output_dir: ./results
2025-01-09 13:34:21,893 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 13:34:21,893 [INFO]   seed: 42
2025-01-09 13:34:21,893 [INFO]   data_size: 400
2025-01-09 13:34:21,893 [INFO]   device: cuda
2025-01-09 13:34:21,893 [INFO]   alpha: 100.0
2025-01-09 13:34:21,893 [INFO]   steer: pos
2025-01-09 13:34:21,893 [INFO]   method: val_mul
2025-01-09 13:34:21,893 [INFO]   topk_mean: 100
2025-01-09 13:34:21,893 [INFO]   topk_cnt: 50
2025-01-09 13:34:21,893 [INFO]   batch_size: 10
2025-01-09 13:34:21,893 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 13:34:21,893 [INFO] Loading model: gpt2-small
2025-01-09 13:35:02,891 [INFO] Loading SAE for layer 6
2025-01-09 13:35:34,018 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:35:34,073 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 13:35:34,081 [INFO] Selected 400 negative, 400 positive, and 400 neutral samples
2025-01-09 13:35:34,083 [INFO] Running model with cache to obtain hidden states
2025-01-09 13:35:34,260 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 13:35:34,260 [INFO] Encoding hidden states for batch 1
2025-01-09 13:35:34,298 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:35:34,298 [INFO] Encoding hidden states for batch 2
2025-01-09 13:35:34,345 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 13:35:34,345 [INFO] Encoding hidden states for batch 3
2025-01-09 13:35:34,387 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 13:35:34,387 [INFO] Encoding hidden states for batch 4
2025-01-09 13:35:34,421 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 13:35:34,421 [INFO] Encoding hidden states for batch 5
2025-01-09 13:35:34,455 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 13:35:34,455 [INFO] Encoding hidden states for batch 6
2025-01-09 13:35:34,488 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 13:35:34,489 [INFO] Encoding hidden states for batch 7
2025-01-09 13:35:34,525 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 13:35:34,525 [INFO] Encoding hidden states for batch 8
2025-01-09 13:35:34,559 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 13:35:34,559 [INFO] Encoding hidden states for batch 9
2025-01-09 13:35:34,593 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:35:34,593 [INFO] Encoding hidden states for batch 10
2025-01-09 13:35:34,628 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:35:34,628 [INFO] Encoding hidden states for batch 11
2025-01-09 13:35:34,661 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 13:35:34,662 [INFO] Encoding hidden states for batch 12
2025-01-09 13:35:34,694 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:35:34,695 [INFO] Encoding hidden states for batch 13
2025-01-09 13:35:34,728 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:35:34,728 [INFO] Encoding hidden states for batch 14
2025-01-09 13:35:34,761 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:35:34,761 [INFO] Encoding hidden states for batch 15
2025-01-09 13:35:34,795 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 13:35:34,795 [INFO] Encoding hidden states for batch 16
2025-01-09 13:35:34,829 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:35:34,829 [INFO] Encoding hidden states for batch 17
2025-01-09 13:35:34,862 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:35:34,862 [INFO] Encoding hidden states for batch 18
2025-01-09 13:35:34,892 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:35:34,892 [INFO] Encoding hidden states for batch 19
2025-01-09 13:35:34,921 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 13:35:34,922 [INFO] Encoding hidden states for batch 20
2025-01-09 13:35:34,950 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 13:35:34,951 [INFO] Encoding hidden states for batch 21
2025-01-09 13:35:34,984 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 13:35:34,984 [INFO] Encoding hidden states for batch 22
2025-01-09 13:35:35,012 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 13:35:35,013 [INFO] Encoding hidden states for batch 23
2025-01-09 13:35:35,041 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 13:35:35,041 [INFO] Encoding hidden states for batch 24
2025-01-09 13:35:35,076 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 13:35:35,076 [INFO] Encoding hidden states for batch 25
2025-01-09 13:35:35,121 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:35:35,121 [INFO] Encoding hidden states for batch 26
2025-01-09 13:35:35,156 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 13:35:35,156 [INFO] Encoding hidden states for batch 27
2025-01-09 13:35:35,190 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 13:35:35,190 [INFO] Encoding hidden states for batch 28
2025-01-09 13:35:35,227 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:35:35,227 [INFO] Encoding hidden states for batch 29
2025-01-09 13:35:35,260 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 13:35:35,260 [INFO] Encoding hidden states for batch 30
2025-01-09 13:35:35,294 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 13:35:35,294 [INFO] Encoding hidden states for batch 31
2025-01-09 13:35:35,328 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 13:35:35,329 [INFO] Encoding hidden states for batch 32
2025-01-09 13:35:35,361 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 13:35:35,362 [INFO] Encoding hidden states for batch 33
2025-01-09 13:35:35,582 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:35:35,582 [INFO] Encoding hidden states for batch 34
2025-01-09 13:35:35,616 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 13:35:35,617 [INFO] Encoding hidden states for batch 35
2025-01-09 13:35:35,651 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 13:35:35,651 [INFO] Encoding hidden states for batch 36
2025-01-09 13:35:35,685 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 13:35:35,685 [INFO] Encoding hidden states for batch 37
2025-01-09 13:35:35,718 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 13:35:35,719 [INFO] Encoding hidden states for batch 38
2025-01-09 13:35:35,752 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 13:35:35,752 [INFO] Encoding hidden states for batch 39
2025-01-09 13:35:35,785 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 13:35:35,786 [INFO] Encoding hidden states for batch 40
2025-01-09 13:35:35,786 [INFO] Total batches processed: 40
2025-01-09 13:35:35,788 [INFO] 最大长度:121
2025-01-09 13:35:35,798 [INFO] Concatenated batch latents shape: torch.Size([400, 121, 24576])
2025-01-09 13:35:35,798 [INFO] Computing non-zero element counts
2025-01-09 13:35:35,923 [INFO] Computing sum of non-zero elements
2025-01-09 13:35:35,940 [INFO] Computing mean of non-zero elements
2025-01-09 13:35:35,952 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 13:35:35,981 [INFO] Top 100 nz_mean values selected.
2025-01-09 13:35:35,981 [INFO] Selecting top-k indices based on act_cnt
2025-01-09 13:35:35,981 [INFO] Top 50 act_cnt values selected.
2025-01-09 13:35:35,981 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:35:35,986 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:35:35,986 [INFO] Computing steering vectors using method: mean
2025-01-09 13:35:35,986 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:35:35,986 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:35:35,989 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:35:36,011 [INFO] Euclidean distance between mean and val_mul steering vectors: 67.7181396484375
2025-01-09 13:35:36,011 [INFO] Cosine similarity between mean and val_mul steering vectors: 0.6636167764663696
2025-01-09 13:35:36,013 [INFO] Example prompt: Amazing!!!!
2025-01-09 13:35:36,013 [INFO] Generating texts without steering...
2025-01-09 13:35:37,234 [INFO] Generated Text 1: Amazing!!!! This was my first time using the Apple Pencils and I was pleasantly surprised. It is perfect for my writing and all my projects! It's very light, not too heavy or bulky but it does help to keep your pencils on a bit
2025-01-09 13:35:37,235 [INFO] Generated Text 2: Amazing!!!!!! The real deal is I was just so happy. It was like the real deal and my husband wanted to make it, but I had no idea what it would be. My husband got me a nice warm gift with lots of goodies and instructions on
2025-01-09 13:35:37,235 [INFO] Generated Text 3: Amazing!!!!

I'm very excited to be able to offer a 4th and 5th gen PC. I'm so glad I did. The drive was great, it's a good drive but not as fast as the previous 3 from me (2gb
2025-01-09 13:35:37,235 [INFO] Generating texts with steering...
2025-01-09 13:35:37,979 [INFO] Generated Text 1: Amazing!!!!Description

Sorry:

This are a new preview for an & M1A New Profile - 6/2- New Server Name:


Hood Finder (1 2 3 -- New : 2016-10-18 20:00
2025-01-09 13:35:37,979 [INFO] Generated Text 2: Amazing!!!!WASHINGTON, Ohio - U.S. Cache & Storage Finder

Ahem...Ya Guys Ahello! The AMD LG-5: View Here

A nice great guys/bacon Mountain View High-Intang for New Galaxy (
2025-01-09 13:35:37,979 [INFO] Generated Text 3: Amazing!!!!Description

- 5★ new: This time last week (1/2-20 Version - 01:00 am: Game Case for Ordos Rec Preview One's Half /Ahem


Aaubuuvela X Episode Profile Server
2025-01-09 13:35:37,979 [INFO] Saving nz_mean and act_cnt to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/nz_stats.pt
2025-01-09 13:35:37,980 [INFO] Saving generated texts to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/generated_texts.txt
2025-01-09 13:35:37,980 [INFO] Saving hyperparameters to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/hyperparameters.json
2025-01-09 13:35:37,980 [INFO] All results saved successfully.
2025-01-09 13:40:08,615 [INFO] Logging initialized. Logs will be saved to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/execution.log
2025-01-09 13:40:08,615 [INFO] Hyperparameters:
2025-01-09 13:40:08,615 [INFO]   layer: 6
2025-01-09 13:40:08,615 [INFO]   LLM: gpt2-small
2025-01-09 13:40:08,615 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:40:08,615 [INFO]   output_dir: ./results
2025-01-09 13:40:08,615 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-09 13:40:08,615 [INFO]   seed: 42
2025-01-09 13:40:08,615 [INFO]   data_size: 400
2025-01-09 13:40:08,615 [INFO]   device: cuda
2025-01-09 13:40:08,615 [INFO]   alpha: 100.0
2025-01-09 13:40:08,615 [INFO]   steer: pos
2025-01-09 13:40:08,615 [INFO]   method: val_mul
2025-01-09 13:40:08,615 [INFO]   topk_mean: 100
2025-01-09 13:40:08,615 [INFO]   topk_cnt: 50
2025-01-09 13:40:08,616 [INFO]   batch_size: 10
2025-01-09 13:40:08,616 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-09 13:40:08,616 [INFO] Loading model: gpt2-small
2025-01-09 13:40:49,578 [INFO] Loading SAE for layer 6
2025-01-09 13:41:20,859 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/emotional_classify/multiclass-sentiment-analysis
2025-01-09 13:41:20,914 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-09 13:41:20,922 [INFO] Selected 400 negative, 400 positive, and 400 neutral samples
2025-01-09 13:41:20,924 [INFO] Running model with cache to obtain hidden states
2025-01-09 13:41:21,092 [INFO] Batch 1: Hidden states shape: torch.Size([10, 31, 768])
2025-01-09 13:41:21,092 [INFO] Encoding hidden states for batch 1
2025-01-09 13:41:21,136 [INFO] Batch 2: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:41:21,137 [INFO] Encoding hidden states for batch 2
2025-01-09 13:41:21,191 [INFO] Batch 3: Hidden states shape: torch.Size([10, 99, 768])
2025-01-09 13:41:21,191 [INFO] Encoding hidden states for batch 3
2025-01-09 13:41:21,239 [INFO] Batch 4: Hidden states shape: torch.Size([10, 94, 768])
2025-01-09 13:41:21,239 [INFO] Encoding hidden states for batch 4
2025-01-09 13:41:21,273 [INFO] Batch 5: Hidden states shape: torch.Size([10, 92, 768])
2025-01-09 13:41:21,273 [INFO] Encoding hidden states for batch 5
2025-01-09 13:41:21,308 [INFO] Batch 6: Hidden states shape: torch.Size([10, 21, 768])
2025-01-09 13:41:21,308 [INFO] Encoding hidden states for batch 6
2025-01-09 13:41:21,343 [INFO] Batch 7: Hidden states shape: torch.Size([10, 68, 768])
2025-01-09 13:41:21,343 [INFO] Encoding hidden states for batch 7
2025-01-09 13:41:21,377 [INFO] Batch 8: Hidden states shape: torch.Size([10, 84, 768])
2025-01-09 13:41:21,377 [INFO] Encoding hidden states for batch 8
2025-01-09 13:41:21,411 [INFO] Batch 9: Hidden states shape: torch.Size([10, 43, 768])
2025-01-09 13:41:21,411 [INFO] Encoding hidden states for batch 9
2025-01-09 13:41:21,445 [INFO] Batch 10: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:41:21,445 [INFO] Encoding hidden states for batch 10
2025-01-09 13:41:21,479 [INFO] Batch 11: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:41:21,479 [INFO] Encoding hidden states for batch 11
2025-01-09 13:41:21,513 [INFO] Batch 12: Hidden states shape: torch.Size([10, 52, 768])
2025-01-09 13:41:21,514 [INFO] Encoding hidden states for batch 12
2025-01-09 13:41:21,546 [INFO] Batch 13: Hidden states shape: torch.Size([10, 40, 768])
2025-01-09 13:41:21,547 [INFO] Encoding hidden states for batch 13
2025-01-09 13:41:21,579 [INFO] Batch 14: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:41:21,579 [INFO] Encoding hidden states for batch 14
2025-01-09 13:41:21,612 [INFO] Batch 15: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:41:21,613 [INFO] Encoding hidden states for batch 15
2025-01-09 13:41:21,647 [INFO] Batch 16: Hidden states shape: torch.Size([10, 109, 768])
2025-01-09 13:41:21,647 [INFO] Encoding hidden states for batch 16
2025-01-09 13:41:21,681 [INFO] Batch 17: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:41:21,682 [INFO] Encoding hidden states for batch 17
2025-01-09 13:41:21,715 [INFO] Batch 18: Hidden states shape: torch.Size([10, 37, 768])
2025-01-09 13:41:21,715 [INFO] Encoding hidden states for batch 18
2025-01-09 13:41:21,749 [INFO] Batch 19: Hidden states shape: torch.Size([10, 75, 768])
2025-01-09 13:41:21,750 [INFO] Encoding hidden states for batch 19
2025-01-09 13:41:21,784 [INFO] Batch 20: Hidden states shape: torch.Size([10, 82, 768])
2025-01-09 13:41:21,784 [INFO] Encoding hidden states for batch 20
2025-01-09 13:41:21,818 [INFO] Batch 21: Hidden states shape: torch.Size([10, 41, 768])
2025-01-09 13:41:21,818 [INFO] Encoding hidden states for batch 21
2025-01-09 13:41:21,853 [INFO] Batch 22: Hidden states shape: torch.Size([10, 119, 768])
2025-01-09 13:41:21,854 [INFO] Encoding hidden states for batch 22
2025-01-09 13:41:21,887 [INFO] Batch 23: Hidden states shape: torch.Size([10, 55, 768])
2025-01-09 13:41:21,887 [INFO] Encoding hidden states for batch 23
2025-01-09 13:41:21,921 [INFO] Batch 24: Hidden states shape: torch.Size([10, 27, 768])
2025-01-09 13:41:21,921 [INFO] Encoding hidden states for batch 24
2025-01-09 13:41:21,954 [INFO] Batch 25: Hidden states shape: torch.Size([10, 121, 768])
2025-01-09 13:41:21,955 [INFO] Encoding hidden states for batch 25
2025-01-09 13:41:21,995 [INFO] Batch 26: Hidden states shape: torch.Size([10, 116, 768])
2025-01-09 13:41:21,995 [INFO] Encoding hidden states for batch 26
2025-01-09 13:41:22,029 [INFO] Batch 27: Hidden states shape: torch.Size([10, 79, 768])
2025-01-09 13:41:22,029 [INFO] Encoding hidden states for batch 27
2025-01-09 13:41:22,061 [INFO] Batch 28: Hidden states shape: torch.Size([10, 33, 768])
2025-01-09 13:41:22,061 [INFO] Encoding hidden states for batch 28
2025-01-09 13:41:22,095 [INFO] Batch 29: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:41:22,096 [INFO] Encoding hidden states for batch 29
2025-01-09 13:41:22,129 [INFO] Batch 30: Hidden states shape: torch.Size([10, 32, 768])
2025-01-09 13:41:22,129 [INFO] Encoding hidden states for batch 30
2025-01-09 13:41:22,166 [INFO] Batch 31: Hidden states shape: torch.Size([10, 80, 768])
2025-01-09 13:41:22,166 [INFO] Encoding hidden states for batch 31
2025-01-09 13:41:22,201 [INFO] Batch 32: Hidden states shape: torch.Size([10, 104, 768])
2025-01-09 13:41:22,202 [INFO] Encoding hidden states for batch 32
2025-01-09 13:41:22,235 [INFO] Batch 33: Hidden states shape: torch.Size([10, 28, 768])
2025-01-09 13:41:22,235 [INFO] Encoding hidden states for batch 33
2025-01-09 13:41:22,477 [INFO] Batch 34: Hidden states shape: torch.Size([10, 35, 768])
2025-01-09 13:41:22,477 [INFO] Encoding hidden states for batch 34
2025-01-09 13:41:22,512 [INFO] Batch 35: Hidden states shape: torch.Size([10, 70, 768])
2025-01-09 13:41:22,512 [INFO] Encoding hidden states for batch 35
2025-01-09 13:41:22,546 [INFO] Batch 36: Hidden states shape: torch.Size([10, 113, 768])
2025-01-09 13:41:22,546 [INFO] Encoding hidden states for batch 36
2025-01-09 13:41:22,579 [INFO] Batch 37: Hidden states shape: torch.Size([10, 38, 768])
2025-01-09 13:41:22,580 [INFO] Encoding hidden states for batch 37
2025-01-09 13:41:22,613 [INFO] Batch 38: Hidden states shape: torch.Size([10, 42, 768])
2025-01-09 13:41:22,613 [INFO] Encoding hidden states for batch 38
2025-01-09 13:41:22,646 [INFO] Batch 39: Hidden states shape: torch.Size([10, 44, 768])
2025-01-09 13:41:22,646 [INFO] Encoding hidden states for batch 39
2025-01-09 13:41:22,680 [INFO] Batch 40: Hidden states shape: torch.Size([10, 95, 768])
2025-01-09 13:41:22,680 [INFO] Encoding hidden states for batch 40
2025-01-09 13:41:22,681 [INFO] Total batches processed: 40
2025-01-09 13:41:22,682 [INFO] 最大长度:121
2025-01-09 13:41:22,693 [INFO] Concatenated batch latents shape: torch.Size([400, 121, 24576])
2025-01-09 13:41:22,693 [INFO] Computing non-zero element counts
2025-01-09 13:41:22,818 [INFO] Computing sum of non-zero elements
2025-01-09 13:41:22,835 [INFO] Computing mean of non-zero elements
2025-01-09 13:41:22,846 [INFO] Selecting top-k indices based on nz_mean
2025-01-09 13:41:22,866 [INFO] Top 100 nz_mean values selected.
2025-01-09 13:41:22,866 [INFO] Selecting top-k indices based on act_cnt
2025-01-09 13:41:22,866 [INFO] Top 50 act_cnt values selected.
2025-01-09 13:41:22,866 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:41:22,871 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:41:22,871 [INFO] Computing steering vectors using method: mean
2025-01-09 13:41:22,871 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:41:22,871 [INFO] Computing steering vectors using method: val_mul
2025-01-09 13:41:22,874 [INFO] Steering vectors computed with shape: torch.Size([768])
2025-01-09 13:41:22,896 [INFO] Euclidean distance between mean and val_mul steering vectors: 67.7181396484375
2025-01-09 13:41:22,896 [INFO] Cosine similarity between mean and val_mul steering vectors: 0.6636167764663696
2025-01-09 13:41:22,899 [INFO] Example prompt: Amazing!!!!
2025-01-09 13:41:22,899 [INFO] Generating texts without steering...
2025-01-09 13:41:24,188 [INFO] Generated Text 1: Amazing!!!! This was my first time using the Apple Pencils and I was pleasantly surprised. It is perfect for my writing and all my projects! It's very light, not too heavy or bulky but it does help to keep your pencils on a bit
2025-01-09 13:41:24,188 [INFO] Generated Text 2: Amazing!!!!!! The real deal is I was just so happy. It was like the real deal and my husband wanted to make it, but I had no idea what it would be. My husband got me a nice warm gift with lots of goodies and instructions on
2025-01-09 13:41:24,188 [INFO] Generated Text 3: Amazing!!!!

I'm very excited to be able to offer a 4th and 5th gen PC. I'm so glad I did. The drive was great, it's a good drive but not as fast as the previous 3 from me (2gb
2025-01-09 13:41:24,188 [INFO] Generating texts with steering...
2025-01-09 13:41:24,916 [INFO] Generated Text 1: Amazing!!!!Description

Sorry:

This are a new preview for an & M1A New Profile - 6/2- New Server Name:


Hood Finder (1 2 3 -- New : 2016-10-18 20:00
2025-01-09 13:41:24,916 [INFO] Generated Text 2: Amazing!!!!WASHINGTON, Ohio - U.S. Cache & Storage Finder

Ahem...Ya Guys Ahello! The AMD LG-5: View Here

A nice great guys/bacon Mountain View High-Intang for New Galaxy (
2025-01-09 13:41:24,916 [INFO] Generated Text 3: Amazing!!!!Description

- 5★ new: This time last week (1/2-20 Version - 01:00 am: Game Case for Ordos Rec Preview One's Half /Ahem


Aaubuuvela X Episode Profile Server
2025-01-09 13:41:24,916 [INFO] Saving nz_mean and act_cnt to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/nz_stats.pt
2025-01-09 13:41:24,917 [INFO] Saving generated texts to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/generated_texts.txt
2025-01-09 13:41:24,917 [INFO] Saving hyperparameters to ./results/LLM_gpt2-small_layer_6_steer_pos_alpha_100.0_cnt_50_mean100/hyperparameters.json
2025-01-09 13:41:24,917 [INFO] All results saved successfully.
