2025-01-25 04:52:42,896 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_50.0_from_pos_to_neg_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 04:52:42,896 [INFO] Show Hyperparameters: 


2025-01-25 04:52:42,896 [INFO]   task: cot
2025-01-25 04:52:42,896 [INFO]   layer: 6
2025-01-25 04:52:42,896 [INFO]   LLM: gemma-2-2b
2025-01-25 04:52:42,897 [INFO]   seed: 42
2025-01-25 04:52:42,897 [INFO]   data_size: 1000
2025-01-25 04:52:42,897 [INFO]   device: cpu
2025-01-25 04:52:42,897 [INFO]   alpha: 50.0
2025-01-25 04:52:42,897 [INFO]   method: val_mul
2025-01-25 04:52:42,897 [INFO]   topk_mean: 100
2025-01-25 04:52:42,897 [INFO]   topk_cnt: 100
2025-01-25 04:52:42,897 [INFO]   batch_size: 8
2025-01-25 04:52:42,897 [INFO]   source: pos
2025-01-25 04:52:42,897 [INFO]   target: neg
2025-01-25 04:52:42,897 [INFO]   mean_type: dif_mean
2025-01-25 04:52:42,897 [INFO]   steer_type: last
2025-01-25 04:52:42,897 [INFO]   output_dir: ./results/cot/
2025-01-25 04:52:42,897 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:52:42,897 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:52:42,897 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 04:52:42,897 [INFO]   temperature: 0.9
2025-01-25 04:52:42,897 [INFO]   top_p: 0.3
2025-01-25 04:52:42,897 [INFO]   freq_penalty: 1.0
2025-01-25 04:52:42,897 [INFO]   debug: 1
2025-01-25 04:52:42,897 [INFO]   save_no_steer: 1
2025-01-25 04:52:42,897 [INFO]   cache_delta_matrix: 0
2025-01-25 04:52:42,897 [INFO]   is_norm_delta_matrix: 0
2025-01-25 04:52:42,898 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 04:52:42,898 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:52:42,898 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 04:52:42,898 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:52:42,928 [INFO] Filtering dataset for COT
2025-01-25 04:52:42,990 [INFO] POS===Q+COT_A
2025-01-25 04:52:43,008 [INFO] Loading SAE for layer 6 gemma-2-2b
2025-01-25 04:52:55,530 [INFO] Loading model: gemma-2-2b
2025-01-25 04:52:55,531 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 04:52:59,237 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 04:53:07,334 [INFO] 缓存 ./results/cot/gemma-2-2b_cot_alpha_50.0_from_pos_to_neg_datasize_1000_layer_6_mean_dif_mean_steertype_last_device_cpu_batchsize8/steer_info_cache_gemma-2-2b_to_6.pkl 不存在，重新计算 steer_info
2025-01-25 04:53:07,334 [INFO] frompostoneg
2025-01-25 04:53:07,334 [INFO] cot
2025-01-25 04:53:07,341 [INFO] Running model with cache to obtain hidden states
2025-01-25 04:57:19,076 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-25 04:57:19,134 [INFO] Running model with cache to obtain hidden states
