2025-01-25 05:38:51,975 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/alpha_5.0_from_pos_to_neg_mean_dif_mean_steertype_last_device_cpu/execution.log
2025-01-25 05:38:51,976 [INFO] Show Hyperparameters: 


2025-01-25 05:38:51,976 [INFO]   task: cot
2025-01-25 05:38:51,976 [INFO]   layer: 12
2025-01-25 05:38:51,976 [INFO]   LLM: gemma-2-2b
2025-01-25 05:38:51,976 [INFO]   seed: 42
2025-01-25 05:38:51,976 [INFO]   data_size: 300
2025-01-25 05:38:51,976 [INFO]   device: cpu
2025-01-25 05:38:51,976 [INFO]   alpha: 5.0
2025-01-25 05:38:51,976 [INFO]   method: val_mul
2025-01-25 05:38:51,976 [INFO]   topk_mean: 100
2025-01-25 05:38:51,976 [INFO]   topk_cnt: 100
2025-01-25 05:38:51,976 [INFO]   batch_size: 8
2025-01-25 05:38:51,976 [INFO]   source: pos
2025-01-25 05:38:51,976 [INFO]   target: neg
2025-01-25 05:38:51,976 [INFO]   mean_type: dif_mean
2025-01-25 05:38:51,976 [INFO]   steer_type: last
2025-01-25 05:38:51,976 [INFO]   output_dir: ./results/cot/
2025-01-25 05:38:51,976 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:38:51,976 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:38:51,976 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 05:38:51,976 [INFO]   temperature: 0.9
2025-01-25 05:38:51,976 [INFO]   top_p: 0.3
2025-01-25 05:38:51,976 [INFO]   freq_penalty: 1.0
2025-01-25 05:38:51,976 [INFO]   debug: 1
2025-01-25 05:38:51,976 [INFO]   save_no_steer: 1
2025-01-25 05:38:51,976 [INFO]   is_norm_delta_matrix: 0
2025-01-25 05:38:51,976 [INFO]   use_cache: 0
2025-01-25 05:38:51,977 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 05:38:51,977 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:38:51,977 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 05:38:51,977 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:38:51,991 [INFO] Filtering dataset for COT
2025-01-25 05:38:52,036 [INFO] POS===Q+COT_A
2025-01-25 05:38:52,044 [INFO] Loading SAE for layer 12 gemma-2-2b
2025-01-25 05:38:54,444 [INFO] Loading model: gemma-2-2b
2025-01-25 05:38:54,444 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 05:38:58,246 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 05:39:05,803 [INFO] 缓存 ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/steer_info_cache_of_gemma-2-2b_l12.pkl 不存在，缓存 steer_info
2025-01-25 05:39:05,803 [INFO] frompostoneg
2025-01-25 05:39:05,803 [INFO] cot
2025-01-25 05:39:05,808 [INFO] Running model with cache to obtain hidden states
2025-01-25 05:39:18,326 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-25 05:39:18,337 [INFO] Running model with cache to obtain hidden states
2025-01-25 05:39:41,864 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/alpha_5.0_from_pos_to_neg_mean_dif_mean_steertype_last_device_cpu/execution.log
2025-01-25 05:39:41,864 [INFO] Show Hyperparameters: 


2025-01-25 05:39:41,864 [INFO]   task: cot
2025-01-25 05:39:41,864 [INFO]   layer: 12
2025-01-25 05:39:41,864 [INFO]   LLM: gemma-2-2b
2025-01-25 05:39:41,864 [INFO]   seed: 42
2025-01-25 05:39:41,864 [INFO]   data_size: 300
2025-01-25 05:39:41,864 [INFO]   device: cpu
2025-01-25 05:39:41,864 [INFO]   alpha: 5.0
2025-01-25 05:39:41,864 [INFO]   method: val_mul
2025-01-25 05:39:41,864 [INFO]   topk_mean: 100
2025-01-25 05:39:41,864 [INFO]   topk_cnt: 100
2025-01-25 05:39:41,864 [INFO]   batch_size: 8
2025-01-25 05:39:41,864 [INFO]   source: pos
2025-01-25 05:39:41,864 [INFO]   target: neg
2025-01-25 05:39:41,864 [INFO]   mean_type: dif_mean
2025-01-25 05:39:41,865 [INFO]   steer_type: last
2025-01-25 05:39:41,865 [INFO]   output_dir: ./results/cot/
2025-01-25 05:39:41,865 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:39:41,865 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:39:41,865 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 05:39:41,865 [INFO]   temperature: 0.9
2025-01-25 05:39:41,865 [INFO]   top_p: 0.3
2025-01-25 05:39:41,865 [INFO]   freq_penalty: 1.0
2025-01-25 05:39:41,865 [INFO]   debug: 1
2025-01-25 05:39:41,865 [INFO]   save_no_steer: 1
2025-01-25 05:39:41,865 [INFO]   is_norm_delta_matrix: 0
2025-01-25 05:39:41,865 [INFO]   use_cache: 1
2025-01-25 05:39:41,866 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 05:39:41,866 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:39:41,866 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 05:39:41,866 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:39:41,880 [INFO] Filtering dataset for COT
2025-01-25 05:39:41,926 [INFO] POS===Q+COT_A
2025-01-25 05:39:41,935 [INFO] Loading SAE for layer 12 gemma-2-2b
2025-01-25 05:39:49,430 [INFO] Loading model: gemma-2-2b
2025-01-25 05:39:49,431 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 05:39:53,456 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 05:40:01,452 [INFO] 从缓存 ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/steer_info_cache_of_gemma-2-2b_l12.pkl 中加载 steer_info
2025-01-25 05:40:04,454 [INFO] 转向方向 dif_neg-pos_relu
2025-01-25 05:40:04,455 [INFO] sae cfg.hook_name 挂载名称: blocks.0.hook_resid_post
2025-01-25 05:40:04,459 [INFO] delta_matrix: tensor([ 0.0386,  0.0966, -0.0387,  ..., -0.0599, -0.1833, -0.0663],
       grad_fn=<AddBackward0>)
2025-01-25 05:40:04,459 [INFO] Example prompt:  Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:40:04,459 [INFO] Generating texts **without** steering... 
2025-01-25 05:40:04,464 [INFO] 无干预
2025-01-25 05:40:17,714 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:40:17,714 [INFO] Generated Text: 1:
y?
A: 36

Q: What is the next number in this sequence?
1, 2, 4, 7, ?
A: 10

Q: What is the next number in this sequence?
10,
2025-01-25 05:40:17,714 [INFO] Generated Text: 2:
y?
A: 36

Q: What is the value of x in this equation?
x + 1 = 2x - 3
A: -2

Q: Which number is a solution to this equation?
-4(x
2025-01-25 05:40:17,714 [INFO] Generated Text: 3:
y?
A: 36

Q: A student is taking a test with 10 questions, each worth 1 point. The student gets one point for every correct answer and loses one point for every incorrect answer. If the student gets at least one correct
2025-01-25 05:40:17,715 [INFO] 干预之后的结果
2025-01-25 05:40:17,715 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-25 05:40:17,715 [INFO] ** Generating texts with steering... Target **
2025-01-25 05:40:17,715 [INFO] form pos to neg
2025-01-25 05:40:31,687 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:40:31,688 [INFO] Generated Text: 1:
y?
A: 36

Q: A car is traveling at a constant speed of 120 miles per hour. How many feet does it travel in one minute?
A: 18,000

Q: What is the product
2025-01-25 05:40:31,688 [INFO] Generated Text: 2:
y?
A: 39.20

Q: A student has a test tomorrow that is worth 10 points, a quiz on Friday that is worth 15 points, and a project due next week that is worth 25 points. The
2025-01-25 05:40:31,688 [INFO] Generated Text: 3:
y?
A: 36

Q: The number of students in a class is 10 more than twice the number of girls in the class. If there are 24 girls in the class, how many boys are there?
A: 1
2025-01-25 05:40:31,692 [INFO] Show Hyperparameters: 


2025-01-25 05:40:31,692 [INFO]   task: cot
2025-01-25 05:40:31,692 [INFO]   layer: 12
2025-01-25 05:40:31,692 [INFO]   LLM: gemma-2-2b
2025-01-25 05:40:31,692 [INFO]   seed: 42
2025-01-25 05:40:31,692 [INFO]   data_size: 300
2025-01-25 05:40:31,692 [INFO]   device: cpu
2025-01-25 05:40:31,692 [INFO]   alpha: 5.0
2025-01-25 05:40:31,692 [INFO]   method: val_mul
2025-01-25 05:40:31,692 [INFO]   topk_mean: 100
2025-01-25 05:40:31,692 [INFO]   topk_cnt: 100
2025-01-25 05:40:31,692 [INFO]   batch_size: 8
2025-01-25 05:40:31,692 [INFO]   source: pos
2025-01-25 05:40:31,692 [INFO]   target: neg
2025-01-25 05:40:31,692 [INFO]   mean_type: dif_mean
2025-01-25 05:40:31,692 [INFO]   steer_type: last
2025-01-25 05:40:31,692 [INFO]   output_dir: ./results/cot/
2025-01-25 05:40:31,692 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:40:31,693 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:40:31,693 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 05:40:31,693 [INFO]   temperature: 0.9
2025-01-25 05:40:31,693 [INFO]   top_p: 0.3
2025-01-25 05:40:31,693 [INFO]   freq_penalty: 1.0
2025-01-25 05:40:31,693 [INFO]   debug: 1
2025-01-25 05:40:31,693 [INFO]   save_no_steer: 1
2025-01-25 05:40:31,693 [INFO]   is_norm_delta_matrix: 0
2025-01-25 05:40:31,693 [INFO]   use_cache: 1
2025-01-25 05:40:31,693 [INFO] debug mode,show example, no full dataset eval
