2025-01-25 05:41:26,811 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/alpha_20.0_from_pos_to_neg_mean_dif_mean_steertype_last_device_cpu/execution.log
2025-01-25 05:41:26,811 [INFO] Show Hyperparameters: 


2025-01-25 05:41:26,811 [INFO]   task: cot
2025-01-25 05:41:26,811 [INFO]   layer: 12
2025-01-25 05:41:26,811 [INFO]   LLM: gemma-2-2b
2025-01-25 05:41:26,811 [INFO]   seed: 42
2025-01-25 05:41:26,811 [INFO]   data_size: 300
2025-01-25 05:41:26,811 [INFO]   device: cpu
2025-01-25 05:41:26,812 [INFO]   alpha: 20.0
2025-01-25 05:41:26,812 [INFO]   method: val_mul
2025-01-25 05:41:26,812 [INFO]   topk_mean: 100
2025-01-25 05:41:26,812 [INFO]   topk_cnt: 100
2025-01-25 05:41:26,812 [INFO]   batch_size: 8
2025-01-25 05:41:26,812 [INFO]   source: pos
2025-01-25 05:41:26,812 [INFO]   target: neg
2025-01-25 05:41:26,812 [INFO]   mean_type: dif_mean
2025-01-25 05:41:26,812 [INFO]   steer_type: last
2025-01-25 05:41:26,812 [INFO]   output_dir: ./results/cot/
2025-01-25 05:41:26,812 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:41:26,812 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:41:26,812 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 05:41:26,812 [INFO]   temperature: 0.9
2025-01-25 05:41:26,812 [INFO]   top_p: 0.3
2025-01-25 05:41:26,812 [INFO]   freq_penalty: 1.0
2025-01-25 05:41:26,812 [INFO]   debug: 1
2025-01-25 05:41:26,812 [INFO]   save_no_steer: 1
2025-01-25 05:41:26,812 [INFO]   is_norm_delta_matrix: 0
2025-01-25 05:41:26,812 [INFO]   use_cache: 1
2025-01-25 05:41:26,812 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 05:41:26,813 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:41:26,813 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 05:41:26,813 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:41:26,826 [INFO] Filtering dataset for COT
2025-01-25 05:41:26,864 [INFO] POS===Q+COT_A
2025-01-25 05:41:26,871 [INFO] Loading SAE for layer 12 gemma-2-2b
2025-01-25 05:41:29,102 [INFO] Loading model: gemma-2-2b
2025-01-25 05:41:29,103 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 05:41:33,062 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 05:41:40,832 [INFO] 从缓存 ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/steer_info_cache_of_gemma-2-2b_l12.pkl 中加载 steer_info
2025-01-25 05:41:43,834 [INFO] 转向方向 dif_neg-pos_relu
2025-01-25 05:41:43,835 [INFO] sae cfg.hook_name 挂载名称: blocks.0.hook_resid_post
2025-01-25 05:41:43,839 [INFO] delta_matrix: tensor([ 0.0386,  0.0966, -0.0387,  ..., -0.0599, -0.1833, -0.0663],
       grad_fn=<AddBackward0>)
2025-01-25 05:41:43,839 [INFO] Example prompt:  Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:41:43,839 [INFO] Generating texts **without** steering... 
2025-01-25 05:41:43,843 [INFO] 无干预
2025-01-25 05:41:57,043 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:41:57,043 [INFO] Generated Text: 1:
y?
A: 39

Q: What is the area of a rectangle with a length of 12 inches and a width of 6 inches?
A: 72

Q: What is the area of a square with sides that are each
2025-01-25 05:41:57,043 [INFO] Generated Text: 2:
y?
A: 36

Q: A car is traveling at a constant speed of 120 miles per hour.  How many feet does it travel in one minute?
A: 18,000

Q: A bag contains
2025-01-25 05:41:57,043 [INFO] Generated Text: 3:
y?
A: 39

Q: What is the next number in this sequence?
1, 2, 4, 7, ?
A: 10

Q: What is the next number in this sequence?
26,
2025-01-25 05:41:57,043 [INFO] 干预之后的结果
2025-01-25 05:41:57,043 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-25 05:41:57,043 [INFO] ** Generating texts with steering... Target **
2025-01-25 05:41:57,043 [INFO] form pos to neg
2025-01-25 05:42:09,568 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 05:42:09,568 [INFO] Generated Text: 1:
y?
A: Cody pays $10 for a book that was originally priced at $12.50? A: The original price of the book was $12.50 B: The original price of the book was $13 C: The
2025-01-25 05:42:09,568 [INFO] Generated Text: 2:
y?
A: Cody goes to the store and buys a $40 shirt. He gets a 10% discount on his purchase. How much does he save? A: Cody saves $32 B: Cody saves $36 C: Cody saves $
2025-01-25 05:42:09,568 [INFO] Generated Text: 3:
y?
A: The answer is C) The total cost of the project is $120,000.
B) The total cost of the project is $135,000.
C) The total cost of the project is
2025-01-25 05:42:09,572 [INFO] Show Hyperparameters: 


2025-01-25 05:42:09,572 [INFO]   task: cot
2025-01-25 05:42:09,572 [INFO]   layer: 12
2025-01-25 05:42:09,572 [INFO]   LLM: gemma-2-2b
2025-01-25 05:42:09,572 [INFO]   seed: 42
2025-01-25 05:42:09,572 [INFO]   data_size: 300
2025-01-25 05:42:09,572 [INFO]   device: cpu
2025-01-25 05:42:09,572 [INFO]   alpha: 20.0
2025-01-25 05:42:09,572 [INFO]   method: val_mul
2025-01-25 05:42:09,572 [INFO]   topk_mean: 100
2025-01-25 05:42:09,572 [INFO]   topk_cnt: 100
2025-01-25 05:42:09,572 [INFO]   batch_size: 8
2025-01-25 05:42:09,572 [INFO]   source: pos
2025-01-25 05:42:09,572 [INFO]   target: neg
2025-01-25 05:42:09,572 [INFO]   mean_type: dif_mean
2025-01-25 05:42:09,572 [INFO]   steer_type: last
2025-01-25 05:42:09,572 [INFO]   output_dir: ./results/cot/
2025-01-25 05:42:09,572 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:42:09,572 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 05:42:09,573 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 05:42:09,573 [INFO]   temperature: 0.9
2025-01-25 05:42:09,573 [INFO]   top_p: 0.3
2025-01-25 05:42:09,573 [INFO]   freq_penalty: 1.0
2025-01-25 05:42:09,573 [INFO]   debug: 1
2025-01-25 05:42:09,573 [INFO]   save_no_steer: 1
2025-01-25 05:42:09,573 [INFO]   is_norm_delta_matrix: 0
2025-01-25 05:42:09,573 [INFO]   use_cache: 1
2025-01-25 05:42:09,573 [INFO] debug mode,show example, no full dataset eval
2025-01-25 15:19:14,985 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/alpha_20.0_from_pos_to_neg_mean_dif_mean_steertype_last_device_cpu/execution.log
2025-01-25 15:19:14,985 [INFO] Show Hyperparameters: 


2025-01-25 15:19:14,985 [INFO]   task: cot
2025-01-25 15:19:14,985 [INFO]   layer: 12
2025-01-25 15:19:14,985 [INFO]   LLM: gemma-2-2b
2025-01-25 15:19:14,985 [INFO]   seed: 42
2025-01-25 15:19:14,985 [INFO]   data_size: 300
2025-01-25 15:19:14,985 [INFO]   device: cpu
2025-01-25 15:19:14,985 [INFO]   alpha: 20.0
2025-01-25 15:19:14,985 [INFO]   method: val_mul
2025-01-25 15:19:14,985 [INFO]   topk_mean: 100
2025-01-25 15:19:14,985 [INFO]   topk_cnt: 100
2025-01-25 15:19:14,985 [INFO]   batch_size: 8
2025-01-25 15:19:14,985 [INFO]   source: pos
2025-01-25 15:19:14,985 [INFO]   target: neg
2025-01-25 15:19:14,985 [INFO]   mean_type: dif_mean
2025-01-25 15:19:14,985 [INFO]   steer_type: last
2025-01-25 15:19:14,985 [INFO]   output_dir: ./results/cot/
2025-01-25 15:19:14,985 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:14,985 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:14,985 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 15:19:14,985 [INFO]   temperature: 0.9
2025-01-25 15:19:14,985 [INFO]   top_p: 0.3
2025-01-25 15:19:14,986 [INFO]   freq_penalty: 1.0
2025-01-25 15:19:14,986 [INFO]   debug: 1
2025-01-25 15:19:14,986 [INFO]   save_no_steer: 1
2025-01-25 15:19:14,986 [INFO]   is_norm_delta_matrix: 0
2025-01-25 15:19:14,986 [INFO]   use_cache: 1
2025-01-25 15:19:14,986 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 15:19:14,986 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:14,986 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 15:19:14,986 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:14,999 [INFO] Filtering dataset for COT
2025-01-25 15:19:15,043 [INFO] POS===Q+COT_A
2025-01-25 15:19:15,052 [INFO] Loading SAE for layer 12 gemma-2-2b
2025-01-25 15:19:17,171 [INFO] Loading model: gemma-2-2b
2025-01-25 15:19:17,172 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 15:19:20,531 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 15:19:28,168 [INFO] 从缓存 ./results/cot/gemma-2-2b_cot_layer_12_datasize_300_batchsize8/steer_info_cache_of_gemma-2-2b_l12.pkl 中加载 steer_info
2025-01-25 15:19:31,170 [INFO] 转向方向 dif_neg-pos_relu
2025-01-25 15:19:31,171 [INFO] sae cfg.hook_name 挂载名称: blocks.0.hook_resid_post
2025-01-25 15:19:31,176 [INFO] delta_matrix: tensor([ 0.0386,  0.0966, -0.0387,  ..., -0.0599, -0.1833, -0.0663],
       grad_fn=<AddBackward0>)
2025-01-25 15:19:31,177 [INFO] Example prompt:  Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 15:19:31,177 [INFO] Generating texts **without** steering... 
2025-01-25 15:19:31,184 [INFO] 无干预
2025-01-25 15:19:44,024 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 15:19:44,024 [INFO] Generated Text: 1:
y?
A: 36

Q: A group of friends is going to a movie theater. The tickets cost $12 each, and they want to buy popcorn for everyone at the theater. If they have a total of $120, how many
2025-01-25 15:19:44,024 [INFO] Generated Text: 2:
y?
A: 36

Q: What is the value of x in this equation?
2x + 1 = 7
A: 3

Q: Which expression is equivalent to (1/2)<sup>4</sup> ?
A:
2025-01-25 15:19:44,024 [INFO] Generated Text: 3:
y?
A: 39

Q: A man has a dog that weighs 12 pounds more than twice as much as his cat. If the dog weighs 76 pounds, how much does the cat weigh?
A: 20

Q
2025-01-25 15:19:44,024 [INFO] 干预之后的结果
2025-01-25 15:19:44,024 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-25 15:19:44,024 [INFO] ** Generating texts with steering... Target **
2025-01-25 15:19:44,024 [INFO] form pos to neg
2025-01-25 15:19:57,409 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 15:19:57,409 [INFO] Generated Text: 1:
y?
A: Cody goes to the store and buys a new shirt for $20. The shirt is on sale for 20% off, so he only pays $16 for it. What is the original price of the shirt? A: The original
2025-01-25 15:19:57,409 [INFO] Generated Text: 2:
y?
A: Cody goes to the store and buys a new shirt for $10. He also buys a pair of jeans for $20. How much does he spend in total? A: Cody spends a total of $30 on his new shirt and
2025-01-25 15:19:57,409 [INFO] Generated Text: 3:
y?
A: Cody pays $10 for a shirt that is on sale for 25% off. What was the original price of the shirt? A: The original price of the shirt was $12.50 B: The original price of the
2025-01-25 15:19:57,414 [INFO] Show Hyperparameters: 


2025-01-25 15:19:57,414 [INFO]   task: cot
2025-01-25 15:19:57,414 [INFO]   layer: 12
2025-01-25 15:19:57,415 [INFO]   LLM: gemma-2-2b
2025-01-25 15:19:57,415 [INFO]   seed: 42
2025-01-25 15:19:57,415 [INFO]   data_size: 300
2025-01-25 15:19:57,415 [INFO]   device: cpu
2025-01-25 15:19:57,415 [INFO]   alpha: 20.0
2025-01-25 15:19:57,415 [INFO]   method: val_mul
2025-01-25 15:19:57,415 [INFO]   topk_mean: 100
2025-01-25 15:19:57,415 [INFO]   topk_cnt: 100
2025-01-25 15:19:57,415 [INFO]   batch_size: 8
2025-01-25 15:19:57,415 [INFO]   source: pos
2025-01-25 15:19:57,415 [INFO]   target: neg
2025-01-25 15:19:57,415 [INFO]   mean_type: dif_mean
2025-01-25 15:19:57,415 [INFO]   steer_type: last
2025-01-25 15:19:57,415 [INFO]   output_dir: ./results/cot/
2025-01-25 15:19:57,415 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:57,415 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 15:19:57,415 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 15:19:57,415 [INFO]   temperature: 0.9
2025-01-25 15:19:57,415 [INFO]   top_p: 0.3
2025-01-25 15:19:57,415 [INFO]   freq_penalty: 1.0
2025-01-25 15:19:57,415 [INFO]   debug: 1
2025-01-25 15:19:57,415 [INFO]   save_no_steer: 1
2025-01-25 15:19:57,415 [INFO]   is_norm_delta_matrix: 0
2025-01-25 15:19:57,415 [INFO]   use_cache: 1
2025-01-25 15:19:57,415 [INFO] debug mode,show example, no full dataset eval
