2025-01-25 03:43:14,430 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:43:14,430 [INFO] Show Hyperparameters: 


2025-01-25 03:43:14,430 [INFO]   task: cot
2025-01-25 03:43:14,430 [INFO]   layer: 0
2025-01-25 03:43:14,430 [INFO]   LLM: gemma-2-2b
2025-01-25 03:43:14,430 [INFO]   seed: 42
2025-01-25 03:43:14,430 [INFO]   data_size: 1000
2025-01-25 03:43:14,430 [INFO]   device: cpu
2025-01-25 03:43:14,430 [INFO]   alpha: 300.0
2025-01-25 03:43:14,430 [INFO]   method: val_mul
2025-01-25 03:43:14,430 [INFO]   topk_mean: 100
2025-01-25 03:43:14,430 [INFO]   topk_cnt: 100
2025-01-25 03:43:14,430 [INFO]   batch_size: 8
2025-01-25 03:43:14,430 [INFO]   source: pos
2025-01-25 03:43:14,430 [INFO]   target: neg
2025-01-25 03:43:14,430 [INFO]   mean_type: dif_mean
2025-01-25 03:43:14,430 [INFO]   steer_type: last
2025-01-25 03:43:14,430 [INFO]   output_dir: ./results/cot/
2025-01-25 03:43:14,430 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:14,430 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:14,430 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:43:14,430 [INFO]   temperature: 0.9
2025-01-25 03:43:14,431 [INFO]   top_p: 0.3
2025-01-25 03:43:14,431 [INFO]   freq_penalty: 1.0
2025-01-25 03:43:14,431 [INFO]   debug: 1
2025-01-25 03:43:14,431 [INFO]   save_no_steer: 1
2025-01-25 03:43:14,431 [INFO]   cache_delta_matrix: 0
2025-01-25 03:43:14,431 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:43:14,431 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:43:14,431 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:14,431 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:43:14,431 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:14,468 [INFO] Filtering dataset for COT
2025-01-25 03:43:14,543 [INFO] POS===Q+COT_A
2025-01-25 03:43:14,565 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:43:14,565 [INFO] Loading model: gemma-2-2b
2025-01-25 03:43:14,566 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 03:43:43,196 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:43:43,196 [INFO] Show Hyperparameters: 


2025-01-25 03:43:43,196 [INFO]   task: cot
2025-01-25 03:43:43,196 [INFO]   layer: 0
2025-01-25 03:43:43,196 [INFO]   LLM: gemma-2-2b
2025-01-25 03:43:43,196 [INFO]   seed: 42
2025-01-25 03:43:43,196 [INFO]   data_size: 1000
2025-01-25 03:43:43,196 [INFO]   device: cpu
2025-01-25 03:43:43,196 [INFO]   alpha: 300.0
2025-01-25 03:43:43,196 [INFO]   method: val_mul
2025-01-25 03:43:43,196 [INFO]   topk_mean: 100
2025-01-25 03:43:43,196 [INFO]   topk_cnt: 100
2025-01-25 03:43:43,196 [INFO]   batch_size: 8
2025-01-25 03:43:43,196 [INFO]   source: pos
2025-01-25 03:43:43,196 [INFO]   target: neg
2025-01-25 03:43:43,196 [INFO]   mean_type: dif_mean
2025-01-25 03:43:43,196 [INFO]   steer_type: last
2025-01-25 03:43:43,196 [INFO]   output_dir: ./results/cot/
2025-01-25 03:43:43,196 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:43,196 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:43,196 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:43:43,196 [INFO]   temperature: 0.9
2025-01-25 03:43:43,196 [INFO]   top_p: 0.3
2025-01-25 03:43:43,196 [INFO]   freq_penalty: 1.0
2025-01-25 03:43:43,196 [INFO]   debug: 1
2025-01-25 03:43:43,196 [INFO]   save_no_steer: 1
2025-01-25 03:43:43,196 [INFO]   cache_delta_matrix: 0
2025-01-25 03:43:43,196 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:43:43,197 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:43:43,197 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:43,197 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:43:43,197 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:43:43,226 [INFO] Filtering dataset for COT
2025-01-25 03:43:43,287 [INFO] POS===Q+COT_A
2025-01-25 03:43:43,304 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:43:43,304 [INFO] Loading model: gemma-2-2b
2025-01-25 03:43:43,304 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 03:44:06,249 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:44:06,249 [INFO] Show Hyperparameters: 


2025-01-25 03:44:06,249 [INFO]   task: cot
2025-01-25 03:44:06,249 [INFO]   layer: 0
2025-01-25 03:44:06,249 [INFO]   LLM: gemma-2-2b
2025-01-25 03:44:06,249 [INFO]   seed: 42
2025-01-25 03:44:06,249 [INFO]   data_size: 1000
2025-01-25 03:44:06,249 [INFO]   device: cpu
2025-01-25 03:44:06,249 [INFO]   alpha: 300.0
2025-01-25 03:44:06,249 [INFO]   method: val_mul
2025-01-25 03:44:06,249 [INFO]   topk_mean: 100
2025-01-25 03:44:06,249 [INFO]   topk_cnt: 100
2025-01-25 03:44:06,249 [INFO]   batch_size: 8
2025-01-25 03:44:06,249 [INFO]   source: pos
2025-01-25 03:44:06,249 [INFO]   target: neg
2025-01-25 03:44:06,249 [INFO]   mean_type: dif_mean
2025-01-25 03:44:06,249 [INFO]   steer_type: last
2025-01-25 03:44:06,249 [INFO]   output_dir: ./results/cot/
2025-01-25 03:44:06,249 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:06,250 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:06,250 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:44:06,250 [INFO]   temperature: 0.9
2025-01-25 03:44:06,250 [INFO]   top_p: 0.3
2025-01-25 03:44:06,250 [INFO]   freq_penalty: 1.0
2025-01-25 03:44:06,250 [INFO]   debug: 1
2025-01-25 03:44:06,250 [INFO]   save_no_steer: 1
2025-01-25 03:44:06,250 [INFO]   cache_delta_matrix: 0
2025-01-25 03:44:06,250 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:44:06,250 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:44:06,250 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:06,250 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:44:06,250 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:06,273 [INFO] Filtering dataset for COT
2025-01-25 03:44:06,324 [INFO] POS===Q+COT_A
2025-01-25 03:44:06,340 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:44:06,340 [INFO] Loading model: gemma-2-2b
2025-01-25 03:44:53,545 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:44:53,545 [INFO] Show Hyperparameters: 


2025-01-25 03:44:53,545 [INFO]   task: cot
2025-01-25 03:44:53,545 [INFO]   layer: 0
2025-01-25 03:44:53,545 [INFO]   LLM: gemma-2-2b
2025-01-25 03:44:53,545 [INFO]   seed: 42
2025-01-25 03:44:53,545 [INFO]   data_size: 1000
2025-01-25 03:44:53,545 [INFO]   device: cpu
2025-01-25 03:44:53,545 [INFO]   alpha: 300.0
2025-01-25 03:44:53,545 [INFO]   method: val_mul
2025-01-25 03:44:53,545 [INFO]   topk_mean: 100
2025-01-25 03:44:53,545 [INFO]   topk_cnt: 100
2025-01-25 03:44:53,545 [INFO]   batch_size: 8
2025-01-25 03:44:53,545 [INFO]   source: pos
2025-01-25 03:44:53,545 [INFO]   target: neg
2025-01-25 03:44:53,545 [INFO]   mean_type: dif_mean
2025-01-25 03:44:53,545 [INFO]   steer_type: last
2025-01-25 03:44:53,546 [INFO]   output_dir: ./results/cot/
2025-01-25 03:44:53,546 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:53,546 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:53,546 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:44:53,546 [INFO]   temperature: 0.9
2025-01-25 03:44:53,546 [INFO]   top_p: 0.3
2025-01-25 03:44:53,546 [INFO]   freq_penalty: 1.0
2025-01-25 03:44:53,546 [INFO]   debug: 1
2025-01-25 03:44:53,546 [INFO]   save_no_steer: 1
2025-01-25 03:44:53,546 [INFO]   cache_delta_matrix: 0
2025-01-25 03:44:53,546 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:44:53,546 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:44:53,546 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:53,546 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:44:53,546 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:44:53,571 [INFO] Filtering dataset for COT
2025-01-25 03:44:53,635 [INFO] POS===Q+COT_A
2025-01-25 03:44:53,653 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:44:53,653 [INFO] Loading model: gemma-2-2b
2025-01-25 03:50:18,103 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:50:18,103 [INFO] Show Hyperparameters: 


2025-01-25 03:50:18,103 [INFO]   task: cot
2025-01-25 03:50:18,103 [INFO]   layer: 0
2025-01-25 03:50:18,103 [INFO]   LLM: gemma-2-2b
2025-01-25 03:50:18,103 [INFO]   seed: 42
2025-01-25 03:50:18,103 [INFO]   data_size: 1000
2025-01-25 03:50:18,103 [INFO]   device: cpu
2025-01-25 03:50:18,103 [INFO]   alpha: 300.0
2025-01-25 03:50:18,103 [INFO]   method: val_mul
2025-01-25 03:50:18,103 [INFO]   topk_mean: 100
2025-01-25 03:50:18,103 [INFO]   topk_cnt: 100
2025-01-25 03:50:18,103 [INFO]   batch_size: 8
2025-01-25 03:50:18,103 [INFO]   source: pos
2025-01-25 03:50:18,103 [INFO]   target: neg
2025-01-25 03:50:18,103 [INFO]   mean_type: dif_mean
2025-01-25 03:50:18,103 [INFO]   steer_type: last
2025-01-25 03:50:18,103 [INFO]   output_dir: ./results/cot/
2025-01-25 03:50:18,103 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:50:18,103 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:50:18,103 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:50:18,103 [INFO]   temperature: 0.9
2025-01-25 03:50:18,103 [INFO]   top_p: 0.3
2025-01-25 03:50:18,103 [INFO]   freq_penalty: 1.0
2025-01-25 03:50:18,103 [INFO]   debug: 1
2025-01-25 03:50:18,103 [INFO]   save_no_steer: 1
2025-01-25 03:50:18,103 [INFO]   cache_delta_matrix: 0
2025-01-25 03:50:18,103 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:50:18,104 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:50:18,104 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:50:18,104 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:50:18,104 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:50:18,134 [INFO] Filtering dataset for COT
2025-01-25 03:50:18,193 [INFO] POS===Q+COT_A
2025-01-25 03:50:18,211 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:50:18,211 [INFO] Loading model: gemma-2-2b
2025-01-25 03:51:03,314 [INFO] Logging initialized. Logs will be saved to ./results/cot/gemma-2-2b_cot_alpha_300.0_from_pos_to_neg_datasize_1000_layer_0_mean_dif_mean_steertype_last_device_cpu_batchsize8/execution.log
2025-01-25 03:51:03,314 [INFO] Show Hyperparameters: 


2025-01-25 03:51:03,314 [INFO]   task: cot
2025-01-25 03:51:03,314 [INFO]   layer: 0
2025-01-25 03:51:03,315 [INFO]   LLM: gemma-2-2b
2025-01-25 03:51:03,315 [INFO]   seed: 42
2025-01-25 03:51:03,315 [INFO]   data_size: 1000
2025-01-25 03:51:03,315 [INFO]   device: cpu
2025-01-25 03:51:03,315 [INFO]   alpha: 300.0
2025-01-25 03:51:03,315 [INFO]   method: val_mul
2025-01-25 03:51:03,315 [INFO]   topk_mean: 100
2025-01-25 03:51:03,315 [INFO]   topk_cnt: 100
2025-01-25 03:51:03,315 [INFO]   batch_size: 8
2025-01-25 03:51:03,315 [INFO]   source: pos
2025-01-25 03:51:03,315 [INFO]   target: neg
2025-01-25 03:51:03,315 [INFO]   mean_type: dif_mean
2025-01-25 03:51:03,315 [INFO]   steer_type: last
2025-01-25 03:51:03,315 [INFO]   output_dir: ./results/cot/
2025-01-25 03:51:03,315 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:51:03,315 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:51:03,316 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 03:51:03,316 [INFO]   temperature: 0.9
2025-01-25 03:51:03,316 [INFO]   top_p: 0.3
2025-01-25 03:51:03,316 [INFO]   freq_penalty: 1.0
2025-01-25 03:51:03,316 [INFO]   debug: 1
2025-01-25 03:51:03,316 [INFO]   save_no_steer: 1
2025-01-25 03:51:03,316 [INFO]   cache_delta_matrix: 0
2025-01-25 03:51:03,316 [INFO]   is_norm_delta_matrix: 0
2025-01-25 03:51:03,317 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-25 03:51:03,317 [INFO] dataset path /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:51:03,317 [INFO] COT COT COT COT COT COT COT COT COT COT 
2025-01-25 03:51:03,317 [INFO] Loading dataset from /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 03:51:03,347 [INFO] Filtering dataset for COT
2025-01-25 03:51:03,429 [INFO] POS===Q+COT_A
2025-01-25 03:51:03,446 [INFO] Loading SAE for layer 0 gemma-2-2b
2025-01-25 03:51:38,326 [INFO] Loading model: gemma-2-2b
2025-01-25 03:51:38,327 [WARNING] You tried to specify center_unembed=True for a model using logit softcap, but this can't be done! Softcapping is not invariant upon adding a constant Setting center_unembed=False instead.
2025-01-25 03:52:15,541 [WARNING] Error while downloading from https://cdn-lfs-us-1.hf-mirror.com/repos/58/05/5805374ced011521b05321183a27655675fe84380c06cd753aecc57bc87ae6e1/1425aa066ec77e3eb79aac14a5bdea3ebcec46aa5c96cd40608c5c1fd70d193d?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model-00001-of-00003.safetensors%3B+filename%3D%22model-00001-of-00003.safetensors%22%3B&Expires=1737751898&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTczNzc1MTg5OH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zLzU4LzA1LzU4MDUzNzRjZWQwMTE1MjFiMDUzMjExODNhMjc2NTU2NzVmZTg0MzgwYzA2Y2Q3NTNhZWNjNTdiYzg3YWU2ZTEvMTQyNWFhMDY2ZWM3N2UzZWI3OWFhYzE0YTViZGVhM2ViY2VjNDZhYTVjOTZjZDQwNjA4YzVjMWZkNzBkMTkzZD9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=qnONOMQD%7EKRowQMKAqIwePdQzZXT9OJF-X6%7EPJfHGKwFIb56ozzoyNYgOe%7EuGcqi1MOO5ulY4yorJGXoiAXEsi9Pw5P4-0iIXZlKwl-1kO-dUZ--9RU8FTbiD2lG96-8uotZKgvnj7owuT9%7Ej8FCLjil5rV7Xgv0PAIpNuhljh79dmx9Cbo0FPc7G71W4lNrAfbDfz0Dk9U-zyK4Z9n1LCS7vrZBtoo-Tr-Fgl9B9ImXQMscU9H6GTUIGwim%7E98HczQE6CTbN-5Kz4t6B-YWSsK9xYPmc0OooEWDbdBexgRN7P1RZbY%7Em0ugGtw8aB1kQeVo9wvf2lUQtjM5RFkRmg__&Key-Pair-Id=K24J24Z295AEI9: HTTPSConnectionPool(host='cdn-lfs-us-1.hf-mirror.com', port=443): Read timed out.
Trying to resume download...
2025-01-25 03:57:18,670 [WARNING] Error while downloading from https://cdn-lfs-us-1.hf-mirror.com/repos/58/05/5805374ced011521b05321183a27655675fe84380c06cd753aecc57bc87ae6e1/96c111d3dcdbde9271595e463b5d9f7fc4810ad8b79e736309c0a1833e6c0d35?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model-00002-of-00003.safetensors%3B+filename%3D%22model-00002-of-00003.safetensors%22%3B&Expires=1737752208&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTczNzc1MjIwOH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zLzU4LzA1LzU4MDUzNzRjZWQwMTE1MjFiMDUzMjExODNhMjc2NTU2NzVmZTg0MzgwYzA2Y2Q3NTNhZWNjNTdiYzg3YWU2ZTEvOTZjMTExZDNkY2RiZGU5MjcxNTk1ZTQ2M2I1ZDlmN2ZjNDgxMGFkOGI3OWU3MzYzMDljMGExODMzZTZjMGQzNT9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=PNCzw2uprIibA5ncftGj4iwDnVDkwPc642nitTvrfD364b-cyx1MIm1EkJ31gUrlDJvYs1REDeToMRLyA2-aerqqm7dxUaCFKrAnNqnHi27hGwQ0PV2ApCd1vL4UtVSB-Y5C%7EkHI8JSD5Si0mGgOCfqXEG8a9Y7bj5QoVyambmzzp0jHKQtnx-Ru-h0yeIo50p%7EPW4iNuFmxjgbPFQI93z3UsAyzl7ozsUGYtfJ-pzu8l80Mj7QQYJ-0Dg9lKvWeOvnZLXFpRQbVK2p8eH1c2-qAP-S7IrgflQ6XCHX4wwy--27yBIBWiBMPbt7xwoEcg79tvhotY56RleCoT3bhKA__&Key-Pair-Id=K24J24Z295AEI9: HTTPSConnectionPool(host='cdn-lfs-us-1.hf-mirror.com', port=443): Read timed out.
Trying to resume download...
2025-01-25 03:59:45,141 [WARNING] Error while downloading from https://cdn-lfs-us-1.hf-mirror.com/repos/58/05/5805374ced011521b05321183a27655675fe84380c06cd753aecc57bc87ae6e1/96c111d3dcdbde9271595e463b5d9f7fc4810ad8b79e736309c0a1833e6c0d35?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model-00002-of-00003.safetensors%3B+filename%3D%22model-00002-of-00003.safetensors%22%3B&Expires=1737752208&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTczNzc1MjIwOH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zLzU4LzA1LzU4MDUzNzRjZWQwMTE1MjFiMDUzMjExODNhMjc2NTU2NzVmZTg0MzgwYzA2Y2Q3NTNhZWNjNTdiYzg3YWU2ZTEvOTZjMTExZDNkY2RiZGU5MjcxNTk1ZTQ2M2I1ZDlmN2ZjNDgxMGFkOGI3OWU3MzYzMDljMGExODMzZTZjMGQzNT9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=PNCzw2uprIibA5ncftGj4iwDnVDkwPc642nitTvrfD364b-cyx1MIm1EkJ31gUrlDJvYs1REDeToMRLyA2-aerqqm7dxUaCFKrAnNqnHi27hGwQ0PV2ApCd1vL4UtVSB-Y5C%7EkHI8JSD5Si0mGgOCfqXEG8a9Y7bj5QoVyambmzzp0jHKQtnx-Ru-h0yeIo50p%7EPW4iNuFmxjgbPFQI93z3UsAyzl7ozsUGYtfJ-pzu8l80Mj7QQYJ-0Dg9lKvWeOvnZLXFpRQbVK2p8eH1c2-qAP-S7IrgflQ6XCHX4wwy--27yBIBWiBMPbt7xwoEcg79tvhotY56RleCoT3bhKA__&Key-Pair-Id=K24J24Z295AEI9: HTTPSConnectionPool(host='cdn-lfs-us-1.hf-mirror.com', port=443): Read timed out.
Trying to resume download...
2025-01-25 04:03:02,709 [WARNING] You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-01-25 04:03:10,633 [INFO] frompostoneg
2025-01-25 04:03:10,633 [INFO] cot
2025-01-25 04:03:10,642 [INFO] Running model with cache to obtain hidden states
2025-01-25 04:07:08,443 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-25 04:07:08,454 [INFO] Running model with cache to obtain hidden states
2025-01-25 04:18:03,849 [INFO] Total non-zero element shape: torch.Size([16384])
2025-01-25 04:18:04,266 [INFO] 转向方向 dif_neg-pos_relu
2025-01-25 04:18:04,267 [INFO] sae cfg.hook_name 挂载名称: blocks.0.hook_resid_post
2025-01-25 04:18:04,271 [INFO] delta_matrix: tensor([-0.0090,  0.0166, -0.0237,  ...,  0.0009,  0.0406, -0.0553],
       grad_fn=<AddBackward0>)
2025-01-25 04:18:04,272 [INFO] Example prompt:  Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 04:18:04,272 [INFO] Generating texts **without** steering... 
2025-01-25 04:18:04,276 [INFO] 无干预
2025-01-25 04:18:15,815 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 04:18:15,815 [INFO] Generated Text: 1:
y?
A: 39.20

Q: A box of cereal costs $12.50 at a grocery store, but it is on sale for 15% off. What is the sale price?
A: 10.
2025-01-25 04:18:15,815 [INFO] Generated Text: 2:
y?
A: 36

Q: A car is going 20 miles per hour. It takes 1 hour to get from point A to point B. What is the distance between points A and B?
A: 20

Q:
2025-01-25 04:18:15,815 [INFO] Generated Text: 3:
y?
A: 36

Q: What is the value of x in this equation?
x + 1 = 20
A: 19

Q: Which expression is equivalent to (3^2) * (3^4)?
2025-01-25 04:18:15,815 [INFO] 干预之后的结果
2025-01-25 04:18:15,815 [INFO] 干预方向pos->neg,礼貌任务下，neg=impolite，情感任务下 pos=积极情感
2025-01-25 04:18:15,815 [INFO] ** Generating texts with steering... Target **
2025-01-25 04:18:15,815 [INFO] form pos to neg
2025-01-25 04:18:27,605 [INFO] prompt:*****
 Q: Cody goes to the store and buys $40 worth of stuff.  The taxes were 5%.  After taxes, he got an $8 discount.  Cody and his friend split the final price equally. How much did Cody pay?
A:
2025-01-25 04:18:27,605 [INFO] Generated Text: 1:
y?
A:


picasмаз


2AV ofta Va VaVaVaNaverververjaverdolujaversesjajaVynku to many people neverjarsedsykatel Maru1vru GleanerstoviDruhrugihfinsikivijan
2025-01-25 04:18:27,605 [INFO] Generated Text: 2:
y?
A:S lot of


ESESESESes dương


2ца Culver


2nd to get outtavudet VeritasSA SingapurajaDGV



2ViondesjaDDrawable form to good enough timesEscomFileDescriptor1 ofjadiki刀
2025-01-25 04:18:27,605 [INFO] Generated Text: 3:
y?
A:





LASLocalTime spot to s s smodel1st person Pes Pes Pes Pessivesesepseiseija VesVesVesVespesesjs Vesves VesVesjaV Marusedves Vesveses pesPessimareladesu
2025-01-25 04:18:27,609 [INFO] Show Hyperparameters: 


2025-01-25 04:18:27,609 [INFO]   task: cot
2025-01-25 04:18:27,609 [INFO]   layer: 0
2025-01-25 04:18:27,609 [INFO]   LLM: gemma-2-2b
2025-01-25 04:18:27,609 [INFO]   seed: 42
2025-01-25 04:18:27,609 [INFO]   data_size: 1000
2025-01-25 04:18:27,609 [INFO]   device: cpu
2025-01-25 04:18:27,609 [INFO]   alpha: 300.0
2025-01-25 04:18:27,609 [INFO]   method: val_mul
2025-01-25 04:18:27,609 [INFO]   topk_mean: 100
2025-01-25 04:18:27,609 [INFO]   topk_cnt: 100
2025-01-25 04:18:27,609 [INFO]   batch_size: 8
2025-01-25 04:18:27,609 [INFO]   source: pos
2025-01-25 04:18:27,609 [INFO]   target: neg
2025-01-25 04:18:27,609 [INFO]   mean_type: dif_mean
2025-01-25 04:18:27,609 [INFO]   steer_type: last
2025-01-25 04:18:27,609 [INFO]   output_dir: ./results/cot/
2025-01-25 04:18:27,609 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:18:27,609 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/ACL_useful_dataset/math/COT_GSM8k
2025-01-25 04:18:27,609 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-25 04:18:27,610 [INFO]   temperature: 0.9
2025-01-25 04:18:27,610 [INFO]   top_p: 0.3
2025-01-25 04:18:27,610 [INFO]   freq_penalty: 1.0
2025-01-25 04:18:27,610 [INFO]   debug: 1
2025-01-25 04:18:27,610 [INFO]   save_no_steer: 1
2025-01-25 04:18:27,610 [INFO]   cache_delta_matrix: 0
2025-01-25 04:18:27,610 [INFO]   is_norm_delta_matrix: 0
2025-01-25 04:18:27,610 [INFO] debug mode,show example, no full dataset eval
