2025-01-17 18:47:12,063 [INFO] Logging initialized. Logs will be saved to /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files/alpha_500_from_pos_to_neg_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize64/execution.log
2025-01-17 18:47:12,064 [INFO] Hyperparameters:
2025-01-17 18:47:12,064 [INFO]   layer: 6
2025-01-17 18:47:12,064 [INFO]   LLM: gpt2-small
2025-01-17 18:47:12,064 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:47:12,064 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 18:47:12,064 [INFO]   output_dir: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files
2025-01-17 18:47:12,064 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 18:47:12,064 [INFO]   task: sentiment
2025-01-17 18:47:12,064 [INFO]   seed: 42
2025-01-17 18:47:12,064 [INFO]   data_size: ALL
2025-01-17 18:47:12,064 [INFO]   device: cuda
2025-01-17 18:47:12,064 [INFO]   alpha: 500
2025-01-17 18:47:12,064 [INFO]   method: val_mul
2025-01-17 18:47:12,064 [INFO]   topk_mean: 100
2025-01-17 18:47:12,064 [INFO]   topk_cnt: 100
2025-01-17 18:47:12,064 [INFO]   batch_size: 64
2025-01-17 18:47:12,064 [INFO]   source: pos
2025-01-17 18:47:12,064 [INFO]   target: neg
2025-01-17 18:47:12,064 [INFO]   mean_type: dif_mean
2025-01-17 18:47:12,064 [INFO]   steer_type: last
2025-01-17 18:47:12,064 [INFO]   save_compared: False
2025-01-17 18:47:12,064 [INFO]   debug: False
2025-01-17 18:47:12,064 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 18:47:12,064 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:47:12,064 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 18:47:12,065 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 18:47:12,163 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 18:50:06,439 [INFO] Logging initialized. Logs will be saved to /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files/alpha_500_from_pos_to_neg_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize64/execution.log
2025-01-17 18:50:06,439 [INFO] Hyperparameters:
2025-01-17 18:50:06,439 [INFO]   layer: 6
2025-01-17 18:50:06,439 [INFO]   LLM: gpt2-small
2025-01-17 18:50:06,439 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:50:06,439 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 18:50:06,439 [INFO]   output_dir: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files
2025-01-17 18:50:06,439 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 18:50:06,439 [INFO]   task: sentiment
2025-01-17 18:50:06,439 [INFO]   seed: 42
2025-01-17 18:50:06,439 [INFO]   data_size: ALL
2025-01-17 18:50:06,439 [INFO]   device: cuda
2025-01-17 18:50:06,439 [INFO]   alpha: 500
2025-01-17 18:50:06,439 [INFO]   method: val_mul
2025-01-17 18:50:06,439 [INFO]   topk_mean: 100
2025-01-17 18:50:06,439 [INFO]   topk_cnt: 100
2025-01-17 18:50:06,439 [INFO]   batch_size: 64
2025-01-17 18:50:06,439 [INFO]   source: pos
2025-01-17 18:50:06,439 [INFO]   target: neg
2025-01-17 18:50:06,439 [INFO]   mean_type: dif_mean
2025-01-17 18:50:06,439 [INFO]   steer_type: last
2025-01-17 18:50:06,439 [INFO]   save_compared: False
2025-01-17 18:50:06,439 [INFO]   debug: False
2025-01-17 18:50:06,440 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 18:50:06,440 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:50:06,440 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 18:50:06,440 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 18:50:06,568 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 18:54:02,821 [INFO] Logging initialized. Logs will be saved to /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files/alpha_500_from_pos_to_neg_datasize_ALL_layer_6_mean_dif_mean_steertype_last_device_cuda_batchsize64/execution.log
2025-01-17 18:54:02,821 [INFO] Hyperparameters:
2025-01-17 18:54:02,821 [INFO]   layer: 6
2025-01-17 18:54:02,821 [INFO]   LLM: gpt2-small
2025-01-17 18:54:02,821 [INFO]   dataset_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:54:02,821 [INFO]   prompt_path: /home/ckqsudo/code2024/0dataset/baseline-acl/data/prompts/sentiment_prompts-10k
2025-01-17 18:54:02,821 [INFO]   output_dir: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/src/evaluations/gen_files
2025-01-17 18:54:02,822 [INFO]   env_path: /home/ckqsudo/code2024/CKQ_ACL2024/Control_Infer/SAE-simple/.env
2025-01-17 18:54:02,822 [INFO]   task: sentiment
2025-01-17 18:54:02,822 [INFO]   seed: 42
2025-01-17 18:54:02,822 [INFO]   data_size: ALL
2025-01-17 18:54:02,822 [INFO]   device: cuda
2025-01-17 18:54:02,822 [INFO]   alpha: 500
2025-01-17 18:54:02,822 [INFO]   method: val_mul
2025-01-17 18:54:02,822 [INFO]   topk_mean: 100
2025-01-17 18:54:02,822 [INFO]   topk_cnt: 100
2025-01-17 18:54:02,822 [INFO]   batch_size: 64
2025-01-17 18:54:02,822 [INFO]   source: pos
2025-01-17 18:54:02,822 [INFO]   target: neg
2025-01-17 18:54:02,822 [INFO]   mean_type: dif_mean
2025-01-17 18:54:02,822 [INFO]   steer_type: last
2025-01-17 18:54:02,822 [INFO]   save_compared: False
2025-01-17 18:54:02,822 [INFO]   debug: False
2025-01-17 18:54:02,822 [INFO] HF_ENDPOINT: https://hf-mirror.com
2025-01-17 18:54:02,822 [INFO] dataset path /home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5
2025-01-17 18:54:02,822 [INFO] Loading dataset from ****/home/ckqsudo/code2024/0dataset/baseline-acl/data/sentiment/sst5***
2025-01-17 18:54:02,823 [WARNING] Repo card metadata block was not found. Setting CardData to empty.
2025-01-17 18:54:02,950 [INFO] Filtering dataset for negative, positive, and neutral samples
2025-01-17 18:54:03,199 [INFO] Selected 3310 negative, 1624 positive, and 3610 neutral samples
2025-01-17 18:54:03,199 [INFO] Loading model: gpt2-small
2025-01-17 18:54:49,630 [INFO] Loading SAE for layer 6
2025-01-17 18:55:30,979 [INFO] frompostoneg
2025-01-17 18:55:30,980 [INFO] positive
2025-01-17 18:55:30,989 [INFO] Running model with cache to obtain hidden states
2025-01-17 18:55:30,990 [INFO] Batch 1: batch_size 64
2025-01-17 18:55:31,197 [INFO] Batch 1: Hidden states shape: torch.Size([64, 51, 768])
2025-01-17 18:55:31,198 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,205 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,205 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,206 [INFO] Batch 2: batch_size 64
2025-01-17 18:55:31,269 [INFO] Batch 2: Hidden states shape: torch.Size([64, 52, 768])
2025-01-17 18:55:31,270 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,270 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,270 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,270 [INFO] Batch 3: batch_size 64
2025-01-17 18:55:31,307 [INFO] Batch 3: Hidden states shape: torch.Size([64, 49, 768])
2025-01-17 18:55:31,308 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,308 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,308 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,308 [INFO] Batch 4: batch_size 64
2025-01-17 18:55:31,347 [INFO] Batch 4: Hidden states shape: torch.Size([64, 47, 768])
2025-01-17 18:55:31,347 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,347 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,348 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,348 [INFO] Batch 5: batch_size 64
2025-01-17 18:55:31,385 [INFO] Batch 5: Hidden states shape: torch.Size([64, 50, 768])
2025-01-17 18:55:31,385 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,386 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,386 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,386 [INFO] Batch 6: batch_size 64
2025-01-17 18:55:31,427 [INFO] Batch 6: Hidden states shape: torch.Size([64, 56, 768])
2025-01-17 18:55:31,428 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,428 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,428 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,428 [INFO] Batch 7: batch_size 64
2025-01-17 18:55:31,471 [INFO] Batch 7: Hidden states shape: torch.Size([64, 53, 768])
2025-01-17 18:55:31,471 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,471 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,471 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,471 [INFO] Batch 8: batch_size 64
2025-01-17 18:55:31,511 [INFO] Batch 8: Hidden states shape: torch.Size([64, 41, 768])
2025-01-17 18:55:31,511 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,512 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,512 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,512 [INFO] Batch 9: batch_size 64
2025-01-17 18:55:31,547 [INFO] Batch 9: Hidden states shape: torch.Size([64, 46, 768])
2025-01-17 18:55:31,548 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,548 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,548 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,548 [INFO] Batch 10: batch_size 64
2025-01-17 18:55:31,585 [INFO] Batch 10: Hidden states shape: torch.Size([64, 60, 768])
2025-01-17 18:55:31,586 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,586 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,586 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,586 [INFO] Batch 11: batch_size 64
2025-01-17 18:55:31,634 [INFO] Batch 11: Hidden states shape: torch.Size([64, 56, 768])
2025-01-17 18:55:31,634 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,635 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,635 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,635 [INFO] Batch 12: batch_size 64
2025-01-17 18:55:31,675 [INFO] Batch 12: Hidden states shape: torch.Size([64, 44, 768])
2025-01-17 18:55:31,675 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,675 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,676 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,676 [INFO] Batch 13: batch_size 64
2025-01-17 18:55:31,712 [INFO] Batch 13: Hidden states shape: torch.Size([64, 53, 768])
2025-01-17 18:55:31,712 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,712 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,712 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,712 [INFO] Batch 14: batch_size 64
2025-01-17 18:55:31,757 [INFO] Batch 14: Hidden states shape: torch.Size([64, 52, 768])
2025-01-17 18:55:31,757 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,757 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,757 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,757 [INFO] Batch 15: batch_size 64
2025-01-17 18:55:31,798 [INFO] Batch 15: Hidden states shape: torch.Size([64, 49, 768])
2025-01-17 18:55:31,799 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,799 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,799 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,799 [INFO] Batch 16: batch_size 64
2025-01-17 18:55:31,838 [INFO] Batch 16: Hidden states shape: torch.Size([64, 56, 768])
2025-01-17 18:55:31,838 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,838 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,839 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,839 [INFO] Batch 17: batch_size 64
2025-01-17 18:55:31,882 [INFO] Batch 17: Hidden states shape: torch.Size([64, 54, 768])
2025-01-17 18:55:31,883 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,883 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,883 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,883 [INFO] Batch 18: batch_size 64
2025-01-17 18:55:31,924 [INFO] Batch 18: Hidden states shape: torch.Size([64, 52, 768])
2025-01-17 18:55:31,924 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,924 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,924 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,925 [INFO] Batch 19: batch_size 64
2025-01-17 18:55:31,965 [INFO] Batch 19: Hidden states shape: torch.Size([64, 54, 768])
2025-01-17 18:55:31,966 [INFO] Computing non-zero element counts
2025-01-17 18:55:31,966 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:31,966 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:31,966 [INFO] Batch 20: batch_size 64
2025-01-17 18:55:32,051 [INFO] Batch 20: Hidden states shape: torch.Size([64, 62, 768])
2025-01-17 18:55:32,052 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,159 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,159 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,159 [INFO] Batch 21: batch_size 64
2025-01-17 18:55:32,213 [INFO] Batch 21: Hidden states shape: torch.Size([64, 57, 768])
2025-01-17 18:55:32,214 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,214 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,214 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,214 [INFO] Batch 22: batch_size 64
2025-01-17 18:55:32,252 [INFO] Batch 22: Hidden states shape: torch.Size([64, 53, 768])
2025-01-17 18:55:32,253 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,253 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,253 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,253 [INFO] Batch 23: batch_size 64
2025-01-17 18:55:32,295 [INFO] Batch 23: Hidden states shape: torch.Size([64, 59, 768])
2025-01-17 18:55:32,295 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,296 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,296 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,296 [INFO] Batch 24: batch_size 64
2025-01-17 18:55:32,341 [INFO] Batch 24: Hidden states shape: torch.Size([64, 50, 768])
2025-01-17 18:55:32,341 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,341 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,342 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,342 [INFO] Batch 25: batch_size 64
2025-01-17 18:55:32,382 [INFO] Batch 25: Hidden states shape: torch.Size([64, 53, 768])
2025-01-17 18:55:32,382 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,383 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,383 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,383 [INFO] Batch 26: batch_size 64
2025-01-17 18:55:32,425 [INFO] Batch 26: Hidden states shape: torch.Size([24, 45, 768])
2025-01-17 18:55:32,425 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,425 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,425 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,427 [INFO] Total non-zero element shape: torch.Size([24576])
2025-01-17 18:55:32,428 [INFO] negative
2025-01-17 18:55:32,442 [INFO] Running model with cache to obtain hidden states
2025-01-17 18:55:32,442 [INFO] Batch 1: batch_size 64
2025-01-17 18:55:32,477 [INFO] Batch 1: Hidden states shape: torch.Size([64, 55, 768])
2025-01-17 18:55:32,478 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,478 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,478 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,478 [INFO] Batch 2: batch_size 64
2025-01-17 18:55:32,523 [INFO] Batch 2: Hidden states shape: torch.Size([64, 52, 768])
2025-01-17 18:55:32,524 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,525 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,525 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,525 [INFO] Batch 3: batch_size 64
2025-01-17 18:55:32,565 [INFO] Batch 3: Hidden states shape: torch.Size([64, 45, 768])
2025-01-17 18:55:32,565 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,565 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,565 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,566 [INFO] Batch 4: batch_size 64
2025-01-17 18:55:32,602 [INFO] Batch 4: Hidden states shape: torch.Size([64, 51, 768])
2025-01-17 18:55:32,603 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,603 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,603 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,603 [INFO] Batch 5: batch_size 64
2025-01-17 18:55:32,646 [INFO] Batch 5: Hidden states shape: torch.Size([64, 54, 768])
2025-01-17 18:55:32,646 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,707 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,708 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,708 [INFO] Batch 6: batch_size 64
2025-01-17 18:55:32,747 [INFO] Batch 6: Hidden states shape: torch.Size([64, 51, 768])
2025-01-17 18:55:32,748 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,748 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,748 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,748 [INFO] Batch 7: batch_size 64
2025-01-17 18:55:32,786 [INFO] Batch 7: Hidden states shape: torch.Size([64, 46, 768])
2025-01-17 18:55:32,786 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,786 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,786 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,787 [INFO] Batch 8: batch_size 64
2025-01-17 18:55:32,823 [INFO] Batch 8: Hidden states shape: torch.Size([64, 48, 768])
2025-01-17 18:55:32,824 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,824 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,825 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,825 [INFO] Batch 9: batch_size 64
2025-01-17 18:55:32,878 [INFO] Batch 9: Hidden states shape: torch.Size([64, 51, 768])
2025-01-17 18:55:32,879 [INFO] Computing non-zero element counts
2025-01-17 18:55:32,879 [INFO] Computing sum of non-zero elements
2025-01-17 18:55:32,879 [INFO] Computing mean of non-zero elements
2025-01-17 18:55:32,879 [INFO] Batch 10: batch_size 64
